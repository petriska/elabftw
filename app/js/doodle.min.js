/*! elabftw https://www.elabftw.net */

$(document).ready(function(){function addClick(x,y,dragging){clickX.push(x),clickY.push(y),clickDrag.push(dragging)}function redraw(){context.clearRect(0,0,context.canvas.width,context.canvas.height),context.strokeStyle="#29AEB9",context.lineJoin="round",context.lineWidth=5;for(var i=0;i<clickX.length;i++)context.beginPath(),clickDrag[i]&&i?context.moveTo(clickX[i-1],clickY[i-1]):context.moveTo(clickX[i]-1,clickY[i]),context.lineTo(clickX[i],clickY[i]),context.closePath(),context.stroke()}$(".canvasDiv").hide(),$(document).on("click",".toggleCanvas",function(){$(".canvasDiv").toggle()}),$(document).on("click",".clearCanvas",function(){context.clearRect(0,0,context.canvas.width,context.canvas.height),clickX=[],clickY=[],clickDrag=[]}),$(document).on("click",".saveCanvas",function(){var image=$("#doodleCanvas")[0].toDataURL(),type=$(this).data("type"),id=$(this).data("id");$.post("app/controllers/EntityController.php",{addFromString:!0,type:type,id:id,fileType:"png",string:image}).done(function(){"items"===type&&(type="database"),$("#filesdiv").load(type+".php?mode=edit&id="+id+" #filesdiv"),notif("Saved","ok")})});var paint,clickX=[],clickY=[],clickDrag=[];context=document.getElementById("doodleCanvas").getContext("2d"),$("#doodleCanvas").mousedown(function(e){paint=!0,addClick(e.pageX-this.offsetLeft,e.pageY-this.offsetTop),redraw()}),$("#doodleCanvas").mousemove(function(e){paint&&(addClick(e.pageX-this.offsetLeft,e.pageY-this.offsetTop,!0),redraw())}),$("#doodleCanvas").mouseup(function(){paint=!1}),$("#doodleCanvas").mouseleave(function(){paint=!1})});