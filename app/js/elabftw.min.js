/*! elabftw https://www.elabftw.net */

function addDateOnCursor(){var todayDate=new Date,year=todayDate.getFullYear(),month=todayDate.getMonth()+1;month<10&&(month="0"+month);var day=todayDate.getDate();day<10&&(day="0"+day),tinyMCE.activeEditor.execCommand("mceInsertContent",!1,year+"-"+month+"-"+day+" ")}function notif(text,cssClass){var htmlText="<p>"+text+"</p>";overlayClass="ok"===cssClass?"overlay-ok":"overlay-ko";var overlay=document.createElement("div");overlay.setAttribute("id","overlay"),overlay.setAttribute("class","overlay "+overlayClass),document.body.appendChild(overlay),document.getElementById("overlay").innerHTML=htmlText,window.setTimeout(removeNotif,2733)}function removeNotif(){$("#overlay").fadeOut(763,function(){$(this).remove()})}function getGetParameters(){var prmstr=window.location.search.substr(1);return null!==prmstr&&""!==prmstr?transformToAssocArray(prmstr):{}}function transformToAssocArray(prmstr){for(var params={},prmarr=prmstr.split("&"),i=0;i<prmarr.length;i++){var tmparr=prmarr[i].split("=");params[tmparr[0]]=tmparr[1]}return params}function isInt(n){return n%1==0}function toggleLock(type,id){$.post("app/controllers/EntityController.php",{lock:!0,type:type,id:id}).done(function(data){data.res?(notif(data.msg,"ok"),current=$("#lock").attr("src"),"app/img/lock-gray.png"===current?$("#lock").attr("src","app/img/unlock.png"):$("#lock").attr("src","app/img/lock-gray.png")):notif(data.msg,"ko")})}function quickSave(type,id){$.post("app/controllers/EntityController.php",{quickSave:!0,type:type,id:id,title:document.getElementById("title_input").value,date:document.getElementById("datepicker").value,body:tinymce.activeEditor.getContent()}).done(function(data,textStatus,xhr){if("1"===xhr.getResponseHeader("X-Elab-Need-Auth"))return localStorage.setItem("body",tinymce.activeEditor.getContent()),localStorage.setItem("id",id),localStorage.setItem("type",type),localStorage.setItem("date",(new Date).toLocaleString()),void location.reload();data.res?notif(data.msg,"ok"):notif(data.msg,"ko")})}function makeEditableFileComment(type,itemId){$(".thumbnail p.editable").editable(function(value,settings){return $.post("app/controllers/EntityController.php",{updateFileComment:!0,type:type,comment:value,comment_id:$(this).attr("id"),id:itemId}).done(function(data){data.res?notif(data.msg,"ok"):notif(data.msg,"ko")}),value},{tooltip:"Click to edit",indicator:"Saving...",name:"fileComment",submit:"Save",cancel:"Cancel",style:"display:inline"})}function insertParamAndReload(key,value){key=escape(key),value=escape(value);var kvp=document.location.search.substr(1).split("&");if(""===kvp)document.location.search="?"+key+"="+value;else{for(var x,i=kvp.length;i--;)if((x=kvp[i].split("="))[0]===key){x[1]=value,kvp[i]=x.join("=");break}i<0&&(kvp[kvp.length]=[key,value].join("=")),document.location.search=kvp.join("&")}}function readFile(file,onLoadCallback){if(!window.FileReader)return alert("Please use a modern web browser. Import aborted."),!1;var reader=new FileReader;reader.onload=onLoadCallback,reader.readAsText(file)}function getQueryParams(qs){qs=qs.split("+").join(" ");for(var tokens,params={},re=/[?&]?([^=]+)=([^&]*)/g;null!==(tokens=re.exec(qs));)params[decodeURIComponent(tokens[1])]=decodeURIComponent(tokens[2]);return params}!function(global,factory){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){"use strict";function DOMEval(code,doc,node){var i,script=(doc=doc||document).createElement("script");if(script.text=code,node)for(i in preservedScriptAttributes)node[i]&&(script[i]=node[i]);doc.head.appendChild(script).parentNode.removeChild(script)}function toType(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj}function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=toType(obj);return!isFunction(obj)&&!isWindow(obj)&&("array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj)}function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()}function winnow(elements,qualifier,not){return isFunction(qualifier)?jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not}):qualifier.nodeType?jQuery.grep(elements,function(elem){return elem===qualifier!==not}):"string"!=typeof qualifier?jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not}):jQuery.filter(qualifier,elements,not)}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object={};return jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=!0}),object}function Identity(v){return v}function Thrower(ex){throw ex}function adoptValue(value,resolve,reject,noValue){var method;try{value&&isFunction(method=value.promise)?method.call(value).done(resolve).fail(reject):value&&isFunction(method=value.then)?method.call(value,resolve,reject):resolve.apply(void 0,[value].slice(noValue))}catch(value){reject.apply(void 0,[value])}}function completed(){document.removeEventListener("DOMContentLoaded",completed),window.removeEventListener("load",completed),jQuery.ready()}function fcamelCase(all,letter){return letter.toUpperCase()}function camelCase(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)}function Data(){this.expando=jQuery.expando+Data.uid++}function getData(data){return"true"===data||"false"!==data&&("null"===data?null:data===+data+""?+data:rbrace.test(data)?JSON.parse(data):data)}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$&").toLowerCase(),"string"==typeof(data=elem.getAttribute(name))){try{data=getData(data)}catch(e){}dataUser.set(elem,key,data)}else data=void 0;return data}function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){for(initial/=2,unit=unit||initialInUnit[3],initialInUnit=+initial||1;maxIterations--;)jQuery.style(elem,prop,initialInUnit+unit),(1-scale)*(1-(scale=currentValue()/initial||.5))<=0&&(maxIterations=0),initialInUnit/=scale;initialInUnit*=2,jQuery.style(elem,prop,initialInUnit+unit),valueParts=valueParts||[]}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted}function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];return display||(temp=doc.body.appendChild(doc.createElement(nodeName)),display=jQuery.css(temp,"display"),temp.parentNode.removeChild(temp),"none"===display&&(display="block"),defaultDisplayMap[nodeName]=display,display)}function showHide(elements,show){for(var display,elem,values=[],index=0,length=elements.length;index<length;index++)(elem=elements[index]).style&&(display=elem.style.display,show?("none"===display&&(values[index]=dataPriv.get(elem,"display")||null,values[index]||(elem.style.display="")),""===elem.style.display&&isHiddenWithinTree(elem)&&(values[index]=getDefaultDisplay(elem))):"none"!==display&&(values[index]="none",dataPriv.set(elem,"display",display)));for(index=0;index<length;index++)null!=values[index]&&(elements[index].style.display=values[index]);return elements}function getAll(context,tag){var ret;return ret=void 0!==context.getElementsByTagName?context.getElementsByTagName(tag||"*"):void 0!==context.querySelectorAll?context.querySelectorAll(tag||"*"):[],void 0===tag||tag&&nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;i<l;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}function buildFragment(elems,context,scripts,selection,ignored){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;i<l;i++)if((elem=elems[i])||0===elem)if("object"===toType(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),(tmp=fragment.firstChild).textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if(selection&&jQuery.inArray(elem,selection)>-1)ignored&&ignored.push(elem);else if(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts)for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),!1===fn)fn=returnFalse;else if(!fn)return elem;return 1===one&&(origFn=fn,(fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)}).guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function manipulationTarget(elem,content){return nodeName(elem,"table")&&nodeName(11!==content.nodeType?content:content.firstChild,"tr")?jQuery(elem).children("tbody")[0]||elem:elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){return"true/"===(elem.type||"").slice(0,5)?elem.type=elem.type.slice(5):elem.removeAttribute("type"),elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)&&(pdataOld=dataPriv.access(src),pdataCur=dataPriv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i])}dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur))}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue)}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],valueIsFunction=isFunction(value);if(valueIsFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);valueIsFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored)});if(l&&(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first||ignored)){for(hasScripts=(scripts=jQuery.map(getAll(fragment,"script"),disableScript)).length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src&&"module"!==(node.type||"").toLowerCase()?jQuery._evalUrl&&jQuery._evalUrl(node.src):DOMEval(node.textContent.replace(rcleanScript,""),doc,node))}return collection}function remove(elem,selector,keepData){for(var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;null!=(node=nodes[i]);i++)keepData||1!==node.nodeType||jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&jQuery.contains(node.ownerDocument,node)&&setGlobalEval(getAll(node,"script")),node.parentNode.removeChild(node));return elem}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return(computed=computed||getStyles(elem))&&(""!==(ret=computed.getPropertyValue(name)||computed[name])||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),!support.pixelBoxStyles()&&rnumnonpx.test(ret)&&rboxStyle.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){if(!conditionFn())return(this.get=hookFn).apply(this,arguments);delete this.get}}}function vendorPropName(name){if(name in emptyStyle)return name;for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;)if((name=cssPrefixes[i]+capName)in emptyStyle)return name}function finalPropName(name){var ret=jQuery.cssProps[name];return ret||(ret=jQuery.cssProps[name]=vendorPropName(name)||name),ret}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function boxModelAdjustment(elem,dimension,box,isBorderBox,styles,computedVal){var i="width"===dimension?1:0,extra=0,delta=0;if(box===(isBorderBox?"border":"content"))return 0;for(;i<4;i+=2)"margin"===box&&(delta+=jQuery.css(elem,box+cssExpand[i],!0,styles)),isBorderBox?("content"===box&&(delta-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==box&&(delta-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(delta+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==box?delta+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles):extra+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles));return!isBorderBox&&computedVal>=0&&(delta+=Math.max(0,Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-computedVal-delta-extra-.5))),delta}function getWidthOrHeight(elem,dimension,extra){var styles=getStyles(elem),val=curCSS(elem,dimension,styles),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles),valueIsBorderBox=isBorderBox;if(rnumnonpx.test(val)){if(!extra)return val;val="auto"}return valueIsBorderBox=valueIsBorderBox&&(support.boxSizingReliable()||val===elem.style[dimension]),("auto"===val||!parseFloat(val)&&"inline"===jQuery.css(elem,"display",!1,styles))&&(val=elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)],valueIsBorderBox=!0),(val=parseFloat(val)||0)+boxModelAdjustment(elem,dimension,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles,val)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function schedule(){inProgress&&(!1===document.hidden&&window.requestAnimationFrame?window.requestAnimationFrame(schedule):window.setTimeout(schedule,jQuery.fx.interval),jQuery.fx.tick())}function createFxNow(){return window.setTimeout(function(){fxNow=void 0}),fxNow=Date.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)attrs["margin"+(which=cssExpand[i])]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=camelCase(index),easing=specialEasing[name],value=props[index],Array.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),(hooks=jQuery.cssHooks[name])&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),percent=1-(remaining/animation.duration||0),index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(length||deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);index<length;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts))return isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=result.stop.bind(result)),result;return jQuery.map(props,createTween,animation),isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation}function stripAndCollapse(value){return(value.match(rnothtmlwhite)||[]).join(" ")}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function classesToArray(value){return Array.isArray(value)?value:"string"==typeof value?value.match(rnothtmlwhite)||[]:[]}function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v&&null!=v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==toType(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}if(finalDataType)return finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(!(conv=converters[prev+" "+current]||converters["* "+current]))for(conv2 in converters)if((tmp=conv2.split(" "))[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){!0===conv?conv=converters[conv2]:!0!==converters[conv2]&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(!0!==conv)if(conv&&s.throws)response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}var arr=[],document=window.document,getProto=Object.getPrototypeOf,slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),support={},isFunction=function(obj){return"function"==typeof obj&&"number"!=typeof obj.nodeType},isWindow=function(obj){return null!=obj&&obj===obj.window},preservedScriptAttributes={type:!0,src:!0,noModule:!0},jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;jQuery.fn=jQuery.prototype={jquery:"3.3.1",constructor:jQuery,length:0,toArray:function(){return slice.call(this)},get:function(num){return null==num?slice.call(this):num<0?this[num+this.length]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],target!==(copy=options[name])&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&Array.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isPlainObject:function(obj){var proto,Ctor;return!(!obj||"[object Object]"!==toString.call(obj))&&(!(proto=getProto(obj))||"function"==typeof(Ctor=hasOwn.call(proto,"constructor")&&proto.constructor)&&fnToString.call(Ctor)===ObjectFunctionString)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},globalEval:function(code){DOMEval(code)},each:function(obj,callback){var length,i=0;if(isArrayLike(obj))for(length=obj.length;i<length&&!1!==callback.call(obj[i],i,obj[i]);i++);else for(i in obj)if(!1===callback.call(obj[i],i,obj[i]))break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var matches=[],i=0,length=elems.length,callbackExpect=!invert;i<length;i++)!callback(elems[i],i)!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems))for(length=elems.length;i<length;i++)null!=(value=callback(elems[i],i,arg))&&ret.push(value);else for(i in elems)null!=(value=callback(elems[i],i,arg))&&ret.push(value);return concat.apply([],ret)},guid:1,support:support}),"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;if(results=results||[],"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,documentIsHTML)){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m)return results.push(elem),results}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(1!==nodeType)newContext=context,newSelector=selector;else if("object"!==context.nodeName.toLowerCase()){for((nid=context.getAttribute("id"))?nid=nid.replace(rcssescape,fcssescape):context.setAttribute("id",nid=expando),i=(groups=tokenize(selector)).length;i--;)groups[i]="#"+nid+" "+toSelector(groups[i]);newSelector=groups.join(","),newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{nid===expando&&context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el)}catch(e){return!1}finally{el.parentNode&&el.parentNode.removeChild(el),el=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createDisabledPseudo(disabled){return function(elem){return"form"in elem?elem.parentNode&&!1===elem.disabled?"label"in elem?"label"in elem.parentNode?elem.parentNode.disabled===disabled:elem.disabled===disabled:elem.isDisabled===disabled||elem.isDisabled!==!disabled&&disabledAncestor(elem)===disabled:elem.disabled===disabled:"label"in elem&&elem.disabled===disabled}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&void 0!==context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&"parentNode"===key,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml);return!1}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={}),skip&&skip===elem.nodeName.toLowerCase())elem=elem[dir]||elem;else{if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(uniqueCache[key]=newCache,newCache[2]=matcher(elem,context,xml))return!0}return!1}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if((matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches))[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context===document||context||outermost);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0,context||elem.ownerDocument===document||(setDocument(elem),xml=!documentIsHTML);matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){return asCodePoint?"\0"===ch?"�":ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" ":"\\"+ch},unloadHandler=function(){setDocument()},disabledAncestor=addCombinator(function(elem){return!0===elem.disabled&&("form"in elem||"label"in elem)},{dir:"parentNode",next:"legend"});try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=document.documentElement,documentIsHTML=!isXML(document),preferredDoc!==document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow&&(subWindow.addEventListener?subWindow.addEventListener("unload",unloadHandler,!1):subWindow.attachEvent&&subWindow.attachEvent("onunload",unloadHandler)),support.attributes=assert(function(el){return el.className="i",!el.getAttribute("className")}),support.getElementsByTagName=assert(function(el){return el.appendChild(document.createComment("")),!el.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(el){return docElem.appendChild(el).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length}),support.getById?(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[]}}):(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=void 0!==elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem];for(elems=context.getElementsByName(id),i=0;elem=elems[i++];)if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem]}return[]}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return void 0!==context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(void 0!==context.getElementsByClassName&&documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(el){docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>",el.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),el.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),el.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),el.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),el.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden"),el.appendChild(input).setAttribute("name","D"),el.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),2!==el.querySelectorAll(":enabled").length&&rbuggyQSA.push(":enabled",":disabled"),docElem.appendChild(el).disabled=!0,2!==el.querySelectorAll(":disabled").length&&rbuggyQSA.push(":enabled",":disabled"),el.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(el){support.disconnectedMatch=matches.call(el,"*"),matches.call(el,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare||(1&(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1)||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape)},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},(Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||void 0!==elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(diff=(nodeIndex=(cache=(uniqueCache=(outerCache=(node=parent)[expando]||(node[expando]={}))[node.uniqueID]||(outerCache[node.uniqueID]={}))[type]||[])[0]===dirruns&&cache[1])&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(diff=nodeIndex=(cache=(uniqueCache=(outerCache=(node=elem)[expando]||(node[expando]={}))[node.uniqueID]||(outerCache[node.uniqueID]={}))[type]||[])[0]===dirruns&&cache[1]),!1===diff)for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((uniqueCache=(outerCache=node[expando]||(node[expando]={}))[node.uniqueID]||(outerCache[node.uniqueID]={}))[type]=[dirruns,diff]),node!==elem)););return(diff-=last)===first||diff%first==0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)seed[idx=indexOf(seed,matched[i])]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return(elemLang=elemLang.toLowerCase())===lang||0===elemLang.indexOf(lang+"-")}while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:createDisabledPseudo(!1),disabled:createDisabledPseudo(!0),checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,!0===elem.selected},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}}).pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=function(type){return function(elem){return"input"===elem.nodeName.toLowerCase()&&elem.type===type}}(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=function(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)(cached=matcherFromTokens(match[i]))[expando]?setMatchers.push(cached):elementMatchers.push(cached);(cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))).selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if((tokens=match[0]=match[0].slice(0)).length>2&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(!(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0]))return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),!(selector=seed.length&&toSelector(tokens)))return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(el){return 1&el.compareDocumentPosition(document.createElement("fieldset"))}),assert(function(el){return el.innerHTML="<a href='#'></a>","#"===el.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(el){return el.innerHTML="<input/>",el.firstChild.setAttribute("value",""),""===el.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(el){return null==el.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return!0===elem[name]?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains,jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(ret=this.pushStack([]),i=0;i<len;i++)jQuery.find(selector,self[i],ret);return len>1?jQuery.uniqueSort(ret):ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,"string"==typeof selector){if(!(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector))||!match[1]&&context)return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return(elem=document.getElementById(match[2]))&&(this[0]=elem,this.length=1),this}return selector.nodeType?(this[0]=selector,this.length=1,this):isFunction(selector)?void 0!==root.ready?root.ready(selector):selector(jQuery):jQuery.makeArray(selector,this)}).prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;i<l;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets="string"!=typeof selectors&&jQuery(selectors);if(!rneedsContext.test(selectors))for(;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(targets?targets.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return nodeName(elem,"iframe")?elem.contentDocument:(nodeName(elem,"template")&&(elem=elem.content||elem),jQuery.merge([],elem.childNodes))}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;jQuery.Callbacks=function(options){options="string"==typeof options?createOptions(options):jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){for(locked=locked||options.once,fired=firing=!0;queue.length;firingIndex=-1)for(memory=queue.shift();++firingIndex<list.length;)!1===list[firingIndex].apply(memory[0],memory[1])&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);options.memory||(memory=!1),firing=!1,locked&&(list=memory?[]:"")},self={add:function(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==toType(arg)&&add(arg)})}(arguments),memory&&!firing&&fire()),this},remove:function(){return jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),index<=firingIndex&&firingIndex--}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0},empty:function(){return list&&(list=[]),this},disable:function(){return locked=queue=[],list=memory="",this},disabled:function(){return!list},lock:function(){return locked=queue=[],memory||firing||(list=memory=""),this},locked:function(){return!!locked},fireWith:function(context,args){return locked||(args=[context,(args=args||[]).slice?args.slice():args],queue.push(args),firing||fire()),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},catch:function(fn){return promise.then(null,fn)},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this,fn?[returned]:arguments)})}),fns=null}).promise()},then:function(onFulfilled,onRejected,onProgress){function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(!(depth<maxDepth)){if((returned=handler.apply(that,args))===deferred.promise())throw new TypeError("Thenable self-resolution");then=returned&&("object"==typeof returned||"function"==typeof returned)&&returned.then,isFunction(then)?special?then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special)):(maxDepth++,then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))):(handler!==Identity&&(that=void 0,args=[returned]),(special||deferred.resolveWith)(that,args))}},process=special?mightThrow:function(){try{mightThrow()}catch(e){jQuery.Deferred.exceptionHook&&jQuery.Deferred.exceptionHook(e,process.stackTrace),depth+1>=maxDepth&&(handler!==Thrower&&(that=void 0,args=[e]),deferred.rejectWith(that,args))}};depth?process():(jQuery.Deferred.getStackHook&&(process.stackTrace=jQuery.Deferred.getStackHook()),window.setTimeout(process))}}var maxDepth=0;return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith)),tuples[1][3].add(resolve(0,newDefer,isFunction(onFulfilled)?onFulfilled:Identity)),tuples[2][3].add(resolve(0,newDefer,isFunction(onRejected)?onRejected:Thrower))}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[3-i][2].disable,tuples[3-i][3].disable,tuples[0][2].lock,tuples[0][3].lock),list.add(tuple[3].fire),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?void 0:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this,resolveValues[i]=arguments.length>1?slice.call(arguments):value,--remaining||master.resolveWith(resolveContexts,resolveValues)}};if(remaining<=1&&(adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining),"pending"===master.state()||isFunction(resolveValues[i]&&resolveValues[i].then)))return master.then();for(;i--;)adoptValue(resolveValues[i],updateFunc(i),master.reject);return master.promise()}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){window.console&&window.console.warn&&error&&rerrorNames.test(error.name)&&window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack)},jQuery.readyException=function(error){window.setTimeout(function(){throw error})};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){return readyList.then(fn).catch(function(error){jQuery.readyException(error)}),this},jQuery.extend({isReady:!1,readyWait:1,ready:function(wait){(!0===wait?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,!0!==wait&&--jQuery.readyWait>0||readyList.resolveWith(document,[jQuery]))}}),jQuery.ready.then=readyList.then,"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed),window.addEventListener("load",completed));var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===toType(key)){chainable=!0;for(i in key)access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet},rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g,acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};Data.uid=1,Data.prototype={cache:function(owner){var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value},set:function(owner,data,value){var prop,cache=this.cache(owner);if("string"==typeof data)cache[camelCase(data)]=value;else for(prop in data)cache[camelCase(prop)]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][camelCase(key)]},access:function(owner,key,value){return void 0===key||key&&"string"==typeof key&&void 0===value?this.get(owner,key):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,cache=owner[this.expando];if(void 0!==cache){if(void 0!==key){i=(key=Array.isArray(key)?key.map(camelCase):(key=camelCase(key))in cache?[key]:key.match(rnothtmlwhite)||[]).length;for(;i--;)delete cache[key[i]]}(void 0===key||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=dataUser.get(elem),1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&0===(name=attrs[i].name).indexOf("data-")&&(name=camelCase(name.slice(5)),dataAttr(elem,name,data[name]));dataPriv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data;if(elem&&void 0===value){if(void 0!==(data=dataUser.get(elem,key)))return data;if(void 0!==(data=dataAttr(elem,key)))return data}else this.each(function(){dataUser.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=dataPriv.get(elem,type),data&&(!queue||Array.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type);"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,function(){jQuery.dequeue(elem,type)},hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)(tmp=dataPriv.get(elements[i],type+"queueHooks"))&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],isHiddenWithinTree=function(elem,el){return"none"===(elem=el||elem).style.display||""===elem.style.display&&jQuery.contains(elem.ownerDocument,elem)&&"none"===jQuery.css(elem,"display")},swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret},defaultDisplayMap={};jQuery.fn.extend({show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHiddenWithinTree(this)?jQuery(this).show():jQuery(this).hide()})}});var rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,rscriptType=/^$|^module$|\/(?:java|ecma)script/i,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var rhtml=/<|&#?\w+;/;!function(){var div=document.createDocumentFragment().appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var documentElement=document.documentElement,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(elemData)for(handler.handler&&(handler=(handleObjIn=handler).handler,selector=handleObjIn.selector),selector&&jQuery.find.matchesSelector(documentElement,selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return void 0!==jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),t=(types=(types||"").match(rnothtmlwhite)||[""]).length;t--;)type=origType=(tmp=rtypenamespace.exec(types[t])||[])[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||((handlers=events[type]=[]).delegateCount=0,special.setup&&!1!==special.setup.call(elem,data,namespaces,eventHandle)||elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(elemData&&(events=elemData.events)){for(t=(types=(types||"").match(rnothtmlwhite)||[""]).length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},handlers=events[type=(selector?special.delegateType:special.bindType)||type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&!1!==special.teardown.call(elem,namespaces,elemData.handle)||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(nativeEvent){var i,j,ret,matched,handleObj,handlerQueue,event=jQuery.event.fix(nativeEvent),args=new Array(arguments.length),handlers=(dataPriv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};for(args[0]=event,i=1;i<arguments.length;i++)args[i]=arguments[i];if(event.delegateTarget=this,!special.preDispatch||!1!==special.preDispatch.call(this,event)){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.rnamespace&&!event.rnamespace.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,void 0!==(ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args))&&!1===(event.result=ret)&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!("click"===event.type&&event.button>=1))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&("click"!==event.type||!0!==cur.disabled)){for(matchedHandlers=[],matchedSelectors={},i=0;i<delegateCount;i++)void 0===matchedSelectors[sel=(handleObj=handlers[i]).selector+" "]&&(matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length),matchedSelectors[sel]&&matchedHandlers.push(handleObj);matchedHandlers.length&&handlerQueue.push({elem:cur,handlers:matchedHandlers})}return cur=this,delegateCount<handlers.length&&handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)}),handlerQueue},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:!0,configurable:!0,get:isFunction(hook)?function(){if(this.originalEvent)return hook(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[name]},set:function(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value:value})}})},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&nodeName(this,"input"))return this.click(),!1},_default:function(event){return nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)},jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&!1===src.returnValue?returnTrue:returnFalse,this.target=src.target&&3===src.target.nodeType?src.target.parentNode:src.target,this.currentTarget=src.currentTarget,this.relatedTarget=src.relatedTarget):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||Date.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(event){var button=event.button;return null==event.which&&rkeyEvent.test(event.type)?null!=event.charCode?event.charCode:event.keyCode:!event.which&&void 0!==button&&rmouseEvent.test(event.type)?1&button?1:2&button?3:4&button?2:0:event.which}},jQuery.event.addProp),jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return!1!==selector&&"function"!=typeof selector||(fn=selector,selector=void 0),!1===fn&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;jQuery.extend({htmlPrefilter:function(html){return html.replace(rxhtmlTag,"<$1></$2>")},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),i=0,l=(srcElements=getAll(elem)).length;i<l;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;i<l;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return(destElements=getAll(clone,"script")).length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},cleanData:function(elems){for(var data,elem,type,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}}),jQuery.fn.extend({detach:function(selector){return remove(this,selector,!0)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||manipulationTarget(this,elem).appendChild(elem)})},prepend:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++)1===(elem=this[i]||{}).nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;jQuery.inArray(this,ignored)<0&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this))},ignored)}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem)},rboxStyle=new RegExp(cssExpand.join("|"),"i");!function(){function computeStyleTests(){if(div){container.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",div.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",documentElement.appendChild(container).appendChild(div);var divStyle=window.getComputedStyle(div);pixelPositionVal="1%"!==divStyle.top,reliableMarginLeftVal=12===roundPixelMeasures(divStyle.marginLeft),div.style.right="60%",pixelBoxStylesVal=36===roundPixelMeasures(divStyle.right),boxSizingReliableVal=36===roundPixelMeasures(divStyle.width),div.style.position="absolute",scrollboxSizeVal=36===div.offsetWidth||"absolute",documentElement.removeChild(container),div=null}}function roundPixelMeasures(measure){return Math.round(parseFloat(measure))}var pixelPositionVal,boxSizingReliableVal,scrollboxSizeVal,pixelBoxStylesVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,jQuery.extend(support,{boxSizingReliable:function(){return computeStyleTests(),boxSizingReliableVal},pixelBoxStyles:function(){return computeStyleTests(),pixelBoxStylesVal},pixelPosition:function(){return computeStyleTests(),pixelPositionVal},reliableMarginLeft:function(){return computeStyleTests(),reliableMarginLeftVal},scrollboxSize:function(){return computeStyleTests(),scrollboxSizeVal}}))}();var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style;jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;if(isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];"string"==(type=typeof value)&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type="number"),null!=value&&value===value&&("number"===type&&(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(isCustomProp?style.setProperty(name,value):style[name]=value))}},css:function(elem,name,extra,styles){var val,num,hooks,origName=camelCase(name);return rcustomProp.test(name)||(name=finalPropName(origName)),(hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName])&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),!0===extra||isFinite(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,dimension){jQuery.cssHooks[dimension]={get:function(elem,computed,extra){if(computed)return!rdisplayswap.test(jQuery.css(elem,"display"))||elem.getClientRects().length&&elem.getBoundingClientRect().width?getWidthOrHeight(elem,dimension,extra):swap(elem,cssShow,function(){return getWidthOrHeight(elem,dimension,extra)})},set:function(elem,value,extra){var matches,styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles),subtract=extra&&boxModelAdjustment(elem,dimension,extra,isBorderBox,styles);return isBorderBox&&support.scrollboxSize()===styles.position&&(subtract-=Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-parseFloat(styles[dimension])-boxModelAdjustment(elem,dimension,"border",!1,styles)-.5)),subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")&&(elem.style[dimension]=value,value=jQuery.css(elem,dimension)),setPositiveNumber(0,value,subtract)}}}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed)return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px"}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},"margin"!==prefix&&(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return 1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop]?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,""))&&"auto"!==result?result:0},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1!==tween.elem.nodeType||null==tween.elem.style[jQuery.cssProps[tween.prop]]&&!jQuery.cssHooks[tween.prop]?tween.elem[tween.prop]=tween.now:jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween}]},tweener:function(props,callback){isFunction(props)?(callback=props,props=["*"]):props=props.match(rnothtmlwhite);for(var prop,index=0,length=props.length;index<length;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback)},prefilters:[function(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");opts.queue||(null==(hooks=jQuery._queueHooks(elem,"fx")).unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})}));for(prop in props)if(value=props[prop],rfxtypes.test(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if((propTween=!jQuery.isEmptyObject(props))||!jQuery.isEmptyObject(orig)){isBox&&1===elem.nodeType&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],null==(restoreDisplay=dataShow&&dataShow.display)&&(restoreDisplay=dataPriv.get(elem,"display")),"none"===(display=jQuery.css(elem,"display"))&&(restoreDisplay?display=restoreDisplay:(showHide([elem],!0),restoreDisplay=elem.style.display||restoreDisplay,display=jQuery.css(elem,"display"),showHide([elem]))),("inline"===display||"inline-block"===display&&null!=restoreDisplay)&&"none"===jQuery.css(elem,"float")&&(propTween||(anim.done(function(){style.display=restoreDisplay}),null==restoreDisplay&&(display=style.display,restoreDisplay="none"===display?"":display)),style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]})),propTween=!1;for(prop in orig)propTween||(dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay}),toggle&&(dataShow.hidden=!hidden),hidden&&showHide([elem],!0),anim.done(function(){hidden||showHide([elem]),dataPriv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])})),propTween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=propTween.start,hidden&&(propTween.end=propTween.start,propTween.start=0))}}],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!isFunction(easing)&&easing};return jQuery.fx.off?opt.duration=0:"number"!=typeof opt.duration&&(opt.duration in jQuery.fx.speeds?opt.duration=jQuery.fx.speeds[opt.duration]:opt.duration=jQuery.fx.speeds._default),null!=opt.queue&&!0!==opt.queue||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||!1===optall.queue?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&!1!==type&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return!1!==type&&(type=type||"fx"),this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=Date.now();i<timers.length;i++)(timer=timers[i])()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){inProgress||(inProgress=!0,schedule())},jQuery.fx.stop=function(){inProgress=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})},function(){var input=document.createElement("input"),opt=document.createElement("select").appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,(input=document.createElement("input")).value="t",input.type="radio",support.radioValue="t"===input.value}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return void 0===elem.getAttribute?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)),void 0!==value?null===value?void jQuery.removeAttr(elem,name):hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:null==(ret=jQuery.find.attr(elem,name))?void 0:ret)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)elem.removeAttribute(name)}}),boolHook={set:function(elem,value,name){return!1===value?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();return isXML||(handle=attrHandle[lowercaseName],attrHandle[lowercaseName]=ret,ret=null!=getter(elem,name,isXML)?lowercaseName:null,attrHandle[lowercaseName]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return 1===nType&&jQuery.isXMLDoc(elem)||(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null},set:function(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex)}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if((classes=classesToArray(value)).length)for(;elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");curValue!==(finalValue=stripAndCollapse(cur))&&elem.setAttribute("class",finalValue)}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if((classes=classesToArray(value)).length)for(;elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>-1;)cur=cur.replace(" "+clazz+" "," ");curValue!==(finalValue=stripAndCollapse(cur))&&elem.setAttribute("class",finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value,isValidValue="string"===type||Array.isArray(value);return"boolean"==typeof stateVal&&isValidValue?stateVal?this.addClass(value):this.removeClass(value):isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if(isValidValue)for(i=0,self=jQuery(this),classNames=classesToArray(value);className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else void 0!==value&&"boolean"!==type||((className=getClass(this))&&dataPriv.set(this,"__className__",className),this.setAttribute&&this.setAttribute("class",className||!1===value?"":dataPriv.get(this,"__className__")||""))})},hasClass:function(selector){var className,elem,i=0;for(className=" "+selector+" ";elem=this[i++];)if(1===elem.nodeType&&(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className)>-1)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,valueIsFunction,elem=this[0];if(arguments.length)return valueIsFunction=isFunction(value),this.each(function(i){var val;1===this.nodeType&&(null==(val=valueIsFunction?value.call(this,i,jQuery(this).val()):value)?val="":"number"==typeof val?val+="":Array.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),(hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()])&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return(hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()])&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:"string"==typeof(ret=elem.value)?ret.replace(rreturn,""):null==ret?"":ret}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:stripAndCollapse(jQuery.text(elem))}},select:{get:function(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type,values=one?null:[],max=one?index+1:options.length;for(i=index<0?max:one?index:0;i<max;i++)if(((option=options[i]).selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)((option=options[i]).selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(Array.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})}),support.focusin="onfocusin"in window;var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,stopPropagationCallback=function(e){e.stopPropagation()};jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,lastElement,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=lastElement=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>-1&&(type=(namespaces=type.split(".")).shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||!1!==special.trigger.apply(elem,data))){if(!onlyHandlers&&!special.noBubble&&!isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)lastElement=cur,event.type=i>1?bubbleType:special.bindType||type,(handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle"))&&handle.apply(cur,data),(handle=ontype&&cur[ontype])&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),!1===event.result&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&!1!==special._default.apply(eventPath.pop(),data)||!acceptData(elem)||ontype&&isFunction(elem[type])&&!isWindow(elem)&&((tmp=elem[ontype])&&(elem[ontype]=null),jQuery.event.triggered=type,event.isPropagationStopped()&&lastElement.addEventListener(type,stopPropagationCallback),elem[type](),event.isPropagationStopped()&&lastElement.removeEventListener(type,stopPropagationCallback),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem)}}),jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}}),support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix))}}});var location=window.location,nonce=Date.now(),rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=void 0}return xml&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(null==value?"":value)};if(Array.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:Array.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});var r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;completed||(completed=!0,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&status<300||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&((modified=jqXHR.getResponseHeader("Last-Modified"))&&(jQuery.lastModified[cacheURL]=modified),(modified=jqXHR.getResponseHeader("etag"))&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,isSuccess=!(error=response.error))):(error=statusText,!status&&statusText||(statusText="error",status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return completed?responseHeadersString:null},setRequestHeader:function(name,value){return null==completed&&(name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return null==completed&&(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(completed)jqXHR.always(map[jqXHR.status]);else for(code in map)statusCode[code]=[statusCode[code],map[code]];return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR),s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""],null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}if(s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),completed)return jqXHR;(fireGlobals=jQuery.event&&s.global)&&0==jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url.replace(rhash,""),s.hasContent?s.data&&s.processData&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&(s.data=s.data.replace(r20,"+")):(uncached=s.url.slice(cacheURL.length),s.data&&(s.processData||"string"==typeof s.data)&&(cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),!1===s.cache&&(cacheURL=cacheURL.replace(rantiCache,"$1"),uncached=(rquery.test(cacheURL)?"&":"?")+"_="+nonce+++uncached),s.url=cacheURL+uncached),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&!1!==s.contentType||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(!1===s.beforeSend.call(callbackContext,jqXHR,s)||completed))return jqXHR.abort();if(strAbort="abort",completeDeferred.add(s.complete),jqXHR.done(s.success),jqXHR.fail(s.error),transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),completed)return jqXHR;s.async&&s.timeout>0&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{completed=!1,transport.send(requestHeaders,done)}catch(e){if(completed)throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return this[0]&&(isFunction(html)&&(html=html.call(this[0])),wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this},wrapInner:function(html){return isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var htmlIsFunction=isFunction(html);return this.each(function(i){jQuery(this).wrapAll(htmlIsFunction?html.call(this,i):html)})},unwrap:function(selector){return this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes)}),this}}),jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem)},jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length)},jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain)return{send:function(headers,complete){var i,xhr=options.xhr();if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.ontimeout=xhr.onreadystatechange=null,"abort"===type?xhr.abort():"error"===type?"number"!=typeof xhr.status?complete(0,"error"):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()))}},xhr.onload=callback(),errorCallback=xhr.onerror=xhr.ontimeout=callback("error"),void 0!==xhr.onabort?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){callback&&errorCallback()})},callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}}),jQuery.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=!1!==s.jsonp&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):!1!==s.jsonp&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),support.createHTMLDocument=function(){var body=document.implementation.createHTMLDocument("").body;return body.innerHTML="<form></form><form></form>",2===body.childNodes.length}(),jQuery.parseHTML=function(data,context,keepScripts){if("string"!=typeof data)return[];"boolean"==typeof context&&(keepScripts=context,context=!1);var base,parsed,scripts;return context||(support.createHTMLDocument?((base=(context=document.implementation.createHTMLDocument("")).createElement("base")).href=document.location.href,context.head.appendChild(base)):context=document),parsed=rsingleTag.exec(data),scripts=!keepScripts&&[],parsed?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");return off>-1&&(selector=stripAndCollapse(url.slice(off)),url=url.slice(0,off)),isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length},jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1?(curTop=(curPosition=curElem.position()).top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var rect,win,elem=this[0];if(elem)return elem.getClientRects().length?(rect=elem.getBoundingClientRect(),win=elem.ownerDocument.defaultView,{top:rect.top+win.pageYOffset,left:rect.left+win.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var offsetParent,offset,doc,elem=this[0],parentOffset={top:0,left:0};if("fixed"===jQuery.css(elem,"position"))offset=elem.getBoundingClientRect();else{for(offset=this.offset(),doc=elem.ownerDocument,offsetParent=elem.offsetParent||doc.documentElement;offsetParent&&(offsetParent===doc.body||offsetParent===doc.documentElement)&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.parentNode;offsetParent&&offsetParent!==elem&&1===offsetParent.nodeType&&((parentOffset=jQuery(offsetParent).offset()).top+=jQuery.css(offsetParent,"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent,"borderLeftWidth",!0))}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;if(isWindow(elem)?win=elem:9===elem.nodeType&&(win=elem.defaultView),void 0===val)return win?win[prop]:elem[method];win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val},method,val,arguments.length)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(!0===margin||!0===value?"margin":"border");return access(this,function(elem,type,value){var doc;return isWindow(elem)?0===funcName.indexOf("outer")?elem["inner"+name]:elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable)}})}),jQuery.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}}),jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}}),jQuery.proxy=function(fn,context){var tmp,args,proxy;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),isFunction(fn))return args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy},jQuery.holdReady=function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},jQuery.isArray=Array.isArray,jQuery.parseJSON=JSON.parse,jQuery.nodeName=nodeName,jQuery.isFunction=isFunction,jQuery.isWindow=isWindow,jQuery.camelCase=camelCase,jQuery.type=toType,jQuery.now=Date.now,jQuery.isNumeric=function(obj){var type=jQuery.type(obj);return("number"===type||"string"===type)&&!isNaN(obj-parseFloat(obj))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},noGlobal||(window.jQuery=window.$=jQuery),jQuery}),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){function visible(element){for(var visibility=element.css("visibility");"inherit"===visibility;)visibility=(element=element.parent()).css("visibility");return"hidden"!==visibility}function datepicker_getZindex(elem){for(var position,value;elem.length&&elem[0]!==document;){if(("absolute"===(position=elem.css("position"))||"relative"===position||"fixed"===position)&&(value=parseInt(elem.css("zIndex"),10),!isNaN(value)&&0!==value))return value;elem=elem.parent()}return 0}function Datepicker(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.regional.en=$.extend(!0,{},this.regional[""]),this.regional["en-US"]=$.extend(!0,{},this.regional.en),this.dpDiv=datepicker_bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function datepicker_bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.on("mouseout",selector,function(){$(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",selector,datepicker_handleMouseover)}function datepicker_handleMouseover(){$.datepicker._isDisabledDatepicker(datepicker_instActive.inline?datepicker_instActive.dpDiv.parent()[0]:datepicker_instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).addClass("ui-datepicker-next-hover"))}function datepicker_extendRemove(target,props){$.extend(target,props);for(var name in props)null==props[name]&&(target[name]=props[name]);return target}function spinnerModifer(fn){return function(){var previous=this.element.val();fn.apply(this,arguments),this._refresh(),previous!==this.element.val()&&this._trigger("change")}}$.ui=$.ui||{};$.ui.version="1.12.1";var widgetUuid=0,widgetSlice=Array.prototype.slice;$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;null!=(elem=elems[i]);i++)try{(events=$._data(elem,"events"))&&events.remove&&$(elem).triggerHandler("remove")}catch(e){}orig(elems)}}($.cleanData),$.widget=function(name,base,prototype){var existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0],fullName=namespace+"-"+(name=name.split(".")[1]);return prototype||(prototype=base,base=$.Widget),$.isArray(prototype)&&(prototype=$.extend.apply(null,[{}].concat(prototype))),$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)},$[namespace]=$[namespace]||{},existingConstructor=$[namespace][name],constructor=$[namespace][name]=function(options,element){if(!this._createWidget)return new constructor(options,element);arguments.length&&this._createWidget(options,element)},$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]}),basePrototype=new base,basePrototype.options=$.widget.extend({},basePrototype.options),$.each(prototype,function(prop,value){$.isFunction(value)?proxiedPrototype[prop]=function(){function _super(){return base.prototype[prop].apply(this,arguments)}function _superApply(args){return base.prototype[prop].apply(this,args)}return function(){var returnValue,__super=this._super,__superApply=this._superApply;return this._super=_super,this._superApply=_superApply,returnValue=value.apply(this,arguments),this._super=__super,this._superApply=__superApply,returnValue}}():proxiedPrototype[prop]=value}),constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName}),existingConstructor?($.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)}),delete existingConstructor._childConstructors):base._childConstructors.push(constructor),$.widget.bridge(name,constructor),constructor},$.widget.extend=function(target){for(var key,value,input=widgetSlice.call(arguments,1),inputIndex=0,inputLength=input.length;inputIndex<inputLength;inputIndex++)for(key in input[inputIndex])value=input[inputIndex][key],input[inputIndex].hasOwnProperty(key)&&void 0!==value&&($.isPlainObject(value)?target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value):target[key]=value);return target},$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall="string"==typeof options,args=widgetSlice.call(arguments,1),returnValue=this;return isMethodCall?this.length||"instance"!==options?this.each(function(){var methodValue,instance=$.data(this,fullName);return"instance"===options?(returnValue=instance,!1):instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?(methodValue=instance[options].apply(instance,args))!==instance&&void 0!==methodValue?(returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue,!1):void 0:$.error("no such method '"+options+"' for "+name+" widget instance"):$.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'")}):returnValue=void 0:(args.length&&(options=$.widget.extend.apply(null,[options].concat(args))),this.each(function(){var instance=$.data(this,fullName);instance?(instance.option(options||{}),instance._init&&instance._init()):$.data(this,fullName,new object(options,this))})),returnValue}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0],this.element=$(element),this.uuid=widgetUuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=$(),this.hoverable=$(),this.focusable=$(),this.classesElementLookup={},element!==this&&($.data(element,this.widgetFullName,this),this._on(!0,this.element,{remove:function(event){event.target===element&&this.destroy()}}),this.document=$(element.style?element.ownerDocument:element.document||element),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.options=$.widget.extend({},this.options,this._getCreateOptions(),options),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){var that=this;this._destroy(),$.each(this.classesElementLookup,function(key,value){that._removeClass(value,key)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var parts,curOption,i,options=key;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof key)if(options={},parts=key.split("."),key=parts.shift(),parts.length){for(curOption=options[key]=$.widget.extend({},this.options[key]),i=0;i<parts.length-1;i++)curOption[parts[i]]=curOption[parts[i]]||{},curOption=curOption[parts[i]];if(key=parts.pop(),1===arguments.length)return void 0===curOption[key]?null:curOption[key];curOption[key]=value}else{if(1===arguments.length)return void 0===this.options[key]?null:this.options[key];options[key]=value}return this._setOptions(options),this},_setOptions:function(options){var key;for(key in options)this._setOption(key,options[key]);return this},_setOption:function(key,value){return"classes"===key&&this._setOptionClasses(value),this.options[key]=value,"disabled"===key&&this._setOptionDisabled(value),this},_setOptionClasses:function(value){var classKey,elements,currentElements;for(classKey in value)currentElements=this.classesElementLookup[classKey],value[classKey]!==this.options.classes[classKey]&&currentElements&&currentElements.length&&(elements=$(currentElements.get()),this._removeClass(currentElements,classKey),elements.addClass(this._classes({element:elements,keys:classKey,classes:value,add:!0})))},_setOptionDisabled:function(value){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!value),value&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(options){function processClassString(classes,checkOption){var current,i;for(i=0;i<classes.length;i++)current=that.classesElementLookup[classes[i]]||$(),current=$(options.add?$.unique(current.get().concat(options.element.get())):current.not(options.element).get()),that.classesElementLookup[classes[i]]=current,full.push(classes[i]),checkOption&&options.classes[classes[i]]&&full.push(options.classes[classes[i]])}var full=[],that=this;return options=$.extend({element:this.element,classes:this.options.classes||{}},options),this._on(options.element,{remove:"_untrackClassesElement"}),options.keys&&processClassString(options.keys.match(/\S+/g)||[],!0),options.extra&&processClassString(options.extra.match(/\S+/g)||[]),full.join(" ")},_untrackClassesElement:function(event){var that=this;$.each(that.classesElementLookup,function(key,value){-1!==$.inArray(event.target,value)&&(that.classesElementLookup[key]=$(value.not(event.target).get()))})},_removeClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!1)},_addClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!0)},_toggleClass:function(element,keys,extra,add){add="boolean"==typeof add?add:extra;var shift="string"==typeof element||null===element,options={extra:shift?keys:extra,keys:shift?element:keys,element:shift?this.element:element,add:add};return options.element.toggleClass(this._classes(options),add),this},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;"boolean"!=typeof suppressDisabledCheck&&(handlers=element,element=suppressDisabledCheck,suppressDisabledCheck=!1),handlers?(element=delegateElement=$(element),this.bindings=this.bindings.add(element)):(handlers=element,element=this.element,delegateElement=this.widget()),$.each(handlers,function(event,handler){function handlerProxy(){if(suppressDisabledCheck||!0!==instance.options.disabled&&!$(this).hasClass("ui-state-disabled"))return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}"string"!=typeof handler&&(handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++);var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];selector?delegateElement.on(eventName,selector,handlerProxy):element.on(eventName,handlerProxy)})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,element.off(eventName).off(eventName),this.bindings=$(this.bindings.not(element).get()),this.focusable=$(this.focusable.not(element).get()),this.hoverable=$(this.hoverable.not(element).get())},_delay:function(handler,delay){var instance=this;return setTimeout(function(){return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)},delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element),this._on(element,{mouseenter:function(event){this._addClass($(event.currentTarget),null,"ui-state-hover")},mouseleave:function(event){this._removeClass($(event.currentTarget),null,"ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element),this._on(element,{focusin:function(event){this._addClass($(event.currentTarget),null,"ui-state-focus")},focusout:function(event){this._removeClass($(event.currentTarget),null,"ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];if(data=data||{},event=$.Event(event),event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase(),event.target=this.element[0],orig=event.originalEvent)for(prop in orig)prop in event||(event[prop]=orig[prop]);return this.element.trigger(event,data),!($.isFunction(callback)&&!1===callback.apply(this.element[0],[event].concat(data))||event.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){"string"==typeof options&&(options={effect:options});var hasOptions,effectName=options?!0===options||"number"==typeof options?defaultEffect:options.effect||defaultEffect:method;"number"==typeof(options=options||{})&&(options={duration:options}),hasOptions=!$.isEmptyObject(options),options.complete=callback,options.delay&&element.delay(options.delay),hasOptions&&$.effects&&$.effects.effect[effectName]?element[method](options):effectName!==method&&element[effectName]?element[effectName](options.duration,options.easing,callback):element.queue(function(next){$(this)[method](),callback&&callback.call(element[0]),next()})}});$.widget;!function(){function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}function parseCss(element,property){return parseInt($.css(element,property),10)||0}function getDimensions(elem){var raw=elem[0];return 9===raw.nodeType?{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}:$.isWindow(raw)?{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}:raw.preventDefault?{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}:{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}var cachedScrollbarWidth,max=Math.max,abs=Math.abs,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;$.position={scrollbarWidth:function(){if(void 0!==cachedScrollbarWidth)return cachedScrollbarWidth;var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];return $("body").append(div),w1=innerDiv.offsetWidth,div.css("overflow","scroll"),w2=innerDiv.offsetWidth,w1===w2&&(w2=div[0].clientWidth),div.remove(),cachedScrollbarWidth=w1-w2},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX="scroll"===overflowX||"auto"===overflowX&&within.width<within.element[0].scrollWidth;return{width:"scroll"===overflowY||"auto"===overflowY&&within.height<within.element[0].scrollHeight?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&9===withinElement[0].nodeType;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:!isWindow&&!isDocument?$(element).offset():{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:withinElement.outerWidth(),height:withinElement.outerHeight()}}},$.fn.position=function(options){if(!options||!options.of)return _position.apply(this,arguments);options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};return dimensions=getDimensions(target),target[0].preventDefault&&(options.at="left top"),targetWidth=dimensions.width,targetHeight=dimensions.height,targetOffset=dimensions.offset,basePosition=$.extend({},targetOffset),$.each(["my","at"],function(){var horizontalOffset,verticalOffset,pos=(options[this]||"").split(" ");1===pos.length&&(pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]),pos[0]=rhorizontal.test(pos[0])?pos[0]:"center",pos[1]=rvertical.test(pos[1])?pos[1]:"center",horizontalOffset=roffset.exec(pos[0]),verticalOffset=roffset.exec(pos[1]),offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0],options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]}),1===collision.length&&(collision[1]=collision[0]),"right"===options.at[0]?basePosition.left+=targetWidth:"center"===options.at[0]&&(basePosition.left+=targetWidth/2),"bottom"===options.at[1]?basePosition.top+=targetHeight:"center"===options.at[1]&&(basePosition.top+=targetHeight/2),atOffset=getOffsets(offsets.at,targetWidth,targetHeight),basePosition.left+=atOffset[0],basePosition.top+=atOffset[1],this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());"right"===options.my[0]?position.left-=elemWidth:"center"===options.my[0]&&(position.left-=elemWidth/2),"bottom"===options.my[1]?position.top-=elemHeight:"center"===options.my[1]&&(position.top-=elemHeight/2),position.left+=myOffset[0],position.top+=myOffset[1],collisionPosition={marginLeft:marginLeft,marginTop:marginTop},$.each(["left","top"],function(i,dir){$.ui.position[collision[i]]&&$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}),options.using&&(using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};targetWidth<elemWidth&&abs(left+right)<targetWidth&&(feedback.horizontal="center"),targetHeight<elemHeight&&abs(top+bottom)<targetHeight&&(feedback.vertical="middle"),max(abs(left),abs(right))>max(abs(top),abs(bottom))?feedback.important="horizontal":feedback.important="vertical",options.using.call(this,props,feedback)}),elem.offset($.extend(position,{using:using}))})},$.ui.position={fit:{left:function(position,data){var newOverRight,within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset;data.collisionWidth>outerWidth?overLeft>0&&overRight<=0?(newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset,position.left+=overLeft-newOverRight):position.left=overRight>0&&overLeft<=0?withinOffset:overLeft>overRight?withinOffset+outerWidth-data.collisionWidth:withinOffset:overLeft>0?position.left+=overLeft:overRight>0?position.left-=overRight:position.left=max(position.left-collisionPosLeft,position.left)},top:function(position,data){var newOverBottom,within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset;data.collisionHeight>outerHeight?overTop>0&&overBottom<=0?(newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset,position.top+=overTop-newOverBottom):position.top=overBottom>0&&overTop<=0?withinOffset:overTop>overBottom?withinOffset+outerHeight-data.collisionHeight:withinOffset:overTop>0?position.top+=overTop:overBottom>0?position.top-=overBottom:position.top=max(position.top-collisionPosTop,position.top)}},flip:{left:function(position,data){var newOverRight,newOverLeft,within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset="left"===data.my[0]?-data.elemWidth:"right"===data.my[0]?data.elemWidth:0,atOffset="left"===data.at[0]?data.targetWidth:"right"===data.at[0]?-data.targetWidth:0,offset=-2*data.offset[0];overLeft<0?((newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset)<0||newOverRight<abs(overLeft))&&(position.left+=myOffset+atOffset+offset):overRight>0&&((newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft)>0||abs(newOverLeft)<overRight)&&(position.left+=myOffset+atOffset+offset)},top:function(position,data){var newOverTop,newOverBottom,within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,myOffset="top"===data.my[1]?-data.elemHeight:"bottom"===data.my[1]?data.elemHeight:0,atOffset="top"===data.at[1]?data.targetHeight:"bottom"===data.at[1]?-data.targetHeight:0,offset=-2*data.offset[1];overTop<0?((newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset)<0||newOverBottom<abs(overTop))&&(position.top+=myOffset+atOffset+offset):overBottom>0&&((newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop)>0||abs(newOverTop)<overBottom)&&(position.top+=myOffset+atOffset+offset)}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments),$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments),$.ui.position.fit.top.apply(this,arguments)}}}}();$.ui.position,$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])}}),$.fn.extend({disableSelection:function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(eventType+".ui-disableSelection",function(event){event.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});var dataSpaceAnimated="ui-effects-animated",jQuery=$;$.effects={effect:{}},function(jQuery,undefined){function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};return null==value?allowEmpty||!prop.def?null:prop.def:(value=type.floor?~~value:parseFloat(value),isNaN(value)?prop.def:type.mod?(value+type.mod)%type.mod:0>value?0:type.max<value?type.max:value)}function stringParse(string){var inst=color(),rgba=inst._rgba=[];return string=string.toLowerCase(),each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values)return parsed=inst[spaceName](values),inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache],rgba=inst._rgba=parsed._rgba,!1}),rgba.length?("0,0,0,0"===rgba.join()&&jQuery.extend(rgba,colors.transparent),inst):colors[string]}function hue2rgb(p,q,h){return 6*(h=(h+1)%1)<1?p+(q-p)*h*6:2*h<1?q:3*h<2?p+(q-p)*(2/3-h)*6:p}var colors,rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],execResult[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]]}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha)},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},support=color.support={},supportElem=jQuery("<p>")[0],each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)",support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1,each(spaces,function(spaceName,space){space.cache="_"+spaceName,space.props.alpha={idx:3,type:"percent",def:1}}),color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(void 0===red)return this._rgba=[null,null,null,null],this;(red.jquery||red.nodeType)&&(red=jQuery(red).css(green),green=void 0);var inst=this,type=jQuery.type(red),rgba=this._rgba=[];return void 0!==green&&(red=[red,green,blue,alpha],type="array"),"string"===type?this.parse(stringParse(red)||colors._default):"array"===type?(each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop)}),this):"object"===type?(red instanceof color?each(spaces,function(spaceName,space){red[space.cache]&&(inst[space.cache]=red[space.cache].slice())}):each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if("alpha"===key||null==red[key])return;inst[cache]=space.to(inst._rgba)}inst[cache][prop.idx]=clamp(red[key],prop,!0)}),inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0&&(inst[cache][3]=1,space.from&&(inst._rgba=space.from(inst[cache])))}),this):void 0},is:function(compare){var is=color(compare),same=!0,inst=this;return each(spaces,function(_,space){var localCache,isCache=is[space.cache];return isCache&&(localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[],each(space.props,function(_,prop){if(null!=isCache[prop.idx])return same=isCache[prop.idx]===localCache[prop.idx]})),same}),same},_space:function(){var used=[],inst=this;return each(spaces,function(spaceName,space){inst[space.cache]&&used.push(spaceName)}),used.pop()},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=0===this.alpha()?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();return end=end[space.cache],each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};null!==endValue&&(null===startValue?result[index]=endValue:(type.mod&&(endValue-startValue>type.mod/2?startValue+=type.mod:startValue-endValue>type.mod/2&&(startValue-=type.mod)),result[index]=clamp((endValue-startValue)*distance+startValue,prop)))}),this[spaceName](result)},blend:function(opaque){if(1===this._rgba[3])return this;var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v}))},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return null==v?i>2?1:0:v});return 1===rgba[3]&&(rgba.pop(),prefix="rgb("),prefix+rgba.join()+")"},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){return null==v&&(v=i>2?1:0),i&&i<3&&(v=Math.round(100*v)+"%"),v});return 1===hsla[3]&&(hsla.pop(),prefix="hsl("),prefix+hsla.join()+")"},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();return includeAlpha&&rgba.push(~~(255*alpha)),"#"+jQuery.map(rgba,function(v){return 1===(v=(v||0).toString(16)).length?"0"+v:v}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),color.fn.parse.prototype=color.fn,spaces.hsla.to=function(rgba){if(null==rgba[0]||null==rgba[1]||null==rgba[2])return[null,null,null,rgba[3]];var h,s,r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=.5*add;return h=min===max?0:r===max?60*(g-b)/diff+360:g===max?60*(b-r)/diff+120:60*(r-g)/diff+240,s=0===diff?0:l<=.5?diff/add:diff/(2-add),[Math.round(h)%360,s,l,null==a?1:a]},spaces.hsla.from=function(hsla){if(null==hsla[0]||null==hsla[1]||null==hsla[2])return[null,null,null,hsla[3]];var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(255*hue2rgb(p,q,h+1/3)),Math.round(255*hue2rgb(p,q,h)),Math.round(255*hue2rgb(p,q,h-1/3)),a]},each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]&&(this[cache]=to(this._rgba)),void 0===value)return this[cache].slice();var ret,type=jQuery.type(value),arr="array"===type||"object"===type?value:arguments,local=this[cache].slice();return each(props,function(key,prop){var val=arr["object"===type?key:prop.idx];null==val&&(val=local[prop.idx]),local[prop.idx]=clamp(val,prop)}),from?(ret=color(from(local)),ret[cache]=local,ret):color(local)},each(props,function(key,prop){color.fn[key]||(color.fn[key]=function(value){var match,vtype=jQuery.type(value),fn="alpha"===key?this._hsla?"hsla":"rgba":spaceName,local=this[fn](),cur=local[prop.idx];return"undefined"===vtype?cur:("function"===vtype&&(value=value.call(this,cur),vtype=jQuery.type(value)),null==value&&prop.empty?this:("string"===vtype&&(match=rplusequals.exec(value))&&(value=cur+parseFloat(match[2])*("+"===match[1]?1:-1)),local[prop.idx]=value,this[fn](local)))})})}),color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if("transparent"!==value&&("string"!==jQuery.type(value)||(parsed=stringParse(value)))){if(value=color(parsed||value),!support.rgba&&1!==value._rgba[3]){for(curElem="backgroundColor"===hook?elem.parentNode:elem;(""===backgroundColor||"transparent"===backgroundColor)&&curElem&&curElem.style;)try{backgroundColor=jQuery.css(curElem,"backgroundColor"),curElem=curElem.parentNode}catch(e){}value=value.blend(backgroundColor&&"transparent"!==backgroundColor?backgroundColor:"_default")}value=value.toRgbaString()}try{elem.style[hook]=value}catch(e){}}},jQuery.fx.step[hook]=function(fx){fx.colorInit||(fx.start=color(fx.elem,hook),fx.end=color(fx.end),fx.colorInit=!0),jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos))}})},color.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),jQuery.cssHooks.borderColor={expand:function(value){var expanded={};return each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value}),expanded}},colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]])for(len=style.length;len--;)"string"==typeof style[key=style[len]]&&(styles[$.camelCase(key)]=style[key]);else for(key in style)"string"==typeof style[key]&&(styles[key]=style[key]);return styles}function styleDifference(oldStyle,newStyle){var name,value,diff={};for(name in newStyle)value=newStyle[name],oldStyle[name]!==value&&(shorthandStyles[name]||!$.fx.step[name]&&isNaN(parseFloat(value))||(diff[name]=value));return diff}var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){("none"!==fx.end&&!fx.setAttr||1===fx.pos&&!fx.setAttr)&&(jQuery.style(fx.elem,prop,fx.end),fx.setAttr=!0)}}),$.fn.addBack||($.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}),$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var applyClassChange,animated=$(this),baseClass=animated.attr("class")||"",allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){return{el:$(this),start:getElementStyles(this)}}),(applyClassChange=function(){$.each(classAnimationActions,function(i,action){value[action]&&animated[action+"Class"](value[action])})})(),allAnimations=allAnimations.map(function(){return this.end=getElementStyles(this.el[0]),this.diff=styleDifference(this.start,this.end),this}),animated.attr("class",baseClass),allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:!1,complete:function(){dfd.resolve(styleInfo)}});return this.el.animate(this.diff,opts),dfd.promise()}),$.when.apply($,allAnimations.get()).done(function(){applyClassChange(),$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"")})}),o.complete.call(animated[0])})})},$.fn.extend({addClass:function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.addClass),removeClass:function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.removeClass),toggleClass:function(orig){return function(classNames,force,speed,easing,callback){return"boolean"==typeof force||void 0===force?speed?$.effects.animateClass.call(this,force?{add:classNames}:{remove:classNames},speed,easing,callback):orig.apply(this,arguments):$.effects.animateClass.call(this,{toggle:classNames},force,speed,easing)}}($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback)}})}(),function(){function _normalizeArguments(effect,options,speed,callback){return $.isPlainObject(effect)&&(options=effect,effect=effect.effect),effect={effect:effect},null==options&&(options={}),$.isFunction(options)&&(callback=options,speed=null,options={}),("number"==typeof options||$.fx.speeds[options])&&(callback=speed,speed=options,options={}),$.isFunction(speed)&&(callback=speed,speed=null),options&&$.extend(effect,options),speed=speed||options.duration,effect.duration=$.fx.off?0:"number"==typeof speed?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default,effect.complete=callback||options.complete,effect}function standardAnimationOption(option){return!(option&&"number"!=typeof option&&!$.fx.speeds[option])||("string"==typeof option&&!$.effects.effect[option]||(!!$.isFunction(option)||"object"==typeof option&&!option.effect))}function parseClip(str,element){var outerWidth=element.outerWidth(),outerHeight=element.outerHeight(),values=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(str)||["",0,outerWidth,outerHeight,0];return{top:parseFloat(values[1])||0,right:"auto"===values[2]?outerWidth:parseFloat(values[2]),bottom:"auto"===values[3]?outerHeight:parseFloat(values[3]),left:parseFloat(values[4])||0}}$.expr&&$.expr.filters&&$.expr.filters.animated&&($.expr.filters.animated=function(orig){return function(elem){return!!$(elem).data(dataSpaceAnimated)||orig(elem)}}($.expr.filters.animated)),!1!==$.uiBackCompat&&$.extend($.effects,{save:function(element,set){for(var i=0,length=set.length;i<length;i++)null!==set[i]&&element.data("ui-effects-"+set[i],element[0].style[set[i]])},restore:function(element,set){for(var val,i=0,length=set.length;i<length;i++)null!==set[i]&&(val=element.data("ui-effects-"+set[i]),element.css(set[i],val))},setMode:function(el,mode){return"toggle"===mode&&(mode=el.is(":hidden")?"show":"hide"),mode},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper"))return element.parent();var props={width:element.outerWidth(!0),height:element.outerHeight(!0),float:element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id}catch(e){active=document.body}return element.wrap(wrapper),(element[0]===active||$.contains(element[0],active))&&$(active).trigger("focus"),wrapper=element.parent(),"static"===element.css("position")?(wrapper.css({position:"relative"}),element.css({position:"relative"})):($.extend(props,{position:element.css("position"),zIndex:element.css("z-index")}),$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos),isNaN(parseInt(props[pos],10))&&(props[pos]="auto")}),element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),element.css(size),wrapper.css(props).show()},removeWrapper:function(element){var active=document.activeElement;return element.parent().is(".ui-effects-wrapper")&&(element.parent().replaceWith(element),(element[0]===active||$.contains(element[0],active))&&$(active).trigger("focus")),element}}),$.extend($.effects,{version:"1.12.1",define:function(name,mode,effect){return effect||(effect=mode,mode="effect"),$.effects.effect[name]=effect,$.effects.effect[name].mode=mode,effect},scaledDimensions:function(element,percent,direction){if(0===percent)return{height:0,width:0,outerHeight:0,outerWidth:0};var x="horizontal"!==direction?(percent||100)/100:1,y="vertical"!==direction?(percent||100)/100:1;return{height:element.height()*y,width:element.width()*x,outerHeight:element.outerHeight()*y,outerWidth:element.outerWidth()*x}},clipToBox:function(animation){return{width:animation.clip.right-animation.clip.left,height:animation.clip.bottom-animation.clip.top,left:animation.clip.left,top:animation.clip.top}},unshift:function(element,queueLength,count){var queue=element.queue();queueLength>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queueLength,count))),element.dequeue()},saveStyle:function(element){element.data("ui-effects-style",element[0].style.cssText)},restoreStyle:function(element){element[0].style.cssText=element.data("ui-effects-style")||"",element.removeData("ui-effects-style")},mode:function(element,mode){var hidden=element.is(":hidden");return"toggle"===mode&&(mode=hidden?"show":"hide"),(hidden?"hide"===mode:"show"===mode)&&(mode="none"),mode},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height}switch(origin[1]){case"left":x=0;break;case"center":x=.5;break;case"right":x=1;break;default:x=origin[1]/original.width}return{x:x,y:y}},createPlaceholder:function(element){var placeholder,cssPosition=element.css("position"),position=element.position();return element.css({marginTop:element.css("marginTop"),marginBottom:element.css("marginBottom"),marginLeft:element.css("marginLeft"),marginRight:element.css("marginRight")}).outerWidth(element.outerWidth()).outerHeight(element.outerHeight()),/^(static|relative)/.test(cssPosition)&&(cssPosition="absolute",placeholder=$("<"+element[0].nodeName+">").insertAfter(element).css({display:/^(inline|ruby)/.test(element.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:element.css("marginTop"),marginBottom:element.css("marginBottom"),marginLeft:element.css("marginLeft"),marginRight:element.css("marginRight"),float:element.css("float")}).outerWidth(element.outerWidth()).outerHeight(element.outerHeight()).addClass("ui-effects-placeholder"),element.data("ui-effects-placeholder",placeholder)),element.css({position:cssPosition,left:position.left,top:position.top}),placeholder},removePlaceholder:function(element){var dataKey="ui-effects-placeholder",placeholder=element.data(dataKey);placeholder&&(placeholder.remove(),element.removeData(dataKey))},cleanUp:function(element){$.effects.restoreStyle(element),$.effects.removePlaceholder(element)},setTransition:function(element,list,factor,value){return value=value||{},$.each(list,function(i,x){var unit=element.cssUnit(x);unit[0]>0&&(value[x]=unit[0]*factor+unit[1])}),value}}),$.fn.extend({effect:function(){function run(next){function done(){$.isFunction(complete)&&complete.call(elem[0]),$.isFunction(next)&&next()}var elem=$(this);args.mode=modes.shift(),!1===$.uiBackCompat||defaultMode?"none"===args.mode?(elem[mode](),done()):effectMethod.call(elem[0],args,function(){elem.removeData(dataSpaceAnimated),$.effects.cleanUp(elem),"hide"===args.mode&&elem.hide(),done()}):(elem.is(":hidden")?"hide"===mode:"show"===mode)?(elem[mode](),done()):effectMethod.call(elem[0],args,done)}var args=_normalizeArguments.apply(this,arguments),effectMethod=$.effects.effect[args.effect],defaultMode=effectMethod.mode,queue=args.queue,queueName=queue||"fx",complete=args.complete,mode=args.mode,modes=[],prefilter=function(next){var el=$(this),normalizedMode=$.effects.mode(el,mode)||defaultMode;el.data(dataSpaceAnimated,!0),modes.push(normalizedMode),defaultMode&&("show"===normalizedMode||normalizedMode===defaultMode&&"hide"===normalizedMode)&&el.show(),defaultMode&&"none"===normalizedMode||$.effects.saveStyle(el),$.isFunction(next)&&next()};return $.fx.off||!effectMethod?mode?this[mode](args.duration,complete):this.each(function(){complete&&complete.call(this)}):!1===queue?this.each(prefilter).each(run):this.queue(queueName,prefilter).queue(queueName,run)},show:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="show",this.effect.call(this,args)}}($.fn.show),hide:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="hide",this.effect.call(this,args)}}($.fn.hide),toggle:function(orig){return function(option){if(standardAnimationOption(option)||"boolean"==typeof option)return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="toggle",this.effect.call(this,args)}}($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];return $.each(["em","px","%","pt"],function(i,unit){style.indexOf(unit)>0&&(val=[parseFloat(style),unit])}),val},cssClip:function(clipObj){return clipObj?this.css("clip","rect("+clipObj.top+"px "+clipObj.right+"px "+clipObj.bottom+"px "+clipObj.left+"px)"):parseClip(this.css("clip"),this)},transfer:function(options,done){var element=$(this),target=$(options.to),targetFixed="fixed"===target.css("position"),body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=element.offset(),transfer=$("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(options.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:element.innerHeight(),width:element.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,options.duration,options.easing,function(){transfer.remove(),$.isFunction(done)&&done()})}}),$.fx.step.clip=function(fx){fx.clipInit||(fx.start=$(fx.elem).cssClip(),"string"==typeof fx.end&&(fx.end=parseClip(fx.end,fx.elem)),fx.clipInit=!0),$(fx.elem).cssClip({top:fx.pos*(fx.end.top-fx.start.top)+fx.start.top,right:fx.pos*(fx.end.right-fx.start.right)+fx.start.right,bottom:fx.pos*(fx.end.bottom-fx.start.bottom)+fx.start.bottom,left:fx.pos*(fx.end.left-fx.start.left)+fx.start.left})}}(),function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2)}}),$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI/2)},Circ:function(p){return 1-Math.sqrt(1-p*p)},Elastic:function(p){return 0===p||1===p?p:-Math.pow(2,8*(p-1))*Math.sin((80*(p-1)-7.5)*Math.PI/15)},Back:function(p){return p*p*(3*p-2)},Bounce:function(p){for(var pow2,bounce=4;p<((pow2=Math.pow(2,--bounce))-1)/11;);return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((3*pow2-2)/22-p,2)}}),$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn,$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p)},$.easing["easeInOut"+name]=function(p){return p<.5?easeIn(2*p)/2:1-easeIn(-2*p+2)/2}})}();$.effects,$.effects.define("blind","hide",function(options,done){var map={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},element=$(this),direction=options.direction||"up",start=element.cssClip(),animate={clip:$.extend({},start)},placeholder=$.effects.createPlaceholder(element);animate.clip[map[direction][0]]=animate.clip[map[direction][1]],"show"===options.mode&&(element.cssClip(animate.clip),placeholder&&placeholder.css($.effects.clipToBox(animate)),animate.clip=start),placeholder&&placeholder.animate($.effects.clipToBox(animate),options.duration,options.easing),element.animate(animate,{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("bounce",function(options,done){var upAnim,downAnim,refValue,element=$(this),mode=options.mode,hide="hide"===mode,show="show"===mode,direction=options.direction||"up",distance=options.distance,times=options.times||5,anims=2*times+(show||hide?1:0),speed=options.duration/anims,easing=options.easing,ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction,i=0,queuelen=element.queue().length;for($.effects.createPlaceholder(element),refValue=element.css(ref),distance||(distance=element["top"===ref?"outerHeight":"outerWidth"]()/3),show&&((downAnim={opacity:1})[ref]=refValue,element.css("opacity",0).css(ref,motion?2*-distance:2*distance).animate(downAnim,speed,easing)),hide&&(distance/=Math.pow(2,times-1)),(downAnim={})[ref]=refValue;i<times;i++)(upAnim={})[ref]=(motion?"-=":"+=")+distance,element.animate(upAnim,speed,easing).animate(downAnim,speed,easing),distance=hide?2*distance:distance/2;hide&&((upAnim={opacity:0})[ref]=(motion?"-=":"+=")+distance,element.animate(upAnim,speed,easing)),element.queue(done),$.effects.unshift(element,queuelen,anims+1)}),$.effects.define("clip","hide",function(options,done){var start,animate={},element=$(this),direction=options.direction||"vertical",both="both"===direction,horizontal=both||"horizontal"===direction,vertical=both||"vertical"===direction;start=element.cssClip(),animate.clip={top:vertical?(start.bottom-start.top)/2:start.top,right:horizontal?(start.right-start.left)/2:start.right,bottom:vertical?(start.bottom-start.top)/2:start.bottom,left:horizontal?(start.right-start.left)/2:start.left},$.effects.createPlaceholder(element),"show"===options.mode&&(element.cssClip(animate.clip),animate.clip=start),element.animate(animate,{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("drop","hide",function(options,done){var distance,element=$(this),show="show"===options.mode,direction=options.direction||"left",ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction?"-=":"+=",oppositeMotion="+="===motion?"-=":"+=",animation={opacity:0};$.effects.createPlaceholder(element),distance=options.distance||element["top"===ref?"outerHeight":"outerWidth"](!0)/2,animation[ref]=motion+distance,show&&(element.css(animation),animation[ref]=oppositeMotion+distance,animation.opacity=1),element.animate(animation,{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("explode","hide",function(options,done){function animComplete(){element.css({visibility:"visible"}),$(pieces).remove(),done()}var i,j,left,top,mx,my,rows=options.pieces?Math.round(Math.sqrt(options.pieces)):3,cells=rows,element=$(this),show="show"===options.mode,offset=element.show().css("visibility","hidden").offset(),width=Math.ceil(element.outerWidth()/cells),height=Math.ceil(element.outerHeight()/rows),pieces=[];for(i=0;i<rows;i++)for(top=offset.top+i*height,my=i-(rows-1)/2,j=0;j<cells;j++)left=offset.left+j*width,mx=j-(cells-1)/2,element.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*width,top:-i*height}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width,height:height,left:left+(show?mx*width:0),top:top+(show?my*height:0),opacity:show?0:1}).animate({left:left+(show?0:mx*width),top:top+(show?0:my*height),opacity:show?1:0},options.duration||500,options.easing,function(){pieces.push(this),pieces.length===rows*cells&&animComplete()})}),$.effects.define("fade","toggle",function(options,done){var show="show"===options.mode;$(this).css("opacity",show?0:1).animate({opacity:show?1:0},{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("fold","hide",function(options,done){var element=$(this),mode=options.mode,show="show"===mode,hide="hide"===mode,size=options.size||15,percent=/([0-9]+)%/.exec(size),ref=!!options.horizFirst?["right","bottom"]:["bottom","right"],duration=options.duration/2,placeholder=$.effects.createPlaceholder(element),start=element.cssClip(),animation1={clip:$.extend({},start)},animation2={clip:$.extend({},start)},distance=[start[ref[0]],start[ref[1]]],queuelen=element.queue().length;percent&&(size=parseInt(percent[1],10)/100*distance[hide?0:1]),animation1.clip[ref[0]]=size,animation2.clip[ref[0]]=size,animation2.clip[ref[1]]=0,show&&(element.cssClip(animation2.clip),placeholder&&placeholder.css($.effects.clipToBox(animation2)),animation2.clip=start),element.queue(function(next){placeholder&&placeholder.animate($.effects.clipToBox(animation1),duration,options.easing).animate($.effects.clipToBox(animation2),duration,options.easing),next()}).animate(animation1,duration,options.easing).animate(animation2,duration,options.easing).queue(done),$.effects.unshift(element,queuelen,4)}),$.effects.define("highlight","show",function(options,done){var element=$(this),animation={backgroundColor:element.css("backgroundColor")};"hide"===options.mode&&(animation.opacity=0),$.effects.saveStyle(element),element.css({backgroundImage:"none",backgroundColor:options.color||"#ffff99"}).animate(animation,{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("size",function(options,done){var baseline,factor,temp,element=$(this),cProps=["fontSize"],vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],mode=options.mode,restore="effect"!==mode,scale=options.scale||"both",origin=options.origin||["middle","center"],position=element.css("position"),pos=element.position(),original=$.effects.scaledDimensions(element),from=options.from||original,to=options.to||$.effects.scaledDimensions(element,0);$.effects.createPlaceholder(element),"show"===mode&&(temp=from,from=to,to=temp),factor={from:{y:from.height/original.height,x:from.width/original.width},to:{y:to.height/original.height,x:to.width/original.width}},"box"!==scale&&"both"!==scale||(factor.from.y!==factor.to.y&&(from=$.effects.setTransition(element,vProps,factor.from.y,from),to=$.effects.setTransition(element,vProps,factor.to.y,to)),factor.from.x!==factor.to.x&&(from=$.effects.setTransition(element,hProps,factor.from.x,from),to=$.effects.setTransition(element,hProps,factor.to.x,to))),"content"!==scale&&"both"!==scale||factor.from.y!==factor.to.y&&(from=$.effects.setTransition(element,cProps,factor.from.y,from),to=$.effects.setTransition(element,cProps,factor.to.y,to)),origin&&(baseline=$.effects.getBaseline(origin,original),from.top=(original.outerHeight-from.outerHeight)*baseline.y+pos.top,from.left=(original.outerWidth-from.outerWidth)*baseline.x+pos.left,to.top=(original.outerHeight-to.outerHeight)*baseline.y+pos.top,to.left=(original.outerWidth-to.outerWidth)*baseline.x+pos.left),element.css(from),"content"!==scale&&"both"!==scale||(vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps),hProps=hProps.concat(["marginLeft","marginRight"]),element.find("*[width]").each(function(){var child=$(this),childOriginal=$.effects.scaledDimensions(child),childFrom={height:childOriginal.height*factor.from.y,width:childOriginal.width*factor.from.x,outerHeight:childOriginal.outerHeight*factor.from.y,outerWidth:childOriginal.outerWidth*factor.from.x},childTo={height:childOriginal.height*factor.to.y,width:childOriginal.width*factor.to.x,outerHeight:childOriginal.height*factor.to.y,outerWidth:childOriginal.width*factor.to.x};factor.from.y!==factor.to.y&&(childFrom=$.effects.setTransition(child,vProps,factor.from.y,childFrom),childTo=$.effects.setTransition(child,vProps,factor.to.y,childTo)),factor.from.x!==factor.to.x&&(childFrom=$.effects.setTransition(child,hProps,factor.from.x,childFrom),childTo=$.effects.setTransition(child,hProps,factor.to.x,childTo)),restore&&$.effects.saveStyle(child),child.css(childFrom),child.animate(childTo,options.duration,options.easing,function(){restore&&$.effects.restoreStyle(child)})})),element.animate(to,{queue:!1,duration:options.duration,easing:options.easing,complete:function(){var offset=element.offset();0===to.opacity&&element.css("opacity",from.opacity),restore||(element.css("position","static"===position?"relative":position).offset(offset),$.effects.saveStyle(element)),done()}})}),$.effects.define("scale",function(options,done){var el=$(this),mode=options.mode,percent=parseInt(options.percent,10)||(0===parseInt(options.percent,10)?0:"effect"!==mode?0:100),newOptions=$.extend(!0,{from:$.effects.scaledDimensions(el),to:$.effects.scaledDimensions(el,percent,options.direction||"both"),origin:options.origin||["middle","center"]},options);options.fade&&(newOptions.from.opacity=1,newOptions.to.opacity=0),$.effects.effect.size.call(this,newOptions,done)}),$.effects.define("puff","hide",function(options,done){var newOptions=$.extend(!0,{},options,{fade:!0,percent:parseInt(options.percent,10)||150});$.effects.effect.scale.call(this,newOptions,done)}),$.effects.define("pulsate","show",function(options,done){var element=$(this),mode=options.mode,show="show"===mode,hide="hide"===mode,showhide=show||hide,anims=2*(options.times||5)+(showhide?1:0),duration=options.duration/anims,animateTo=0,i=1,queuelen=element.queue().length;for(!show&&element.is(":visible")||(element.css("opacity",0).show(),animateTo=1);i<anims;i++)element.animate({opacity:animateTo},duration,options.easing),animateTo=1-animateTo;element.animate({opacity:animateTo},duration,options.easing),element.queue(done),$.effects.unshift(element,queuelen,anims+1)}),$.effects.define("shake",function(options,done){var i=1,element=$(this),direction=options.direction||"left",distance=options.distance||20,times=options.times||3,anims=2*times+1,speed=Math.round(options.duration/anims),ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,animation={},animation1={},animation2={},queuelen=element.queue().length;for($.effects.createPlaceholder(element),animation[ref]=(positiveMotion?"-=":"+=")+distance,animation1[ref]=(positiveMotion?"+=":"-=")+2*distance,animation2[ref]=(positiveMotion?"-=":"+=")+2*distance,element.animate(animation,speed,options.easing);i<times;i++)element.animate(animation1,speed,options.easing).animate(animation2,speed,options.easing);element.animate(animation1,speed,options.easing).animate(animation,speed/2,options.easing).queue(done),$.effects.unshift(element,queuelen,anims+1)}),$.effects.define("slide","show",function(options,done){var startClip,startRef,element=$(this),map={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},mode=options.mode,direction=options.direction||"left",ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,distance=options.distance||element["top"===ref?"outerHeight":"outerWidth"](!0),animation={};$.effects.createPlaceholder(element),startClip=element.cssClip(),startRef=element.position()[ref],animation[ref]=(positiveMotion?-1:1)*distance+startRef,animation.clip=element.cssClip(),animation.clip[map[direction][1]]=animation.clip[map[direction][0]],"show"===mode&&(element.cssClip(animation.clip),element.css(ref,animation[ref]),animation.clip=startClip,animation[ref]=startRef),element.animate(animation,{queue:!1,duration:options.duration,easing:options.easing,complete:done})});!1!==$.uiBackCompat&&$.effects.define("transfer",function(options,done){$(this).transfer(options,done)});$.ui.focusable=function(element,hasTabindex){var map,mapName,img,focusableIfVisible,fieldset,nodeName=element.nodeName.toLowerCase();return"area"===nodeName?(map=element.parentNode,mapName=map.name,!(!element.href||!mapName||"map"!==map.nodeName.toLowerCase())&&((img=$("img[usemap='#"+mapName+"']")).length>0&&img.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(nodeName)?(focusableIfVisible=!element.disabled)&&(fieldset=$(element).closest("fieldset")[0])&&(focusableIfVisible=!fieldset.disabled):focusableIfVisible="a"===nodeName?element.href||hasTabindex:hasTabindex,focusableIfVisible&&$(element).is(":visible")&&visible($(element)))},$.extend($.expr[":"],{focusable:function(element){return $.ui.focusable(element,null!=$.attr(element,"tabindex"))}});$.ui.focusable,$.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):$(this[0].form)},$.ui.formResetMixin={_formResetHandler:function(){var form=$(this);setTimeout(function(){var instances=form.data("ui-form-reset-instances");$.each(instances,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var instances=this.form.data("ui-form-reset-instances")||[];instances.length||this.form.on("reset.ui-form-reset",this._formResetHandler),instances.push(this),this.form.data("ui-form-reset-instances",instances)}},_unbindFormResetHandler:function(){if(this.form.length){var instances=this.form.data("ui-form-reset-instances");instances.splice($.inArray(this,instances),1),instances.length?this.form.data("ui-form-reset-instances",instances):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}};"1.7"===$.fn.jquery.substring(0,3)&&($.each(["Width","Height"],function(i,name){function reduce(elem,size,border,margin){return $.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0,border&&(size-=parseFloat($.css(elem,"border"+this+"Width"))||0),margin&&(size-=parseFloat($.css(elem,"margin"+this))||0)}),size}var side="Width"===name?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+name]=function(size){return void 0===size?orig["inner"+name].call(this):this.each(function(){$(this).css(type,reduce(this,size)+"px")})},$.fn["outer"+name]=function(size,margin){return"number"!=typeof size?orig["outer"+name].call(this,size):this.each(function(){$(this).css(type,reduce(this,size,!0,margin)+"px")})}}),$.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))});$.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},$.ui.escapeSelector=function(){var selectorEscape=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g;return function(selector){return selector.replace(selectorEscape,"\\$1")}}(),$.fn.labels=function(){var ancestor,selector,id,labels,ancestors;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(labels=this.eq(0).parents("label"),(id=this.attr("id"))&&(ancestors=(ancestor=this.eq(0).parents().last()).add(ancestor.length?ancestor.siblings():this.siblings()),selector="label[for='"+$.ui.escapeSelector(id)+"']",labels=labels.add(ancestors.find(selector).addBack(selector))),this.pushStack(labels))},$.fn.scrollParent=function(includeHidden){var position=this.css("position"),excludeStaticParent="absolute"===position,overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);return(!excludeStaticParent||"static"!==parent.css("position"))&&overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(this[0].ownerDocument||document)},$.extend($.expr[":"],{tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),hasTabindex=null!=tabIndex;return(!hasTabindex||tabIndex>=0)&&$.ui.focusable(element,hasTabindex)}}),$.fn.extend({uniqueId:function(){var uuid=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++uuid)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&$(this).removeAttr("id")})}}),$.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var options=this.options;this.prevShow=this.prevHide=$(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),options.collapsible||!1!==options.active&&null!=options.active||(options.active=0),this._processPanels(),options.active<0&&(options.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():$()}},_createIcons:function(){var icon,children,icons=this.options.icons;icons&&(icon=$("<span>"),this._addClass(icon,"ui-accordion-header-icon","ui-icon "+icons.header),icon.prependTo(this.headers),children=this.active.children(".ui-accordion-header-icon"),this._removeClass(children,icons.header)._addClass(children,null,icons.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var contents;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),contents=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&contents.css("height","")},_setOption:function(key,value){"active"!==key?("event"===key&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(value)),this._super(key,value),"collapsible"!==key||value||!1!==this.options.active||this._activate(0),"icons"===key&&(this._destroyIcons(),value&&this._createIcons())):this._activate(value)},_setOptionDisabled:function(value){this._super(value),this.element.attr("aria-disabled",value),this._toggleClass(null,"ui-state-disabled",!!value),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!value)},_keydown:function(event){if(!event.altKey&&!event.ctrlKey){var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=!1;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event);break;case keyCode.HOME:toFocus=this.headers[0];break;case keyCode.END:toFocus=this.headers[length-1]}toFocus&&($(event.target).attr("tabIndex",-1),$(toFocus).attr("tabIndex",0),$(toFocus).trigger("focus"),event.preventDefault())}},_panelKeyDown:function(event){event.keyCode===$.ui.keyCode.UP&&event.ctrlKey&&$(event.currentTarget).prev().trigger("focus")},refresh:function(){var options=this.options;this._processPanels(),!1===options.active&&!0===options.collapsible||!this.headers.length?(options.active=!1,this.active=$()):!1===options.active?this._activate(0):this.active.length&&!$.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(options.active=!1,this.active=$()):this._activate(Math.max(0,options.active-1)):options.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var prevHeaders=this.headers,prevPanels=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),prevPanels&&(this._off(prevHeaders.not(this.headers)),this._off(prevPanels.not(this.panels)))},_refresh:function(){var maxHeight,options=this.options,heightStyle=options.heightStyle,parent=this.element.parent();this.active=this._findActive(options.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var header=$(this),headerId=header.uniqueId().attr("id"),panel=header.next(),panelId=panel.uniqueId().attr("id");header.attr("aria-controls",panelId),panel.attr("aria-labelledby",headerId)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(options.event),"fill"===heightStyle?(maxHeight=parent.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.headers.each(function(){maxHeight-=$(this).outerHeight(!0)}),this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.headers.next().each(function(){var isVisible=$(this).is(":visible");isVisible||$(this).show(),maxHeight=Math.max(maxHeight,$(this).css("height","").height()),isVisible||$(this).hide()}).height(maxHeight))},_activate:function(index){var active=this._findActive(index)[0];active!==this.active[0]&&(active=active||this.active[0],this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop}))},_findActive:function(selector){return"number"==typeof selector?this.headers.eq(selector):$()},_setupEvents:function(event){var events={keydown:"_keydown"};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,events),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(event){var activeChildren,clickedChildren,options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),eventData={oldHeader:active,oldPanel:active.next(),newHeader:collapsing?$():clicked,newPanel:toShow};event.preventDefault(),clickedIsActive&&!options.collapsible||!1===this._trigger("beforeActivate",event,eventData)||(options.active=!collapsing&&this.headers.index(clicked),this.active=clickedIsActive?$():clicked,this._toggle(eventData),this._removeClass(active,"ui-accordion-header-active","ui-state-active"),options.icons&&(activeChildren=active.children(".ui-accordion-header-icon"),this._removeClass(activeChildren,null,options.icons.activeHeader)._addClass(activeChildren,null,options.icons.header)),clickedIsActive||(this._removeClass(clicked,"ui-accordion-header-collapsed")._addClass(clicked,"ui-accordion-header-active","ui-state-active"),options.icons&&(clickedChildren=clicked.children(".ui-accordion-header-icon"),this._removeClass(clickedChildren,null,options.icons.header)._addClass(clickedChildren,null,options.icons.activeHeader)),this._addClass(clicked.next(),"ui-accordion-content-active")))},_toggle:function(data){var toShow=data.newPanel,toHide=this.prevShow.length?this.prevShow:data.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=toShow,this.prevHide=toHide,this.options.animate?this._animate(toShow,toHide,data):(toHide.hide(),toShow.show(),this._toggleComplete(data)),toHide.attr({"aria-hidden":"true"}),toHide.prev().attr({"aria-selected":"false","aria-expanded":"false"}),toShow.length&&toHide.length?toHide.prev().attr({tabIndex:-1,"aria-expanded":"false"}):toShow.length&&this.headers.filter(function(){return 0===parseInt($(this).attr("tabIndex"),10)}).attr("tabIndex",-1),toShow.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(toShow,toHide,data){var total,easing,duration,that=this,adjust=0,boxSizing=toShow.css("box-sizing"),down=toShow.length&&(!toHide.length||toShow.index()<toHide.index()),animate=this.options.animate||{},options=down&&animate.down||animate,complete=function(){that._toggleComplete(data)};return"number"==typeof options&&(duration=options),"string"==typeof options&&(easing=options),easing=easing||options.easing||animate.easing,duration=duration||options.duration||animate.duration,toHide.length?toShow.length?(total=toShow.show().outerHeight(),toHide.animate(this.hideProps,{duration:duration,easing:easing,step:function(now,fx){fx.now=Math.round(now)}}),void toShow.hide().animate(this.showProps,{duration:duration,easing:easing,complete:complete,step:function(now,fx){fx.now=Math.round(now),"height"!==fx.prop?"content-box"===boxSizing&&(adjust+=fx.now):"content"!==that.options.heightStyle&&(fx.now=Math.round(total-toHide.outerHeight()-adjust),adjust=0)}})):toHide.animate(this.hideProps,duration,easing,complete):toShow.animate(this.showProps,duration,easing,complete)},_toggleComplete:function(data){var toHide=data.oldPanel,prev=toHide.prev();this._removeClass(toHide,"ui-accordion-content-active"),this._removeClass(prev,"ui-accordion-header-active")._addClass(prev,"ui-accordion-header-collapsed"),toHide.length&&(toHide.parent()[0].className=toHide.parent()[0].className),this._trigger("activate",null,data)}}),$.ui.safeActiveElement=function(document){var activeElement;try{activeElement=document.activeElement}catch(error){activeElement=document.body}return activeElement||(activeElement=document.body),activeElement.nodeName||(activeElement=document.body),activeElement},$.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(event){event.preventDefault()},"click .ui-menu-item":function(event){var target=$(event.target),active=$($.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&target.not(".ui-state-disabled").length&&(this.select(event),event.isPropagationStopped()||(this.mouseHandled=!0),target.has(".ui-menu").length?this.expand(event):!this.element.is(":focus")&&active.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(event){if(!this.previousFilter){var actualTarget=$(event.target).closest(".ui-menu-item"),target=$(event.currentTarget);actualTarget[0]===target[0]&&(this._removeClass(target.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(event,target))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.find(this.options.items).eq(0);keepActiveItem||this.focus(event,item)},blur:function(event){this._delay(function(){!$.contains(this.element[0],$.ui.safeActiveElement(this.document[0]))&&this.collapseAll(event)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(event){this._closeOnDocumentClick(event)&&this.collapseAll(event),this.mouseHandled=!1}})},_destroy:function(){var submenus=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),submenus.children().each(function(){var elem=$(this);elem.data("ui-menu-submenu-caret")&&elem.remove()})},_keydown:function(event){var match,prev,character,skip,preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(event);break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=!1,prev=this.previousFilter||"",skip=!1,character=event.keyCode>=96&&event.keyCode<=105?(event.keyCode-96).toString():String.fromCharCode(event.keyCode),clearTimeout(this.filterTimer),character===prev?skip=!0:character=prev+character,match=this._filterMenuItems(character),(match=skip&&-1!==match.index(this.active.next())?this.active.nextAll(".ui-menu-item"):match).length||(character=String.fromCharCode(event.keyCode),match=this._filterMenuItems(character)),match.length?(this.focus(event,match),this.previousFilter=character,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}preventDefault&&event.preventDefault()},_activate:function(event){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(event):this.select(event))},refresh:function(){var items,newSubmenus,newItems,newWrappers,that=this,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),newSubmenus=submenus.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.prev(),submenuCaret=$("<span>").data("ui-menu-submenu-caret",!0);that._addClass(submenuCaret,"ui-menu-icon","ui-icon "+icon),item.attr("aria-haspopup","true").prepend(submenuCaret),menu.attr("aria-labelledby",item.attr("id"))}),this._addClass(newSubmenus,"ui-menu","ui-widget ui-widget-content ui-front"),(items=submenus.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var item=$(this);that._isDivider(item)&&that._addClass(item,"ui-menu-divider","ui-widget-content")}),newWrappers=(newItems=items.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(newItems,"ui-menu-item")._addClass(newWrappers,"ui-menu-item-wrapper"),items.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(key,value){if("icons"===key){var icons=this.element.find(".ui-menu-icon");this._removeClass(icons,null,this.options.icons.submenu)._addClass(icons,null,value.submenu)}this._super(key,value)},_setOptionDisabled:function(value){this._super(value),this.element.attr("aria-disabled",String(value)),this._toggleClass(null,"ui-state-disabled",!!value)},focus:function(event,item){var nested,focused,activeParent;this.blur(event,event&&"focus"===event.type),this._scrollIntoView(item),this.active=item.first(),focused=this.active.children(".ui-menu-item-wrapper"),this._addClass(focused,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",focused.attr("id")),activeParent=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(activeParent,null,"ui-state-active"),event&&"keydown"===event.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(nested=item.children(".ui-menu")).length&&event&&/^mouse/.test(event.type)&&this._startOpening(nested),this.activeMenu=item.parent(),this._trigger("focus",event,{item:item})},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;this._hasScroll()&&(borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0,paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0,offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop,scroll=this.activeMenu.scrollTop(),elementHeight=this.activeMenu.height(),itemHeight=item.outerHeight(),offset<0?this.activeMenu.scrollTop(scroll+offset):offset+itemHeight>elementHeight&&this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight))},blur:function(event,fromFocus){fromFocus||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",event,{item:this.active}),this.active=null)},_startOpening:function(submenu){clearTimeout(this.timer),"true"===submenu.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(submenu)},this.delay))},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true"),submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position)},collapseAll:function(event,all){clearTimeout(this.timer),this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));currentMenu.length||(currentMenu=this.element),this._close(currentMenu),this.blur(event),this._removeClass(currentMenu.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=currentMenu},this.delay)},_close:function(startMenu){startMenu||(startMenu=this.active?this.active.parent():this.element),startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(event){return!$(event.target).closest(".ui-menu").length},_isDivider:function(item){return!/[^\-\u2014\u2013\s]/.test(item.text())},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);newItem&&newItem.length&&(this._close(),this.focus(event,newItem))},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();newItem&&newItem.length&&(this._open(newItem.parent()),this._delay(function(){this.focus(event,newItem)}))},next:function(event){this._move("next","first",event)},previous:function(event){this._move("prev","last",event)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(direction,filter,event){var next;this.active&&(next="first"===direction||"last"===direction?this.active["first"===direction?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[direction+"All"](".ui-menu-item").eq(0)),next&&next.length&&this.active||(next=this.activeMenu.find(this.options.items)[filter]()),this.focus(event,next)},nextPage:function(event){var item,base,height;this.active?this.isLastItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(item=$(this)).offset().top-base-height<0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())):this.next(event)},previousPage:function(event){var item,base,height;this.active?this.isFirstItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return(item=$(this)).offset().top-base+height>0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items).first())):this.next(event)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(event,!0),this._trigger("select",event,ui)},_filterMenuItems:function(character){var escapedCharacter=character.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),regex=new RegExp("^"+escapedCharacter,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return regex.test($.trim($(this).children(".ui-menu-item-wrapper").text()))})}});$.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea="textarea"===nodeName,isInput="input"===nodeName;this.isMultiLine=isTextarea||!isInput&&this._isContentEditable(this.element),this.valueMethod=this.element[isTextarea||isInput?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly"))return suppressKeyPress=!0,suppressInput=!0,void(suppressKeyPressRepeat=!0);suppressKeyPress=!1,suppressInput=!1,suppressKeyPressRepeat=!1;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=!0,this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=!0,this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=!0,this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=!0,this._keyEvent("next",event);break;case keyCode.ENTER:this.menu.active&&(suppressKeyPress=!0,event.preventDefault(),this.menu.select(event));break;case keyCode.TAB:this.menu.active&&this.menu.select(event);break;case keyCode.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(event),event.preventDefault());break;default:suppressKeyPressRepeat=!0,this._searchTimeout(event)}},keypress:function(event){if(suppressKeyPress)return suppressKeyPress=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||event.preventDefault());if(!suppressKeyPressRepeat){var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event)}}},input:function(event){if(suppressInput)return suppressInput=!1,void event.preventDefault();this._searchTimeout(event)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(event){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(event),this._change(event))}}),this._initSource(),this.menu=$("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(event){event.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==$.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(event,ui){var label,item;if(this.isNewMenu&&(this.isNewMenu=!1,event.originalEvent&&/^mouse/.test(event.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent)});item=ui.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",event,{item:item})&&event.originalEvent&&/^key/.test(event.originalEvent.type)&&this._value(item.value),(label=ui.item.attr("aria-label")||item.value)&&$.trim(label).length&&(this.liveRegion.children().hide(),$("<div>").text(label).appendTo(this.liveRegion))},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;this.element[0]!==$.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=previous,this._delay(function(){this.previous=previous,this.selectedItem=item})),!1!==this._trigger("select",event,{item:item})&&this._value(item.value),this.term=this._value(),this.close(event),this.selectedItem=item}}),this.liveRegion=$("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(key,value){this._super(key,value),"source"===key&&this._initSource(),"appendTo"===key&&this.menu.element.appendTo(this._appendTo()),"disabled"===key&&value&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(event){var menuElement=this.menu.element[0];return event.target===this.element[0]||event.target===menuElement||$.contains(menuElement,event.target)},_closeOnClickOutside:function(event){this._isEventTargetInWidget(event)||this.close()},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element&&element[0]||(element=this.element.closest(".ui-front, dialog")),element.length||(element=this.document[0].body),element},_initSource:function(){var array,url,that=this;$.isArray(this.options.source)?(array=this.options.source,this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}):"string"==typeof this.options.source?(url=this.options.source,this.source=function(request,response){that.xhr&&that.xhr.abort(),that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data)},error:function(){response([])}})}):this.source=this.options.source},_searchTimeout:function(event){clearTimeout(this.searching),this.searching=this._delay(function(){var equalValues=this.term===this._value(),menuVisible=this.menu.element.is(":visible"),modifierKey=event.altKey||event.ctrlKey||event.metaKey||event.shiftKey;equalValues&&(!equalValues||menuVisible||modifierKey)||(this.selectedItem=null,this.search(null,event))},this.options.delay)},search:function(value,event){return value=null!=value?value:this._value(),this.term=this._value(),value.length<this.options.minLength?this.close(event):!1!==this._trigger("search",event)?this._search(value):void 0},_search:function(value){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:value},this._response())},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){index===this.requestIndex&&this.__response(content),--this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(content){content&&(content=this._normalize(content)),this._trigger("response",null,{content:content}),!this.options.disabled&&content&&content.length&&!this.cancelSearch?(this._suggest(content),this._trigger("open")):this._close()},close:function(event){this.cancelSearch=!0,this._close(event)},_close:function(event){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",event))},_change:function(event){this.previous!==this._value()&&this._trigger("change",event,{item:this.selectedItem})},_normalize:function(items){return items.length&&items[0].label&&items[0].value?items:$.map(items,function(item){return"string"==typeof item?{label:item,value:item}:$.extend({},item,{label:item.label||item.value,value:item.value||item.label})})},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items),this.isNewMenu=!0,this.menu.refresh(),ul.show(),this._resizeMenu(),ul.position($.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item)},_renderItem:function(ul,item){return $("<li>").append($("<div>").text(item.label)).appendTo(ul)},_move:function(direction,event){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[direction](event);this.search(null,event)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(keyEvent,event){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(keyEvent,event),event.preventDefault())},_isContentEditable:function(element){if(!element.length)return!1;var editable=element.prop("contentEditable");return"inherit"===editable?this._isContentEditable(element.parent()):"true"===editable}}),$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}}),$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(content){var message;this._superApply(arguments),this.options.disabled||this.cancelSearch||(message=content&&content.length?this.options.messages.results(content.length):this.options.messages.noResults,this.liveRegion.children().hide(),$("<div>").text(message).appendTo(this.liveRegion))}});$.ui.autocomplete;var controlgroupCornerRegex=/ui-corner-([a-z]){2,6}/g;$.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var that=this,childWidgets=[];$.each(this.options.items,function(widget,selector){var labels,options={};if(selector)return"controlgroupLabel"===widget?((labels=that.element.find(selector)).each(function(){var element=$(this);element.children(".ui-controlgroup-label-contents").length||element.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),that._addClass(labels,null,"ui-widget ui-widget-content ui-state-default"),void(childWidgets=childWidgets.concat(labels.get()))):void($.fn[widget]&&(options=that["_"+widget+"Options"]?that["_"+widget+"Options"]("middle"):{classes:{}},that.element.find(selector).each(function(){var element=$(this),instance=element[widget]("instance"),instanceOptions=$.widget.extend({},options);if("button"!==widget||!element.parent(".ui-spinner").length){instance||(instance=element[widget]()[widget]("instance")),instance&&(instanceOptions.classes=that._resolveClassesValues(instanceOptions.classes,instance)),element[widget](instanceOptions);var widgetElement=element[widget]("widget");$.data(widgetElement[0],"ui-controlgroup-data",instance||element[widget]("instance")),childWidgets.push(widgetElement[0])}})))}),this.childWidgets=$($.unique(childWidgets)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(method){this.childWidgets.each(function(){var data=$(this).data("ui-controlgroup-data");data&&data[method]&&data[method]()})},_updateCornerClass:function(element,position){var add=this._buildSimpleOptions(position,"label").classes.label;this._removeClass(element,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(element,null,add)},_buildSimpleOptions:function(position,key){var direction="vertical"===this.options.direction,result={classes:{}};return result.classes[key]={middle:"",first:"ui-corner-"+(direction?"top":"left"),last:"ui-corner-"+(direction?"bottom":"right"),only:"ui-corner-all"}[position],result},_spinnerOptions:function(position){var options=this._buildSimpleOptions(position,"ui-spinner");return options.classes["ui-spinner-up"]="",options.classes["ui-spinner-down"]="",options},_buttonOptions:function(position){return this._buildSimpleOptions(position,"ui-button")},_checkboxradioOptions:function(position){return this._buildSimpleOptions(position,"ui-checkboxradio-label")},_selectmenuOptions:function(position){var direction="vertical"===this.options.direction;return{width:!!direction&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(direction?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(direction?"top":"left")},last:{"ui-selectmenu-button-open":direction?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(direction?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[position]}},_resolveClassesValues:function(classes,instance){var result={};return $.each(classes,function(key){var current=instance.options.classes[key]||"";current=$.trim(current.replace(controlgroupCornerRegex,"")),result[key]=(current+" "+classes[key]).replace(/\s+/g," ")}),result},_setOption:function(key,value){"direction"===key&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(key,value),"disabled"!==key?this.refresh():this._callChildMethod(value?"disable":"enable")},refresh:function(){var children,that=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),children=this.childWidgets,this.options.onlyVisible&&(children=children.filter(":visible")),children.length&&($.each(["first","last"],function(index,value){var instance=children[value]().data("ui-controlgroup-data");if(instance&&that["_"+instance.widgetName+"Options"]){var options=that["_"+instance.widgetName+"Options"](1===children.length?"only":value);options.classes=that._resolveClassesValues(options.classes,instance),instance.element[instance.widgetName](options)}else that._updateCornerClass(children[value](),value)}),this._callChildMethod("refresh"))}});$.widget("ui.checkboxradio",[$.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var disabled,labels,that=this,options=this._super()||{};return this._readType(),labels=this.element.labels(),this.label=$(labels[labels.length-1]),this.label.length||$.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){that.originalLabel+=3===this.nodeType?$(this).text():this.outerHTML}),this.originalLabel&&(options.label=this.originalLabel),null!=(disabled=this.element[0].disabled)&&(options.disabled=disabled),options},_create:function(){var checked=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),checked&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var nodeName=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===nodeName&&/radio|checkbox/.test(this.type)||$.error("Can't create checkboxradio on element.nodeName="+nodeName+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var name=this.element[0].name,nameSelector="input[name='"+$.ui.escapeSelector(name)+"']";return name?(this.form.length?$(this.form[0].elements).filter(nameSelector):$(nameSelector).filter(function(){return 0===$(this).form().length})).not(this.element):$([])},_toggleClasses:function(){var checked=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",checked),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",checked)._toggleClass(this.icon,null,"ui-icon-blank",!checked),"radio"===this.type&&this._getRadioGroup().each(function(){var instance=$(this).checkboxradio("instance");instance&&instance._removeClass(instance.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(key,value){if("label"!==key||value){if(this._super(key,value),"disabled"===key)return this._toggleClass(this.label,null,"ui-state-disabled",value),void(this.element[0].disabled=value);this.refresh()}},_updateIcon:function(checked){var toAdd="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=$("<span>"),this.iconSpace=$("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(toAdd+=checked?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,checked?"ui-icon-blank":"ui-icon-check")):toAdd+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",toAdd),checked||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var contents=this.label.contents().not(this.element[0]);this.icon&&(contents=contents.not(this.icon[0])),this.iconSpace&&(contents=contents.not(this.iconSpace[0])),contents.remove(),this.label.append(this.options.label)},refresh:function(){var checked=this.element[0].checked,isDisabled=this.element[0].disabled;this._updateIcon(checked),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",checked),null!==this.options.label&&this._updateLabel(),isDisabled!==this.options.disabled&&this._setOptions({disabled:isDisabled})}}]);$.ui.checkboxradio;$.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var disabled,options=this._super()||{};return this.isInput=this.element.is("input"),null!=(disabled=this.element[0].disabled)&&(options.disabled=disabled),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(options.label=this.originalLabel),options},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(event){event.keyCode===$.ui.keyCode.SPACE&&(event.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(option,value){var icon="iconPosition"!==option,position=icon?this.options.iconPosition:value,displayBlock="top"===position||"bottom"===position;this.icon?icon&&this._removeClass(this.icon,null,this.options.icon):(this.icon=$("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),icon&&this._addClass(this.icon,null,value),this._attachIcon(position),displayBlock?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=$("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(position))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(iconPosition){this.icon[/^(?:end|bottom)/.test(iconPosition)?"before":"after"](this.iconSpace)},_attachIcon:function(iconPosition){this.element[/^(?:end|bottom)/.test(iconPosition)?"append":"prepend"](this.icon)},_setOptions:function(options){var newShowLabel=void 0===options.showLabel?this.options.showLabel:options.showLabel,newIcon=void 0===options.icon?this.options.icon:options.icon;newShowLabel||newIcon||(options.showLabel=!0),this._super(options)},_setOption:function(key,value){"icon"===key&&(value?this._updateIcon(key,value):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===key&&this._updateIcon(key,value),"showLabel"===key&&(this._toggleClass("ui-button-icon-only",null,!value),this._updateTooltip()),"label"===key&&(this.isInput?this.element.val(value):(this.element.html(value),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(key,value),"disabled"===key&&(this._toggleClass(null,"ui-state-disabled",value),this.element[0].disabled=value,value&&this.element.blur())},refresh:function(){var isDisabled=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");isDisabled!==this.options.disabled&&this._setOptions({disabled:isDisabled}),this._updateTooltip()}}),!1!==$.uiBackCompat&&($.widget("ui.button",$.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(key,value){"text"!==key?("showLabel"===key&&(this.options.text=value),"icon"===key&&(this.options.icons.primary=value),"icons"===key&&(value.primary?(this._super("icon",value.primary),this._super("iconPosition","beginning")):value.secondary&&(this._super("icon",value.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",value)}}),$.fn.button=function(orig){return function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?orig.apply(this,arguments):($.ui.checkboxradio||$.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}}($.fn.button),$.fn.buttonset=function(){return $.ui.controlgroup||$.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))});$.ui.button;$.extend($.ui,{datepicker:{version:"1.12.1"}});var datepicker_instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){return datepicker_extendRemove(this._defaults,settings||{}),this},_attachDatepicker:function(target,settings){var nodeName,inline,inst;inline="div"===(nodeName=target.nodeName.toLowerCase())||"span"===nodeName,target.id||(this.uuid+=1,target.id="dp"+this.uuid),(inst=this._newInst($(target),inline)).settings=$.extend({},settings||{}),"input"===nodeName?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(target,inline){return{id:target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:inline?datepicker_bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]),inst.trigger=$([]),input.hasClass(this.markerClassName)||(this._attachments(input,inst),input.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(inst),$.data(target,"datepicker",inst),inst.settings.disabled&&this._disableDatepicker(target))},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");inst.append&&inst.append.remove(),appendText&&(inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>"),input[isRTL?"before":"after"](inst.append)),input.off("focus",this._showDatepicker),inst.trigger&&inst.trigger.remove(),"focus"!==(showOn=this._get(inst,"showOn"))&&"both"!==showOn||input.on("focus",this._showDatepicker),"button"!==showOn&&"both"!==showOn||(buttonText=this._get(inst,"buttonText"),buttonImage=this._get(inst,"buttonImage"),inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(buttonImage?$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText}):buttonText)),input[isRTL?"before":"after"](inst.trigger),inst.trigger.on("click",function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(input[0])):$.datepicker._showDatepicker(input[0]),!1}))},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,11,20),dateFormat=this._get(inst,"dateFormat");dateFormat.match(/[DM]/)&&(findMax=function(names){for(max=0,maxI=0,i=0;i<names.length;i++)names[i].length>max&&(max=names[i].length,maxI=i);return maxI},date.setMonth(findMax(this._get(inst,dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))),date.setDate(findMax(this._get(inst,dateFormat.match(/DD/)?"dayNames":"dayNamesShort"))+20-date.getDay())),inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);divSpan.hasClass(this.markerClassName)||(divSpan.addClass(this.markerClassName).append(inst.dpDiv),$.data(target,"datepicker",inst),this._setDate(inst,this._getDefaultDate(inst),!0),this._updateDatepicker(inst),this._updateAlternate(inst),inst.settings.disabled&&this._disableDatepicker(target),inst.dpDiv.css("display","block"))},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;return inst||(this.uuid+=1,id="dp"+this.uuid,this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),$("body").append(this._dialogInput),(inst=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},$.data(this._dialogInput[0],"datepicker",inst)),datepicker_extendRemove(inst.settings,settings||{}),date=date&&date.constructor===Date?this._formatDate(inst,date):date,this._dialogInput.val(date),this._pos=pos?pos.length?pos:[pos.pageX,pos.pageY]:null,this._pos||(browserWidth=document.documentElement.clientWidth,browserHeight=document.documentElement.clientHeight,scrollX=document.documentElement.scrollLeft||document.body.scrollLeft,scrollY=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[browserWidth/2-100+scrollX,browserHeight/2-150+scrollY]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),inst.settings.onSelect=onSelect,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],"datepicker",inst),this},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),$.removeData(target,"datepicker"),"input"===nodeName?(inst.append.remove(),inst.trigger.remove(),$target.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==nodeName&&"span"!==nodeName||$target.removeClass(this.markerClassName).empty(),datepicker_instActive===inst&&(datepicker_instActive=null))},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&("input"===(nodeName=target.nodeName.toLowerCase())?(target.disabled=!1,inst.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==nodeName&&"span"!==nodeName||((inline=$target.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}))},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&("input"===(nodeName=target.nodeName.toLowerCase())?(target.disabled=!0,inst.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==nodeName&&"span"!==nodeName||((inline=$target.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}),this._disabledInputs[this._disabledInputs.length]=target)},_isDisabledDatepicker:function(target){if(!target)return!1;for(var i=0;i<this._disabledInputs.length;i++)if(this._disabledInputs[i]===target)return!0;return!1},_getInst:function(target){try{return $.data(target,"datepicker")}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);if(2===arguments.length&&"string"==typeof name)return"defaults"===name?$.extend({},$.datepicker._defaults):inst?"all"===name?$.extend({},inst.settings):this._get(inst,name):null;settings=name||{},"string"==typeof name&&((settings={})[name]=value),inst&&(this._curInst===inst&&this._hideDatepicker(),date=this._getDateDatepicker(target,!0),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),datepicker_extendRemove(inst.settings,settings),null!==minDate&&void 0!==settings.dateFormat&&void 0===settings.minDate&&(inst.settings.minDate=this._formatDate(inst,minDate)),null!==maxDate&&void 0!==settings.dateFormat&&void 0===settings.maxDate&&(inst.settings.maxDate=this._formatDate(inst,maxDate)),"disabled"in settings&&(settings.disabled?this._disableDatepicker(target):this._enableDatepicker(target)),this._attachments($(target),inst),this._autoSize(inst),this._setDate(inst,date),this._updateAlternate(inst),this._updateDatepicker(inst))},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);inst&&this._updateDatepicker(inst)},_setDateDatepicker:function(target,date){var inst=this._getInst(target);inst&&(this._setDate(inst,date),this._updateDatepicker(inst),this._updateAlternate(inst))},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);return inst&&!inst.inline&&this._setDateFromField(inst,noDefault),inst?this._getDate(inst):null},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=!0,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");if(inst._keyEvent=!0,$.datepicker._datepickerShowing)switch(event.keyCode){case 9:$.datepicker._hideDatepicker(),handled=!1;break;case 13:return(sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv))[0]&&$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]),(onSelect=$.datepicker._get(inst,"onSelect"))?(dateStr=$.datepicker._formatDate(inst),onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst])):$.datepicker._hideDatepicker(),!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 35:(event.ctrlKey||event.metaKey)&&$.datepicker._clearDate(event.target),handled=event.ctrlKey||event.metaKey;break;case 36:(event.ctrlKey||event.metaKey)&&$.datepicker._gotoToday(event.target),handled=event.ctrlKey||event.metaKey;break;case 37:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?1:-1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 38:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,-7,"D"),handled=event.ctrlKey||event.metaKey;break;case 39:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?-1:1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 40:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,7,"D"),handled=event.ctrlKey||event.metaKey;break;default:handled=!1}else 36===event.keyCode&&event.ctrlKey?$.datepicker._showDatepicker(this):handled=!1;handled&&(event.preventDefault(),event.stopPropagation())},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput"))return chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat")),chr=String.fromCharCode(null==event.charCode?event.keyCode:event.charCode),event.ctrlKey||event.metaKey||chr<" "||!chars||chars.indexOf(chr)>-1},_doKeyUp:function(event){var inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal)try{$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),inst.input?inst.input.val():null,$.datepicker._getFormatConfig(inst))&&($.datepicker._setDateFromField(inst),$.datepicker._updateAlternate(inst),$.datepicker._updateDatepicker(inst))}catch(err){}return!0},_showDatepicker:function(input){if("input"!==(input=input.target||input).nodeName.toLowerCase()&&(input=$("input",input.parentNode)[0]),!$.datepicker._isDisabledDatepicker(input)&&$.datepicker._lastInput!==input){var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input),$.datepicker._curInst&&$.datepicker._curInst!==inst&&($.datepicker._curInst.dpDiv.stop(!0,!0),inst&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0])),!1!==(beforeShowSettings=(beforeShow=$.datepicker._get(inst,"beforeShow"))?beforeShow.apply(input,[input,inst]):{})&&(datepicker_extendRemove(inst.settings,beforeShowSettings),inst.lastVal=null,$.datepicker._lastInput=input,$.datepicker._setDateFromField(inst),$.datepicker._inDialog&&(input.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(input),$.datepicker._pos[1]+=input.offsetHeight),isFixed=!1,$(input).parents().each(function(){return!(isFixed|="fixed"===$(this).css("position"))}),offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]},$.datepicker._pos=null,inst.dpDiv.empty(),inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(inst),offset=$.datepicker._checkOffset(inst,offset,isFixed),inst.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":isFixed?"fixed":"absolute",display:"none",left:offset.left+"px",top:offset.top+"px"}),inst.inline||(showAnim=$.datepicker._get(inst,"showAnim"),duration=$.datepicker._get(inst,"duration"),inst.dpDiv.css("z-index",datepicker_getZindex($(input))+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects.effect[showAnim]?inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration):inst.dpDiv[showAnim||"show"](showAnim?duration:null),$.datepicker._shouldFocusInput(inst)&&inst.input.trigger("focus"),$.datepicker._curInst=inst))}},_updateDatepicker:function(inst){this.maxRows=4,datepicker_instActive=inst,inst.dpDiv.empty().append(this._generateHTML(inst)),this._attachHandlers(inst);var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1],activeCell=inst.dpDiv.find("."+this._dayOverClass+" a");activeCell.length>0&&datepicker_handleMouseover.apply(activeCell.get(0)),inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),cols>1&&inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",17*cols+"em"),inst.dpDiv[(1!==numMonths[0]||1!==numMonths[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)&&inst.input.trigger("focus"),inst.yearshtml&&(origyearshtml=inst.yearshtml,setTimeout(function(){origyearshtml===inst.yearshtml&&inst.yearshtml&&inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml),origyearshtml=inst.yearshtml=null},0))},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus")},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());return offset.left-=this._get(inst,"isRTL")?dpWidth-inputWidth:0,offset.left-=isFixed&&offset.left===inst.input.offset().left?$(document).scrollLeft():0,offset.top-=isFixed&&offset.top===inst.input.offset().top+inputHeight?$(document).scrollTop():0,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight):0),offset},_findPos:function(obj){for(var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");obj&&("hidden"===obj.type||1!==obj.nodeType||$.expr.filters.hidden(obj));)obj=obj[isRTL?"previousSibling":"nextSibling"];return position=$(obj).offset(),[position.left,position.top]},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;!inst||input&&inst!==$.data(input,"datepicker")||this._datepickerShowing&&(showAnim=this._get(inst,"showAnim"),duration=this._get(inst,"duration"),postProcess=function(){$.datepicker._tidyDialog(inst)},$.effects&&($.effects.effect[showAnim]||$.effects[showAnim])?inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess):inst.dpDiv["slideDown"===showAnim?"slideUp":"fadeIn"===showAnim?"fadeOut":"hide"](showAnim?duration:null,postProcess),showAnim||postProcess(),this._datepickerShowing=!1,(onClose=this._get(inst,"onClose"))&&onClose.apply(inst.input?inst.input[0]:null,[inst.input?inst.input.val():"",inst]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(event){if($.datepicker._curInst){var $target=$(event.target),inst=$.datepicker._getInst($target[0]);($target[0].id===$.datepicker._mainDivId||0!==$target.parents("#"+$.datepicker._mainDivId).length||$target.hasClass($.datepicker.markerClassName)||$target.closest("."+$.datepicker._triggerClass).length||!$.datepicker._datepickerShowing||$.datepicker._inDialog&&$.blockUI)&&(!$target.hasClass($.datepicker.markerClassName)||$.datepicker._curInst===inst)||$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);this._isDisabledDatepicker(target[0])||(this._adjustInstDate(inst,offset+("M"===period?this._get(inst,"showCurrentAtPos"):0),period),this._updateDatepicker(inst))},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);this._get(inst,"gotoCurrent")&&inst.currentDay?(inst.selectedDay=inst.currentDay,inst.drawMonth=inst.selectedMonth=inst.currentMonth,inst.drawYear=inst.selectedYear=inst.currentYear):(date=new Date,inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear()),this._notifyChange(inst),this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+("M"===period?"Month":"Year")]=inst["draw"+("M"===period?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10),this._notifyChange(inst),this._adjustDate(target)},_selectDay:function(id,month,year,td){var inst,target=$(id);$(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])||((inst=this._getInst(target[0])).selectedDay=inst.currentDay=$("a",td).html(),inst.selectedMonth=inst.currentMonth=month,inst.selectedYear=inst.currentYear=year,this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear)))},_clearDate:function(id){var target=$(id);this._selectDate(target,"")},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=null!=dateStr?dateStr:this._formatDate(inst),inst.input&&inst.input.val(dateStr),this._updateAlternate(inst),(onSelect=this._get(inst,"onSelect"))?onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst]):inst.input&&inst.input.trigger("change"),inst.inline?this._updateDatepicker(inst):(this._hideDatepicker(),this._lastInput=inst.input[0],"object"!=typeof inst.input[0]&&inst.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");altField&&(altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat"),date=this._getDate(inst),dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst)),$(altField).val(dateStr))},noWeekends:function(date){var day=date.getDay();return[day>0&&day<6,""]},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());return checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7)),time=checkDate.getTime(),checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1},parseDate:function(format,value,settings){if(null==format||null==value)throw"Invalid arguments";if(""===(value="object"==typeof value?value.toString():value+""))return null;var iFormat,dim,extra,date,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff="string"!=typeof shortYearCutoffTemp?shortYearCutoffTemp:(new Date).getFullYear()%100+parseInt(shortYearCutoffTemp,10),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=!1,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},getNumber=function(match){var isDoubled=lookAhead(match),size="@"===match?14:"!"===match?20:"y"===match&&isDoubled?4:"o"===match?3:2,minSize="y"===match?size:1,digits=new RegExp("^\\d{"+minSize+","+size+"}"),num=value.substring(iValue).match(digits);if(!num)throw"Missing number at position "+iValue;return iValue+=num[0].length,parseInt(num[0],10)},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if($.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase())return index=pair[0],iValue+=name.length,!1}),-1!==index)return index+1;throw"Unknown name at position "+iValue},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat))throw"Unexpected literal at position "+iValue;iValue++};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?checkLiteral():literal=!1;else switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":year=(date=new Date(getNumber("@"))).getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"!":year=(date=new Date((getNumber("!")-this._ticksTo1970)/1e4)).getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"'":lookAhead("'")?checkLiteral():literal=!0;break;default:checkLiteral()}if(iValue<value.length&&(extra=value.substr(iValue),!/^\s+/.test(extra)))throw"Extra/unparsed characters found in date: "+extra;if(-1===year?year=(new Date).getFullYear():year<100&&(year+=(new Date).getFullYear()-(new Date).getFullYear()%100+(year<=shortYearCutoff?0:-100)),doy>-1)for(month=1,day=doy;;){if(dim=this._getDaysInMonth(year,month-1),day<=dim)break;month++,day-=dim}if((date=this._daylightSavingAdjust(new Date(year,month-1,day))).getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day)throw"Invalid date";return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(format,date,settings){if(!date)return"";var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match))for(;num.length<len;)num="0"+num;return num},formatName=function(match,value,shortNames,longNames){return lookAhead(match)?longNames[value]:shortNames[value]},output="",literal=!1;if(date)for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?output+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/864e5),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=lookAhead("y")?date.getFullYear():(date.getFullYear()%100<10?"0":"")+date.getFullYear()%100;break;case"@":output+=date.getTime();break;case"!":output+=1e4*date.getTime()+this._ticksTo1970;break;case"'":lookAhead("'")?output+="'":literal=!0;break;default:output+=format.charAt(iFormat)}return output},_possibleChars:function(format){var iFormat,chars="",literal=!1,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?chars+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":lookAhead("'")?chars+="'":literal=!0;break;default:chars+=format.charAt(iFormat)}return chars},_get:function(inst,name){return void 0!==inst.settings[name]?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()!==inst.lastVal){var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){dates=noDefault?"":dates}inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),inst.currentDay=dates?date.getDate():0,inst.currentMonth=dates?date.getMonth():0,inst.currentYear=dates?date.getFullYear():0,this._adjustInstDate(inst)}},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date))},_determineDate:function(inst,date,defaultDate){var newDate=null==date||""===date?defaultDate:"string"==typeof date?function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}for(var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date,year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);matches;){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=7*parseInt(matches[1],10);break;case"m":case"M":month+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month))}matches=pattern.exec(offset)}return new Date(year,month,day)}(date):"number"==typeof date?isNaN(date)?defaultDate:function(offset){var date=new Date;return date.setDate(date.getDate()+offset),date}(date):new Date(date.getTime());return(newDate=newDate&&"Invalid Date"===newDate.toString()?defaultDate:newDate)&&(newDate.setHours(0),newDate.setMinutes(0),newDate.setSeconds(0),newDate.setMilliseconds(0)),this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){return date?(date.setHours(date.getHours()>12?date.getHours()+2:0),date):null},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date));inst.selectedDay=inst.currentDay=newDate.getDate(),inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth(),inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear(),origMonth===inst.selectedMonth&&origYear===inst.selectedYear||noChange||this._notifyChange(inst),this._adjustInstDate(inst),inst.input&&inst.input.val(clear?"":this._formatDate(inst))},_getDate:function(inst){return!inst.currentYear||inst.input&&""===inst.input.val()?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay))},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M")},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(id)},selectDay:function(){return $.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return $.datepicker._selectMonthYear(id,this,"M"),!1},selectYear:function(){return $.datepicker._selectMonthYear(id,this,"Y"),!1}};$(this).on(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date,today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=1!==numMonths[0]||1!==numMonths[1],currentDate=this._daylightSavingAdjust(inst.currentDay?new Date(inst.currentYear,inst.currentMonth,inst.currentDay):new Date(9999,9,9)),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(drawMonth<0&&(drawMonth+=12,drawYear--),maxDate)for(maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-numMonths[0]*numMonths[1]+1,maxDate.getDate())),maxDraw=minDate&&maxDraw<minDate?minDate:maxDraw;this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw;)--drawMonth<0&&(drawMonth=11,drawYear--);for(inst.drawMonth=drawMonth,inst.drawYear=drawYear,prevText=this._get(inst,"prevText"),prevText=navigationAsDateFormat?this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)):prevText,prev=this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>",nextText=this._get(inst,"nextText"),nextText=navigationAsDateFormat?this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)):nextText,next=this._canAdjustMonth(inst,1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>",currentText=this._get(inst,"currentText"),gotoDate=this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today,currentText=navigationAsDateFormat?this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)):currentText,controls=inst.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(inst,"closeText")+"</button>",buttonPanel=showButtonPanel?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"",firstDay=parseInt(this._get(inst,"firstDay"),10),firstDay=isNaN(firstDay)?0:firstDay,showWeek=this._get(inst,"showWeek"),dayNames=this._get(inst,"dayNames"),dayNamesMin=this._get(inst,"dayNamesMin"),monthNames=this._get(inst,"monthNames"),monthNamesShort=this._get(inst,"monthNamesShort"),beforeShowDay=this._get(inst,"beforeShowDay"),showOtherMonths=this._get(inst,"showOtherMonths"),selectOtherMonths=this._get(inst,"selectOtherMonths"),defaultDate=this._getDefaultDate(inst),html="",row=0;row<numMonths[0];row++){for(group="",this.maxRows=4,col=0;col<numMonths[1];col++){if(selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay)),cornerClass=" ui-corner-all",calender="",isMultiMonth){if(calender+="<div class='ui-datepicker-group",numMonths[1]>1)switch(col){case 0:calender+=" ui-datepicker-group-first",cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last",cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle",cornerClass=""}calender+="'>"}for(calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+(/all|left/.test(cornerClass)&&0===row?isRTL?next:prev:"")+(/all|right/.test(cornerClass)&&0===row?isRTL?prev:next:"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead><tr>",thead=showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"",dow=0;dow<7;dow++)day=(dow+firstDay)%7,thead+="<th scope='col'"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>";for(calender+=thead+"</tr></thead><tbody>",daysInMonth=this._getDaysInMonth(drawYear,drawMonth),drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth&&(inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)),leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7,curRows=Math.ceil((leadDays+daysInMonth)/7),numRows=isMultiMonth&&this.maxRows>curRows?this.maxRows:curRows,this.maxRows=numRows,printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays)),dRow=0;dRow<numRows;dRow++){for(calender+="<tr>",tbody=showWeek?"<td class='ui-datepicker-week-col'>"+this._get(inst,"calculateWeek")(printDate)+"</td>":"",dow=0;dow<7;dow++)daySettings=beforeShowDay?beforeShowDay.apply(inst.input?inst.input[0]:null,[printDate]):[!0,""],unselectable=(otherMonth=printDate.getMonth()!==drawMonth)&&!selectOtherMonths||!daySettings[0]||minDate&&printDate<minDate||maxDate&&printDate>maxDate,tbody+="<td class='"+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+(printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent||defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime()?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+(otherMonth&&!showOtherMonths||!daySettings[2]?"":" title='"+daySettings[2].replace(/'/g,"&#39;")+"'")+(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+(otherMonth&&!showOtherMonths?"&#xa0;":unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>")+"</td>",printDate.setDate(printDate.getDate()+1),printDate=this._daylightSavingAdjust(printDate);calender+=tbody+"</tr>"}++drawMonth>11&&(drawMonth=0,drawYear++),group+=calender+="</tbody></table>"+(isMultiMonth?"</div>"+(numMonths[0]>0&&col===numMonths[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}html+=group}return html+=buttonPanel,inst._keyEvent=!1,html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth)monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>";else{for(inMinYear=minDate&&minDate.getFullYear()===drawYear,inMaxYear=maxDate&&maxDate.getFullYear()===drawYear,monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",month=0;month<12;month++)(!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())&&(monthHtml+="<option value='"+month+"'"+(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>");monthHtml+="</select>"}if(showMonthAfterYear||(html+=monthHtml+(!secondary&&changeMonth&&changeYear?"":"&#xa0;")),!inst.yearshtml)if(inst.yearshtml="",secondary||!changeYear)html+="<span class='ui-datepicker-year'>"+drawYear+"</span>";else{for(years=this._get(inst,"yearRange").split(":"),thisYear=(new Date).getFullYear(),year=(determineYear=function(value){var year=value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10);return isNaN(year)?thisYear:year})(years[0]),endYear=Math.max(year,determineYear(years[1]||"")),year=minDate?Math.max(year,minDate.getFullYear()):year,endYear=maxDate?Math.min(endYear,maxDate.getFullYear()):endYear,inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";year<=endYear;year++)inst.yearshtml+="<option value='"+year+"'"+(year===drawYear?" selected='selected'":"")+">"+year+"</option>";inst.yearshtml+="</select>",html+=inst.yearshtml,inst.yearshtml=null}return html+=this._get(inst,"yearSuffix"),showMonthAfterYear&&(html+=(!secondary&&changeMonth&&changeYear?"":"&#xa0;")+monthHtml),html+="</div>"},_adjustInstDate:function(inst,offset,period){var year=inst.selectedYear+("Y"===period?offset:0),month=inst.selectedMonth+("M"===period?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+("D"===period?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),"M"!==period&&"Y"!==period||this._notifyChange(inst)},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=minDate&&date<minDate?minDate:date;return maxDate&&newDate>maxDate?maxDate:newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");onChange&&onChange.apply(inst.input?inst.input[0]:null,[inst.selectedYear,inst.selectedMonth+1,inst])},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return null==numMonths?[1,1]:"number"==typeof numMonths?[1,numMonths]:numMonths},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));return offset<0&&date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth())),this._isInRange(inst,date)},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");return years&&(yearSplit=years.split(":"),currentYear=(new Date).getFullYear(),minYear=parseInt(yearSplit[0],10),maxYear=parseInt(yearSplit[1],10),yearSplit[0].match(/[+\-].*/)&&(minYear+=currentYear),yearSplit[1].match(/[+\-].*/)&&(maxYear+=currentYear)),(!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear)},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");return shortYearCutoff="string"!=typeof shortYearCutoff?shortYearCutoff:(new Date).getFullYear()%100+parseInt(shortYearCutoff,10),{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){day||(inst.currentDay=inst.selectedDay,inst.currentMonth=inst.selectedMonth,inst.currentYear=inst.selectedYear);var date=day?"object"==typeof day?day:this._daylightSavingAdjust(new Date(year,month,day)):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}}),$.fn.datepicker=function(options){if(!this.length)return this;$.datepicker.initialized||($(document).on("mousedown",$.datepicker._checkExternalClick),$.datepicker.initialized=!0),0===$("#"+$.datepicker._mainDivId).length&&$("body").append($.datepicker.dpDiv);var otherArgs=Array.prototype.slice.call(arguments,1);return"string"!=typeof options||"isDisabled"!==options&&"getDate"!==options&&"widget"!==options?"option"===options&&2===arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs)):this.each(function(){"string"==typeof options?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)}):$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.12.1";$.datepicker,$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var mouseHandled=!1;$(document).on("mouseup",function(){mouseHandled=!1});$.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.on("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).on("click."+this.widgetName,function(event){if(!0===$.data(event.target,that.widgetName+".preventClickEvent"))return $.removeData(event.target,that.widgetName+".preventClickEvent"),event.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(event){if(!mouseHandled){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(event),this._mouseDownEvent=event;var that=this,btnIsLeft=1===event.which,elIsCancel=!("string"!=typeof this.options.cancel||!event.target.nodeName)&&$(event.target).closest(this.options.cancel).length;return!(btnIsLeft&&!elIsCancel&&this._mouseCapture(event))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=!1!==this._mouseStart(event),!this._mouseStarted)?(event.preventDefault(),!0):(!0===$.data(event.target,this.widgetName+".preventClickEvent")&&$.removeData(event.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(event){return that._mouseMove(event)},this._mouseUpDelegate=function(event){return that._mouseUp(event)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),event.preventDefault(),mouseHandled=!0,!0))}},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button)return this._mouseUp(event);if(!event.which)if(event.originalEvent.altKey||event.originalEvent.ctrlKey||event.originalEvent.metaKey||event.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(event)}return(event.which||event.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(event),event.preventDefault()):(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,event),this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)),!this._mouseStarted)},_mouseUp:function(event){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,event.target===this._mouseDownEvent.target&&$.data(event.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(event)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,mouseHandled=!1,event.preventDefault()},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set)proto.plugins[i]=proto.plugins[i]||[],proto.plugins[i].push([option,set[i]])},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(set&&(allowDisconnected||instance.element[0].parentNode&&11!==instance.element[0].parentNode.nodeType))for(i=0;i<set.length;i++)instance.options[set[i][0]]&&set[i][1].apply(instance.element,args)}},$.ui.safeBlur=function(element){element&&"body"!==element.nodeName.toLowerCase()&&$(element).trigger("blur")};$.widget("ui.draggable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(key,value){this._super(key,value),"handle"===key&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(event){var o=this.options;return!(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(event),!!this.handle&&(this._blurActiveElement(event),this._blockFrames(!0===o.iframeFix?"iframe":o.iframeFix),!0))},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(event){var activeElement=$.ui.safeActiveElement(this.document[0]);$(event.target).closest(activeElement).length||$.ui.safeBlur(activeElement)},_mouseStart:function(event){var o=this.options;return this.helper=this._createHelper(event),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===$(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(event),this.originalPosition=this.position=this._generatePosition(event,!1),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this._setContainment(),!1===this._trigger("start",event)?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this._mouseDrag(event,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,event),!0)},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top}},_mouseDrag:function(event,noPropagation){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(event,!0),this.positionAbs=this._convertPositionTo("absolute"),!noPropagation){var ui=this._uiHash();if(!1===this._trigger("drag",event,ui))return this._mouseUp(new $.Event("mouseup",event)),!1;this.position=ui.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),!1},_mouseStop:function(event){var that=this,dropped=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(dropped=$.ui.ddmanager.drop(this,event)),this.dropped&&(dropped=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!dropped||"valid"===this.options.revert&&dropped||!0===this.options.revert||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==that._trigger("stop",event)&&that._clear()}):!1!==this._trigger("stop",event)&&this._clear(),!1},_mouseUp:function(event){return this._unblockFrames(),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,event),this.handleElement.is(event.target)&&this.element.trigger("focus"),$.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new $.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(event){return!this.options.handle||!!$(event.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(event){var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;return helper.parents("body").length||helper.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo),helperIsFunction&&helper[0]===this.element[0]&&this._setPositionRelative(),helper[0]===this.element[0]||/(fixed|absolute)/.test(helper.css("position"))||helper.css("position","absolute"),helper},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_isRootNode:function(element){return/(html|body)/i.test(element.tagName)||element===this.document[0]},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollTop()),left:p.left-(parseInt(this.helper.css("left"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];this.relativeContainer=null,o.containment?"window"!==o.containment?"document"!==o.containment?o.containment.constructor!==Array?("parent"===o.containment&&(o.containment=this.helper[0].parentNode),(ce=(c=$(o.containment))[0])&&(isUserScrollable=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c)):this.containment=o.containment:this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top)*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)*mod}},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;return scrollIsRootNode&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),constrainPosition&&(this.containment&&(this.relativeContainer?(co=this.relativeContainer.offset(),containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]):containment=this.containment,event.pageX-this.offset.click.left<containment[0]&&(pageX=containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<containment[1]&&(pageY=containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>containment[2]&&(pageX=containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>containment[3]&&(pageY=containment[3]+this.offset.click.top)),o.grid&&(top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,pageY=containment?top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3]?top:top-this.offset.click.top>=containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,pageX=containment?left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2]?left:left-this.offset.click.left>=containment[0]?left-o.grid[0]:left+o.grid[0]:left),"y"===o.axis&&(pageX=this.originalPageX),"x"===o.axis&&(pageY=this.originalPageY)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(type,event,ui){return ui=ui||this._uiHash(),$.ui.plugin.call(this,type,[event,ui,this],!0),/^(drag|start|stop)/.test(type)&&(this.positionAbs=this._convertPositionTo("absolute"),ui.offset=this.positionAbs),$.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[],$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");sortable&&!sortable.options.disabled&&(draggable.sortables.push(sortable),sortable.refreshPositions(),sortable._trigger("activate",event,uiSortable))})},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=!1,$.each(draggable.sortables,function(){var sortable=this;sortable.isOver?(sortable.isOver=0,draggable.cancelHelperRemoval=!0,sortable.cancelHelperRemoval=!1,sortable._storedCSS={position:sortable.placeholder.css("position"),top:sortable.placeholder.css("top"),left:sortable.placeholder.css("left")},sortable._mouseStop(event),sortable.options.helper=sortable.options._helper):(sortable.cancelHelperRemoval=!0,sortable._trigger("deactivate",event,uiSortable))})},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=!1,sortable=this;sortable.positionAbs=draggable.positionAbs,sortable.helperProportions=draggable.helperProportions,sortable.offset.click=draggable.offset.click,sortable._intersectsWith(sortable.containerCache)&&(innermostIntersecting=!0,$.each(draggable.sortables,function(){return this.positionAbs=draggable.positionAbs,this.helperProportions=draggable.helperProportions,this.offset.click=draggable.offset.click,this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])&&(innermostIntersecting=!1),innermostIntersecting})),innermostIntersecting?(sortable.isOver||(sortable.isOver=1,draggable._parent=ui.helper.parent(),sortable.currentItem=ui.helper.appendTo(sortable.element).data("ui-sortable-item",!0),sortable.options._helper=sortable.options.helper,sortable.options.helper=function(){return ui.helper[0]},event.target=sortable.currentItem[0],sortable._mouseCapture(event,!0),sortable._mouseStart(event,!0,!0),sortable.offset.click.top=draggable.offset.click.top,sortable.offset.click.left=draggable.offset.click.left,sortable.offset.parent.left-=draggable.offset.parent.left-sortable.offset.parent.left,sortable.offset.parent.top-=draggable.offset.parent.top-sortable.offset.parent.top,draggable._trigger("toSortable",event),draggable.dropped=sortable.element,$.each(draggable.sortables,function(){this.refreshPositions()}),draggable.currentItem=draggable.element,sortable.fromOutside=draggable),sortable.currentItem&&(sortable._mouseDrag(event),ui.position=sortable.position)):sortable.isOver&&(sortable.isOver=0,sortable.cancelHelperRemoval=!0,sortable.options._revert=sortable.options.revert,sortable.options.revert=!1,sortable._trigger("out",event,sortable._uiHash(sortable)),sortable._mouseStop(event,!0),sortable.options.revert=sortable.options._revert,sortable.options.helper=sortable.options._helper,sortable.placeholder&&sortable.placeholder.remove(),ui.helper.appendTo(draggable._parent),draggable._refreshOffsets(event),ui.position=draggable._generatePosition(event,!0),draggable._trigger("fromSortable",event),draggable.dropped=!1,$.each(draggable.sortables,function(){this.refreshPositions()}))})}}),$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;t.css("cursor")&&(o._cursor=t.css("cursor")),t.css("cursor",o.cursor)},stop:function(event,ui,instance){var o=instance.options;o._cursor&&$("body").css("cursor",o._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("opacity")&&(o._opacity=t.css("opacity")),t.css("opacity",o.opacity)},stop:function(event,ui,instance){var o=instance.options;o._opacity&&$(ui.helper).css("opacity",o._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(event,ui,i){var o=i.options,scrolled=!1,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];scrollParent!==document&&"HTML"!==scrollParent.tagName?(o.axis&&"x"===o.axis||(i.overflowOffset.top+scrollParent.offsetHeight-event.pageY<o.scrollSensitivity?scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed:event.pageY-i.overflowOffset.top<o.scrollSensitivity&&(scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(i.overflowOffset.left+scrollParent.offsetWidth-event.pageX<o.scrollSensitivity?scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed:event.pageX-i.overflowOffset.left<o.scrollSensitivity&&(scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)))),!1!==scrolled&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(i,event)}}),$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[],$(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var $t=$(this),$o=$t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})})},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--)r=(l=inst.snapElements[i].left-inst.margins.left)+inst.snapElements[i].width,b=(t=inst.snapElements[i].top-inst.margins.top)+inst.snapElements[i].height,x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)?(inst.snapElements[i].snapping&&inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=!1):("inner"!==o.snapMode&&(ts=Math.abs(t-y2)<=d,bs=Math.abs(b-y1)<=d,ls=Math.abs(l-x2)<=d,rs=Math.abs(r-x1)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left)),first=ts||bs||ls||rs,"outer"!==o.snapMode&&(ts=Math.abs(t-y1)<=d,bs=Math.abs(b-y2)<=d,ls=Math.abs(l-x1)<=d,rs=Math.abs(r-x2)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left)),!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)&&inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=ts||bs||ls||rs||first)}}),$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});group.length&&(min=parseInt($(group[0]).css("zIndex"),10)||0,$(group).each(function(i){$(this).css("zIndex",min+i)}),this.css("zIndex",min+group.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("zIndex")&&(o._zIndex=t.css("zIndex")),t.css("zIndex",o.zIndex)},stop:function(event,ui,instance){var o=instance.options;o._zIndex&&$(ui.helper).css("zIndex",o._zIndex)}});$.ui.draggable;$.widget("ui.resizable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(value){return parseFloat(value)||0},_isNumber:function(value){return!isNaN(parseFloat(value))},_hasScroll:function(el,a){if("hidden"===$(el).css("overflow"))return!1;var scroll=a&&"left"===a?"scrollLeft":"scrollTop",has=!1;return el[scroll]>0||(el[scroll]=1,has=el[scroll]>0,el[scroll]=0,has)},_create:function(){var margins,o=this.options,that=this;this._addClass("ui-resizable"),$.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,margins={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(margins),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(margins),this._proportionallyResize()),this._setupHandles(),o.autoHide&&$(this.element).on("mouseenter",function(){o.disabled||(that._removeClass("ui-resizable-autohide"),that._handles.show())}).on("mouseleave",function(){o.disabled||that.resizing||(that._addClass("ui-resizable-autohide"),that._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(_destroy(this.element),wrapper=this.element,this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper),wrapper.remove()),this.originalElement.css("resize",this.originalResizeStyle),_destroy(this.originalElement),this},_setOption:function(key,value){switch(this._super(key,value),key){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var handle,i,n,hname,axis,o=this.options,that=this;if(this.handles=o.handles||($(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=$(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),n=this.handles.split(","),this.handles={},i=0;i<n.length;i++)hname="ui-resizable-"+(handle=$.trim(n[i])),axis=$("<div>"),this._addClass(axis,"ui-resizable-handle "+hname),axis.css({zIndex:o.zIndex}),this.handles[handle]=".ui-resizable-"+handle,this.element.append(axis);this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=$(this.handles[i]),this._on(this.handles[i],{mousedown:that._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(axis=$(this.handles[i],this.element),padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth(),padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),target.css(padPos,padWrapper),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){that.resizing||(this.className&&(axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),that.axis=axis&&axis[1]?axis[1]:"se")}),o.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(event){var i,handle,capture=!1;for(i in this.handles)((handle=$(this.handles[i])[0])===event.target||$.contains(handle,event.target))&&(capture=!0);return!this.options.disabled&&capture},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,el=this.element;return this.resizing=!0,this._renderProxy(),curleft=this._num(this.helper.css("left")),curtop=this._num(this.helper.css("top")),o.containment&&(curleft+=$(o.containment).scrollLeft()||0,curtop+=$(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:curleft,top:curtop},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()},this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()},this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()},this.originalPosition={left:curleft,top:curtop},this.originalMousePosition={left:event.pageX,top:event.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,cursor=$(".ui-resizable-"+this.axis).css("cursor"),$("body").css("cursor","auto"===cursor?this.axis+"-resize":cursor),this._addClass("ui-resizable-resizing"),this._propagate("start",event),!0},_mouseDrag:function(event){var data,props,smp=this.originalMousePosition,a=this.axis,dx=event.pageX-smp.left||0,dy=event.pageY-smp.top||0,trigger=this._change[a];return this._updatePrevProperties(),!!trigger&&(data=trigger.apply(this,[event,dx,dy]),this._updateVirtualBoundaries(event.shiftKey),(this._aspectRatio||event.shiftKey)&&(data=this._updateRatio(data,event)),data=this._respectSize(data,event),this._updateCache(data),this._propagate("resize",event),props=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),$.isEmptyObject(props)||(this._updatePrevProperties(),this._trigger("resize",event,this.ui()),this._applyChanges()),!1)},_mouseStop:function(event){this.resizing=!1;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;return this._helper&&(soffseth=(ista=(pr=this._proportionallyResizeElements).length&&/textarea/i.test(pr[0].nodeName))&&this._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,s={width:that.helper.width()-soffsetw,height:that.helper.height()-soffseth},left=parseFloat(that.element.css("left"))+(that.position.left-that.originalPosition.left)||null,top=parseFloat(that.element.css("top"))+(that.position.top-that.originalPosition.top)||null,o.animate||this.element.css($.extend(s,{top:top,left:left})),that.helper.height(that.size.height),that.helper.width(that.size.width),this._helper&&!o.animate&&this._proportionallyResize()),$("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",event),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var props={};return this.position.top!==this.prevPosition.top&&(props.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(props.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(props.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(props.height=this.size.height+"px"),this.helper.css(props),props},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||forceAspectRatio)&&(pMinWidth=b.minHeight*this.aspectRatio,pMinHeight=b.minWidth/this.aspectRatio,pMaxWidth=b.maxHeight*this.aspectRatio,pMaxHeight=b.maxWidth/this.aspectRatio,pMinWidth>b.minWidth&&(b.minWidth=pMinWidth),pMinHeight>b.minHeight&&(b.minHeight=pMinHeight),pMaxWidth<b.maxWidth&&(b.maxWidth=pMaxWidth),pMaxHeight<b.maxHeight&&(b.maxHeight=pMaxHeight)),this._vBoundaries=b},_updateCache:function(data){this.offset=this.helper.offset(),this._isNumber(data.left)&&(this.position.left=data.left),this._isNumber(data.top)&&(this.position.top=data.top),this._isNumber(data.height)&&(this.size.height=data.height),this._isNumber(data.width)&&(this.size.width=data.width)},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;return this._isNumber(data.height)?data.width=data.height*this.aspectRatio:this._isNumber(data.width)&&(data.height=data.width/this.aspectRatio),"sw"===a&&(data.left=cpos.left+(csize.width-data.width),data.top=null),"nw"===a&&(data.top=cpos.top+(csize.height-data.height),data.left=cpos.left+(csize.width-data.width)),data},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=this._isNumber(data.width)&&o.maxWidth&&o.maxWidth<data.width,ismaxh=this._isNumber(data.height)&&o.maxHeight&&o.maxHeight<data.height,isminw=this._isNumber(data.width)&&o.minWidth&&o.minWidth>data.width,isminh=this._isNumber(data.height)&&o.minHeight&&o.minHeight>data.height,dw=this.originalPosition.left+this.originalSize.width,dh=this.originalPosition.top+this.originalSize.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);return isminw&&(data.width=o.minWidth),isminh&&(data.height=o.minHeight),ismaxw&&(data.width=o.maxWidth),ismaxh&&(data.height=o.maxHeight),isminw&&cw&&(data.left=dw-o.minWidth),ismaxw&&cw&&(data.left=dw-o.maxWidth),isminh&&ch&&(data.top=dh-o.minHeight),ismaxh&&ch&&(data.top=dh-o.maxHeight),data.width||data.height||data.left||!data.top?data.width||data.height||data.top||!data.left||(data.left=null):data.top=null,data},_getPaddingPlusBorderDimensions:function(element){for(var i=0,widths=[],borders=[element.css("borderTopWidth"),element.css("borderRightWidth"),element.css("borderBottomWidth"),element.css("borderLeftWidth")],paddings=[element.css("paddingTop"),element.css("paddingRight"),element.css("paddingBottom"),element.css("paddingLeft")];i<4;i++)widths[i]=parseFloat(borders[i])||0,widths[i]+=parseFloat(paddings[i])||0;return{height:widths[0]+widths[2],width:widths[1]+widths[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var prel,i=0,element=this.helper||this.element;i<this._proportionallyResizeElements.length;i++)prel=this._proportionallyResizeElements[i],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(prel)),prel.css({height:element.height()-this.outerDimensions.height||0,width:element.width()-this.outerDimensions.width||0})},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset(),this._helper?(this.helper=this.helper||$("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(event,dx){return{width:this.originalSize.width+dx}},w:function(event,dx){var cs=this.originalSize;return{left:this.originalPosition.left+dx,width:cs.width-dx}},n:function(event,dx,dy){var cs=this.originalSize;return{top:this.originalPosition.top+dy,height:cs.height-dy}},s:function(event,dx,dy){return{height:this.originalSize.height+dy}},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]),"resize"!==n&&this._trigger(n,event,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).resizable("instance"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&that._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:that.size.width-soffsetw,height:that.size.height-soffseth},left=parseFloat(that.element.css("left"))+(that.position.left-that.originalPosition.left)||null,top=parseFloat(that.element.css("top"))+(that.position.top-that.originalPosition.top)||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseFloat(that.element.css("width")),height:parseFloat(that.element.css("height")),top:parseFloat(that.element.css("top")),left:parseFloat(that.element.css("left"))};pr&&pr.length&&$(pr[0]).css({width:data.width,height:data.height}),that._updateCache(data),that._propagate("resize",event)}})}}),$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).resizable("instance"),o=that.options,el=that.element,oc=o.containment,ce=oc instanceof $?oc.get(0):/parent/.test(oc)?el.parent().get(0):oc;ce&&(that.containerElement=$(ce),/document/.test(oc)||oc===document?(that.containerOffset={left:0,top:0},that.containerPosition={left:0,top:0},that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}):(element=$(ce),p=[],$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=that._num(element.css("padding"+name))}),that.containerOffset=element.offset(),that.containerPosition=element.position(),that.containerSize={height:element.innerHeight()-p[3],width:element.innerWidth()-p[1]},co=that.containerOffset,ch=that.containerSize.height,cw=that.containerSize.width,width=that._hasScroll(ce,"left")?ce.scrollWidth:cw,height=that._hasScroll(ce)?ce.scrollHeight:ch,that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height}))},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement,continueResize=!0;ce[0]!==document&&/static/.test(ce.css("position"))&&(cop=co),cp.left<(that._helper?co.left:0)&&(that.size.width=that.size.width+(that._helper?that.position.left-co.left:that.position.left-cop.left),pRatio&&(that.size.height=that.size.width/that.aspectRatio,continueResize=!1),that.position.left=o.helper?co.left:0),cp.top<(that._helper?co.top:0)&&(that.size.height=that.size.height+(that._helper?that.position.top-co.top:that.position.top),pRatio&&(that.size.width=that.size.height*that.aspectRatio,continueResize=!1),that.position.top=that._helper?co.top:0),isParent=that.containerElement.get(0)===that.element.parent().get(0),isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position")),isParent&&isOffsetRelative?(that.offset.left=that.parentData.left+that.position.left,that.offset.top=that.parentData.top+that.position.top):(that.offset.left=that.element.offset().left,that.offset.top=that.element.offset().top),woset=Math.abs(that.sizeDiff.width+(that._helper?that.offset.left-cop.left:that.offset.left-co.left)),hoset=Math.abs(that.sizeDiff.height+(that._helper?that.offset.top-cop.top:that.offset.top-co.top)),woset+that.size.width>=that.parentData.width&&(that.size.width=that.parentData.width-woset,pRatio&&(that.size.height=that.size.width/that.aspectRatio,continueResize=!1)),hoset+that.size.height>=that.parentData.height&&(that.size.height=that.parentData.height-hoset,pRatio&&(that.size.width=that.size.height*that.aspectRatio,continueResize=!1)),continueResize||(that.position.left=that.prevPosition.left,that.position.top=that.prevPosition.top,that.size.width=that.prevSize.width,that.size.height=that.prevSize.height)},stop:function(){var that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;that._helper&&!o.animate&&/relative/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h}),that._helper&&!o.animate&&/static/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}}),$.ui.plugin.add("resizable","alsoResize",{start:function(){var o=$(this).resizable("instance").options;$(o.alsoResize).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseFloat(el.width()),height:parseFloat(el.height()),left:parseFloat(el.css("left")),top:parseFloat(el.css("top"))})})},resize:function(event,ui){var that=$(this).resizable("instance"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:that.size.height-os.height||0,width:that.size.width-os.width||0,top:that.position.top-op.top||0,left:that.position.left-op.left||0};$(o.alsoResize).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);sum&&sum>=0&&(style[prop]=sum||null)}),el.css(style)})},stop:function(){$(this).removeData("ui-resizable-alsoresize")}}),$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).resizable("instance"),cs=that.size;that.ghost=that.originalElement.clone(),that.ghost.css({opacity:.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}),that._addClass(that.ghost,"ui-resizable-ghost"),!1!==$.uiBackCompat&&"string"==typeof that.options.ghost&&that.ghost.addClass(this.options.ghost),that.ghost.appendTo(that.helper)},resize:function(){var that=$(this).resizable("instance");that.ghost&&that.ghost.css({position:"relative",height:that.size.height,width:that.size.width})},stop:function(){var that=$(this).resizable("instance");that.ghost&&that.helper&&that.helper.get(0).removeChild(that.ghost.get(0))}}),$.ui.plugin.add("resizable","grid",{resize:function(){var outerDimensions,that=$(this).resizable("instance"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid="number"==typeof o.grid?[o.grid,o.grid]:o.grid,gridX=grid[0]||1,gridY=grid[1]||1,ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&o.maxWidth<newWidth,isMaxHeight=o.maxHeight&&o.maxHeight<newHeight,isMinWidth=o.minWidth&&o.minWidth>newWidth,isMinHeight=o.minHeight&&o.minHeight>newHeight;o.grid=grid,isMinWidth&&(newWidth+=gridX),isMinHeight&&(newHeight+=gridY),isMaxWidth&&(newWidth-=gridX),isMaxHeight&&(newHeight-=gridY),/^(se|s|e)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight):/^(ne)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.top=op.top-oy):/^(sw)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.left=op.left-ox):((newHeight-gridY<=0||newWidth-gridX<=0)&&(outerDimensions=that._getPaddingPlusBorderDimensions(this)),newHeight-gridY>0?(that.size.height=newHeight,that.position.top=op.top-oy):(newHeight=gridY-outerDimensions.height,that.size.height=newHeight,that.position.top=op.top+os.height-newHeight),newWidth-gridX>0?(that.size.width=newWidth,that.position.left=op.left-ox):(newWidth=gridX-outerDimensions.width,that.size.width=newWidth,that.position.left=op.left+os.width-newWidth))}});$.ui.resizable;$.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;topOffset<0&&$(this).css("top",pos.top-topOffset)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&$.fn.draggable&&this._makeDraggable(),this.options.resizable&&$.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var element=this.options.appendTo;return element&&(element.jquery||element.nodeType)?$(element):this.document.find(element||"body").eq(0)},_destroy:function(){var next,originalPosition=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(next=originalPosition.parent.children().eq(originalPosition.index)).length&&next[0]!==this.element[0]?next.before(this.element):originalPosition.parent.append(this.element)},widget:function(){return this.uiDialog},disable:$.noop,enable:$.noop,close:function(event){var that=this;this._isOpen&&!1!==this._trigger("beforeClose",event)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||$.ui.safeBlur($.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){that._trigger("close",event)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(event,silent){var moved=!1,zIndices=this.uiDialog.siblings(".ui-front:visible").map(function(){return+$(this).css("z-index")}).get(),zIndexMax=Math.max.apply(null,zIndices);return zIndexMax>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",zIndexMax+1),moved=!0),moved&&!silent&&this._trigger("focus",event),moved},open:function(){var that=this;this._isOpen?this._moveToTop()&&this._focusTabbable():(this._isOpen=!0,this.opener=$($.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){that._focusTabbable(),that._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"))},_focusTabbable:function(){var hasFocus=this._focusedElement;hasFocus||(hasFocus=this.element.find("[autofocus]")),hasFocus.length||(hasFocus=this.element.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogButtonPane.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogTitlebarClose.filter(":tabbable")),hasFocus.length||(hasFocus=this.uiDialog),hasFocus.eq(0).trigger("focus")},_keepFocus:function(event){function checkFocus(){var activeElement=$.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===activeElement||$.contains(this.uiDialog[0],activeElement)||this._focusTabbable()}event.preventDefault(),checkFocus.call(this),this._delay(checkFocus)},_createWrapper:function(){this.uiDialog=$("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(event){if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE)return event.preventDefault(),void this.close(event);if(event.keyCode===$.ui.keyCode.TAB&&!event.isDefaultPrevented()){var tabbables=this.uiDialog.find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");event.target!==last[0]&&event.target!==this.uiDialog[0]||event.shiftKey?event.target!==first[0]&&event.target!==this.uiDialog[0]||!event.shiftKey||(this._delay(function(){last.trigger("focus")}),event.preventDefault()):(this._delay(function(){first.trigger("focus")}),event.preventDefault())}},mousedown:function(event){this._moveToTop(event)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var uiDialogTitle;this.uiDialogTitlebar=$("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(event){$(event.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:$("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(event){event.preventDefault(),this.close(event)}}),uiDialogTitle=$("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(uiDialogTitle,"ui-dialog-title"),this._title(uiDialogTitle),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":uiDialogTitle.attr("id")})},_title:function(title){this.options.title?title.text(this.options.title):title.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=$("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var that=this,buttons=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),$.isEmptyObject(buttons)||$.isArray(buttons)&&!buttons.length?this._removeClass(this.uiDialog,"ui-dialog-buttons"):($.each(buttons,function(name,props){var click,buttonOptions;props=$.isFunction(props)?{click:props,text:name}:props,props=$.extend({type:"button"},props),click=props.click,buttonOptions={icon:props.icon,iconPosition:props.iconPosition,showLabel:props.showLabel,icons:props.icons,text:props.text},delete props.click,delete props.icon,delete props.iconPosition,delete props.showLabel,delete props.icons,"boolean"==typeof props.text&&delete props.text,$("<button></button>",props).button(buttonOptions).appendTo(that.uiButtonSet).on("click",function(){click.apply(that.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function filteredUi(ui){return{position:ui.position,offset:ui.offset}}var that=this,options=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){that._addClass($(this),"ui-dialog-dragging"),that._blockFrames(),that._trigger("dragStart",event,filteredUi(ui))},drag:function(event,ui){that._trigger("drag",event,filteredUi(ui))},stop:function(event,ui){var left=ui.offset.left-that.document.scrollLeft(),top=ui.offset.top-that.document.scrollTop();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" top"+(top>=0?"+":"")+top,of:that.window},that._removeClass($(this),"ui-dialog-dragging"),that._unblockFrames(),that._trigger("dragStop",event,filteredUi(ui))}})},_makeResizable:function(){function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size}}var that=this,options=this.options,handles=options.resizable,position=this.uiDialog.css("position"),resizeHandles="string"==typeof handles?handles:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:this._minHeight(),handles:resizeHandles,start:function(event,ui){that._addClass($(this),"ui-dialog-resizing"),that._blockFrames(),that._trigger("resizeStart",event,filteredUi(ui))},resize:function(event,ui){that._trigger("resize",event,filteredUi(ui))},stop:function(event,ui){var offset=that.uiDialog.offset(),left=offset.left-that.document.scrollLeft(),top=offset.top-that.document.scrollTop();options.height=that.uiDialog.height(),options.width=that.uiDialog.width(),options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" top"+(top>=0?"+":"")+top,of:that.window},that._removeClass($(this),"ui-dialog-resizing"),that._unblockFrames(),that._trigger("resizeStop",event,filteredUi(ui))}}).css("position",position)},_trackFocus:function(){this._on(this.widget(),{focusin:function(event){this._makeFocusTarget(),this._focusedElement=$(event.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var instances=this._trackingInstances(),exists=$.inArray(this,instances);-1!==exists&&instances.splice(exists,1)},_trackingInstances:function(){var instances=this.document.data("ui-dialog-instances");return instances||(instances=[],this.document.data("ui-dialog-instances",instances)),instances},_minHeight:function(){var options=this.options;return"auto"===options.height?options.minHeight:Math.min(options.minHeight,options.height)},_position:function(){var isVisible=this.uiDialog.is(":visible");isVisible||this.uiDialog.show(),this.uiDialog.position(this.options.position),isVisible||this.uiDialog.hide()},_setOptions:function(options){var that=this,resize=!1,resizableOptions={};$.each(options,function(key,value){that._setOption(key,value),key in that.sizeRelatedOptions&&(resize=!0),key in that.resizableRelatedOptions&&(resizableOptions[key]=value)}),resize&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",resizableOptions)},_setOption:function(key,value){var isDraggable,isResizable,uiDialog=this.uiDialog;"disabled"!==key&&(this._super(key,value),"appendTo"===key&&this.uiDialog.appendTo(this._appendTo()),"buttons"===key&&this._createButtons(),"closeText"===key&&this.uiDialogTitlebarClose.button({label:$("<a>").text(""+this.options.closeText).html()}),"draggable"===key&&((isDraggable=uiDialog.is(":data(ui-draggable)"))&&!value&&uiDialog.draggable("destroy"),!isDraggable&&value&&this._makeDraggable()),"position"===key&&this._position(),"resizable"===key&&((isResizable=uiDialog.is(":data(ui-resizable)"))&&!value&&uiDialog.resizable("destroy"),isResizable&&"string"==typeof value&&uiDialog.resizable("option","handles",value),isResizable||!1===value||this._makeResizable()),"title"===key&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var nonContentHeight,minContentHeight,maxContentHeight,options=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),options.minWidth>options.width&&(options.width=options.minWidth),nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).outerHeight(),minContentHeight=Math.max(0,options.minHeight-nonContentHeight),maxContentHeight="number"==typeof options.maxHeight?Math.max(0,options.maxHeight-nonContentHeight):"none","auto"===options.height?this.element.css({minHeight:minContentHeight,maxHeight:maxContentHeight,height:"auto"}):this.element.height(Math.max(0,options.height-nonContentHeight)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var iframe=$(this);return $("<div>").css({position:"absolute",width:iframe.outerWidth(),height:iframe.outerHeight()}).appendTo(iframe.parent()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(event){return!!$(event.target).closest(".ui-dialog").length||!!$(event.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var isOpening=!0;this._delay(function(){isOpening=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(event){isOpening||this._allowInteraction(event)||(event.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=$("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var overlays=this.document.data("ui-dialog-overlays")-1;overlays?this.document.data("ui-dialog-overlays",overlays):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),!1!==$.uiBackCompat&&$.widget("ui.dialog",$.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(key,value){"dialogClass"===key&&this.uiDialog.removeClass(this.options.dialogClass).addClass(value),this._superApply(arguments)}});$.ui.dialog;$.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept)},this.proportions=function(){if(!arguments.length)return proportions||(proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});proportions=arguments[0]},this._addToManager(o.scope),o.addClasses&&this._addClass("ui-droppable")},_addToManager:function(scope){$.ui.ddmanager.droppables[scope]=$.ui.ddmanager.droppables[scope]||[],$.ui.ddmanager.droppables[scope].push(this)},_splice:function(drop){for(var i=0;i<drop.length;i++)drop[i]===this&&drop.splice(i,1)},_destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop)},_setOption:function(key,value){if("accept"===key)this.accept=$.isFunction(value)?value:function(d){return d.is(value)};else if("scope"===key){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop),this._addToManager(value)}this._super(key,value)},_activate:function(event){var draggable=$.ui.ddmanager.current;this._addActiveClass(),draggable&&this._trigger("activate",event,this.ui(draggable))},_deactivate:function(event){var draggable=$.ui.ddmanager.current;this._removeActiveClass(),draggable&&this._trigger("deactivate",event,this.ui(draggable))},_over:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this._addHoverClass(),this._trigger("over",event,this.ui(draggable)))},_out:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this._removeHoverClass(),this._trigger("out",event,this.ui(draggable)))},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=!1;return!(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$(this).droppable("instance");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],draggable.currentItem||draggable.element)&&intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance,event))return childrenIntersection=!0,!1}),!childrenIntersection&&(!!this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",event,this.ui(draggable)),this.element)))},ui:function(c){return{draggable:c.currentItem||c.element,helper:c.helper,position:c.position,offset:c.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var intersect=$.ui.intersect=function(){function isOverAxis(x,reference,size){return x>=reference&&x<reference+size}return function(draggable,droppable,toleranceMode,event){if(!droppable.offset)return!1;var x1=(draggable.positionAbs||draggable.position.absolute).left+draggable.margins.left,y1=(draggable.positionAbs||draggable.position.absolute).top+draggable.margins.top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return l<=x1&&x2<=r&&t<=y1&&y2<=b;case"intersect":return l<x1+draggable.helperProportions.width/2&&x2-draggable.helperProportions.width/2<r&&t<y1+draggable.helperProportions.height/2&&y2-draggable.helperProportions.height/2<b;case"pointer":return isOverAxis(event.pageY,t,droppable.proportions().height)&&isOverAxis(event.pageX,l,droppable.proportions().width);case"touch":return(y1>=t&&y1<=b||y2>=t&&y2<=b||y1<t&&y2>b)&&(x1>=l&&x1<=r||x2>=l&&x2<=r||x1<l&&x2>r);default:return!1}}}();$.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++)if(!(m[i].options.disabled||t&&!m[i].accept.call(m[i].element[0],t.currentItem||t.element))){for(j=0;j<list.length;j++)if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop}m[i].visible="none"!==m[i].element.css("display"),m[i].visible&&("mousedown"===type&&m[i]._activate.call(m[i],event),m[i].offset=m[i].element.offset(),m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight}))}},drop:function(draggable,event){var dropped=!1;return $.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&intersect(draggable,this,this.options.tolerance,event)&&(dropped=this._drop.call(this,event)||dropped),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,event)))}),dropped},dragStart:function(draggable,event){draggable.element.parentsUntil("body").on("scroll.droppable",function(){draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)})},drag:function(draggable,event){draggable.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(draggable,event),$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var parentInstance,scope,parent,intersects=intersect(draggable,this,this.options.tolerance,event),c=!intersects&&this.isover?"isout":intersects&&!this.isover?"isover":null;c&&(this.options.greedy&&(scope=this.options.scope,(parent=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===scope})).length&&((parentInstance=$(parent[0]).droppable("instance")).greedyChild="isover"===c)),parentInstance&&"isover"===c&&(parentInstance.isover=!1,parentInstance.isout=!0,parentInstance._out.call(parentInstance,event)),this[c]=!0,this["isout"===c?"isover":"isout"]=!1,this["isover"===c?"_over":"_out"].call(this,event),parentInstance&&"isout"===c&&(parentInstance.isout=!1,parentInstance.isover=!0,parentInstance._over.call(parentInstance,event)))}})},dragStop:function(draggable,event){draggable.element.parentsUntil("body").off("scroll.droppable"),draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)}},!1!==$.uiBackCompat&&$.widget("ui.droppable",$.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}});$.ui.droppable,$.widget("ui.progressbar",{version:"1.12.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=$("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(newValue){if(void 0===newValue)return this.options.value;this.options.value=this._constrainedValue(newValue),this._refreshValue()},_constrainedValue:function(newValue){return void 0===newValue&&(newValue=this.options.value),this.indeterminate=!1===newValue,"number"!=typeof newValue&&(newValue=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,newValue))},_setOptions:function(options){var value=options.value;delete options.value,this._super(options),this.options.value=this._constrainedValue(value),this._refreshValue()},_setOption:function(key,value){"max"===key&&(value=Math.max(this.min,value)),this._super(key,value)},_setOptionDisabled:function(value){this._super(value),this.element.attr("aria-disabled",value),this._toggleClass(null,"ui-state-disabled",!!value)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var value=this.options.value,percentage=this._percentage();this.valueDiv.toggle(this.indeterminate||value>this.min).width(percentage.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,value===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=$("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":value}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==value&&(this.oldValue=value,this._trigger("change")),value===this.options.max&&this._trigger("complete")}}),$.widget("ui.selectable",$.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var that=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){that.elementPos=$(that.element[0]).offset(),that.selectees=$(that.options.filter,that.element[0]),that._addClass(that.selectees,"ui-selectee"),that.selectees.each(function(){var $this=$(this),selecteeOffset=$this.offset(),pos={left:selecteeOffset.left-that.elementPos.left,top:selecteeOffset.top-that.elementPos.top};$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:!1,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=$("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(event){var that=this,options=this.options;this.opos=[event.pageX,event.pageY],this.elementPos=$(this.element[0]).offset(),this.options.disabled||(this.selectees=$(options.filter,this.element[0]),this._trigger("start",event),$(options.appendTo).append(this.helper),this.helper.css({left:event.pageX,top:event.pageY,width:0,height:0}),options.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=!0,event.metaKey||event.ctrlKey||(that._removeClass(selectee.$element,"ui-selected"),selectee.selected=!1,that._addClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element}))}),$(event.target).parents().addBack().each(function(){var doSelect,selectee=$.data(this,"selectable-item");if(selectee)return doSelect=!event.metaKey&&!event.ctrlKey||!selectee.$element.hasClass("ui-selected"),that._removeClass(selectee.$element,doSelect?"ui-unselecting":"ui-selected")._addClass(selectee.$element,doSelect?"ui-selecting":"ui-unselecting"),selectee.unselecting=!doSelect,selectee.selecting=doSelect,selectee.selected=doSelect,doSelect?that._trigger("selecting",event,{selecting:selectee.element}):that._trigger("unselecting",event,{unselecting:selectee.element}),!1}))},_mouseDrag:function(event){if(this.dragged=!0,!this.options.disabled){var tmp,that=this,options=this.options,x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;return x1>x2&&(tmp=x2,x2=x1,x1=tmp),y1>y2&&(tmp=y2,y2=y1,y1=tmp),this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1}),this.selectees.each(function(){var selectee=$.data(this,"selectable-item"),hit=!1,offset={};selectee&&selectee.element!==that.element[0]&&(offset.left=selectee.left+that.elementPos.left,offset.right=selectee.right+that.elementPos.left,offset.top=selectee.top+that.elementPos.top,offset.bottom=selectee.bottom+that.elementPos.top,"touch"===options.tolerance?hit=!(offset.left>x2||offset.right<x1||offset.top>y2||offset.bottom<y1):"fit"===options.tolerance&&(hit=offset.left>x1&&offset.right<x2&&offset.top>y1&&offset.bottom<y2),hit?(selectee.selected&&(that._removeClass(selectee.$element,"ui-selected"),selectee.selected=!1),selectee.unselecting&&(that._removeClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!1),selectee.selecting||(that._addClass(selectee.$element,"ui-selecting"),selectee.selecting=!0,that._trigger("selecting",event,{selecting:selectee.element}))):(selectee.selecting&&((event.metaKey||event.ctrlKey)&&selectee.startselected?(that._removeClass(selectee.$element,"ui-selecting"),selectee.selecting=!1,that._addClass(selectee.$element,"ui-selected"),selectee.selected=!0):(that._removeClass(selectee.$element,"ui-selecting"),selectee.selecting=!1,selectee.startselected&&(that._addClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!0),that._trigger("unselecting",event,{unselecting:selectee.element}))),selectee.selected&&(event.metaKey||event.ctrlKey||selectee.startselected||(that._removeClass(selectee.$element,"ui-selected"),selectee.selected=!1,that._addClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element})))))}),!1}},_mouseStop:function(event){var that=this;return this.dragged=!1,$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");that._removeClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!1,selectee.startselected=!1,that._trigger("unselected",event,{unselected:selectee.element})}),$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");that._removeClass(selectee.$element,"ui-selecting")._addClass(selectee.$element,"ui-selected"),selectee.selecting=!1,selectee.selected=!0,selectee.startselected=!0,that._trigger("selected",event,{selected:selectee.element})}),this._trigger("stop",event),this.helper.remove(),!1}}),$.widget("ui.selectmenu",[$.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var selectmenuId=this.element.uniqueId().attr("id");this.ids={element:selectmenuId,button:selectmenuId+"-button",menu:selectmenuId+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=$()},_drawButton:function(){var icon,that=this,item=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(event){this.button.focus(),event.preventDefault()}}),this.element.hide(),this.button=$("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),icon=$("<span>").appendTo(this.button),this._addClass(icon,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(item).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){that._rendered||that._refreshMenu()})},_drawMenu:function(){var that=this;this.menu=$("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=$("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(event,ui){event.preventDefault(),that._setSelection(),that._select(ui.item.data("ui-selectmenu-item"),event)},focus:function(event,ui){var item=ui.item.data("ui-selectmenu-item");null!=that.focusIndex&&item.index!==that.focusIndex&&(that._trigger("focus",event,{item:item}),that.isOpen||that._select(item,event)),that.focusIndex=item.index,that.button.attr("aria-activedescendant",that.menuItems.eq(item.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var item,options=this.element.find("option");this.menu.empty(),this._parseOptions(options),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,options.length&&(item=this._getSelectedItem(),this.menuInstance.focus(null,item),this._setAria(item.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(event){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",event)))},_position:function(){this.menuWrap.position($.extend({of:this.button},this.options.position))},close:function(event){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",event))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(item){var buttonItem=$("<span>");return this._setText(buttonItem,item.label),this._addClass(buttonItem,"ui-selectmenu-text"),buttonItem},_renderMenu:function(ul,items){var that=this,currentOptgroup="";$.each(items,function(index,item){var li;item.optgroup!==currentOptgroup&&(li=$("<li>",{text:item.optgroup}),that._addClass(li,"ui-selectmenu-optgroup","ui-menu-divider"+(item.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),li.appendTo(ul),currentOptgroup=item.optgroup),that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-selectmenu-item",item)},_renderItem:function(ul,item){var li=$("<li>"),wrapper=$("<div>",{title:item.element.attr("title")});return item.disabled&&this._addClass(li,null,"ui-state-disabled"),this._setText(wrapper,item.label),li.append(wrapper).appendTo(ul)},_setText:function(element,value){value?element.text(value):element.html("&#160;")},_move:function(direction,event){var item,next,filter=".ui-menu-item";this.isOpen?item=this.menuItems.eq(this.focusIndex).parent("li"):(item=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),filter+=":not(.ui-state-disabled)"),(next="first"===direction||"last"===direction?item["first"===direction?"prevAll":"nextAll"](filter).eq(-1):item[direction+"All"](filter).eq(0)).length&&this.menuInstance.focus(event,next)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(event){this[this.isOpen?"close":"open"](event)},_setSelection:function(){var selection;this.range&&(window.getSelection?((selection=window.getSelection()).removeAllRanges(),selection.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(event){this.isOpen&&($(event.target).closest(".ui-selectmenu-menu, #"+$.ui.escapeSelector(this.ids.button)).length||this.close(event))}},_buttonEvents:{mousedown:function(){var selection;window.getSelection?(selection=window.getSelection()).rangeCount&&(this.range=selection.getRangeAt(0)):this.range=document.selection.createRange()},click:function(event){this._setSelection(),this._toggle(event)},keydown:function(event){var preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.TAB:case $.ui.keyCode.ESCAPE:this.close(event),preventDefault=!1;break;case $.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(event);break;case $.ui.keyCode.UP:event.altKey?this._toggle(event):this._move("prev",event);break;case $.ui.keyCode.DOWN:event.altKey?this._toggle(event):this._move("next",event);break;case $.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(event):this._toggle(event);break;case $.ui.keyCode.LEFT:this._move("prev",event);break;case $.ui.keyCode.RIGHT:this._move("next",event);break;case $.ui.keyCode.HOME:case $.ui.keyCode.PAGE_UP:this._move("first",event);break;case $.ui.keyCode.END:case $.ui.keyCode.PAGE_DOWN:this._move("last",event);break;default:this.menu.trigger(event),preventDefault=!1}preventDefault&&event.preventDefault()}},_selectFocusedItem:function(event){var item=this.menuItems.eq(this.focusIndex).parent("li");item.hasClass("ui-state-disabled")||this._select(item.data("ui-selectmenu-item"),event)},_select:function(item,event){var oldIndex=this.element[0].selectedIndex;this.element[0].selectedIndex=item.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(item)),this._setAria(item),this._trigger("select",event,{item:item}),item.index!==oldIndex&&this._trigger("change",event,{item:item}),this.close(event)},_setAria:function(item){var id=this.menuItems.eq(item.index).attr("id");this.button.attr({"aria-labelledby":id,"aria-activedescendant":id}),this.menu.attr("aria-activedescendant",id)},_setOption:function(key,value){if("icons"===key){var icon=this.button.find("span.ui-icon");this._removeClass(icon,null,this.options.icons.button)._addClass(icon,null,value.button)}this._super(key,value),"appendTo"===key&&this.menuWrap.appendTo(this._appendTo()),"width"===key&&this._resizeButton()},_setOptionDisabled:function(value){this._super(value),this.menuInstance.option("disabled",value),this.button.attr("aria-disabled",value),this._toggleClass(this.button,null,"ui-state-disabled",value),this.element.prop("disabled",value),value?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element&&element[0]||(element=this.element.closest(".ui-front, dialog")),element.length||(element=this.document[0].body),element},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var width=this.options.width;!1!==width?(null===width&&(width=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(width)):this.button.css("width","")},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var options=this._super();return options.disabled=this.element.prop("disabled"),options},_parseOptions:function(options){var that=this,data=[];options.each(function(index,item){data.push(that._parseOption($(item),index))}),this.items=data},_parseOption:function(option,index){var optgroup=option.parent("optgroup");return{element:option,index:index,value:option.val(),label:option.text(),optgroup:optgroup.attr("label")||"",disabled:optgroup.prop("disabled")||option.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),$.widget("ui.slider",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle"),handles=[];for(handleCount=options.values&&options.values.length||1,existingHandles.length>handleCount&&(existingHandles.slice(handleCount).remove(),existingHandles=existingHandles.slice(0,handleCount)),i=existingHandles.length;i<handleCount;i++)handles.push("<span tabindex='0'></span>");this.handles=existingHandles.add($(handles.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(i){$(this).data("ui-slider-handle-index",i).attr("tabIndex",0)})},_createRange:function(){var options=this.options;options.range?(!0===options.range&&(options.values?options.values.length&&2!==options.values.length?options.values=[options.values[0],options.values[0]]:$.isArray(options.values)&&(options.values=options.values.slice(0)):options.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=$("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==options.range&&"max"!==options.range||this._addClass(this.range,"ui-slider-range-"+options.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,offset,mouseOverHandle,that=this,o=this.options;return!o.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position),distance=this._valueMax()-this._valueMin()+1,this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));(distance>thisDistance||distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min))&&(distance=thisDistance,closestHandle=$(this),index=i)}),!1!==this._start(event,index)&&(this._mouseSliding=!0,this._handleIndex=index,this._addClass(closestHandle,null,"ui-state-active"),closestHandle.trigger("focus"),offset=closestHandle.offset(),mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-closestHandle.width()/2,top:event.pageY-offset.top-closestHandle.height()/2-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(event,index,normValue),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);return this._slide(event,this._handleIndex,normValue),!1},_mouseStop:function(event){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(event,this._handleIndex),this._change(event,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;return"horizontal"===this.orientation?(pixelTotal=this.elementSize.width,pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(pixelTotal=this.elementSize.height,pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(percentMouse=pixelMouse/pixelTotal)>1&&(percentMouse=1),percentMouse<0&&(percentMouse=0),"vertical"===this.orientation&&(percentMouse=1-percentMouse),valueTotal=this._valueMax()-this._valueMin(),valueMouse=this._valueMin()+percentMouse*valueTotal,this._trimAlignValue(valueMouse)},_uiHash:function(index,value,values){var uiHash={handle:this.handles[index],handleIndex:index,value:void 0!==value?value:this.value()};return this._hasMultipleValues()&&(uiHash.value=void 0!==value?value:this.values(index),uiHash.values=values||this.values()),uiHash},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(event,index){return this._trigger("start",event,this._uiHash(index))},_slide:function(event,index,newVal){var otherVal,currentValue=this.value(),newValues=this.values();this._hasMultipleValues()&&(otherVal=this.values(index?0:1),currentValue=this.values(index),2===this.options.values.length&&!0===this.options.range&&(newVal=0===index?Math.min(otherVal,newVal):Math.max(otherVal,newVal)),newValues[index]=newVal),newVal!==currentValue&&!1!==this._trigger("slide",event,this._uiHash(index,newVal,newValues))&&(this._hasMultipleValues()?this.values(index,newVal):this.value(newVal))},_stop:function(event,index){this._trigger("stop",event,this._uiHash(index))},_change:function(event,index){this._keySliding||this._mouseSliding||(this._lastChangedValue=index,this._trigger("change",event,this._uiHash(index)))},value:function(newValue){return arguments.length?(this.options.value=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,0)):this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1)return this.options.values[index]=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,index);if(!arguments.length)return this._values();if(!$.isArray(arguments[0]))return this._hasMultipleValues()?this._values(index):this.value();for(vals=this.options.values,newValues=arguments[0],i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(newValues[i]),this._change(null,i);this._refreshValue()},_setOption:function(key,value){var i,valsLength=0;switch("range"===key&&!0===this.options.range&&("min"===value?(this.options.value=this._values(0),this.options.values=null):"max"===value&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),$.isArray(this.options.values)&&(valsLength=this.options.values.length),this._super(key,value),key){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(value),this.handles.css("horizontal"===value?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=valsLength-1;i>=0;i--)this._change(null,i);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(value){this._super(value),this._toggleClass(null,"ui-state-disabled",!!value)},_value:function(){var val=this.options.value;return val=this._trimAlignValue(val)},_values:function(index){var val,vals,i;if(arguments.length)return val=this.options.values[index],val=this._trimAlignValue(val);if(this._hasMultipleValues()){for(vals=this.options.values.slice(),i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(vals[i]);return vals}return[]},_trimAlignValue:function(val){if(val<=this._valueMin())return this._valueMin();if(val>=this._valueMax())return this._valueMax();var step=this.options.step>0?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;return 2*Math.abs(valModStep)>=step&&(alignValue+=valModStep>0?step:-step),parseFloat(alignValue.toFixed(5))},_calculateNewMax:function(){var max=this.options.max,min=this._valueMin(),step=this.options.step;(max=Math.round((max-min)/step)*step+min)>this.options.max&&(max-=step),this.max=parseFloat(max.toFixed(this._precision()))},_precision:function(){var precision=this._precisionOf(this.options.step);return null!==this.options.min&&(precision=Math.max(precision,this._precisionOf(this.options.min))),precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return-1===decimal?0:str.length-decimal-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(orientation){"vertical"===orientation&&this.range.css({width:"",left:""}),"horizontal"===orientation&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=!this._animateOff&&o.animate,_set={};this._hasMultipleValues()?this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100,_set["horizontal"===that.orientation?"left":"bottom"]=valPercent+"%",$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate),!0===that.options.range&&("horizontal"===that.orientation?(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({width:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate})):(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({bottom:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({height:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate}))),lastValPercent=valPercent}):(value=this.value(),valueMin=this._valueMin(),valueMax=this._valueMax(),valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0,_set["horizontal"===this.orientation?"left":"bottom"]=valPercent+"%",this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate),"min"===oRange&&"horizontal"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate),"max"===oRange&&"horizontal"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({width:100-valPercent+"%"},o.animate),"min"===oRange&&"vertical"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate),"max"===oRange&&"vertical"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({height:100-valPercent+"%"},o.animate))},_handleEvents:{keydown:function(event){var curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(event.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass($(event.target),null,"ui-state-active"),!1===this._start(event,index)))return}switch(step=this.options.step,curVal=newVal=this._hasMultipleValues()?this.values(index):this.value(),event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax())return;newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin())return;newVal=this._trimAlignValue(curVal-step)}this._slide(event,index,newVal)},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(event,index),this._change(event,index),this._removeClass($(event.target),null,"ui-state-active"))}}}),$.widget("ui.sortable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(x,reference,size){return x>=reference&&x<reference+size},_isFloating:function(item){return/left|right/.test(item.css("float"))||/inline|table-cell/.test(item.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(key,value){this._super(key,value),"handle"===key&&this._setHandleClassName()},_setHandleClassName:function(){var that=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),$.each(this.items,function(){that._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--)this.items[i].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=!1,that=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(event),$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that)return currentItem=$(this),!1}),$.data(event.target,that.widgetName+"-item")===that&&(currentItem=$(event.target)),!!currentItem&&(!(this.options.handle&&!overrideHandle&&($(this.options.handle,currentItem).find("*").addBack().each(function(){this===event.target&&(validHandle=!0)}),!validHandle))&&(this.currentItem=currentItem,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(event),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(event),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(body=this.document.find("body"),this.storedCursor=body.css("cursor"),body.css("cursor",o.cursor),this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",event,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!noActivation)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",event,this._uiHash(this));return $.ui.ddmanager&&($.ui.ddmanager.current=this),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(event),!0},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=!1;for(this.position=this._generatePosition(event),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed:event.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed:event.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(event.pageY-this.document.scrollTop()<o.scrollSensitivity?scrolled=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(event.pageY-this.document.scrollTop())<o.scrollSensitivity&&(scrolled=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),event.pageX-this.document.scrollLeft()<o.scrollSensitivity?scrolled=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(event.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(scrolled=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),!1!==scrolled&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(item=this.items[i],itemElement=item.item[0],(intersection=this._intersectsWithPointer(item))&&item.instance===this.currentContainer&&!(itemElement===this.currentItem[0]||this.placeholder[1===intersection?"next":"prev"]()[0]===itemElement||$.contains(this.placeholder[0],itemElement)||"semi-dynamic"===this.options.type&&$.contains(this.element[0],itemElement))){if(this.direction=1===intersection?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(item))break;this._rearrange(event,item),this._trigger("change",event,this._uiHash());break}return this._contactContainers(event),$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),this._trigger("sort",event,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(event,noPropagation){if(event){if($.ui.ddmanager&&!this.options.dropBehaviour&&$.ui.ddmanager.drop(this,event),this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};axis&&"x"!==axis||(animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),axis&&"y"!==axis||(animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event)})}else this._clear(event,noPropagation);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new $.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("deactivate",null,this._uiHash(this)),this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",null,this._uiHash(this)),this.containers[i].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),$.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?$(this.domPosition.prev).after(this.currentItem):$(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];return o=o||{},$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||/(.+)[\-=_](.+)/);res&&str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]))}),!str.length&&o.key&&str.push(o.key+"="),str.join("&")},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];return o=o||{},items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"")}),ret},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight="x"===this.options.axis||y1+dyClick>t&&y1+dyClick<b,isOverElementWidth="y"===this.options.axis||x1+dxClick>l&&x1+dxClick<r,isOverElement=isOverElementHeight&&isOverElementWidth;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"]?isOverElement:l<x1+this.helperProportions.width/2&&x2-this.helperProportions.width/2<r&&t<y1+this.helperProportions.height/2&&y2-this.helperProportions.height/2<b},_intersectsWithPointer:function(item){var verticalDirection,horizontalDirection,isOverElementHeight="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width);return!(!isOverElementHeight||!isOverElementWidth)&&(verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection(),this.floating?"right"===horizontalDirection||"down"===verticalDirection?2:1:verticalDirection&&("down"===verticalDirection?2:1))},_intersectsWithSides:function(item){var isOverBottomHalf=this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+item.height/2,item.height),isOverRightHalf=this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+item.width/2,item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return this.floating&&horizontalDirection?"right"===horizontalDirection&&isOverRightHalf||"left"===horizontalDirection&&!isOverRightHalf:verticalDirection&&("down"===verticalDirection&&isOverBottomHalf||"up"===verticalDirection&&!isOverBottomHalf)},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return 0!==delta&&(delta>0?"down":"up")},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return 0!==delta&&(delta>0?"right":"left")},refresh:function(event){return this._refreshItems(event),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith},_getItemsAsjQuery:function(connected){var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected)for(i=connectWith.length-1;i>=0;i--)for(j=(cur=$(connectWith[i],this.document[0])).length-1;j>=0;j--)(inst=$.data(cur[j],this.widgetFullName))&&inst!==this&&!inst.options.disabled&&queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);for(queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=queries.length-1;i>=0;i--)queries[i][0].each(function(){items.push(this)});return $(items)},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++)if(list[j]===item.item[0])return!1;return!0})},_refreshItems:function(event){this.items=[],this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready)for(i=connectWith.length-1;i>=0;i--)for(j=(cur=$(connectWith[i],this.document[0])).length-1;j>=0;j--)(inst=$.data(cur[j],this.widgetFullName))&&inst!==this&&!inst.options.disabled&&(queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]),this.containers.push(inst));for(i=queries.length-1;i>=0;i--)for(targetData=queries[i][1],j=0,queriesLength=(_queries=queries[i][0]).length;j<queriesLength;j++)(item=$(_queries[j])).data(this.widgetName+"-item",targetData),items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0})},refreshPositions:function(fast){this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,item,t,p;for(i=this.items.length-1;i>=0;i--)(item=this.items[i]).instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]||(t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item,fast||(item.width=t.outerWidth(),item.height=t.outerHeight()),p=t.offset(),item.left=p.left,item.top=p.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)p=this.containers[i].element.offset(),this.containers[i].containerCache.left=p.left,this.containers[i].containerCache.top=p.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(that){var className,o=(that=that||this).options;o.placeholder&&o.placeholder.constructor!==String||(className=o.placeholder,o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]);return that._addClass(element,"ui-sortable-placeholder",className||that.currentItem[0].className)._removeClass(element,"ui-sortable-helper"),"tbody"===nodeName?that._createTrPlaceholder(that.currentItem.find("tr").eq(0),$("<tr>",that.document[0]).appendTo(element)):"tr"===nodeName?that._createTrPlaceholder(that.currentItem,element):"img"===nodeName&&element.attr("src",that.currentItem.attr("src")),className||element.css("visibility","hidden"),element},update:function(container,p){className&&!o.forcePlaceholderSize||(p.height()||p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10)),p.width()||p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10)))}}),that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem)),that.currentItem.after(that.placeholder),o.placeholder.update(that,that.placeholder)},_createTrPlaceholder:function(sourceTr,targetTr){var that=this;sourceTr.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(targetTr)})},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,cur,nearBottom,floating,axis,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--)if(!$.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0]))continue;innermostContainer=this.containers[i],innermostIndex=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",event,this._uiHash(this)),this.containers[i].containerCache.over=0);if(innermostContainer)if(1===this.containers.length)this.containers[innermostIndex].containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1);else{for(dist=1e4,itemWithLeastDistance=null,posProperty=(floating=innermostContainer.floating||this._isFloating(this.currentItem))?"left":"top",sizeProperty=floating?"width":"height",axis=floating?"pageX":"pageY",j=this.items.length-1;j>=0;j--)$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])&&this.items[j].item[0]!==this.currentItem[0]&&(cur=this.items[j].item.offset()[posProperty],nearBottom=!1,event[axis]-cur>this.items[j][sizeProperty]/2&&(nearBottom=!0),Math.abs(event[axis]-cur)<dist&&(dist=Math.abs(event[axis]-cur),itemWithLeastDistance=this.items[j],this.direction=nearBottom?"up":"down"));if(!itemWithLeastDistance&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[innermostIndex])return void(this.currentContainer.containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash()),this.currentContainer.containerCache.over=1));itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,!0):this._rearrange(event,null,this.containers[innermostIndex].element,!0),this._trigger("change",event,this._uiHash()),this.containers[innermostIndex]._trigger("change",event,this._uiHash(this)),this.currentContainer=this.containers[innermostIndex],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):"clone"===o.helper?this.currentItem.clone():this.currentItem;return helper.parents("body").length||$("parent"!==o.appendTo?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]),helper[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),helper[0].style.width&&!o.forceHelperSize||helper.width(this.currentItem.width()),helper[0].style.height&&!o.forceHelperSize||helper.height(this.currentItem.height()),helper},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var ce,co,over,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===o.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===o.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(ce=$(o.containment)[0],co=$(o.containment).offset(),over="hidden"!==$(ce).css("overflow"),this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop())*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod}},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(event.pageX-this.offset.click.left<this.containment[0]&&(pageX=this.containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<this.containment[1]&&(pageY=this.containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>this.containment[2]&&(pageX=this.containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>this.containment[3]&&(pageY=this.containment[3]+this.offset.click.top)),o.grid&&(top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1],pageY=this.containment?top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3]?top:top-this.offset.click.top>=this.containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0],pageX=this.containment?left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2]?left:left-this.offset.click.left>=this.containment[0]?left-o.grid[0]:left+o.grid[0]:left)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop()),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())}},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?i.item[0]:i.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){counter===this.counter&&this.refreshPositions(!hardRefresh)})},_clear:function(event,noPropagation){function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance))}}this.reverting=!1;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!noPropagation&&delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||noPropagation||delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())}),this!==this.currentContainer&&(noPropagation||(delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())}),delayedTriggers.push(function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}.call(this,this.currentContainer)),delayedTriggers.push(function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)noPropagation||delayedTriggers.push(delayEvent("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(delayedTriggers.push(delayEvent("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,noPropagation||this._trigger("beforeStop",event,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!noPropagation){for(i=0;i<delayedTriggers.length;i++)delayedTriggers[i].call(this,event);this._trigger("stop",event,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===$.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null}}});$.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var options=this._super(),element=this.element;return $.each(["min","max","step"],function(i,option){var value=element.attr(option);null!=value&&value.length&&(options[option]=value)}),options},_events:{keydown:function(event){this._start(event)&&this._keydown(event)&&event.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(event){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",event))},mousewheel:function(event,delta){if(delta){if(!this.spinning&&!this._start(event))return!1;this._spin((delta>0?1:-1)*this.options.step,event),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(event)},100),event.preventDefault()}},"mousedown .ui-spinner-button":function(event){function checkFocus(){this.element[0]===$.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=previous,this._delay(function(){this.previous=previous}))}var previous;previous=this.element[0]===$.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),event.preventDefault(),checkFocus.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,checkFocus.call(this)}),!1!==this._start(event)&&this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(event){if($(event.currentTarget).hasClass("ui-state-active"))return!1!==this._start(event)&&void this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(event){var options=this.options,keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.UP:return this._repeat(null,1,event),!0;case keyCode.DOWN:return this._repeat(null,-1,event),!0;case keyCode.PAGE_UP:return this._repeat(null,options.page,event),!0;case keyCode.PAGE_DOWN:return this._repeat(null,-options.page,event),!0}return!1},_start:function(event){return!(!this.spinning&&!1===this._trigger("start",event))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(i,steps,event){i=i||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,steps,event)},i),this._spin(steps*this.options.step,event)},_spin:function(step,event){var value=this.value()||0;this.counter||(this.counter=1),value=this._adjustValue(value+step*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",event,{value:value})||(this._value(value),this.counter++)},_increment:function(i){var incremental=this.options.incremental;return incremental?$.isFunction(incremental)?incremental(i):Math.floor(i*i*i/5e4-i*i/500+17*i/200+1):1},_precision:function(){var precision=this._precisionOf(this.options.step);return null!==this.options.min&&(precision=Math.max(precision,this._precisionOf(this.options.min))),precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return-1===decimal?0:str.length-decimal-1},_adjustValue:function(value){var base,aboveMin,options=this.options;return base=null!==options.min?options.min:0,aboveMin=value-base,aboveMin=Math.round(aboveMin/options.step)*options.step,value=base+aboveMin,value=parseFloat(value.toFixed(this._precision())),null!==options.max&&value>options.max?options.max:null!==options.min&&value<options.min?options.min:value},_stop:function(event){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",event))},_setOption:function(key,value){var prevValue,first,last;if("culture"===key||"numberFormat"===key)return prevValue=this._parse(this.element.val()),this.options[key]=value,void this.element.val(this._format(prevValue));"max"!==key&&"min"!==key&&"step"!==key||"string"==typeof value&&(value=this._parse(value)),"icons"===key&&(first=this.buttons.first().find(".ui-icon"),this._removeClass(first,null,this.options.icons.up),this._addClass(first,null,value.up),last=this.buttons.last().find(".ui-icon"),this._removeClass(last,null,this.options.icons.down),this._addClass(last,null,value.down)),this._super(key,value)},_setOptionDisabled:function(value){this._super(value),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!value),this.element.prop("disabled",!!value),this.buttons.button(value?"disable":"enable")},_setOptions:spinnerModifer(function(options){this._super(options)}),_parse:function(val){return"string"==typeof val&&""!==val&&(val=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(val,10,this.options.culture):+val),""===val||isNaN(val)?null:val},_format:function(value){return""===value?"":window.Globalize&&this.options.numberFormat?Globalize.format(value,this.options.numberFormat,this.options.culture):value},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var value=this.value();return null!==value&&value===this._adjustValue(value)},_value:function(value,allowAny){var parsed;""!==value&&null!==(parsed=this._parse(value))&&(allowAny||(parsed=this._adjustValue(parsed)),value=this._format(parsed)),this.element.val(value),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:spinnerModifer(function(steps){this._stepUp(steps)}),_stepUp:function(steps){this._start()&&(this._spin((steps||1)*this.options.step),this._stop())},stepDown:spinnerModifer(function(steps){this._stepDown(steps)}),_stepDown:function(steps){this._start()&&(this._spin((steps||1)*-this.options.step),this._stop())},pageUp:spinnerModifer(function(pages){this._stepUp((pages||1)*this.options.page)}),pageDown:spinnerModifer(function(pages){this._stepDown((pages||1)*this.options.page)}),value:function(newVal){if(!arguments.length)return this._parse(this.element.val());spinnerModifer(this._value).call(this,newVal)},widget:function(){return this.uiSpinner}}),!1!==$.uiBackCompat&&$.widget("ui.spinner",$.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}});$.ui.spinner;$.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var rhash=/#.*$/;return function(anchor){var anchorUrl,locationUrl;anchorUrl=anchor.href.replace(rhash,""),locationUrl=location.href.replace(rhash,"");try{anchorUrl=decodeURIComponent(anchorUrl)}catch(error){}try{locationUrl=decodeURIComponent(locationUrl)}catch(error){}return anchor.hash.length>1&&anchorUrl===locationUrl}}(),_create:function(){var that=this,options=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,options.collapsible),this._processTabs(),options.active=this._initialActive(),$.isArray(options.disabled)&&(options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li)}))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(options.active):this.active=$(),this._refresh(),this.active.length&&this.load(options.active)},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);return null===active&&(locationHash&&this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash)return active=i,!1}),null===active&&(active=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==active&&-1!==active||(active=!!this.tabs.length&&0)),!1!==active&&-1===(active=this.tabs.index(this.tabs.eq(active)))&&(active=!collapsible&&0),!collapsible&&!1===active&&this.anchors.length&&(active=0),active},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):$()}},_tabKeydown:function(event){var focusedTab=$($.ui.safeActiveElement(this.document[0])).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=!0;if(!this._handlePageNav(event)){switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=!1,selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex);case $.ui.keyCode.ENTER:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex!==this.options.active&&selectedIndex);default:return}event.preventDefault(),clearTimeout(this.activating),selectedIndex=this._focusNextTab(selectedIndex,goingForward),event.ctrlKey||event.metaKey||(focusedTab.attr("aria-selected","false"),this.tabs.eq(selectedIndex).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",selectedIndex)},this.delay))}},_panelKeydown:function(event){this._handlePageNav(event)||event.ctrlKey&&event.keyCode===$.ui.keyCode.UP&&(event.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(event){return event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(index,goingForward){for(var lastTabIndex=this.tabs.length-1;-1!==$.inArray((index>lastTabIndex&&(index=0),index<0&&(index=lastTabIndex),index),this.options.disabled);)index=goingForward?index+1:index-1;return index},_focusNextTab:function(index,goingForward){return index=this._findNextTab(index,goingForward),this.tabs.eq(index).trigger("focus"),index},_setOption:function(key,value){"active"!==key?(this._super(key,value),"collapsible"===key&&(this._toggleClass("ui-tabs-collapsible",null,value),value||!1!==this.options.active||this._activate(0)),"event"===key&&this._setupEvents(value),"heightStyle"===key&&this._setupHeightStyle(value)):this._activate(value)},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab)}),this._processTabs(),!1!==options.active&&this.anchors.length?this.active.length&&!$.contains(this.tablist[0],this.active[0])?this.tabs.length===options.disabled.length?(options.active=!1,this.active=$()):this._activate(this._findNextTab(Math.max(0,options.active-1),!1)):options.active=this.tabs.index(this.active):(options.active=!1,this.active=$()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var that=this,prevTabs=this.tabs,prevAnchors=this.anchors,prevPanels=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(event){$(this).is(".ui-state-disabled")&&event.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){$(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return $("a",this)[0]}).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=$(),this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");that._isLocal(anchor)?(panelId=(selector=anchor.hash).substring(1),panel=that.element.find(that._sanitizeSelector(selector))):(selector="#"+(panelId=tab.attr("aria-controls")||$({}).uniqueId()[0].id),(panel=that.element.find(selector)).length||(panel=that._createPanel(panelId)).insertAfter(that.panels[i-1]||that.tablist),panel.attr("aria-live","polite")),panel.length&&(that.panels=that.panels.add(panel)),originalAriaControls&&tab.data("ui-tabs-aria-controls",originalAriaControls),tab.attr({"aria-controls":panelId,"aria-labelledby":anchorId}),panel.attr("aria-labelledby",anchorId)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),prevTabs&&(this._off(prevTabs.not(this.tabs)),this._off(prevAnchors.not(this.anchors)),this._off(prevPanels.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(id){return $("<div>").attr("id",id).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(disabled){var currentItem,li,i;for($.isArray(disabled)&&(disabled.length?disabled.length===this.anchors.length&&(disabled=!0):disabled=!1),i=0;li=this.tabs[i];i++)currentItem=$(li),!0===disabled||-1!==$.inArray(i,disabled)?(currentItem.attr("aria-disabled","true"),this._addClass(currentItem,null,"ui-state-disabled")):(currentItem.removeAttr("aria-disabled"),this._removeClass(currentItem,null,"ui-state-disabled"));this.options.disabled=disabled,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===disabled)},_setupEvents:function(event){var events={};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(event){event.preventDefault()}}),this._on(this.anchors,events),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();"fill"===heightStyle?(maxHeight=parent.height(),maxHeight-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(!0)}),this.panels.each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height())}).height(maxHeight))},_eventHandler:function(event){var options=this.options,active=this.active,tab=$(event.currentTarget).closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=active.length?this._getPanelForTab(active):$(),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault(),tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||clickedIsActive&&!options.collapsible||!1===this._trigger("beforeActivate",event,eventData)||(options.active=!collapsing&&this.tabs.index(tab),this.active=clickedIsActive?$():tab,this.xhr&&this.xhr.abort(),toHide.length||toShow.length||$.error("jQuery UI Tabs: Mismatching fragment identifier."),toShow.length&&this.load(this.tabs.index(tab),event),this._toggle(event,eventData))},_toggle:function(event,eventData){function complete(){that.running=!1,that._trigger("activate",event,eventData)}function show(){that._addClass(eventData.newTab.closest("li"),"ui-tabs-active","ui-state-active"),toShow.length&&that.options.show?that._show(toShow,that.options.show,complete):(toShow.show(),complete())}var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=!0,toHide.length&&this.options.hide?this._hide(toHide,this.options.hide,function(){that._removeClass(eventData.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),show()}):(this._removeClass(eventData.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),toHide.hide(),show()),toHide.attr("aria-hidden","true"),eventData.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),toShow.length&&toHide.length?eventData.oldTab.attr("tabIndex",-1):toShow.length&&this.tabs.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),toShow.attr("aria-hidden","false"),eventData.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(index){var anchor,active=this._findActive(index);active[0]!==this.active[0]&&(active.length||(active=this.active),anchor=active.find(".ui-tabs-anchor")[0],this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop}))},_findActive:function(index){return!1===index?$():this.tabs.eq(index)},_getIndex:function(index){return"string"==typeof index&&(index=this.anchors.index(this.anchors.filter("[href$='"+$.ui.escapeSelector(index)+"']"))),index},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){$.data(this,"ui-tabs-destroy")?$(this).remove():$(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");prev?li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls"):li.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(index){var disabled=this.options.disabled;!1!==disabled&&(void 0===index?disabled=!1:(index=this._getIndex(index),disabled=$.isArray(disabled)?$.map(disabled,function(num){return num!==index?num:null}):$.map(this.tabs,function(li,num){return num!==index?num:null})),this._setOptionDisabled(disabled))},disable:function(index){var disabled=this.options.disabled;if(!0!==disabled){if(void 0===index)disabled=!0;else{if(index=this._getIndex(index),-1!==$.inArray(index,disabled))return;disabled=$.isArray(disabled)?$.merge([index],disabled).sort():[index]}this._setOptionDisabled(disabled)}},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel},complete=function(jqXHR,status){"abort"===status&&that.panels.stop(!1,!0),that._removeClass(tab,"ui-tabs-loading"),panel.removeAttr("aria-busy"),jqXHR===that.xhr&&delete that.xhr};this._isLocal(anchor[0])||(this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(tab,"ui-tabs-loading"),panel.attr("aria-busy","true"),this.xhr.done(function(response,status,jqXHR){setTimeout(function(){panel.html(response),that._trigger("load",event,eventData),complete(jqXHR,status)},1)}).fail(function(jqXHR,status){setTimeout(function(){complete(jqXHR,status)},1)})))},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href").replace(/#.*$/,""),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData))}}},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id))}}),!1!==$.uiBackCompat&&$.widget("ui.tabs",$.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}});$.ui.tabs;$.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var title=$(this).attr("title")||"";return $("<a>").text(title).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(elem,id){var describedby=(elem.attr("aria-describedby")||"").split(/\s+/);describedby.push(id),elem.data("ui-tooltip-id",id).attr("aria-describedby",$.trim(describedby.join(" ")))},_removeDescribedBy:function(elem){var id=elem.data("ui-tooltip-id"),describedby=(elem.attr("aria-describedby")||"").split(/\s+/),index=$.inArray(id,describedby);-1!==index&&describedby.splice(index,1),elem.removeData("ui-tooltip-id"),(describedby=$.trim(describedby.join(" ")))?elem.attr("aria-describedby",describedby):elem.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=$("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=$([])},_setOption:function(key,value){var that=this;this._super(key,value),"content"===key&&$.each(this.tooltips,function(id,tooltipData){that._updateContent(tooltipData.element)})},_setOptionDisabled:function(value){this[value?"_disable":"_enable"]()},_disable:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur");event.target=event.currentTarget=tooltipData.element[0],that.close(event,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var element=$(this);if(element.is("[title]"))return element.data("ui-tooltip-title",element.attr("title")).removeAttr("title")}))},_enable:function(){this.disabledTitles.each(function(){var element=$(this);element.data("ui-tooltip-title")&&element.attr("title",element.data("ui-tooltip-title"))}),this.disabledTitles=$([])},open:function(event){var that=this,target=$(event?event.target:this.element).closest(this.options.items);target.length&&!target.data("ui-tooltip-id")&&(target.attr("title")&&target.data("ui-tooltip-title",target.attr("title")),target.data("ui-tooltip-open",!0),event&&"mouseover"===event.type&&target.parents().each(function(){var blurEvent,parent=$(this);parent.data("ui-tooltip-open")&&((blurEvent=$.Event("blur")).target=blurEvent.currentTarget=this,that.close(blurEvent,!0)),parent.attr("title")&&(parent.uniqueId(),that.parents[this.id]={element:this,title:parent.attr("title")},parent.attr("title",""))}),this._registerCloseHandlers(event,target),this._updateContent(target,event))},_updateContent:function(target,event){var content,contentOption=this.options.content,that=this,eventType=event?event.type:null;if("string"==typeof contentOption||contentOption.nodeType||contentOption.jquery)return this._open(event,target,contentOption);(content=contentOption.call(target[0],function(response){that._delay(function(){target.data("ui-tooltip-open")&&(event&&(event.type=eventType),this._open(event,target,response))})}))&&this._open(event,target,content)},_open:function(event,target,content){function position(event){positionOption.of=event,tooltip.is(":hidden")||tooltip.position(positionOption)}var tooltipData,tooltip,delayedShow,a11yContent,positionOption=$.extend({},this.options.position);content&&((tooltipData=this._find(target))?tooltipData.tooltip.find(".ui-tooltip-content").html(content):(target.is("[title]")&&(event&&"mouseover"===event.type?target.attr("title",""):target.removeAttr("title")),tooltipData=this._tooltip(target),tooltip=tooltipData.tooltip,this._addDescribedBy(target,tooltip.attr("id")),tooltip.find(".ui-tooltip-content").html(content),this.liveRegion.children().hide(),(a11yContent=$("<div>").html(tooltip.find(".ui-tooltip-content").html())).removeAttr("name").find("[name]").removeAttr("name"),a11yContent.removeAttr("id").find("[id]").removeAttr("id"),a11yContent.appendTo(this.liveRegion),this.options.track&&event&&/^mouse/.test(event.type)?(this._on(this.document,{mousemove:position}),position(event)):tooltip.position($.extend({of:target},this.options.position)),tooltip.hide(),this._show(tooltip,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(delayedShow=this.delayedShow=setInterval(function(){tooltip.is(":visible")&&(position(positionOption.of),clearInterval(delayedShow))},$.fx.interval)),this._trigger("open",event,{tooltip:tooltip})))},_registerCloseHandlers:function(event,target){var events={keyup:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){var fakeEvent=$.Event(event);fakeEvent.currentTarget=target[0],this.close(fakeEvent,!0)}}};target[0]!==this.element[0]&&(events.remove=function(){this._removeTooltip(this._find(target).tooltip)}),event&&"mouseover"!==event.type||(events.mouseleave="close"),event&&"focusin"!==event.type||(events.focusout="close"),this._on(!0,target,events)},close:function(event){var tooltip,that=this,target=$(event?event.currentTarget:this.element),tooltipData=this._find(target);tooltipData?(tooltip=tooltipData.tooltip,tooltipData.closing||(clearInterval(this.delayedShow),target.data("ui-tooltip-title")&&!target.attr("title")&&target.attr("title",target.data("ui-tooltip-title")),this._removeDescribedBy(target),tooltipData.hiding=!0,tooltip.stop(!0),this._hide(tooltip,this.options.hide,function(){that._removeTooltip($(this))}),target.removeData("ui-tooltip-open"),this._off(target,"mouseleave focusout keyup"),target[0]!==this.element[0]&&this._off(target,"remove"),this._off(this.document,"mousemove"),event&&"mouseleave"===event.type&&$.each(this.parents,function(id,parent){$(parent.element).attr("title",parent.title),delete that.parents[id]}),tooltipData.closing=!0,this._trigger("close",event,{tooltip:tooltip}),tooltipData.hiding||(tooltipData.closing=!1))):target.removeData("ui-tooltip-open")},_tooltip:function(element){var tooltip=$("<div>").attr("role","tooltip"),content=$("<div>").appendTo(tooltip),id=tooltip.uniqueId().attr("id");return this._addClass(content,"ui-tooltip-content"),this._addClass(tooltip,"ui-tooltip","ui-widget ui-widget-content"),tooltip.appendTo(this._appendTo(element)),this.tooltips[id]={element:element,tooltip:tooltip}},_find:function(target){var id=target.data("ui-tooltip-id");return id?this.tooltips[id]:null},_removeTooltip:function(tooltip){tooltip.remove(),delete this.tooltips[tooltip.attr("id")]},_appendTo:function(target){var element=target.closest(".ui-front, dialog");return element.length||(element=this.document[0].body),element},_destroy:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur"),element=tooltipData.element;event.target=event.currentTarget=element[0],that.close(event,!0),$("#"+id).remove(),element.data("ui-tooltip-title")&&(element.attr("title")||element.attr("title",element.data("ui-tooltip-title")),element.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),!1!==$.uiBackCompat&&$.widget("ui.tooltip",$.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var tooltipData=this._superApply(arguments);return this.options.tooltipClass&&tooltipData.tooltip.addClass(this.options.tooltipClass),tooltipData}});$.ui.tooltip}),function($){"use strict";var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.VERSION="3.3.7",Alert.TRANSITION_DURATION=150,Alert.prototype.close=function(e){function removeElement(){$parent.detach().trigger("closed.bs.alert").remove()}var $this=$(this),selector=$this.attr("data-target");selector||(selector=(selector=$this.attr("href"))&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=$("#"===selector?[]:selector);e&&e.preventDefault(),$parent.length||($parent=$this.closest(".alert")),$parent.trigger(e=$.Event("close.bs.alert")),e.isDefaultPrevented()||($parent.removeClass("in"),$.support.transition&&$parent.hasClass("fade")?$parent.one("bsTransitionEnd",removeElement).emulateTransitionEnd(Alert.TRANSITION_DURATION):removeElement())};var old=$.fn.alert;$.fn.alert=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.alert");data||$this.data("bs.alert",data=new Alert(this)),"string"==typeof option&&data[option].call($this)})},$.fn.alert.Constructor=Alert,$.fn.alert.noConflict=function(){return $.fn.alert=old,this},$(document).on("click.bs.alert.data-api",dismiss,Alert.prototype.close)}(jQuery),function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.button"),options="object"==typeof option&&option;data||$this.data("bs.button",data=new Button(this,options)),"toggle"==option?data.toggle():option&&data.setState(option)})}var Button=function(element,options){this.$element=$(element),this.options=$.extend({},Button.DEFAULTS,options),this.isLoading=!1};Button.VERSION="3.3.7",Button.DEFAULTS={loadingText:"loading..."},Button.prototype.setState=function(state){var d="disabled",$el=this.$element,val=$el.is("input")?"val":"html",data=$el.data();state+="Text",null==data.resetText&&$el.data("resetText",$el[val]()),setTimeout($.proxy(function(){$el[val](null==data[state]?this.options[state]:data[state]),"loadingText"==state?(this.isLoading=!0,$el.addClass(d).attr(d,d).prop(d,!0)):this.isLoading&&(this.isLoading=!1,$el.removeClass(d).removeAttr(d).prop(d,!1))},this),0)},Button.prototype.toggle=function(){var changed=!0,$parent=this.$element.closest('[data-toggle="buttons"]');if($parent.length){var $input=this.$element.find("input");"radio"==$input.prop("type")?($input.prop("checked")&&(changed=!1),$parent.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==$input.prop("type")&&($input.prop("checked")!==this.$element.hasClass("active")&&(changed=!1),this.$element.toggleClass("active")),$input.prop("checked",this.$element.hasClass("active")),changed&&$input.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var old=$.fn.button;$.fn.button=Plugin,$.fn.button.Constructor=Button,$.fn.button.noConflict=function(){return $.fn.button=old,this},$(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(e){var $btn=$(e.target).closest(".btn");Plugin.call($btn,"toggle"),$(e.target).is('input[type="radio"], input[type="checkbox"]')||(e.preventDefault(),$btn.is("input,button")?$btn.trigger("focus"):$btn.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){$(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),function($){"use strict";function getTargetFromTrigger($trigger){var href,target=$trigger.attr("data-target")||(href=$trigger.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,"");return $(target)}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);!data&&options.toggle&&/show|hide/.test(option)&&(options.toggle=!1),data||$this.data("bs.collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()})}var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.$trigger=$('[data-toggle="collapse"][href="#'+element.id+'"],[data-toggle="collapse"][data-target="#'+element.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};Collapse.VERSION="3.3.7",Collapse.TRANSITION_DURATION=350,Collapse.DEFAULTS={toggle:!0},Collapse.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},Collapse.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var activesData,actives=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(actives&&actives.length&&(activesData=actives.data("bs.collapse"))&&activesData.transitioning)){var startEvent=$.Event("show.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){actives&&actives.length&&(Plugin.call(actives,"hide"),activesData||actives.data("bs.collapse",null));var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])}}}},Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!$.support.transition)return complete.call(this);this.$element[dimension](0).one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)}}},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},Collapse.prototype.getParent=function(){return $(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each($.proxy(function(i,element){var $element=$(element);this.addAriaAndCollapsedClass(getTargetFromTrigger($element),$element)},this)).end()},Collapse.prototype.addAriaAndCollapsedClass=function($element,$trigger){var isOpen=$element.hasClass("in");$element.attr("aria-expanded",isOpen),$trigger.toggleClass("collapsed",!isOpen).attr("aria-expanded",isOpen)};var old=$.fn.collapse;$.fn.collapse=Plugin,$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var $this=$(this);$this.attr("data-target")||e.preventDefault();var $target=getTargetFromTrigger($this),option=$target.data("bs.collapse")?"toggle":$this.data();Plugin.call($target,option)})}(jQuery),function($){"use strict";function getParent($this){var selector=$this.attr("data-target");selector||(selector=(selector=$this.attr("href"))&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function clearMenus(e){e&&3===e.which||($(backdrop).remove(),$(toggle).each(function(){var $this=$(this),$parent=getParent($this),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&$.contains($parent[0],e.target)||($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||($this.attr("aria-expanded","false"),$parent.removeClass("open").trigger($.Event("hidden.bs.dropdown",relatedTarget)))))}))}var backdrop=".dropdown-backdrop",toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.3.7",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$(document.createElement("div")).addClass("dropdown-backdrop").insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus").attr("aria-expanded","true"),$parent.toggleClass("open").trigger($.Event("shown.bs.dropdown",relatedTarget))}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive&&27!=e.which||isActive&&27==e.which)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var $items=$parent.find(".dropdown-menu li:not(.disabled):visible a");if($items.length){var index=$items.index(e.target);38==e.which&&index>0&&index--,40==e.which&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})},$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle,Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",Dropdown.prototype.keydown)}(jQuery),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){"use strict";var _colorpicker_index=0,_intToHex=function(dec){var result=Math.round(dec).toString(16);return 1===result.length&&(result="0"+result),result.toLowerCase()},_keycode={isPrint:function(keycode){return 32==keycode||keycode>=48&&keycode<=57||keycode>=65&&keycode<=90||keycode>=96&&keycode<=111||keycode>=186&&keycode<192||keycode>=219&&keycode<222},isHex:function(keycode){return keycode>=48&&keycode<=57||keycode>=65&&keycode<=70}},_layoutTable=function(layout,callback){var bitmap,x,y,width,height,columns,rows,index,cell,html,w,h,colspan,walked;for(layout.sort(function(a,b){return a.pos[1]===b.pos[1]?a.pos[0]-b.pos[0]:a.pos[1]-b.pos[1]}),width=0,height=0,$.each(layout,function(index,part){width=Math.max(width,part.pos[0]+part.pos[2]),height=Math.max(height,part.pos[1]+part.pos[3])}),bitmap=[],x=0;x<width;++x)bitmap.push([]);for(rows=[],columns=[],$.each(layout,function(index,part){for(x=0;x<part.pos[2];x+=1)columns[part.pos[0]+x]=!0;for(y=0;y<part.pos[3];y+=1)rows[part.pos[1]+y]=!0}),html="",cell=layout[index=0],y=0;y<height;++y){for(html+="<tr>",x=0;x<width;)if(void 0!==cell&&x===cell.pos[0]&&y===cell.pos[1]){for(html+=callback(cell,x,y),h=0;h<cell.pos[3];h+=1)for(w=0;w<cell.pos[2];w+=1)bitmap[x+w][y+h]=!0;x+=cell.pos[2],cell=layout[++index]}else{for(colspan=0,walked=!1;x<width&&void 0===bitmap[x][y]&&(void 0===cell||y<cell.pos[1]||y===cell.pos[1]&&x<cell.pos[0]);)!0===columns[x]&&(colspan+=1),walked=!0,x+=1;colspan>0?html+='<td colspan="'+colspan+'"></td>':walked||(x+=1)}html+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+html+"</tbody></table>"};return $.colorpicker=new function(){this.regional={"":{ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"}},this.swatchesNames={html:"HTML"},this.swatches={html:[{name:"black",r:0,g:0,b:0},{name:"dimgray",r:.4117647058823529,g:.4117647058823529,b:.4117647058823529},{name:"gray",r:.5019607843137255,g:.5019607843137255,b:.5019607843137255},{name:"darkgray",r:.6627450980392157,g:.6627450980392157,b:.6627450980392157},{name:"silver",r:.7529411764705882,g:.7529411764705882,b:.7529411764705882},{name:"lightgrey",r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},{name:"gainsboro",r:.8627450980392157,g:.8627450980392157,b:.8627450980392157},{name:"whitesmoke",r:.9607843137254902,g:.9607843137254902,b:.9607843137254902},{name:"white",r:1,g:1,b:1},{name:"rosybrown",r:.7372549019607844,g:.5607843137254902,b:.5607843137254902},{name:"indianred",r:.803921568627451,g:.3607843137254902,b:.3607843137254902},{name:"brown",r:.6470588235294118,g:.16470588235294117,b:.16470588235294117},{name:"firebrick",r:.6980392156862745,g:.13333333333333333,b:.13333333333333333},{name:"lightcoral",r:.9411764705882353,g:.5019607843137255,b:.5019607843137255},{name:"maroon",r:.5019607843137255,g:0,b:0},{name:"darkred",r:.5450980392156862,g:0,b:0},{name:"red",r:1,g:0,b:0},{name:"snow",r:1,g:.9803921568627451,b:.9803921568627451},{name:"salmon",r:.9803921568627451,g:.5019607843137255,b:.4470588235294118},{name:"mistyrose",r:1,g:.8941176470588236,b:.8823529411764706},{name:"tomato",r:1,g:.38823529411764707,b:.2784313725490196},{name:"darksalmon",r:.9137254901960784,g:.5882352941176471,b:.47843137254901963},{name:"orangered",r:1,g:.27058823529411763,b:0},{name:"coral",r:1,g:.4980392156862745,b:.3137254901960784},{name:"lightsalmon",r:1,g:.6274509803921569,b:.47843137254901963},{name:"sienna",r:.6274509803921569,g:.3215686274509804,b:.17647058823529413},{name:"seashell",r:1,g:.9607843137254902,b:.9333333333333333},{name:"chocolate",r:.8235294117647058,g:.4117647058823529,b:.11764705882352941},{name:"saddlebrown",r:.5450980392156862,g:.27058823529411763,b:.07450980392156863},{name:"sandybrown",r:.9568627450980393,g:.6431372549019608,b:.3764705882352941},{name:"peachpuff",r:1,g:.8549019607843137,b:.7254901960784313},{name:"peru",r:.803921568627451,g:.5215686274509804,b:.24705882352941178},{name:"linen",r:.9803921568627451,g:.9411764705882353,b:.9019607843137255},{name:"darkorange",r:1,g:.5490196078431373,b:0},{name:"bisque",r:1,g:.8941176470588236,b:.7686274509803922},{name:"burlywood",r:.8705882352941177,g:.7215686274509804,b:.5294117647058824},{name:"tan",r:.8235294117647058,g:.7058823529411765,b:.5490196078431373},{name:"antiquewhite",r:.9803921568627451,g:.9215686274509803,b:.8431372549019608},{name:"navajowhite",r:1,g:.8705882352941177,b:.6784313725490196},{name:"blanchedalmond",r:1,g:.9215686274509803,b:.803921568627451},{name:"papayawhip",r:1,g:.9372549019607843,b:.8352941176470589},{name:"orange",r:1,g:.6470588235294118,b:0},{name:"moccasin",r:1,g:.8941176470588236,b:.7098039215686275},{name:"wheat",r:.9607843137254902,g:.8705882352941177,b:.7019607843137254},{name:"oldlace",r:.9921568627450981,g:.9607843137254902,b:.9019607843137255},{name:"floralwhite",r:1,g:.9803921568627451,b:.9411764705882353},{name:"goldenrod",r:.8549019607843137,g:.6470588235294118,b:.12549019607843137},{name:"darkgoldenrod",r:.7215686274509804,g:.5254901960784314,b:.043137254901960784},{name:"cornsilk",r:1,g:.9725490196078431,b:.8627450980392157},{name:"gold",r:1,g:.8431372549019608,b:0},{name:"palegoldenrod",r:.9333333333333333,g:.9098039215686274,b:.6666666666666666},{name:"khaki",r:.9411764705882353,g:.9019607843137255,b:.5490196078431373},{name:"lemonchiffon",r:1,g:.9803921568627451,b:.803921568627451},{name:"darkkhaki",r:.7411764705882353,g:.7176470588235294,b:.4196078431372549},{name:"beige",r:.9607843137254902,g:.9607843137254902,b:.8627450980392157},{name:"lightgoldenrodyellow",r:.9803921568627451,g:.9803921568627451,b:.8235294117647058},{name:"olive",r:.5019607843137255,g:.5019607843137255,b:0},{name:"yellow",r:1,g:1,b:0},{name:"lightyellow",r:1,g:1,b:.8784313725490196},{name:"ivory",r:1,g:1,b:.9411764705882353},{name:"olivedrab",r:.4196078431372549,g:.5568627450980392,b:.13725490196078433},{name:"yellowgreen",r:.6039215686274509,g:.803921568627451,b:.19607843137254902},{name:"darkolivegreen",r:.3333333333333333,g:.4196078431372549,b:.1843137254901961},{name:"greenyellow",r:.6784313725490196,g:1,b:.1843137254901961},{name:"lawngreen",r:.48627450980392156,g:.9882352941176471,b:0},{name:"chartreuse",r:.4980392156862745,g:1,b:0},{name:"darkseagreen",r:.5607843137254902,g:.7372549019607844,b:.5607843137254902},{name:"forestgreen",r:.13333333333333333,g:.5450980392156862,b:.13333333333333333},{name:"limegreen",r:.19607843137254902,g:.803921568627451,b:.19607843137254902},{name:"lightgreen",r:.5647058823529412,g:.9333333333333333,b:.5647058823529412},{name:"palegreen",r:.596078431372549,g:.984313725490196,b:.596078431372549},{name:"darkgreen",r:0,g:.39215686274509803,b:0},{name:"green",r:0,g:.5019607843137255,b:0},{name:"lime",r:0,g:1,b:0},{name:"honeydew",r:.9411764705882353,g:1,b:.9411764705882353},{name:"mediumseagreen",r:.23529411764705882,g:.7019607843137254,b:.44313725490196076},{name:"seagreen",r:.1803921568627451,g:.5450980392156862,b:.3411764705882353},{name:"springgreen",r:0,g:1,b:.4980392156862745},{name:"mintcream",r:.9607843137254902,g:1,b:.9803921568627451},{name:"mediumspringgreen",r:0,g:.9803921568627451,b:.6039215686274509},{name:"mediumaquamarine",r:.4,g:.803921568627451,b:.6666666666666666},{name:"aquamarine",r:.4980392156862745,g:1,b:.8313725490196079},{name:"turquoise",r:.25098039215686274,g:.8784313725490196,b:.8156862745098039},{name:"lightseagreen",r:.12549019607843137,g:.6980392156862745,b:.6666666666666666},{name:"mediumturquoise",r:.2823529411764706,g:.8196078431372549,b:.8},{name:"darkslategray",r:.1843137254901961,g:.30980392156862746,b:.30980392156862746},{name:"paleturquoise",r:.6862745098039216,g:.9333333333333333,b:.9333333333333333},{name:"teal",r:0,g:.5019607843137255,b:.5019607843137255},{name:"darkcyan",r:0,g:.5450980392156862,b:.5450980392156862},{name:"darkturquoise",r:0,g:.807843137254902,b:.8196078431372549},{name:"aqua",r:0,g:1,b:1},{name:"cyan",r:0,g:1,b:1},{name:"lightcyan",r:.8784313725490196,g:1,b:1},{name:"azure",r:.9411764705882353,g:1,b:1},{name:"cadetblue",r:.37254901960784315,g:.6196078431372549,b:.6274509803921569},{name:"powderblue",r:.6901960784313725,g:.8784313725490196,b:.9019607843137255},{name:"lightblue",r:.6784313725490196,g:.8470588235294118,b:.9019607843137255},{name:"deepskyblue",r:0,g:.7490196078431373,b:1},{name:"skyblue",r:.5294117647058824,g:.807843137254902,b:.9215686274509803},{name:"lightskyblue",r:.5294117647058824,g:.807843137254902,b:.9803921568627451},{name:"steelblue",r:.27450980392156865,g:.5098039215686274,b:.7058823529411765},{name:"aliceblue",r:.9411764705882353,g:.9725490196078431,b:1},{name:"dodgerblue",r:.11764705882352941,g:.5647058823529412,b:1},{name:"slategray",r:.4392156862745098,g:.5019607843137255,b:.5647058823529412},{name:"lightslategray",r:.4666666666666667,g:.5333333333333333,b:.6},{name:"lightsteelblue",r:.6901960784313725,g:.7686274509803922,b:.8705882352941177},{name:"cornflowerblue",r:.39215686274509803,g:.5843137254901961,b:.9294117647058824},{name:"royalblue",r:.2549019607843137,g:.4117647058823529,b:.8823529411764706},{name:"midnightblue",r:.09803921568627451,g:.09803921568627451,b:.4392156862745098},{name:"lavender",r:.9019607843137255,g:.9019607843137255,b:.9803921568627451},{name:"navy",r:0,g:0,b:.5019607843137255},{name:"darkblue",r:0,g:0,b:.5450980392156862},{name:"mediumblue",r:0,g:0,b:.803921568627451},{name:"blue",r:0,g:0,b:1},{name:"ghostwhite",r:.9725490196078431,g:.9725490196078431,b:1},{name:"darkslateblue",r:.2823529411764706,g:.23921568627450981,b:.5450980392156862},{name:"slateblue",r:.41568627450980394,g:.35294117647058826,b:.803921568627451},{name:"mediumslateblue",r:.4823529411764706,g:.40784313725490196,b:.9333333333333333},{name:"mediumpurple",r:.5764705882352941,g:.4392156862745098,b:.8588235294117647},{name:"blueviolet",r:.5411764705882353,g:.16862745098039217,b:.8862745098039215},{name:"indigo",r:.29411764705882354,g:0,b:.5098039215686274},{name:"darkorchid",r:.6,g:.19607843137254902,b:.8},{name:"darkviolet",r:.5803921568627451,g:0,b:.8274509803921568},{name:"mediumorchid",r:.7294117647058823,g:.3333333333333333,b:.8274509803921568},{name:"thistle",r:.8470588235294118,g:.7490196078431373,b:.8470588235294118},{name:"plum",r:.8666666666666667,g:.6274509803921569,b:.8666666666666667},{name:"violet",r:.9333333333333333,g:.5098039215686274,b:.9333333333333333},{name:"purple",r:.5019607843137255,g:0,b:.5019607843137255},{name:"darkmagenta",r:.5450980392156862,g:0,b:.5450980392156862},{name:"magenta",r:1,g:0,b:1},{name:"fuchsia",r:1,g:0,b:1},{name:"orchid",r:.8549019607843137,g:.4392156862745098,b:.8392156862745098},{name:"mediumvioletred",r:.7803921568627451,g:.08235294117647059,b:.5215686274509804},{name:"deeppink",r:1,g:.0784313725490196,b:.5764705882352941},{name:"hotpink",r:1,g:.4117647058823529,b:.7058823529411765},{name:"palevioletred",r:.8588235294117647,g:.4392156862745098,b:.5764705882352941},{name:"lavenderblush",r:1,g:.9411764705882353,b:.9607843137254902},{name:"crimson",r:.8627450980392157,g:.0784313725490196,b:.23529411764705882},{name:"pink",r:1,g:.7529411764705882,b:.796078431372549},{name:"lightpink",r:1,g:.7137254901960784,b:.7568627450980392}]},this.writers={"#HEX":function(color,that){return that._formatColor("#rxgxbx",color)},"#HEX3":function(color,that){var hex3=$.colorpicker.writers.HEX3(color);return!1!==hex3&&"#"+hex3},HEX:function(color,that){return that._formatColor("rxgxbx",color)},HEX3:function(color,that){var rgb=color.getRGB(),r=Math.round(255*rgb.r),g=Math.round(255*rgb.g),b=Math.round(255*rgb.b);return r>>>4==(r&=15)&&g>>>4==(g&=15)&&b>>>4==(b&=15)&&r.toString(16)+g.toString(16)+b.toString(16)},"#HEXA":function(color,that){return that._formatColor("#rxgxbxax",color)},"#HEXA4":function(color,that){var hexa4=$.colorpicker.writers.HEXA4(color,that);return!1!==hexa4&&"#"+hexa4},HEXA:function(color,that){return that._formatColor("rxgxbxax",color)},HEXA4:function(color,that){var a=Math.round(255*color.getAlpha());return a>>>4==(a&=15)&&$.colorpicker.writers.HEX3(color,that)+a.toString(16)},RGB:function(color,that){return color.getAlpha()>=1&&that._formatColor("rgb(rd,gd,bd)",color)},RGBA:function(color,that){return that._formatColor("rgba(rd,gd,bd,af)",color)},"RGB%":function(color,that){return color.getAlpha()>=1&&that._formatColor("rgb(rp%,gp%,bp%)",color)},"RGBA%":function(color,that){return that._formatColor("rgba(rp%,gp%,bp%,af)",color)},HSL:function(color,that){return color.getAlpha()>=1&&that._formatColor("hsl(hd,sd,vd)",color)},HSLA:function(color,that){return that._formatColor("hsla(hd,sd,vd,af)",color)},"HSL%":function(color,that){return color.getAlpha()>=1&&that._formatColor("hsl(hp%,sp%,vp%)",color)},"HSLA%":function(color,that){return that._formatColor("hsla(hp%,sp%,vp%,af)",color)},NAME:function(color,that){return that._closestName(color)},EXACT:function(color,that){return that._exactName(color)}},this.parsers={"":function(color){if(""===color)return new $.colorpicker.Color},NAME:function(color,that){var c=that._getSwatch($.trim(color));if(c)return new $.colorpicker.Color(c.r,c.g,c.b)},RGBA:function(color){var m=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(color);if(m)return new $.colorpicker.Color(m[1]/255,m[2]/255,m[3]/255,parseFloat(m[4]))},"RGBA%":function(color){var m=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(color);if(m)return new $.colorpicker.Color(m[1]/100,m[2]/100,m[3]/100,m[4]/100)},HSLA:function(color){var m=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(color);if(m)return(new $.colorpicker.Color).setHSL(m[1]/255,m[2]/255,m[3]/255).setAlpha(parseFloat(m[4]))},"HSLA%":function(color){var m=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(color);if(m)return(new $.colorpicker.Color).setHSL(m[1]/100,m[2]/100,m[3]/100).setAlpha(m[4]/100)},"#HEX":function(color){var m=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(color);if(m)return new $.colorpicker.Color(parseInt(m[1],16)/255,parseInt(m[2],16)/255,parseInt(m[3],16)/255)},"#HEX3":function(color){var m=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(color);if(m)return new $.colorpicker.Color(parseInt(String(m[1])+m[1],16)/255,parseInt(String(m[2])+m[2],16)/255,parseInt(String(m[3])+m[3],16)/255)},HEX:function(color){var m=/^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(color);if(m)return new $.colorpicker.Color(parseInt(m[1],16)/255,parseInt(m[2],16)/255,parseInt(m[3],16)/255)},HEX3:function(color){var m=/^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(color);if(m)return new $.colorpicker.Color(parseInt(String(m[1])+m[1],16)/255,parseInt(String(m[2])+m[2],16)/255,parseInt(String(m[3])+m[3],16)/255)},"#HEXA":function(color){var m=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(color);if(m)return new $.colorpicker.Color(parseInt(m[1],16)/255,parseInt(m[2],16)/255,parseInt(m[3],16)/255,parseInt(m[4],16)/255)},"#HEXA4":function(color){var m=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(color);if(m)return new $.colorpicker.Color(parseInt(String(m[1])+m[1],16)/255,parseInt(String(m[2])+m[2],16)/255,parseInt(String(m[3])+m[3],16)/255,parseInt(String(m[4])+m[4],16)/255)},HEXA:function(color){var m=/^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(color);if(m)return new $.colorpicker.Color(parseInt(m[1],16)/255,parseInt(m[2],16)/255,parseInt(m[3],16)/255,parseInt(m[4],16)/255)},HEXA4:function(color){var m=/^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(color);if(m)return new $.colorpicker.Color(parseInt(String(m[1])+m[1],16)/255,parseInt(String(m[2])+m[2],16)/255,parseInt(String(m[3])+m[3],16)/255,parseInt(String(m[4])+m[4],16)/255)}},this.partslists={full:["header","map","bar","hex","hsv","rgb","alpha","lab","cmyk","preview","swatches","footer"],popup:["map","bar","hex","hsv","rgb","alpha","preview","footer"],draggable:["header","map","bar","hex","hsv","rgb","alpha","preview","footer"],inline:["map","bar","hex","hsv","rgb","alpha","preview"]},this.limits={websafe:function(color){color.limit(6)},nibble:function(color){color.limit(16)},binary:function(color){color.limit(2)},name:function(color,that){var swatch=that._getSwatch(that._closestName(color));color.setRGB(swatch.r,swatch.g,swatch.b)}},this.parts={header:function(inst){var part=null,_html=function(){var html='<span class="ui-dialog-title">'+(inst.options.title||inst._getRegional("title"))+"</span>";return!inst.inline&&inst.options.showCloseButton&&(html+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a>'),'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+html+"</div>"},_onclick=function(event){event.preventDefault(),inst.close(inst.options.revert)};this.init=function(){part=$(_html()).prependTo(inst.dialog);var close=$(".ui-dialog-titlebar-close",part);if(inst._hoverable(close),inst._focusable(close),close.on("click",_onclick),!inst.inline&&inst.options.draggable){var draggableOptions={handle:part};inst.options.containment&&(draggableOptions.containment=inst.options.containment),inst.dialog.draggable(draggableOptions)}},this.disable=function(disable){$(".ui-dialog-titlebar-close",part)[disable?"off":"on"]("click",_onclick)}},map:function(inst){var pointer,width,height,_mousedown,_mouseup,_mousemove,_keydown,_html,that=this,part=null,layers={};_mousedown=function(event){if(inst.opened){var offset=layers.p.offset(),x=event.pageX-offset.left,y=event.pageY-offset.top;x>=0&&x<width&&y>=0&&y<height&&(event.stopImmediatePropagation(),event.preventDefault(),part.off("mousedown",_mousedown).focus(),$(document).on("mouseup",_mouseup),$(document).on("mousemove",_mousemove),_mousemove(event))}},_mouseup=function(event){event.stopImmediatePropagation(),event.preventDefault(),$(document).off("mouseup",_mouseup),$(document).off("mousemove",_mousemove),part.on("mousedown",_mousedown),inst._callback("stop")},_mousemove=function(event){if(event.stopImmediatePropagation(),event.preventDefault(),event.pageX!==that.x||event.pageY!==that.y){that.x=event.pageX,that.y=event.pageY;var offset=layers.p.offset(),x=event.pageX-offset.left,y=event.pageY-offset.top;switch(x=Math.max(0,Math.min(x/width,1)),y=Math.max(0,Math.min(y/height,1)),inst.mode){case"h":inst.color.setHSV(null,x,1-y);break;case"s":case"a":inst.color.setHSV(x,null,1-y);break;case"v":inst.color.setHSV(x,1-y,null);break;case"r":inst.color.setRGB(null,1-y,x);break;case"g":inst.color.setRGB(1-y,null,x);break;case"b":inst.color.setRGB(x,1-y,null)}inst._change(!1)}},_keydown=function(event){var change,value,x_channel_map={h:"s",s:"h",v:"h",r:"b",g:"b",b:"r",a:"h"},x_change={37:-1,39:1},y_channel_map={h:"v",s:"v",v:"s",r:"g",g:"r",b:"g",a:"v"},y_change={38:1,40:-1},set={35:0,36:1};void 0!==x_change[event.which]?(value=inst.color.getChannel(x_channel_map[inst.mode])*width,change=x_change[event.which],event.shiftKey?change*=10:(event.ctrlKey||event.metaKey)&&(change*=width),inst.color.setChannel(x_channel_map[inst.mode],(value+change)/width),inst._change(!1)):void 0!==y_change[event.which]?(value=inst.color.getChannel(y_channel_map[inst.mode])*height,change=y_change[event.which],event.shiftKey?change*=10:(event.ctrlKey||event.metaKey)&&(change*=height),inst.color.setChannel(y_channel_map[inst.mode],(value+change)/height),inst._change(!1)):void 0!==set[event.which]&&(inst.color.setChannel(x_channel_map[inst.mode],1-set[event.which]),inst.color.setChannel(y_channel_map[inst.mode],set[event.which]),inst._change(!1))},_html=function(){return'<div class="ui-colorpicker-map ui-colorpicker-map-'+(inst.options.part.map.size||256)+' ui-colorpicker-border" taonex="0"><span class="ui-colorpicker-map-layer-1">&nbsp;</span><span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(inst.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>'},this.init=function(){(part=$(_html()).appendTo($(".ui-colorpicker-map-container",inst.dialog))).on("mousedown",_mousedown),part.on("keydown",_keydown),layers[1]=$(".ui-colorpicker-map-layer-1",part),layers[2]=$(".ui-colorpicker-map-layer-2",part),layers.a=$(".ui-colorpicker-map-layer-alpha",part),layers.p=$(".ui-colorpicker-map-layer-pointer",part),width=layers.p.width(),height=layers.p.height(),pointer=$(".ui-colorpicker-map-pointer",part)},this.update=function(){var step=65*(inst.options.part.map.size||256)/64;switch(inst.mode){case"h":layers[1].css({"background-position":"0 0",opacity:""}).show(),layers[2].hide();break;case"s":case"a":layers[1].css({"background-position":"0 "+-step+"px",opacity:""}).show(),layers[2].css({"background-position":"0 "+2*-step+"px",opacity:""}).show();break;case"v":part.css("background-color","black"),layers[1].css({"background-position":"0 "+3*-step+"px",opacity:""}).show(),layers[2].hide();break;case"r":layers[1].css({"background-position":"0 "+4*-step+"px",opacity:""}).show(),layers[2].css({"background-position":"0 "+5*-step+"px",opacity:""}).show();break;case"g":layers[1].css({"background-position":"0 "+6*-step+"px",opacity:""}).show(),layers[2].css({"background-position":"0 "+7*-step+"px",opacity:""}).show();break;case"b":layers[1].css({"background-position":"0 "+8*-step+"px",opacity:""}).show(),layers[2].css({"background-position":"0 "+9*-step+"px",opacity:""}).show()}that.repaint()},this.repaint=function(){var x=0,y=0;switch(inst.mode){case"h":x=(hsv=inst.color.getHSV()).s*width,y=(1-hsv.v)*width,part.css("background-color",inst.color.copy().setHSV(null,1,1).toCSS());break;case"s":case"a":x=(hsv=inst.color.getHSV()).h*width,y=(1-hsv.v)*width,layers[2].css("opacity",1-hsv.s);break;case"v":var hsv=inst.color.getHSV();x=hsv.h*width,y=(1-hsv.s)*width,layers[1].css("opacity",hsv.v);break;case"r":x=(rgb=inst.color.getRGB()).b*width,y=(1-rgb.g)*width,layers[2].css("opacity",rgb.r);break;case"g":x=(rgb=inst.color.getRGB()).b*width,y=(1-rgb.r)*width,layers[2].css("opacity",rgb.g);break;case"b":var rgb=inst.color.getRGB();x=rgb.r*width,y=(1-rgb.g)*width,layers[2].css("opacity",rgb.b)}inst.options.alpha&&layers.a.css("opacity",1-inst.color.getAlpha()),pointer.css({left:x-7,top:y-7})},this.disable=function(disable){part[disable?"off":"on"]("mousedown",_mousedown),part[disable?"off":"on"]("keydown",_keydown)}},bar:function(inst){var pointer,width,height,_mousedown,_mouseup,_mousemove,_keydown,_html,that=this,part=null,layers={};_mousedown=function(event){if(inst.opened){var offset=layers.p.offset(),x=event.pageX-offset.left,y=event.pageY-offset.top;x>=0&&x<width&&y>=0&&y<height&&(event.stopImmediatePropagation(),event.preventDefault(),part.off("mousedown",_mousedown).focus(),$(document).on("mouseup",_mouseup),$(document).on("mousemove",_mousemove),_mousemove(event))}},_mouseup=function(event){event.stopImmediatePropagation(),event.preventDefault(),$(document).off("mouseup",_mouseup),$(document).off("mousemove",_mousemove),part.on("mousedown",_mousedown),inst._callback("stop")},_mousemove=function(event){if(event.stopImmediatePropagation(),event.preventDefault(),event.pageY!==that.y){that.y=event.pageY;var offset=layers.p.offset(),y=event.pageY-offset.top;switch(y=Math.max(0,Math.min(y/height,1)),inst.mode){case"h":inst.color.setHSV(1-y,null,null);break;case"s":inst.color.setHSV(null,1-y,null);break;case"v":inst.color.setHSV(null,null,1-y);break;case"r":inst.color.setRGB(1-y,null,null);break;case"g":inst.color.setRGB(null,1-y,null);break;case"b":inst.color.setRGB(null,null,1-y);break;case"a":inst.color.setAlpha(1-y)}inst._change(!1)}},_keydown=function(event){var change,value,set={35:0,36:1};void 0!==(change={38:1,40:-1,33:10,34:-10})[event.which]?(value=inst.color.getChannel(inst.mode)*height,change=change[event.which],event.shiftKey?change*=10:(event.ctrlKey||event.metaKey)&&(change*=height),inst.color.setChannel(inst.mode,(value+change)/height),inst._change(!1)):void 0!==set[event.which]&&(inst.color.setChannel(inst.mode,set[event.which]),inst._change(!1))},_html=function(){var html='<div class="ui-colorpicker-bar ui-colorpicker-bar-'+(inst.options.part.bar.size||256)+'  ui-colorpicker-border" taonex="0"><span class="ui-colorpicker-bar-layer-1">&nbsp;</span><span class="ui-colorpicker-bar-layer-2">&nbsp;</span><span class="ui-colorpicker-bar-layer-3">&nbsp;</span><span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';return inst.options.alpha&&(html+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span><span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>'),html+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>'},this.init=function(){(part=$(_html()).appendTo($(".ui-colorpicker-bar-container",inst.dialog))).on("mousedown",_mousedown),part.on("keydown",_keydown),layers[1]=$(".ui-colorpicker-bar-layer-1",part),layers[2]=$(".ui-colorpicker-bar-layer-2",part),layers[3]=$(".ui-colorpicker-bar-layer-3",part),layers[4]=$(".ui-colorpicker-bar-layer-4",part),layers.a=$(".ui-colorpicker-bar-layer-alpha",part),layers.ab=$(".ui-colorpicker-bar-layer-alphabar",part),layers.p=$(".ui-colorpicker-bar-layer-pointer",part),width=layers.p.width(),height=layers.p.height(),pointer=$(".ui-colorpicker-bar-pointer",part)},this.update=function(){var step=65*(inst.options.part.bar.size||256)/64;switch(inst.mode){case"h":case"s":case"v":case"r":case"g":case"b":layers.a.show(),layers.ab.hide();break;case"a":layers.a.hide(),layers.ab.show()}switch(inst.mode){case"h":layers[1].css({"background-position":"0 0",opacity:""}).show(),layers[2].hide(),layers[3].hide(),layers[4].hide();break;case"s":layers[1].css({"background-position":"0 "+-step+"px",opacity:""}).show(),layers[2].css({"background-position":"0 "+2*-step+"px",opacity:""}).show(),layers[3].hide(),layers[4].hide();break;case"v":layers[1].css({"background-position":"0 "+2*-step+"px",opacity:""}).show(),layers[2].hide(),layers[3].hide(),layers[4].hide();break;case"r":layers[1].css({"background-position":"0 "+6*-step+"px",opacity:""}).show(),layers[2].css({"background-position":"0 "+5*-step+"px",opacity:""}).show(),layers[3].css({"background-position":"0 "+3*-step+"px",opacity:""}).show(),layers[4].css({"background-position":"0 "+4*-step+"px",opacity:""}).show();break;case"g":layers[1].css({"background-position":"0 "+10*-step+"px",opacity:""}).show(),layers[2].css({"background-position":"0 "+9*-step+"px",opacity:""}).show(),layers[3].css({"background-position":"0 "+7*-step+"px",opacity:""}).show(),layers[4].css({"background-position":"0 "+8*-step+"px",opacity:""}).show();break;case"b":layers[1].css({"background-position":"0 "+14*-step+"px",opacity:""}).show(),layers[2].css({"background-position":"0 "+13*-step+"px",opacity:""}).show(),layers[3].css({"background-position":"0 "+11*-step+"px",opacity:""}).show(),layers[4].css({"background-position":"0 "+12*-step+"px",opacity:""}).show();break;case"a":layers[1].hide(),layers[2].hide(),layers[3].hide(),layers[4].hide()}that.repaint()},this.repaint=function(){var y=0;switch(inst.mode){case"h":y=(1-inst.color.getHSV().h)*height;break;case"s":var hsv=inst.color.getHSV();y=(1-hsv.s)*height,layers[2].css("opacity",1-hsv.v),part.css("background-color",inst.color.copy().setHSV(null,1,null).toCSS());break;case"v":y=(1-inst.color.getHSV().v)*height,part.css("background-color",inst.color.copy().setHSV(null,null,1).toCSS());break;case"r":y=(1-(rgb=inst.color.getRGB()).r)*height,layers[2].css("opacity",Math.max(0,rgb.b-rgb.g)),layers[3].css("opacity",Math.max(0,rgb.g-rgb.b)),layers[4].css("opacity",Math.min(rgb.b,rgb.g));break;case"g":y=(1-(rgb=inst.color.getRGB()).g)*height,layers[2].css("opacity",Math.max(0,rgb.b-rgb.r)),layers[3].css("opacity",Math.max(0,rgb.r-rgb.b)),layers[4].css("opacity",Math.min(rgb.r,rgb.b));break;case"b":var rgb=inst.color.getRGB();y=(1-rgb.b)*height,layers[2].css("opacity",Math.max(0,rgb.r-rgb.g)),layers[3].css("opacity",Math.max(0,rgb.g-rgb.r)),layers[4].css("opacity",Math.min(rgb.r,rgb.g));break;case"a":y=(1-inst.color.getAlpha())*height,part.css("background-color",inst.color.copy().toCSS())}"a"!==inst.mode&&layers.a.css("opacity",1-inst.color.getAlpha()),pointer.css("top",y-3)},this.disable=function(disable){part[disable?"off":"on"]("mousedown",_mousedown),part[disable?"off":"on"]("keydown",_keydown)}},preview:function(inst){var both,initial,initial_alpha,current,current_alpha,part=null,onclick=function(){inst.color=inst.currentColor.copy(),inst._change()};this.init=function(){part=$('<div class="ui-colorpicker-preview ui-colorpicker-border"><div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div><div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div></div>').appendTo($(".ui-colorpicker-preview-container",inst.dialog)),$(".ui-colorpicker-preview-initial",part).on("click",onclick),initial=$(".ui-colorpicker-preview-initial",part),initial_alpha=$(".ui-colorpicker-preview-initial-alpha",part),current=$(".ui-colorpicker-preview-current",part),current_alpha=$(".ui-colorpicker-preview-current-alpha",part),both=$(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",part)},this.update=function(){both[inst.options.alpha?"show":"hide"](),this.repaint()},this.repaint=function(){initial.css("background-color",inst.currentColor.set?inst.currentColor.toCSS():"").attr("title",inst.currentColor.set?inst.currentColor.toCSS():""),initial_alpha.css("opacity",1-inst.currentColor.getAlpha()),current.css("background-color",inst.color.set?inst.color.toCSS():"").attr("title",inst.color.set?inst.color.toCSS():""),current_alpha.css("opacity",1-inst.color.getAlpha())},this.disable=function(disable){$(".ui-colorpicker-preview-initial",part)[disable?"off":"on"]("click",onclick)}},hsv:function(inst){var _html,part=null,inputs={};_html=function(){var html="";return inst.options.hsv&&(html+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+inst._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div><div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+inst._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+inst._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-hsv">'+html+"</div>"},this.init=function(){part=$(_html()).appendTo($(".ui-colorpicker-hsv-container",inst.dialog)),$(".ui-colorpicker-mode",part).click(function(){inst.mode=$(this).val(),inst._updateAllParts()}),inputs.h=$(".ui-colorpicker-hsv-h .ui-colorpicker-number",part),inputs.s=$(".ui-colorpicker-hsv-s .ui-colorpicker-number",part),inputs.v=$(".ui-colorpicker-hsv-v .ui-colorpicker-number",part),$(".ui-colorpicker-number",part).on("change keyup",function(){inst.color.setHSV(inputs.h.val()/360,inputs.s.val()/100,inputs.v.val()/100),inst._change()})},this.repaint=function(){var hsv=inst.color.getHSV();inputs.h.val(Math.round(360*hsv.h)),inputs.s.val(Math.round(100*hsv.s)),inputs.v.val(Math.round(100*hsv.v))},this.update=function(){$(".ui-colorpicker-mode",part).each(function(){var $this=$(this);$this.prop("checked",$this.val()===inst.mode)}),this.repaint()},this.disable=function(disable){$(":input",part).prop("disabled",disable)}},rgb:function(inst){var _html,part=null,inputs={};_html=function(){var html="";return inst.options.rgb&&(html+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+inst._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+inst._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+inst._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'),'<div class="ui-colorpicker-rgb">'+html+"</div>"},this.init=function(){part=$(_html()).appendTo($(".ui-colorpicker-rgb-container",inst.dialog)),$(".ui-colorpicker-mode",part).click(function(){inst.mode=$(this).val(),inst._updateAllParts()}),inputs.r=$(".ui-colorpicker-rgb-r .ui-colorpicker-number",part),inputs.g=$(".ui-colorpicker-rgb-g .ui-colorpicker-number",part),inputs.b=$(".ui-colorpicker-rgb-b .ui-colorpicker-number",part),$(".ui-colorpicker-number",part).on("change keyup",function(){$(".ui-colorpicker-rgb-r .ui-colorpicker-number",part).val();inst.color.setRGB(inputs.r.val()/255,inputs.g.val()/255,inputs.b.val()/255),inst._change()})},this.repaint=function(){var rgb=inst.color.getRGB();inputs.r.val(Math.round(255*rgb.r)),inputs.g.val(Math.round(255*rgb.g)),inputs.b.val(Math.round(255*rgb.b))},this.update=function(){$(".ui-colorpicker-mode",part).each(function(){var $this=$(this);$this.prop("checked",$this.val()===inst.mode)}),this.repaint()},this.disable=function(disable){$(":input",part).prop("disabled",disable)}},lab:function(inst){var part=null,inputs={},html=function(){var html="";return inst.options.hsv&&(html+='<div class="ui-colorpicker-lab-l"><label>'+inst._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div><div class="ui-colorpicker-lab-a"><label>'+inst._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div><div class="ui-colorpicker-lab-b"><label>'+inst._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'),'<div class="ui-colorpicker-lab">'+html+"</div>"};this.init=function(){part=$(html()).appendTo($(".ui-colorpicker-lab-container",inst.dialog)),inputs.l=$(".ui-colorpicker-lab-l .ui-colorpicker-number",part),inputs.a=$(".ui-colorpicker-lab-a .ui-colorpicker-number",part),inputs.b=$(".ui-colorpicker-lab-b .ui-colorpicker-number",part),$(".ui-colorpicker-number",part).on("change keyup",function(event){inst.color.setLAB(parseInt(inputs.l.val(),10)/100,(parseInt(inputs.a.val(),10)+128)/255,(parseInt(inputs.b.val(),10)+128)/255),inst._change()})},this.repaint=function(){var lab=inst.color.getLAB();inputs.l.val(Math.round(100*lab.l)),inputs.a.val(Math.round(255*lab.a)-128),inputs.b.val(Math.round(255*lab.b)-128)},this.update=this.repaint,this.disable=function(disable){$(":input",part).prop("disabled",disable)}},cmyk:function(inst){var part=null,inputs={},html=function(){var html="";return inst.options.hsv&&(html+='<div class="ui-colorpicker-cmyk-c"><label>'+inst._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-m"><label>'+inst._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-y"><label>'+inst._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-k"><label>'+inst._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-cmyk">'+html+"</div>"};this.init=function(){part=$(html()).appendTo($(".ui-colorpicker-cmyk-container",inst.dialog)),inputs.c=$(".ui-colorpicker-cmyk-c .ui-colorpicker-number",part),inputs.m=$(".ui-colorpicker-cmyk-m .ui-colorpicker-number",part),inputs.y=$(".ui-colorpicker-cmyk-y .ui-colorpicker-number",part),inputs.k=$(".ui-colorpicker-cmyk-k .ui-colorpicker-number",part),$(".ui-colorpicker-number",part).on("change keyup",function(event){inst.color.setCMYK(parseInt(inputs.c.val(),10)/100,parseInt(inputs.m.val(),10)/100,parseInt(inputs.y.val(),10)/100,parseInt(inputs.k.val(),10)/100),inst._change()})},this.repaint=function(){var cmyk=inst.color.getCMYK();inputs.c.val(Math.round(100*cmyk.c)),inputs.m.val(Math.round(100*cmyk.m)),inputs.y.val(Math.round(100*cmyk.y)),inputs.k.val(Math.round(100*cmyk.k))},this.update=this.repaint,this.disable=function(disable){$(":input",part).prop("disabled",disable)}},alpha:function(inst){var input,part=null,html=function(){var html="";return inst.options.alpha&&(html+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+inst._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-alpha">'+html+"</div>"};this.init=function(){part=$(html()).appendTo($(".ui-colorpicker-alpha-container",inst.dialog)),$(".ui-colorpicker-mode",part).click(function(){inst.mode=$(this).val(),inst._updateAllParts()}),input=$(".ui-colorpicker-a .ui-colorpicker-number",part),$(".ui-colorpicker-number",part).on("change keyup",function(){inst.color.setAlpha(input.val()/100),inst._change()})},this.update=function(){$(".ui-colorpicker-mode",part).each(function(){$(this).prop("checked",$(this).val()===inst.mode)}),this.repaint()},this.repaint=function(){input.val(Math.round(100*inst.color.getAlpha()))},this.disable=function(disable){$(":input",part).prop("disabled",disable)}},hex:function(inst){var part=null,inputs={},parseHex=function(color){var c,m;return(m=/^#?([a-fA-F0-9]{1,3})$/.exec(color))?(c=parseInt(m[1],16),new $.colorpicker.Color((c>>8&15)/15,(c>>4&15)/15,(15&c)/15)):(m=/^#?([a-fA-F0-9]{1,6})$/.exec(color))?(c=parseInt(m[1],16),new $.colorpicker.Color((c>>16&255)/255,(c>>8&255)/255,(255&c)/255)):new $.colorpicker.Color},html=function(){var html="";return inst.options.alpha&&(html+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>'),'<div class="ui-colorpicker-hex"><label>#</label>'+(html+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>')+"</div>"};this.init=function(){part=$(html()).appendTo($(".ui-colorpicker-hex-container",inst.dialog)),inputs.color=$(".ui-colorpicker-hex-input",part),inputs.alpha=$(".ui-colorpicker-hex-alpha",part),inputs.color.on("keydown keyup",function(e){return e.ctrlKey||e.metaKey||_keycode.isHex(e.which)||!_keycode.isPrint(e.which)}),inputs.color.on("change",function(){/[^a-fA-F0-9]/.test(inputs.color.val())&&inputs.color.val(inputs.color.val().replace(/[^a-fA-F0-9]/g,""))}),inputs.color.on("change keyup",function(){inst.color=parseHex(inputs.color.val()).setAlpha(inst.color.getAlpha()),inst._change()}),inputs.alpha.on("keydown keyup",function(e){return e.ctrlKey||e.metaKey||_keycode.isHex(e.which)||!_keycode.isPrint(e.which)}),inputs.alpha.on("change",function(){/[^a-fA-F0-9]/.test(inputs.alpha)&&inputs.alpha.val(inputs.alpha.val().replace(/[^a-fA-F0-9]/g,""))}),inputs.alpha.on("change keyup",function(){inst.color.setAlpha(parseInt(inputs.alpha.val(),16)/255),inst._change()})},this.repaint=function(){inputs.color.is(":focus")||inputs.color.val(inst.color.toHex(!0)),inputs.alpha.is(":focus")||inputs.alpha.val(_intToHex(255*inst.color.getAlpha()))},this.update=this.repaint,this.disable=function(disable){$(":input",part).prop("disabled",disable)}},swatches:function(inst){var part=null,html=function(){var html="";return inst._eachSwatch(function(name,color){var css=new $.colorpicker.Color(color.r,color.g,color.b).toCSS();html+='<div class="ui-colorpicker-swatch" style="background-color:'+css+'" title="'+name+'"></div>'}),'<div class="ui-colorpicker-swatches ui-colorpicker-border" style="width:'+inst.options.swatchesWidth+'px">'+html+"</div>"},onclick=function(){inst.color=inst._parseColor($(this).css("background-color"))||new $.colorpicker.Color,inst._change()};this.init=function(){part=$(html()),$(".ui-colorpicker-swatches-container",inst.dialog).html(part),$(".ui-colorpicker-swatch",part).on("click",onclick)},this.disable=function(disable){$(".ui-colorpicker-swatch",part)[disable?"off":"on"]("click",onclick)}},footer:function(inst){var part=null,id_transparent="ui-colorpicker-special-transparent-"+inst.colorpicker_index,id_none="ui-colorpicker-special-none-"+inst.colorpicker_index,html=function(){var html="";return(inst.options.alpha||!inst.inline&&inst.options.showNoneButton)&&(html+='<div class="ui-colorpicker-buttonset">',inst.options.alpha&&(html+='<input type="radio" name="ui-colorpicker-special" id="'+id_transparent+'" class="ui-colorpicker-special-transparent"/><label for="'+id_transparent+'">'+inst._getRegional("transparent")+"</label>"),!inst.inline&&inst.options.showNoneButton&&(html+='<input type="radio" name="ui-colorpicker-special" id="'+id_none+'" class="ui-colorpicker-special-none"><label for="'+id_none+'">'+inst._getRegional("none")+"</label>"),html+="</div>"),inst.inline||(html+='<div class="ui-dialog-buttonset">',inst.options.showCancelButton&&(html+='<button class="ui-colorpicker-cancel">'+inst._getRegional("cancel")+"</button>"),html+='<button class="ui-colorpicker-ok">'+inst._getRegional("ok")+"</button>",html+="</div>"),'<div class="ui-dialog-buttonpane ui-widget-content">'+html+"</div>"};this.init=function(){part=$(html()).appendTo(inst.dialog),$(".ui-colorpicker-ok",part).button().click(function(){inst.close()}),$(".ui-colorpicker-cancel",part).button().click(function(){inst.close(!0)}),$(".ui-colorpicker-buttonset",part)[$.fn.controlgroup?"controlgroup":"buttonset"](),$(".ui-colorpicker-special-color",part).click(function(){inst._change()}),$("#"+id_none,part).click(function(){inst.color.set=!1,inst._change()}),$("#"+id_transparent,part).click(function(){inst.color.setAlpha(0),inst._change()})},this.repaint=function(){$(".ui-colorpicker-special-none",part).prop("checked",!inst.color.set).button("refresh"),$(".ui-colorpicker-special-transparent",part).prop("checked",inst.color.set&&0===inst.color.getAlpha()).button("refresh"),$(".ui-colorpicker-ok",part).button(inst.changed?"enable":"disable")},this.update=function(){},this.disable=function(disabled){$(":input, :button",part).button(disabled?"disable":"enable"),disabled||$(".ui-colorpicker-ok",part).button(inst.changed?"enable":"disable")}}},this.Color=function(){var spaces={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},a=1,illuminant=[.9504285,1,1.0889],args=arguments,_clip=function(v){return isNaN(v)||null===v?0:("string"==typeof v&&(v=parseInt(v,10)),Math.max(0,Math.min(v,1)))},_hexify=function(number){var lsd=(number=Math.round(number))%16,msd=(number-lsd)/16;return"0123456789abcdef".charAt(msd)+"0123456789abcdef".charAt(lsd)},_rgb_to_xyz=function(rgb){var r=rgb.r>.04045?Math.pow((rgb.r+.055)/1.055,2.4):rgb.r/12.92,g=rgb.g>.04045?Math.pow((rgb.g+.055)/1.055,2.4):rgb.g/12.92,b=rgb.b>.04045?Math.pow((rgb.b+.055)/1.055,2.4):rgb.b/12.92;return{x:.4124*r+.3576*g+.1805*b,y:.2126*r+.7152*g+.0722*b,z:.0193*r+.1192*g+.9505*b}},_xyz_to_rgb=function(xyz){var rgb={r:3.2406*xyz.x+-1.5372*xyz.y+-.4986*xyz.z,g:-.9689*xyz.x+1.8758*xyz.y+.0415*xyz.z,b:.0557*xyz.x+-.204*xyz.y+1.057*xyz.z};return rgb.r=rgb.r>.0031308?1.055*Math.pow(rgb.r,1/2.4)-.055:12.92*rgb.r,rgb.g=rgb.g>.0031308?1.055*Math.pow(rgb.g,1/2.4)-.055:12.92*rgb.g,rgb.b=rgb.b>.0031308?1.055*Math.pow(rgb.b,1/2.4)-.055:12.92*rgb.b,rgb},_rgb_to_hsv=function(rgb){var del_R,del_G,del_B,minVal=Math.min(rgb.r,rgb.g,rgb.b),maxVal=Math.max(rgb.r,rgb.g,rgb.b),delta=maxVal-minVal,hsv={h:0,s:0,v:maxVal};return 0===delta?(hsv.h=0,hsv.s=0):(hsv.s=delta/maxVal,del_R=((maxVal-rgb.r)/6+delta/2)/delta,del_G=((maxVal-rgb.g)/6+delta/2)/delta,del_B=((maxVal-rgb.b)/6+delta/2)/delta,rgb.r===maxVal?hsv.h=del_B-del_G:rgb.g===maxVal?hsv.h=1/3+del_R-del_B:rgb.b===maxVal&&(hsv.h=2/3+del_G-del_R),hsv.h<0?hsv.h+=1:hsv.h>1&&(hsv.h-=1)),hsv},_hsv_to_rgb=function(hsv){var var_h,var_i,var_1,var_2,var_3,rgb={r:0,g:0,b:0};return 0===hsv.s?rgb.r=rgb.g=rgb.b=hsv.v:(var_h=1===hsv.h?0:6*hsv.h,var_i=Math.floor(var_h),var_1=hsv.v*(1-hsv.s),var_2=hsv.v*(1-hsv.s*(var_h-var_i)),var_3=hsv.v*(1-hsv.s*(1-(var_h-var_i))),0===var_i?(rgb.r=hsv.v,rgb.g=var_3,rgb.b=var_1):1===var_i?(rgb.r=var_2,rgb.g=hsv.v,rgb.b=var_1):2===var_i?(rgb.r=var_1,rgb.g=hsv.v,rgb.b=var_3):3===var_i?(rgb.r=var_1,rgb.g=var_2,rgb.b=hsv.v):4===var_i?(rgb.r=var_3,rgb.g=var_1,rgb.b=hsv.v):(rgb.r=hsv.v,rgb.g=var_1,rgb.b=var_2)),rgb},_rgb_to_hsl=function(rgb){var del_R,del_G,del_B,minVal=Math.min(rgb.r,rgb.g,rgb.b),maxVal=Math.max(rgb.r,rgb.g,rgb.b),delta=maxVal-minVal,hsl={h:0,s:0,l:(maxVal+minVal)/2};return 0===delta?(hsl.h=0,hsl.s=0):(hsl.s=hsl.l<.5?delta/(maxVal+minVal):delta/(2-maxVal-minVal),del_R=((maxVal-rgb.r)/6+delta/2)/delta,del_G=((maxVal-rgb.g)/6+delta/2)/delta,del_B=((maxVal-rgb.b)/6+delta/2)/delta,rgb.r===maxVal?hsl.h=del_B-del_G:rgb.g===maxVal?hsl.h=1/3+del_R-del_B:rgb.b===maxVal&&(hsl.h=2/3+del_G-del_R),hsl.h<0?hsl.h+=1:hsl.h>1&&(hsl.h-=1)),hsl},_hsl_to_rgb=function(hsl){var var_1,var_2,hue_to_rgb=function(v1,v2,vH){return vH<0&&(vH+=1),vH>1&&(vH-=1),6*vH<1?v1+6*(v2-v1)*vH:2*vH<1?v2:3*vH<2?v1+(v2-v1)*(2/3-vH)*6:v1};return 0===hsl.s?{r:hsl.l,g:hsl.l,b:hsl.l}:(var_2=hsl.l<.5?hsl.l*(1+hsl.s):hsl.l+hsl.s-hsl.s*hsl.l,var_1=2*hsl.l-var_2,{r:hue_to_rgb(var_1,var_2,hsl.h+1/3),g:hue_to_rgb(var_1,var_2,hsl.h),b:hue_to_rgb(var_1,var_2,hsl.h-1/3)})},_xyz_to_lab=function(xyz){var x=xyz.x/illuminant[0],y=xyz.y/illuminant[1],z=xyz.z/illuminant[2];return x=x>.008856?Math.pow(x,1/3):7.787*x+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,z=z>.008856?Math.pow(z,1/3):7.787*z+16/116,{l:(116*y-16)/100,a:(500*(x-y)+128)/255,b:(200*(y-z)+128)/255}},_lab_to_xyz=function(lab){var lab2={l:100*lab.l,a:255*lab.a-128,b:255*lab.b-128},xyz={x:0,y:(lab2.l+16)/116,z:0};return xyz.x=lab2.a/500+xyz.y,xyz.z=xyz.y-lab2.b/200,xyz.x=Math.pow(xyz.x,3)>.008856?Math.pow(xyz.x,3):(xyz.x-16/116)/7.787,xyz.y=Math.pow(xyz.y,3)>.008856?Math.pow(xyz.y,3):(xyz.y-16/116)/7.787,xyz.z=Math.pow(xyz.z,3)>.008856?Math.pow(xyz.z,3):(xyz.z-16/116)/7.787,xyz.x*=illuminant[0],xyz.y*=illuminant[1],xyz.z*=illuminant[2],xyz},_rgb_to_cmy=function(rgb){return{c:1-rgb.r,m:1-rgb.g,y:1-rgb.b}},_cmy_to_rgb=function(cmy){return{r:1-cmy.c,g:1-cmy.m,b:1-cmy.y}},_cmy_to_cmyk=function(cmy){var K=1;return cmy.c<K&&(K=cmy.c),cmy.m<K&&(K=cmy.m),cmy.y<K&&(K=cmy.y),1===K?{c:0,m:0,y:0,k:1}:{c:(cmy.c-K)/(1-K),m:(cmy.m-K)/(1-K),y:(cmy.y-K)/(1-K),k:K}},_cmyk_to_cmy=function(cmyk){return{c:cmyk.c*(1-cmyk.k)+cmyk.k,m:cmyk.m*(1-cmyk.k)+cmyk.k,y:cmyk.y*(1-cmyk.k)+cmyk.k}};this.set=!1,this.setAlpha=function(_a){return null!==_a&&(a=_clip(_a)),this.set=!0,this},this.getAlpha=function(){return a},this.setRGB=function(r,g,b){return spaces={rgb:this.getRGB()},null!==r&&(spaces.rgb.r=_clip(r)),null!==g&&(spaces.rgb.g=_clip(g)),null!==b&&(spaces.rgb.b=_clip(b)),this.set=!0,this},this.getChannel=function(channel){switch(channel){case"h":case"s":case"v":return this.getHSV()[channel];case"r":case"g":case"b":return this.getRGB()[channel];case"a":return this.getAlpha()}return null},this.setChannel=function(channel,value){switch(channel){case"h":return this.setHSV(value,null,null);case"s":return this.setHSV(null,value,null);case"v":return this.setHSV(null,null,value);case"r":return this.setRGB(value,null,null);case"g":return this.setRGB(null,value,null);case"b":return this.setRGB(null,null,value);case"a":return this.setAlpha(value)}return this},this.setHSV=function(h,s,v){return spaces={hsv:this.getHSV()},null!==h&&(spaces.hsv.h=_clip(h)),null!==s&&(spaces.hsv.s=_clip(s)),null!==v&&(spaces.hsv.v=_clip(v)),this.set=!0,this},this.setHSL=function(h,s,l){return spaces={hsl:this.getHSL()},null!==h&&(spaces.hsl.h=_clip(h)),null!==s&&(spaces.hsl.s=_clip(s)),null!==l&&(spaces.hsl.l=_clip(l)),this.set=!0,this},this.setLAB=function(l,a,b){return spaces={lab:this.getLAB()},null!==l&&(spaces.lab.l=_clip(l)),null!==a&&(spaces.lab.a=_clip(a)),null!==b&&(spaces.lab.b=_clip(b)),this.set=!0,this},this.setCMYK=function(c,m,y,k){return spaces={cmyk:this.getCMYK()},null!==c&&(spaces.cmyk.c=_clip(c)),null!==m&&(spaces.cmyk.m=_clip(m)),null!==y&&(spaces.cmyk.y=_clip(y)),null!==k&&(spaces.cmyk.k=_clip(k)),this.set=!0,this},this.getRGB=function(){return spaces.rgb||(spaces.rgb=spaces.lab?_xyz_to_rgb(_lab_to_xyz(spaces.lab)):spaces.hsv?_hsv_to_rgb(spaces.hsv):spaces.hsl?_hsl_to_rgb(spaces.hsl):spaces.cmyk?_cmy_to_rgb(_cmyk_to_cmy(spaces.cmyk)):{r:0,g:0,b:0},spaces.rgb.r=_clip(spaces.rgb.r),spaces.rgb.g=_clip(spaces.rgb.g),spaces.rgb.b=_clip(spaces.rgb.b)),$.extend({},spaces.rgb)},this.getHSV=function(){return spaces.hsv||(spaces.hsv=spaces.lab?_rgb_to_hsv(this.getRGB()):spaces.rgb?_rgb_to_hsv(spaces.rgb):spaces.hsl?_rgb_to_hsv(this.getRGB()):spaces.cmyk?_rgb_to_hsv(this.getRGB()):{h:0,s:0,v:0},spaces.hsv.h=_clip(spaces.hsv.h),spaces.hsv.s=_clip(spaces.hsv.s),spaces.hsv.v=_clip(spaces.hsv.v)),$.extend({},spaces.hsv)},this.getHSL=function(){return spaces.hsl||(spaces.hsl=spaces.rgb?_rgb_to_hsl(spaces.rgb):spaces.hsv?_rgb_to_hsl(this.getRGB()):spaces.cmyk?_rgb_to_hsl(this.getRGB()):spaces.hsv?_rgb_to_hsl(this.getRGB()):{h:0,s:0,l:0},spaces.hsl.h=_clip(spaces.hsl.h),spaces.hsl.s=_clip(spaces.hsl.s),spaces.hsl.l=_clip(spaces.hsl.l)),$.extend({},spaces.hsl)},this.getCMYK=function(){return spaces.cmyk||(spaces.cmyk=spaces.rgb?_cmy_to_cmyk(_rgb_to_cmy(spaces.rgb)):spaces.hsv?_cmy_to_cmyk(_rgb_to_cmy(this.getRGB())):spaces.hsl?_cmy_to_cmyk(_rgb_to_cmy(this.getRGB())):spaces.lab?_cmy_to_cmyk(_rgb_to_cmy(this.getRGB())):{c:0,m:0,y:0,k:1},spaces.cmyk.c=_clip(spaces.cmyk.c),spaces.cmyk.m=_clip(spaces.cmyk.m),spaces.cmyk.y=_clip(spaces.cmyk.y),spaces.cmyk.k=_clip(spaces.cmyk.k)),$.extend({},spaces.cmyk)},this.getLAB=function(){return spaces.lab||(spaces.lab=spaces.rgb?_xyz_to_lab(_rgb_to_xyz(spaces.rgb)):spaces.hsv?_xyz_to_lab(_rgb_to_xyz(this.getRGB())):spaces.hsl?_xyz_to_lab(_rgb_to_xyz(this.getRGB())):spaces.cmyk?_xyz_to_lab(_rgb_to_xyz(this.getRGB())):{l:0,a:0,b:0},spaces.lab.l=_clip(spaces.lab.l),spaces.lab.a=_clip(spaces.lab.a),spaces.lab.b=_clip(spaces.lab.b)),$.extend({},spaces.lab)},this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}},this.getSpaces=function(){return $.extend(!0,{},spaces)},this.distance=function(color){var channel,getter="get"+"lab".toUpperCase(),a=this[getter](),b=color[getter](),distance=0;for(channel in a)distance+=Math.pow(a[channel]-b[channel],2);return distance},this.equals=function(color){if(color){var a=this.getRGB(),b=color.getRGB();return this.set===color.set&&this.getAlpha()===color.getAlpha()&&a.r===b.r&&a.g===b.g&&a.b===b.b}return!1},this.limit=function(steps){steps-=1;var rgb=this.getRGB();this.setRGB(Math.round(rgb.r*steps)/steps,Math.round(rgb.g*steps)/steps,Math.round(rgb.b*steps)/steps)},this.toHex=function(){var rgb=this.getRGB();return _hexify(255*rgb.r)+_hexify(255*rgb.g)+_hexify(255*rgb.b)},this.toCSS=function(){return"#"+this.toHex()},this.copy=function(){var color=new $.colorpicker.Color(this.getSpaces(),this.getAlpha());return color.set=this.set,color},2===args.length&&(spaces=args[0],this.setAlpha(0===args[1]?0:args[1]||1),this.set=!0),args.length>2&&(this.setRGB(args[0],args[1],args[2]),this.setAlpha(0===args[3]?0:args[3]||1),this.set=!0)}},$.widget("vanderlee.colorpicker",{options:{alpha:!1,altAlpha:!0,altField:"",altOnChange:!0,altProperties:"background-color",autoOpen:!1,buttonClass:null,buttonColorize:!1,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:!1,buttonText:null,closeOnEscape:!0,closeOnOutside:!0,color:"#00FF00",colorFormat:"HEX",disabled:!1,draggable:!0,containment:null,duration:"fast",hideOn:"button",hsv:!0,inline:!0,inlineFrame:!0,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:!1,mode:"h",okOnEnter:!1,parts:"",part:{map:{size:256},bar:{size:256}},position:null,regional:"",revert:!1,rgb:!0,showAnim:"fadeIn",showCancelButton:!0,showNoneButton:!1,showCloseButton:!0,showOn:"focus click alt",showOptions:{},swatches:null,swatchesWidth:84,title:null,cancel:null,close:null,init:null,ok:null,open:null,select:null,stop:null},_create:function(){var text,that=this;return that.colorpicker_index=_colorpicker_index++,that.widgetEventPrefix="colorpicker",that.opened=!1,that.generated=!1,that.inline=!1,that.changed=!1,that.dialog=null,that.button=null,that.image=null,that.overlay=null,that.events={window_resize:null,document_keydown:null,document_click_html:null},that.mode=that.options.mode,that.element.is("input")||!1===that.options.inline?(that._setColor(that.element.is("input")?that.element.val():that.options.color),that._callback("init"),/\bfocus|all|both\b/.test(that.options.showOn)&&that.element.on("focus",function(){that.open()}),/\bfocus|all|both\b/.test(that.options.hideOn)&&that.element.on("focusout",function(e){that.close()}),/\bclick|all|both\b/.test(that.options.showOn)&&that.element.on("click",function(e){that.opened&&/\bclick|all|both\b/.test(that.options.hideOn)?that.close():that.open()}),/\bbutton|all|both\b/.test(that.options.showOn)&&(""!==that.options.buttonImage&&(text=that.options.buttonText||that._getRegional("button"),that.image=$("<img/>").attr({src:that.options.buttonImage,alt:text,title:text}),that.options.buttonClass&&that.image.attr("class",that.options.buttonClass),that._setImageBackground()),that.options.buttonImageOnly&&that.image?that.button=that.image:(that.button=$('<button type="button"></button>').html(that.image||that.options.buttonText).button(),that.image=that.image?$("img",that.button).first():null),that.button.insertAfter(that.element).click(function(){that.options.disabled||(that.opened&&/\bbutton|all|both\b/.test(that.options.hideOn)?that.close():that.open())})),/\balt|all|both\b/.test(that.options.showOn)&&$(that.options.altField).on("click",function(){that.opened&&/\balt|all|both\b/.test(that.options.hideOn)?that.close():that.open()}),that.options.autoOpen&&that.open()):(that.inline=!0,that._generate(),that.opened=!0),(that.element.is(":disabled")||that.options.disabled)&&that.disable(),this},_setOption:function(key,value){switch(key){case"disabled":this[value?"disable":"enable"]();break;case"swatches":this.options.swatches=value,this.parts.swatches.init()}$.Widget.prototype._setOption.apply(this,arguments)},enable:function(){this.element&&this.element.prop("disabled",!1),this.button&&this.button.prop("disabled",!1),this.dialog&&this.dialog.removeClass("ui-colorpicker-disabled"),this.options.disabled=!1,this.parts&&$.each(this.parts,function(index,part){part.disable&&part.disable(!1)})},disable:function(){this.element&&this.element.prop("disabled",!0),this.button&&this.button.prop("disabled",!0),this.dialog&&this.dialog.addClass("ui-colorpicker-disabled"),this.options.disabled=!0,this.parts&&$.each(this.parts,function(index,part){part.disable&&part.disable(!0)})},_setImageBackground:function(){this.image&&this.options.buttonColorize&&this.image.css("background-color",this.color.set?this._formatColor("RGBA",this.color):"")},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var index,property,properties=this.options.altProperties.split(",");for(index=0;index<=properties.length;++index)switch(property=$.trim(properties[index])){case"color":case"fill":case"stroke":case"background-color":case"backgroundColor":case"outline-color":case"border-color":$(this.options.altField).css(property,this.color.set?this.color.toCSS():"")}this.options.altAlpha&&$(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}},_setColor:function(text){this.color=this._parseColor(text)||new $.colorpicker.Color,this.currentColor=this.color.copy(),this._setImageBackground(),this._setAltField()},setColor:function(text){this._setColor(text),this._change()},getColor:function(format){return this._formatColor(format||this.options.colorFormat,this.color)},_generateInline:function(){var that=this;$(that.element).html(that.options.inlineFrame?'<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>':'<div class="ui-colorpicker ui-colorpicker-inline"></div>'),that.dialog=$(".ui-colorpicker",that.element)},_generatePopup:function(){var that=this;that.dialog=$('<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>').appendTo("body"),null===that.events.document_click_html&&$(document).on("touchstart click","html",that.events.document_click_html=function(event){if(that.opened&&event.target!==that.element[0]&&!that.overlay)if(that.dialog.is(event.target)||that.dialog.has(event.target).length>0)that.element.blur();else{var p,parents=$(event.target).parents();for(parents.push(event.target),p=0;p<=parents.length;++p){if(null!==that.button&&parents[p]===that.button[0])return;if(/\balt|all|both\b/.test(that.options.showOn)&&$(that.options.altField).is(parents[p]))return}that.options.closeOnOutside&&that.close(that.options.revert)}}),null===that.events.document_keydown&&$(document).on("keydown",that.events.document_keydown=function(event){that.opened&&27===event.keyCode&&that.options.closeOnEscape&&that.close(that.options.revert),that.opened&&13===event.keyCode&&that.options.okOnEnter&&that.close()}),that.element.keydown(function(event){9===event.keyCode&&that.close()}).keyup(function(event){var color=that._parseColor(that.element.val());color&&!that.color.equals(color)&&(that.color=color,that._change())})},_generate:function(){var parts_list,layout_parts,table,classes,that=this;that._setColor(that.inline||!that.element.is("input")?that.options.color:that.element.val()),that[that.inline?"_generateInline":"_generatePopup"](),parts_list="string"==typeof that.options.parts?$.colorpicker.partslists[that.options.parts]?$.colorpicker.partslists[that.options.parts]:$.colorpicker.partslists[that.inline?"inline":"popup"]:that.options.parts,that.parts={},$.each(parts_list,function(index,part){$.colorpicker.parts[part]&&(that.parts[part]=new $.colorpicker.parts[part](that))}),that.generated||(layout_parts=[],$.each(that.options.layout,function(part,pos){that.parts[part]&&layout_parts.push({part:part,pos:pos})}),table=$(_layoutTable(layout_parts,function(cell,x,y){return classes=["ui-colorpicker-"+cell.part+"-container"],x>0&&classes.push("ui-colorpicker-padding-left"),y>0&&classes.push("ui-colorpicker-padding-top"),'<td  class="'+classes.join(" ")+'"'+(cell.pos[2]>1?' colspan="'+cell.pos[2]+'"':"")+(cell.pos[3]>1?' rowspan="'+cell.pos[3]+'"':"")+' valign="top"></td>'})).appendTo(that.dialog),that.options.inlineFrame&&table.addClass("ui-dialog-content ui-widget-content"),that._initAllParts(),that._updateAllParts(),that.generated=!0)},_effectGeneric:function(element,show,slide,fade,callback){var that=this;$.effects&&$.effects[that.options.showAnim]?element[show](that.options.showAnim,that.options.showOptions,that.options.duration,callback):(element["slideDown"===that.options.showAnim?slide:"fadeIn"===that.options.showAnim?fade:show](that.options.showAnim?that.options.duration:null,callback),!$.isFunction(callback)||that.options.showAnim&&that.options.duration||callback())},_effectShow:function(element,callback){this._effectGeneric(element,"show","slideDown","fadeIn",callback)},_effectHide:function(element,callback){this._effectGeneric(element,"hide","slideUp","fadeOut",callback)},open:function(){var zIndex,element,position,that=this;that.opened||(that._generate(),element=that.element.is(":hidden")?$("<div/>").insertBefore(that.element):that.element,that.element.is(":hidden")&&element.remove(),zIndex=0,$(that.element[0]).parents().each(function(){var z=$(this).css("z-index");if("number"!=typeof z&&"string"!=typeof z||""===z||isNaN(z))$(this).siblings().each(function(){var z=$(this).css("z-index");"number"!=typeof z&&"string"!=typeof z||""===z||isNaN(z)||z>zIndex&&(zIndex=parseInt(z,10))});else if(z>zIndex)return zIndex=parseInt(z,10),!1}),zIndex+=2,that.dialog.css("z-index",zIndex),that.options.modal&&(that.overlay=$('<div class="ui-widget-overlay"></div>').appendTo("body").css("z-index",zIndex-1),null!==that.events.window_resize&&$(window).off("resize",that.events.window_resize),that.events.window_resize=function(){that.overlay&&(that.overlay.width($(document).width()),that.overlay.height($(document).height()))},$(window).on("resize",that.events.window_resize),that.events.window_resize()),that._effectShow(this.dialog),that.options.position?"element"===(position=$.extend({},that.options.position)).of&&(position.of=element):position={my:"left top",at:"left bottom",of:element,collision:"flip"},that.dialog.position(position),that.opened=!0,that._callback("open"),$(function(){that._repaintAllParts()}))},close:function(cancel){var that=this;that.opened&&(cancel?(that.color=that.currentColor.copy(),that._change(),that._callback("cancel")):(that.currentColor=that.color.copy(),that._callback("ok")),that.changed=!1,that.overlay&&($(window).off("resize",that.events.window_resize),that.overlay.remove()),that._effectHide(that.dialog,function(){that.dialog.remove(),that.dialog=null,that.generated=!1,that.opened=!1,that._callback("close")}))},destroy:function(){var that=this;null!==that.events.document_click_html&&$(document).off("touchstart click","html",that.events.document_click_html),null!==that.events.document_keydown&&$(document).off("keydown",that.events.document_keydown),null!==that.events.window_resize&&$(window).off("resize",that.events.window_resize),this.element.off(),this.overlay&&this.overlay.remove(),null!==this.dialog&&this.dialog.remove(),null!==this.image&&this.image.remove(),null!==this.button&&this.button.remove()},_callback:function(callback){var data,lab,that=this;return that.color.set?(data={formatted:that._formatColor(that.options.colorFormat,that.color),colorPicker:that},data.hex=that.color.toHex(),data.css=that.color.toCSS(),data.a=that.color.getAlpha(),data.rgb=that.color.getRGB(),data.hsv=that.color.getHSV(),data.cmyk=that.color.getCMYK(),data.hsl=that.color.getHSL(),lab=that.color.getLAB(),lab.a=2*lab.a-1,lab.b=2*lab.b-1,data.lab=lab,that._trigger(callback,null,data)):that._trigger(callback,null,{formatted:"",colorPicker:that})},_initAllParts:function(){$.each(this.parts,function(index,part){part.init&&part.init()})},_updateAllParts:function(){$.each(this.parts,function(index,part){part.update&&part.update()})},_repaintAllParts:function(){$.each(this.parts,function(index,part){part.repaint&&part.repaint()})},_change:function(stoppedChanging){this.color.set&&this.options.limit&&$.colorpicker.limits[this.options.limit]&&$.colorpicker.limits[this.options.limit](this.color,this),this.changed=!this.color.equals(this.currentColor),this.inline||(this.color.set?this.color.equals(this._parseColor(this.element.val()))||this.element.val(this._formatColor(this.options.colorFormat,this.color)).change():""!==this.element.val()&&this.element.val("").change(),this._setImageBackground()),this._setAltField(),this.options.color=this.color.set?this.color.toCSS():"",this.opened&&this._repaintAllParts(),this._callback("select"),void 0!==stoppedChanging&&!stoppedChanging||this._callback("stop")},_hoverable:function(e){e.hover(function(){e.addClass("ui-state-hover")},function(){e.removeClass("ui-state-hover")})},_focusable:function(e){e.focus(function(){e.addClass("ui-state-focus")}).blur(function(){e.removeClass("ui-state-focus")})},_getRegional:function(name){return void 0!==$.colorpicker.regional[this.options.regional][name]?$.colorpicker.regional[this.options.regional][name]:$.colorpicker.regional[""][name]},_getSwatches:function(){return"string"==typeof this.options.swatches?$.colorpicker.swatches[this.options.swatches]:$.isPlainObject(this.options.swatches)?this.options.swatches:$.colorpicker.swatches.html},_eachSwatch:function(callback){var name,currentSwatches=this._getSwatches();$.each(currentSwatches,function(nameOrIndex,swatch){return name=$.isArray(currentSwatches)?swatch.name:nameOrIndex,callback(name,swatch)})},_getSwatch:function(name){var swatch=!1;return this._eachSwatch(function(swatchName,current){if(swatchName.toLowerCase()==name.toLowerCase())return swatch=current,!1}),swatch},_parseFormat:function(format,text){var color,pattern,typeRegexps={x:function(){return"([0-9a-fA-F]{2})"},d:function(){return"([12]?[0-9]{1,2})"},f:function(){return"([0-9]*\\.?[0-9]*)"},p:function(){return"([0-9]*\\.?[0-9]*)"}},typeConverters={x:function(v){return parseInt(v,16)/255},d:function(v){return v/255},f:function(v){return v},p:function(v){return.01*v}},setters={r:"setRGB",g:"setRGB",b:"setRGB",h:"setHSV",s:"setHSV",v:"setHSV",c:"setCMYK",m:"setCMYK",y:"setCMYK",k:"setCMYK",L:"setLAB",A:"setLAB",B:"setLAB"},setterChannels={setRGB:["r","g","b"],setHSV:["h","s","v"],setCMYK:["c","m","y","k"],setLAB:["L","A","B"]},channels=[],converters=[],setter=null;if(pattern=format.replace(/[()\\^$.|?*+[\]]/g,function(m){return"\\"+m}),pattern=pattern.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(variable){if(variable.match(/^\\/))return variable.slice(1);var channel=variable.charAt(0),type=variable.charAt(1);return channels.push(channel),converters.push(typeConverters[type]),setters[channel]&&(setter=setters[channel]),typeRegexps[type]()}),setter){var values=text.match(new RegExp(pattern));if(values){var channelIndex,args=[];values.shift(),$.each(setterChannels[setter],function(index,channel){channelIndex=$.inArray(channel,channels),args[index]=converters[channelIndex](values[channelIndex])}),(color=new $.colorpicker.Color)[setter].apply(color,args)}}return color},_parseColor:function(text){var color,that=this,formats=$.isArray(that.options.colorFormat)?that.options.colorFormat:[that.options.colorFormat];return $.each(formats,function(index,format){if(color=$.colorpicker.parsers[format]?$.colorpicker.parsers[format](text,that):that._parseFormat(format,text))return!1}),color||$.each($.colorpicker.parsers,function(name,parser){if(color=parser(text,that))return!1}),color||!1},_exactName:function(color){var name=!1;return this._eachSwatch(function(n,swatch){if(color.equals(new $.colorpicker.Color(swatch.r,swatch.g,swatch.b)))return name=n,!1}),name},_closestName:function(color){color.getRGB();var d,distance=null,name=!1;return this._eachSwatch(function(n,swatch){if((d=color.distance(new $.colorpicker.Color(swatch.r,swatch.g,swatch.b)))<distance||null===distance){if(name=n,d<=1e-20)return!1;distance=d}}),name},_formatColor:function(formats,color){var that=this,text=null,types={x:function(v){return _intToHex(255*v)},d:function(v){return Math.round(255*v)},f:function(v){return v},p:function(v){return 100*v}},channels=color.getChannels();return $.isArray(formats)||(formats=[formats]),$.each(formats,function(index,format){return $.colorpicker.writers[format]?!1===(text=$.colorpicker.writers[format](color,that)):(text=format.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(m){return m.match(/^\\/)?m.slice(1):types[m.charAt(1)](channels[m.charAt(0)])}),!1)}),text}}),$.vanderlee.colorpicker}),function(global){function index(array,item){for(var i=array.length;i--;)if(array[i]===item)return i;return-1}function compareArray(a1,a2){if(a1.length!=a2.length)return!1;for(var i=0;i<a1.length;i++)if(a1[i]!==a2[i])return!1;return!0}function updateModifierKey(event){for(k in _mods)_mods[k]=event[modifierMap[k]]}function dispatch(event){var key,handler,k,i,modifiersMatch,scope;if(key=event.keyCode,-1==index(_downKeys,key)&&_downKeys.push(key),93!=key&&224!=key||(key=91),key in _mods){_mods[key]=!0;for(k in _MODIFIERS)_MODIFIERS[k]==key&&(assignKey[k]=!0)}else if(updateModifierKey(event),assignKey.filter.call(this,event)&&key in _handlers)for(scope=getScope(),i=0;i<_handlers[key].length;i++)if((handler=_handlers[key][i]).scope==scope||"all"==handler.scope){modifiersMatch=handler.mods.length>0;for(k in _mods)(!_mods[k]&&index(handler.mods,+k)>-1||_mods[k]&&-1==index(handler.mods,+k))&&(modifiersMatch=!1);(0!=handler.mods.length||_mods[16]||_mods[18]||_mods[17]||_mods[91])&&!modifiersMatch||!1===handler.method(event,handler)&&(event.preventDefault?event.preventDefault():event.returnValue=!1,event.stopPropagation&&event.stopPropagation(),event.cancelBubble&&(event.cancelBubble=!0))}}function assignKey(key,scope,method){var keys,mods;keys=getKeys(key),void 0===method&&(method=scope,scope="all");for(var i=0;i<keys.length;i++)mods=[],(key=keys[i].split("+")).length>1&&(mods=getMods(key),key=[key[key.length-1]]),key=key[0],(key=code(key))in _handlers||(_handlers[key]=[]),_handlers[key].push({shortcut:keys[i],scope:scope,method:method,key:keys[i],mods:mods})}function getScope(){return _scope||"all"}function getKeys(key){var keys;return key=key.replace(/\s/g,""),""==(keys=key.split(","))[keys.length-1]&&(keys[keys.length-2]+=","),keys}function getMods(key){for(var mods=key.slice(0,key.length-1),mi=0;mi<mods.length;mi++)mods[mi]=_MODIFIERS[mods[mi]];return mods}function addEvent(object,event,method){object.addEventListener?object.addEventListener(event,method,!1):object.attachEvent&&object.attachEvent("on"+event,function(){method(window.event)})}var k,_handlers={},_mods={16:!1,18:!1,17:!1,91:!1},_scope="all",_MODIFIERS={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},_MAP={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},code=function(x){return _MAP[x]||x.toUpperCase().charCodeAt(0)},_downKeys=[];for(k=1;k<20;k++)_MAP["f"+k]=111+k;var modifierMap={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(k in _MODIFIERS)assignKey[k]=!1;addEvent(document,"keydown",function(event){dispatch(event)}),addEvent(document,"keyup",function(event){var k,key=event.keyCode,i=index(_downKeys,key);if(i>=0&&_downKeys.splice(i,1),93!=key&&224!=key||(key=91),key in _mods){_mods[key]=!1;for(k in _MODIFIERS)_MODIFIERS[k]==key&&(assignKey[k]=!1)}}),addEvent(window,"focus",function(){for(k in _mods)_mods[k]=!1;for(k in _MODIFIERS)assignKey[k]=!1});var previousKey=global.key;global.key=assignKey,global.key.setScope=function(scope){_scope=scope||"all"},global.key.getScope=getScope,global.key.deleteScope=function(scope){var key,handlers,i;for(key in _handlers)for(handlers=_handlers[key],i=0;i<handlers.length;)handlers[i].scope===scope?handlers.splice(i,1):i++},global.key.filter=function(event){var tagName=(event.target||event.srcElement).tagName;return!("INPUT"==tagName||"SELECT"==tagName||"TEXTAREA"==tagName)},global.key.isPressed=function(keyCode){return"string"==typeof keyCode&&(keyCode=code(keyCode)),-1!=index(_downKeys,keyCode)},global.key.getPressedKeyCodes=function(){return _downKeys.slice(0)},global.key.noConflict=function(){var k=global.key;return global.key=previousKey,k},global.key.unbind=function(key,scope){var multipleKeys,keys,i,j,obj,mods=[];for(multipleKeys=getKeys(key),j=0;j<multipleKeys.length;j++){if((keys=multipleKeys[j].split("+")).length>1&&(mods=getMods(keys),key=keys[keys.length-1]),key=code(key),void 0===scope&&(scope=getScope()),!_handlers[key])return;for(i=0;i<_handlers[key].length;i++)(obj=_handlers[key][i]).scope===scope&&compareArray(obj.mods,mods)&&(_handlers[key][i]={})}},"undefined"!=typeof module&&(module.exports=assignKey)}(this),function($){"use strict";$.fn.editableAriaShim=function(){return this.attr({role:"button",tabindex:0}),this},$.fn.editable=function(target,options){if("disable"!==target)if("enable"!==target){if("destroy"!==target){var settings=$.extend({},$.fn.editable.defaults,{target:target},options),plugin=$.editable.types[settings.type].plugin||function(){},submit=$.editable.types[settings.type].submit||function(){},buttons=$.editable.types[settings.type].buttons||$.editable.types.defaults.buttons,content=$.editable.types[settings.type].content||$.editable.types.defaults.content,element=$.editable.types[settings.type].element||$.editable.types.defaults.element,reset=$.editable.types[settings.type].reset||$.editable.types.defaults.reset,destroy=$.editable.types[settings.type].destroy||$.editable.types.defaults.destroy,callback=settings.callback||function(){},intercept=settings.intercept||function(s){return s},onedit=settings.onedit||function(){},onsubmit=settings.onsubmit||function(){},onreset=settings.onreset||function(){},onerror=settings.onerror||reset;settings.before;return settings.tooltip&&$(this).attr("title",settings.tooltip),this.each(function(){var self=this;$(this).data("event.editable",settings.event),$.trim($(this).html())||$(this).html(settings.placeholder),"destroy"!==target?($(this).bind(settings.event,function(e){if(!0!==$(this).data("disabled.editable")&&9!==e.keyCode&&!self.editing&&!1!==onedit.apply(this,[settings,self,e])){if(settings.before&&jQuery.isFunction(settings.before))settings.before();else if(settings.before&&!jQuery.isFunction(settings.before))throw"The 'before' option needs to be provided as a function!";e.preventDefault(),e.stopPropagation(),settings.tooltip&&$(self).removeAttr("title"),$(this).html().toLowerCase().replace(/(;|"|\/)/g,"")===settings.placeholder.toLowerCase().replace(/(;|"|\/)/g,"")&&$(this).html(""),self.editing=!0,self.revert=$(self).text(),$(self).html("");var form=$("<form />");settings.cssclass&&("inherit"===settings.cssclass?form.attr("class",$(self).attr("class")):form.attr("class",settings.cssclass)),settings.style&&("inherit"===settings.style?(form.attr("style",$(self).attr("style")),form.css("display",$(self).css("display"))):form.attr("style",settings.style)),settings.label&&form.append("<label>"+settings.label+"</label>"),settings.formid&&form.attr("id",settings.formid);var input_content,t,input=element.apply(form,[settings,self]);if(settings.loadurl){t=self.setTimeout(function(){input.disabled=!0},100),$(self).html(settings.loadtext);var loaddata={};loaddata[settings.id]=self.id,$.isFunction(settings.loaddata)?$.extend(loaddata,settings.loaddata.apply(self,[self.revert,settings])):$.extend(loaddata,settings.loaddata),$.ajax({type:settings.loadtype,url:settings.loadurl,data:loaddata,async:!1,cache:!1,success:function(result){self.clearTimeout(t),input_content=result,input.disabled=!1}})}else settings.data?(input_content=settings.data,$.isFunction(settings.data)&&(input_content=settings.data.apply(self,[self.revert,settings]))):input_content=self.revert;if(content.apply(form,[input_content,settings,self]),input.attr("name",settings.name),"none"!==settings.width){var adj_width=settings.width-(input.outerWidth(!0)-settings.width);input.width(adj_width)}buttons.apply(form,[settings,self]),settings.showfn&&$.isFunction(settings.showfn)&&form.hide(),$(self).html(""),$(self).append(form),settings.showfn&&$.isFunction(settings.showfn)&&settings.showfn(form),plugin.apply(form,[settings,self]),form.find(":input:visible:enabled:first").focus(),settings.select&&input.select(),input.keydown(function(e){27===e.keyCode&&(e.preventDefault(),reset.apply(form,[settings,self]))}),"cancel"===settings.onblur?input.blur(function(e){t=self.setTimeout(function(){reset.apply(form,[settings,self])},500)}):"submit"===settings.onblur?input.blur(function(e){t=self.setTimeout(function(){form.submit()},200)}):$.isFunction(settings.onblur)&&input.blur(function(e){!1===settings.onblur.apply(self,[input.val(),settings,form])&&reset.apply(form,[settings,self])}),form.submit(function(e){if(t&&self.clearTimeout(t),e.preventDefault(),!1!==onsubmit.apply(form,[settings,self])&&!1!==submit.apply(form,[settings,self]))if($.isFunction(settings.target)){var responseHandler=function(value){$(self).html(value),self.editing=!1,callback.apply(self,[self.innerHTML,settings]),$.trim($(self).html())||$(self).html(settings.placeholder)},userTarget=settings.target.apply(self,[input.val(),settings,responseHandler]);!1!==userTarget&&void 0!==userTarget&&responseHandler(userTarget)}else{var submitdata={};submitdata[settings.name]=input.val(),submitdata[settings.id]=self.id,$.isFunction(settings.submitdata)?$.extend(submitdata,settings.submitdata.apply(self,[self.revert,settings,submitdata])):$.extend(submitdata,settings.submitdata),"PUT"===settings.method&&(submitdata._method="put"),$(self).html(settings.indicator);var ajaxoptions={type:"POST",data:submitdata,dataType:"html",url:settings.target,success:function(result,status){result=intercept.apply(self,[result,status]),"html"===ajaxoptions.dataType&&$(self).html(result),self.editing=!1,callback.apply(self,[result,settings,submitdata]),$.trim($(self).html())||$(self).html(settings.placeholder)},error:function(xhr,status,error){onerror.apply(form,[settings,self,xhr])}};$.extend(ajaxoptions,settings.ajaxoptions),$.ajax(ajaxoptions)}return $(self).attr("title",settings.tooltip),!1})}}),self.reset=function(form){self.editing&&!1!==onreset.apply(form,[settings,self])&&($(self).html(self.revert),self.editing=!1,$.trim($(self).html())||$(self).html(settings.placeholder),settings.tooltip&&$(self).attr("title",settings.tooltip))},self.destroy=function(form){$(self).unbind($(self).data("event.editable")).removeData("disabled.editable").removeData("event.editable"),self.clearTimeouts(),self.editing&&reset.apply(form,[settings,self])},self.clearTimeout=function(t){var timeouts=$(self).data("timeouts");if(clearTimeout(t),timeouts){var i=timeouts.indexOf(t);i>-1?(timeouts.splice(i,1),timeouts.length<=0&&$(self).removeData("timeouts")):console.warn("jeditable clearTimeout could not find timeout "+t)}},self.clearTimeouts=function(){var timeouts=$(self).data("timeouts");if(timeouts){for(var i=0,n=timeouts.length;i<n;++i)clearTimeout(timeouts[i]);timeouts.length=0,$(self).removeData("timeouts")}},self.setTimeout=function(callback,time){var timeouts=$(self).data("timeouts"),t=setTimeout(function(){callback(),self.clearTimeout(t)},time);return timeouts||(timeouts=[],$(self).data("timeouts",timeouts)),timeouts.push(t),t}):destroy.apply($(this).find("form"),[settings,self])})}$(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable")}else $(this).data("disabled.editable",!1);else $(this).data("disabled.editable",!0)};var _supportInType=function(type){var i=document.createElement("input");return i.setAttribute("type",type),"text"!==i.type?type:"text"};$.editable={types:{defaults:{element:function(settings,original){var input=$('<input type="hidden"></input>');return $(this).append(input),input},content:function(string,settings,original){$(this).find(":input:first").val(string)},reset:function(settings,original){original.reset(this)},destroy:function(settings,original){original.destroy(this)},buttons:function(settings,original){var submit,form=this;if(settings.submit&&(settings.submit.match(/>$/)?submit=$(settings.submit).click(function(){"submit"!==submit.attr("type")&&form.submit()}):((submit=$('<button type="submit" />')).html(settings.submit),settings.submitcssclass&&submit.addClass(settings.submitcssclass)),$(this).append(submit)),settings.cancel){var cancel;settings.cancel.match(/>$/)?cancel=$(settings.cancel):((cancel=$('<button type="cancel" />')).html(settings.cancel),settings.cancelcssclass&&cancel.addClass(settings.cancelcssclass)),$(this).append(cancel),$(cancel).click(function(event){return($.isFunction($.editable.types[settings.type].reset)?$.editable.types[settings.type].reset:$.editable.types.defaults.reset).apply(form,[settings,original]),!1})}}},text:{element:function(settings,original){var input=$("<input />").attr({autocomplete:"off",list:settings.list,maxlength:settings.maxlength,pattern:settings.pattern,placeholder:settings.placeholder,tooltip:settings.tooltip,type:"text"});return"none"!==settings.width&&input.css("width",settings.width),"none"!==settings.height&&input.css("height",settings.height),settings.size&&input.attr("size",settings.size),settings.maxlength&&input.attr("maxlength",settings.maxlength),$(this).append(input),input}},textarea:{element:function(settings,original){var textarea=$("<textarea></textarea>");return settings.rows?textarea.attr("rows",settings.rows):"none"!==settings.height&&textarea.height(settings.height),settings.cols?textarea.attr("cols",settings.cols):"none"!==settings.width&&textarea.width(settings.width),settings.maxlength&&textarea.attr("maxlength",settings.maxlength),$(this).append(textarea),textarea}},select:{element:function(settings,original){var select=$("<select />");return settings.multiple&&select.attr("multiple","multiple"),$(this).append(select),select},content:function(data,settings,original){var json;json=String===data.constructor?JSON.parse(data):data;var key,tuples=[];for(key in json)tuples.push([key,json[key]]);tuples.sort(function(a,b){return a=a[1],b=b[1],a<b?-1:a>b?1:0});for(var i=0;i<tuples.length;i++){key=tuples[i][0];var value=tuples[i][1];if(json.hasOwnProperty(key)){var option=$("<option />").val(key).append(value);"selected"!==key&&key!==$.trim(original.revert)||$(option).prop("selected","selected"),$(this).find("select").append(option)}}if(!settings.submit){var form=this;$(this).find("select").change(function(){form.submit()})}}},number:{element:function(settings,original){var input=$("<input />").attr({maxlength:settings.maxlength,placeholder:settings.placeholder,min:settings.min,max:settings.max,step:settings.step,tooltip:settings.tooltip,type:_supportInType("number")});return $(this).append(input),input}},email:{element:function(settings,original){var input=$("<input />").attr({maxlength:settings.maxlength,placeholder:settings.placeholder,tooltip:settings.tooltip,type:_supportInType("email")});return $(this).append(input),input}},url:{element:function(settings,original){var input=$("<input />").attr({maxlength:settings.maxlength,pattern:settings.pattern,placeholder:settings.placeholder,tooltip:settings.tooltip,type:_supportInType("url")});return $(this).append(input),input}}},addInputType:function(name,input){$.editable.types[name]=input}},$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable keydown.editable",onblur:"cancel",tooltip:"Click to edit",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}}(jQuery),$(document).ready(function(){$(document).on("click",".togglable-next",function(){$(this).next().toggle()}),$(".togglable-hidden").hide()});var cornifyCount=0;cornifyAdd=function(){cornifyCount+=1;var div=document.createElement("div");div.style.position="fixed";var numType="px",heightRandom=.75*Math.random(),windowHeight=768,windowWidth=1024,height=0,de=document.documentElement;"number"==typeof window.innerHeight?(windowHeight=window.innerHeight,windowWidth=window.innerWidth):de&&de.clientHeight?(windowHeight=de.clientHeight,windowWidth=de.clientWidth):(numType="%",height=Math.round(100*height)+"%"),div.onclick=cornifyAdd,div.style.zIndex=10,div.style.outline=0,15===cornifyCount?(div.style.top=Math.max(0,Math.round((windowHeight-530)/2))+"px",div.style.left=Math.round((windowWidth-530)/2)+"px",div.style.zIndex=1e3):(div.style.top="px"===numType?Math.round(windowHeight*heightRandom)+numType:height,div.style.left=Math.round(90*Math.random())+"%");var img=document.createElement("img"),submitTime=(new Date).getTime();15===cornifyCount&&(submitTime=0),img.setAttribute("src","https://www.cornify.com/getacorn.php?r="+submitTime);if(div.style.WebkitTransition="all .1s linear",div.style.WebkitTransform="rotate(1deg) scale(1.01,1.01)",div.style.transition="all .1s linear",div.onmouseover=function(){var size=1+Math.round(10*Math.random())/100,result="rotate("+Math.round(20*Math.random()-10)+"deg) scale("+size+","+size+")";this.style.transform=result,this.style.WebkitTransform=result},div.onmouseout=function(){var size=.9+Math.round(10*Math.random())/100,result="rotate("+Math.round(6*Math.random()-3)+"deg) scale("+size+","+size+")";this.style.transform=result,this.style.WebkitTransform=result},document.getElementsByTagName("body")[0].appendChild(div),div.appendChild(img),1===cornifyCount){if(!document.getElementById("__cornify_css")){var head=document.getElementsByTagName("head")[0],css=document.createElement("link");css.id="__cornify_css",css.type="text/css",css.rel="stylesheet",css.href="app/css/cornify.css",css.media="screen",head.appendChild(css)}cornifyReplace()}},cornifyReplace=function(){for(var hs,h,k,hc=6,words=["Happy","Sparkly","Glittery","Fun","Magical","Lovely","Cute","Charming","Amazing","Wonderful"];hc>=1;){for(hs=document.getElementsByTagName("h"+hc),k=0;k<hs.length;k++)(h=hs[k]).innerHTML=words[Math.floor(Math.random()*words.length)]+" "+h.innerHTML;hc-=1}};var cornami={input:"",pattern:"38384040373937396665",clear:function(){var _this=this;setTimeout(_this.clearInput(),5e3)},load:function(){window.document.onkeydown=function(e){if(cornami.input===cornami.pattern)return cornifyAdd(),void clearTimeout(cornami.clear);cornami.input+=e?e.keyCode:event.keyCode,cornami.input===cornami.pattern&&cornifyAdd(),clearTimeout(cornami.clear);var _this=this;cornami.clear=_this.clear()}},clearInput:function(){cornami.input="",clearTimeout(cornami.clear)}};cornami.load(),window.jQuery&&function($){if(!$.support.opacity&&!$.support.style)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}$.fn.rating=function(options){if(0==this.length)return this;if("string"==typeof arguments[0]){if(this.length>1){var args=arguments;return this.each(function(){$.fn.rating.apply($(this),args)})}return $.fn.rating[arguments[0]].apply(this,$.makeArray(arguments).slice(1)||[]),this}var options=$.extend({},$.fn.rating.options,options||{});return $.fn.rating.calls++,this.not(".star-rating-applied").addClass("star-rating-applied").each(function(){var control,input=$(this),eid=(this.name||"unnamed-rating").replace(/\[|\]/g,"_").replace(/^\_+|\_+$/g,""),context=$(this.form||document.body),raters=context.data("rating");raters&&raters.call==$.fn.rating.calls||(raters={count:0,call:$.fn.rating.calls});var rater=raters[eid]||context.data("rating"+eid);rater&&(control=rater.data("rating")),rater&&control?control.count++:((control=$.extend({},options||{},($.metadata?input.metadata():$.meta?input.data():null)||{},{count:0,stars:[],inputs:[]})).serial=raters.count++,rater=$('<span class="star-rating-control"/>'),input.before(rater),rater.addClass("rating-to-be-drawn"),(input.attr("disabled")||input.hasClass("disabled"))&&(control.readOnly=!0),input.hasClass("required")&&(control.required=!0),rater.append(control.cancel=$('<div class="rating-cancel"><a title="'+control.cancel+'">'+control.cancelValue+"</a></div>").on("mouseover",function(){$(this).rating("drain"),$(this).addClass("star-rating-hover")}).on("mouseout",function(){$(this).rating("draw"),$(this).removeClass("star-rating-hover")}).on("click",function(){$(this).rating("select")}).data("rating",control)));var star=$('<div role="text" aria-label="'+this.title+'" class="star-rating rater-'+control.serial+'"><a title="'+(this.title||this.value)+'">'+this.value+"</a></div>");if(rater.append(star),this.id&&star.attr("id",this.id),this.className&&star.addClass(this.className),control.half&&(control.split=2),"number"==typeof control.split&&control.split>0){var stw=($.fn.width?star.width():0)||control.starWidth,spi=control.count%control.split,spw=Math.floor(stw/control.split);star.width(spw).find("a").css({"margin-left":"-"+spi*spw+"px"})}control.readOnly?star.addClass("star-rating-readonly"):star.addClass("star-rating-live").on("mouseover",function(){$(this).rating("fill"),$(this).rating("focus")}).on("mouseout",function(){$(this).rating("draw"),$(this).rating("blur")}).on("click",function(){$(this).rating("select")}),this.checked&&(control.current=star),"A"==this.nodeName&&$(this).hasClass("selected")&&(control.current=star),input.hide(),input.on("change.rating",function(event){if(event.selfTriggered)return!1;$(this).rating("select")}),star.data("rating.input",input.data("rating.star",star)),control.stars[control.stars.length]=star[0],control.inputs[control.inputs.length]=input[0],control.rater=raters[eid]=rater,control.context=context,input.data("rating",control),rater.data("rating",control),star.data("rating",control),context.data("rating",raters),context.data("rating"+eid,rater)}),$(".rating-to-be-drawn").rating("draw").removeClass("rating-to-be-drawn"),this},$.extend($.fn.rating,{calls:0,focus:function(){var control=this.data("rating");if(!control)return this;if(!control.focus)return this;var input=$(this).data("rating.input")||$("INPUT"==this.tagName?this:null);control.focus&&control.focus.apply(input[0],[input.val(),$("a",input.data("rating.star"))[0]])},blur:function(){var control=this.data("rating");if(!control)return this;if(!control.blur)return this;var input=$(this).data("rating.input")||$("INPUT"==this.tagName?this:null);control.blur&&control.blur.apply(input[0],[input.val(),$("a",input.data("rating.star"))[0]])},fill:function(){var control=this.data("rating");if(!control)return this;control.readOnly||(this.rating("drain"),this.prevAll().addBack().filter(".rater-"+control.serial).addClass("star-rating-hover"))},drain:function(){var control=this.data("rating");if(!control)return this;control.readOnly||control.rater.children().filter(".rater-"+control.serial).removeClass("star-rating-on").removeClass("star-rating-hover")},draw:function(){var control=this.data("rating");if(!control)return this;this.rating("drain");var current=$(control.current),starson=current.length?current.prevAll().addBack().filter(".rater-"+control.serial):null;starson&&starson.addClass("star-rating-on"),control.cancel[control.readOnly||control.required?"hide":"show"](),this.siblings()[control.readOnly?"addClass":"removeClass"]("star-rating-readonly")},select:function(value,wantCallBack){var control=this.data("rating");if(!control)return this;if(!control.readOnly){if(control.current=null,void 0!==value||this.length>1){if("number"==typeof value)return $(control.stars[value]).rating("select",void 0,wantCallBack);if("string"==typeof value)return $.each(control.stars,function(){$(this).data("rating.input").val()==value&&$(this).rating("select",void 0,wantCallBack)}),this}else control.current="INPUT"==this[0].tagName?this.data("rating.star"):this.is(".rater-"+control.serial)?this:null;this.data("rating",control),this.rating("draw");var current=$(control.current?control.current.data("rating.input"):null),lastipt=$(control.inputs).filter(":checked");return $(control.inputs).not(current).prop("checked",!1),current.prop("checked",!0),$(current.length?current:lastipt).trigger({type:"change",selfTriggered:!0}),(wantCallBack||void 0==wantCallBack)&&control.callback&&control.callback.apply(current[0],[current.val(),$("a",control.current)[0]]),this}},readOnly:function(toggle,disable){var control=this.data("rating");if(!control)return this;control.readOnly=!(!toggle&&void 0!=toggle),disable?$(control.inputs).attr("disabled","disabled"):$(control.inputs).removeAttr("disabled"),this.data("rating",control),this.rating("draw")},disable:function(){this.rating("readOnly",!0,!0)},enable:function(){this.rating("readOnly",!1,!1)}}),$.fn.rating.options={cancel:"Cancel Rating",cancelValue:"",split:0,starWidth:16},$(function(){$("input[type=radio].star").rating()})}(jQuery),function(global,factory){(function(exports){"use strict";function utf8Write(view,offset,string){var byteLength=view.byteLength;for(var i=0,l=string.length;i<l;i++){var codePoint=string.charCodeAt(i);if(codePoint<128){view.setUint8(offset++,codePoint>>>0&127|0);continue}if(codePoint<2048){view.setUint8(offset++,codePoint>>>6&31|192);view.setUint8(offset++,codePoint>>>0&63|128);continue}if(codePoint<65536){view.setUint8(offset++,codePoint>>>12&15|224);view.setUint8(offset++,codePoint>>>6&63|128);view.setUint8(offset++,codePoint>>>0&63|128);continue}if(codePoint<1114112){view.setUint8(offset++,codePoint>>>18&7|240);view.setUint8(offset++,codePoint>>>12&63|128);view.setUint8(offset++,codePoint>>>6&63|128);view.setUint8(offset++,codePoint>>>0&63|128);continue}throw new Error("bad codepoint "+codePoint)}}function utf8ByteCount(string){var count=0;for(var i=0,l=string.length;i<l;i++){var codePoint=string.charCodeAt(i);if(codePoint<128){count+=1;continue}if(codePoint<2048){count+=2;continue}if(codePoint<65536){count+=3;continue}if(codePoint<1114112){count+=4;continue}throw new Error("bad codepoint "+codePoint)}return count}function encode$1(value,view,offset){var type=typeof value;if(type==="string"){var length=utf8ByteCount(value);if(length<32){view.setUint8(offset,length|160);utf8Write(view,offset+1,value);return 1+length}if(length<256){view.setUint8(offset,217);view.setUint8(offset+1,length);utf8Write(view,offset+2,value);return 2+length}if(length<65536){view.setUint8(offset,218);view.setUint16(offset+1,length);utf8Write(view,offset+3,value);return 3+length}if(length<4294967296){view.setUint8(offset,219);view.setUint32(offset+1,length);utf8Write(view,offset+5,value);return 5+length}}if(value instanceof Uint8Array){var length=value.byteLength;var bytes=new Uint8Array(view.buffer);if(length<256){view.setUint8(offset,196);view.setUint8(offset+1,length);bytes.set(value,offset+2);return 2+length}if(length<65536){view.setUint8(offset,197);view.setUint16(offset+1,length);bytes.set(value,offset+3);return 3+length}if(length<4294967296){view.setUint8(offset,198);view.setUint32(offset+1,length);bytes.set(value,offset+5);return 5+length}}if(type==="number"){if(!isFinite(value)){throw new Error("Number not finite: "+value)}if(Math.floor(value)!==value){view.setUint8(offset,203);view.setFloat64(offset+1,value);return 9}if(value>=0){if(value<128){view.setUint8(offset,value);return 1}if(value<256){view.setUint8(offset,204);view.setUint8(offset+1,value);return 2}if(value<65536){view.setUint8(offset,205);view.setUint16(offset+1,value);return 3}if(value<4294967296){view.setUint8(offset,206);view.setUint32(offset+1,value);return 5}throw new Error("Number too big 0x"+value.toString(16))}if(value>=-32){view.setInt8(offset,value);return 1}if(value>=-128){view.setUint8(offset,208);view.setInt8(offset+1,value);return 2}if(value>=-32768){view.setUint8(offset,209);view.setInt16(offset+1,value);return 3}if(value>=-2147483648){view.setUint8(offset,210);view.setInt32(offset+1,value);return 5}throw new Error("Number too small -0x"+(-value).toString(16).substr(1))}if(value===null){view.setUint8(offset,192);return 1}if(type==="boolean"){view.setUint8(offset,value?195:194);return 1}if(type==="object"){var length,size=0;var isArray=Array.isArray(value);if(isArray){length=value.length}else{var keys=Object.keys(value);length=keys.length}var size;if(length<16){view.setUint8(offset,length|(isArray?144:128));size=1}else if(length<65536){view.setUint8(offset,isArray?220:222);view.setUint16(offset+1,length);size=3}else if(length<4294967296){view.setUint8(offset,isArray?221:223);view.setUint32(offset+1,length);size=5}if(isArray){for(var i=0;i<length;i++){size+=encode$1(value[i],view,offset+size)}}else{for(var i=0;i<length;i++){var key=keys[i];size+=encode$1(key,view,offset+size);size+=encode$1(value[key],view,offset+size)}}return size}throw new Error("Unknown type "+type)}function encodedSize(value){var type=typeof value;if(type==="string"){var length=utf8ByteCount(value);if(length<32){return 1+length}if(length<256){return 2+length}if(length<65536){return 3+length}if(length<4294967296){return 5+length}}if(value instanceof Uint8Array){var length=value.byteLength;if(length<256){return 2+length}if(length<65536){return 3+length}if(length<4294967296){return 5+length}}if(type==="number"){if(Math.floor(value)!==value)return 9;if(value>=0){if(value<128)return 1;if(value<256)return 2;if(value<65536)return 3;if(value<4294967296)return 5;throw new Error("Number too big 0x"+value.toString(16))}if(value>=-32)return 1;if(value>=-128)return 2;if(value>=-32768)return 3;if(value>=-2147483648)return 5;throw new Error("Number too small -0x"+value.toString(16).substr(1))}if(type==="boolean"||value===null)return 1;if(type==="object"){var length,size=0;if(Array.isArray(value)){length=value.length;for(var i=0;i<length;i++){size+=encodedSize(value[i])}}else{var keys=Object.keys(value);length=keys.length;for(var i=0;i<length;i++){var key=keys[i];size+=encodedSize(key)+encodedSize(value[key])}}if(length<16){return 1+size}if(length<65536){return 3+size}if(length<4294967296){return 5+size}throw new Error("Array or object too long 0x"+length.toString(16))}throw new Error("Unknown type "+type)}function encodeMsgpack(value){var buffer=new ArrayBuffer(encodedSize(value));var view=new DataView(buffer);encode$1(value,view,0);return new Uint8Array(buffer)}var PassThroughFields=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"];var EncodedFields=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"];var AllFields=PassThroughFields.concat(EncodedFields);function getView(ctor,typedArray,elemSize){return typedArray?new ctor(typedArray.buffer,typedArray.byteOffset,typedArray.byteLength/(elemSize||1)):undefined}function getDataView(typedArray){return getView(DataView,typedArray)}function getUint8View(typedArray){return getView(Uint8Array,typedArray)}function getInt8View(typedArray){return getView(Int8Array,typedArray)}function getInt32View(typedArray){return getView(Int32Array,typedArray,4)}function getFloat32View(typedArray){return getView(Float32Array,typedArray,4)}function decodeInt16(bytes,output){var n=bytes.length/2;if(!output)output=new Int16Array(n);for(var i=0,i2=0;i<n;++i,i2+=2){output[i]=bytes[i2]<<8^bytes[i2+1]<<0}return output}function encodeInt16(array,output){var n=array.length;if(!output)output=new Uint8Array(2*n);var dv=getDataView(output);for(var i=0;i<n;++i){dv.setInt16(2*i,array[i])}return getUint8View(output)}function decodeInt32(bytes,output){var n=bytes.length/4;if(!output)output=new Int32Array(n);for(var i=0,i4=0;i<n;++i,i4+=4){output[i]=bytes[i4]<<24^bytes[i4+1]<<16^bytes[i4+2]<<8^bytes[i4+3]<<0}return output}function encodeInt32(array,output){var n=array.length;if(!output)output=new Uint8Array(4*n);var dv=getDataView(output);for(var i=0;i<n;++i){dv.setInt32(4*i,array[i])}return getUint8View(output)}function decodeFloat32(bytes,output){var n=bytes.length;if(!output)output=new Float32Array(n/4);var dvOut=getDataView(output);var dvIn=getDataView(bytes);for(var i=0,i4=0,il=n/4;i<il;++i,i4+=4){dvOut.setFloat32(i4,dvIn.getFloat32(i4),true)}return output}function decodeInteger(intArray,divisor,output){var n=intArray.length;var invDiv=1/divisor;if(!output)output=new Float32Array(n);for(var i=0;i<n;++i){output[i]=intArray[i]*invDiv}return output}function encodeInteger(floatArray,factor,output){var n=floatArray.length;if(!output)output=new Int32Array(n);for(var i=0;i<n;++i){output[i]=Math.round(floatArray[i]*factor)}return output}function decodeRun(array,output){var i,il;if(!output){var fullLength=0;for(i=0,il=array.length;i<il;i+=2){fullLength+=array[i+1]}output=new array.constructor(fullLength)}var dataOffset=0;for(i=0,il=array.length;i<il;i+=2){var value=array[i];var length=array[i+1];for(var j=0;j<length;++j){output[dataOffset]=value;++dataOffset}}return output}function encodeRun(array){if(array.length===0)return new Int32Array;var i,il;var fullLength=2;for(i=1,il=array.length;i<il;++i){if(array[i-1]!==array[i]){fullLength+=2}}var output=new Int32Array(fullLength);var offset=0;var runLength=1;for(i=1,il=array.length;i<il;++i){if(array[i-1]!==array[i]){output[offset]=array[i-1];output[offset+1]=runLength;runLength=1;offset+=2}else{++runLength}}output[offset]=array[array.length-1];output[offset+1]=runLength;return output}function decodeDelta(array,output){var n=array.length;if(!output)output=new array.constructor(n);if(n)output[0]=array[0];for(var i=1;i<n;++i){output[i]=array[i]+output[i-1]}return output}function encodeDelta(array,output){var n=array.length;if(!output)output=new array.constructor(n);output[0]=array[0];for(var i=1;i<n;++i){output[i]=array[i]-array[i-1]}return output}function decodePacking(int16or8,output){var upperLimit=int16or8 instanceof Int8Array?127:32767;var lowerLimit=-upperLimit-1;var n=int16or8.length;var i,j;if(!output){var fullLength=0;for(i=0;i<n;++i){if(int16or8[i]<upperLimit&&int16or8[i]>lowerLimit){++fullLength}}output=new Int32Array(fullLength)}i=0;j=0;while(i<n){var value=0;while(int16or8[i]===upperLimit||int16or8[i]===lowerLimit){value+=int16or8[i];++i}value+=int16or8[i];++i;output[j]=value;++j}return output}function encodePacking(intArray,useInt8){var upperLimit=useInt8?127:32767;var lowerLimit=-upperLimit-1;var i;var n=intArray.length;var size=0;for(i=0;i<n;++i){var value=intArray[i];if(value===0){++size}else if(value===upperLimit||value===lowerLimit){size+=2}else if(value>0){size+=Math.ceil(value/upperLimit)}else{size+=Math.ceil(value/lowerLimit)}}var output=useInt8?new Int8Array(size):new Int16Array(size);var j=0;for(i=0;i<n;++i){var value=intArray[i];if(value>=0){while(value>=upperLimit){output[j]=upperLimit;++j;value-=upperLimit}}else{while(value<=lowerLimit){output[j]=lowerLimit;++j;value-=lowerLimit}}output[j]=value;++j}return output}function decodeDeltaRun(array,output){return decodeDelta(decodeRun(array),output)}function encodeDeltaRun(array){return encodeRun(encodeDelta(array))}function decodeIntegerRun(intArray,divisor,output){return decodeInteger(decodeRun(intArray,getInt32View(output)),divisor,output)}function encodeIntegerRun(floatArray,factor){return encodeRun(encodeInteger(floatArray,factor))}function decodeIntegerDelta(intArray,divisor,output){return decodeInteger(decodeDelta(intArray,getInt32View(output)),divisor,output)}function encodeIntegerDelta(floatArray,factor,output){return encodeDelta(encodeInteger(floatArray,factor),output)}function decodeIntegerPacking(int16or8,divisor,output){return decodeInteger(decodePacking(int16or8,getInt32View(output)),divisor,output)}function decodeIntegerDeltaPacking(int16or8,divisor,output){var unpacked=decodePacking(int16or8,getInt32View(output));return decodeIntegerDelta(unpacked,divisor,getFloat32View(unpacked))}function encodeIntegerDeltaPacking(floatArray,factor,useInt8){return encodePacking(encodeIntegerDelta(floatArray,factor),useInt8)}function decodeBytes(bytes){var dv=getDataView(bytes);var type=dv.getInt32(0);var size=dv.getInt32(4);var param=bytes.subarray(8,12);var bytes=bytes.subarray(12);return[type,bytes,size,param]}function encodeBytes(type,size,param,bytes){var buffer=new ArrayBuffer(12+bytes.byteLength);var out=new Uint8Array(buffer);var dv=new DataView(buffer);dv.setInt32(0,type);dv.setInt32(4,size);if(param)out.set(param,8);out.set(bytes,12);return out}function passInt8(int8){var size=int8.length;var bytes=getUint8View(int8);return encodeBytes(2,size,undefined,bytes)}function passInt32(int32){var size=int32.length;var bytes=encodeInt32(int32);return encodeBytes(4,size,undefined,bytes)}function passString(stringBytes,length){var size=stringBytes.length/length;var param=encodeInt32([length]);var bytes=getUint8View(stringBytes);return encodeBytes(5,size,param,bytes)}function runChar(charBytes){var size=charBytes.length;var bytes=encodeInt32(encodeRun(charBytes));return encodeBytes(6,size,undefined,bytes)}function deltaRun(int32){var size=int32.length;var bytes=encodeInt32(encodeDeltaRun(int32));return encodeBytes(8,size,undefined,bytes)}function integerRun(float32,factor){var size=float32.length;var param=encodeInt32([factor]);var bytes=encodeInt32(encodeIntegerRun(float32,factor));return encodeBytes(9,size,param,bytes)}function integerDeltaPacking16(float32,factor){var size=float32.length;var param=encodeInt32([factor]);var bytes=encodeInt16(encodeIntegerDeltaPacking(float32,factor));return encodeBytes(10,size,param,bytes)}function encodeMmtf(inputDict){var outputDict={};PassThroughFields.forEach(function(name){if(inputDict[name]!==undefined){outputDict[name]=inputDict[name]}});if(inputDict.bondAtomList){outputDict.bondAtomList=passInt32(inputDict.bondAtomList)}if(inputDict.bondOrderList){outputDict.bondOrderList=passInt8(inputDict.bondOrderList)}outputDict.xCoordList=integerDeltaPacking16(inputDict.xCoordList,1e3);outputDict.yCoordList=integerDeltaPacking16(inputDict.yCoordList,1e3);outputDict.zCoordList=integerDeltaPacking16(inputDict.zCoordList,1e3);if(inputDict.bFactorList){outputDict.bFactorList=integerDeltaPacking16(inputDict.bFactorList,100)}if(inputDict.atomIdList){outputDict.atomIdList=deltaRun(inputDict.atomIdList)}if(inputDict.altLocList){outputDict.altLocList=runChar(inputDict.altLocList)}if(inputDict.occupancyList){outputDict.occupancyList=integerRun(inputDict.occupancyList,100)}outputDict.groupIdList=deltaRun(inputDict.groupIdList);outputDict.groupTypeList=passInt32(inputDict.groupTypeList);if(inputDict.secStructList){outputDict.secStructList=passInt8(inputDict.secStructList,1)}if(inputDict.insCodeList){outputDict.insCodeList=runChar(inputDict.insCodeList)}if(inputDict.sequenceIndexList){outputDict.sequenceIndexList=deltaRun(inputDict.sequenceIndexList)}outputDict.chainIdList=passString(inputDict.chainIdList,4);if(inputDict.chainNameList){outputDict.chainNameList=passString(inputDict.chainNameList,4)}return outputDict}function decodeMsgpack(buffer){var offset=0;var dataView=new DataView(buffer.buffer);function map(length){var value={};for(var i=0;i<length;i++){var key=parse();value[key]=parse()}return value}function bin(length){var value=buffer.subarray(offset,offset+length);offset+=length;return value}function str(length){var array=buffer.subarray(offset,offset+length);offset+=length;var chunkSize=65535;if(length>chunkSize){var c=[];for(var i=0;i<array.length;i+=chunkSize){c.push(String.fromCharCode.apply(null,array.subarray(i,i+chunkSize)))}return c.join("")}else{return String.fromCharCode.apply(null,array)}}function array(length){var value=new Array(length);for(var i=0;i<length;i++){value[i]=parse()}return value}function parse(){var type=buffer[offset];var value,length,extType;if((type&128)===0){offset++;return type}if((type&240)===128){length=type&15;offset++;return map(length)}if((type&240)===144){length=type&15;offset++;return array(length)}if((type&224)===160){length=type&31;offset++;return str(length)}if((type&224)===224){value=dataView.getInt8(offset);offset++;return value}switch(type){case 192:offset++;return null;case 194:offset++;return false;case 195:offset++;return true;case 196:length=dataView.getUint8(offset+1);offset+=2;return bin(length);case 197:length=dataView.getUint16(offset+1);offset+=3;return bin(length);case 198:length=dataView.getUint32(offset+1);offset+=5;return bin(length);case 202:value=dataView.getFloat32(offset+1);offset+=5;return value;case 203:value=dataView.getFloat64(offset+1);offset+=9;return value;case 204:value=buffer[offset+1];offset+=2;return value;case 205:value=dataView.getUint16(offset+1);offset+=3;return value;case 206:value=dataView.getUint32(offset+1);offset+=5;return value;case 208:value=dataView.getInt8(offset+1);offset+=2;return value;case 209:value=dataView.getInt16(offset+1);offset+=3;return value;case 210:value=dataView.getInt32(offset+1);offset+=5;return value;case 217:length=dataView.getUint8(offset+1);offset+=2;return str(length);case 218:length=dataView.getUint16(offset+1);offset+=3;return str(length);case 219:length=dataView.getUint32(offset+1);offset+=5;return str(length);case 220:length=dataView.getUint16(offset+1);offset+=3;return array(length);case 221:length=dataView.getUint32(offset+1);offset+=5;return array(length);case 222:length=dataView.getUint16(offset+1);offset+=3;return map(length);case 223:length=dataView.getUint32(offset+1);offset+=5;return map(length)}throw new Error("Unknown type 0x"+type.toString(16))}return parse()}function performDecoding(type,bytes,size,param){switch(type){case 1:return decodeFloat32(bytes);case 2:return getInt8View(bytes);case 3:return decodeInt16(bytes);case 4:return decodeInt32(bytes);case 5:return getUint8View(bytes);case 6:return decodeRun(decodeInt32(bytes),new Uint8Array(size));case 7:return decodeRun(decodeInt32(bytes));case 8:return decodeDeltaRun(decodeInt32(bytes));case 9:return decodeIntegerRun(decodeInt32(bytes),decodeInt32(param)[0]);case 10:return decodeIntegerDeltaPacking(decodeInt16(bytes),decodeInt32(param)[0]);case 11:return decodeInteger(decodeInt16(bytes),decodeInt32(param)[0]);case 12:return decodeIntegerPacking(decodeInt16(bytes),decodeInt32(param)[0]);case 13:return decodeIntegerPacking(getInt8View(bytes),decodeInt32(param)[0]);case 14:return decodePacking(decodeInt16(bytes));case 15:return decodePacking(getInt8View(bytes))}}function decodeMmtf(inputDict,params){params=params||{};var ignoreFields=params.ignoreFields;var outputDict={};AllFields.forEach(function(name){var ignore=ignoreFields?ignoreFields.indexOf(name)!==-1:false;var data=inputDict[name];if(!ignore&&data!==undefined){if(data instanceof Uint8Array){outputDict[name]=performDecoding.apply(null,decodeBytes(data))}else{outputDict[name]=data}}});return outputDict}function fromCharCode(charCodeArray){return String.fromCharCode.apply(null,charCodeArray).replace(/\0/g,"")}function traverseMmtf(mmtfData,eventCallbacks,params){params=params||{};var firstModelOnly=params.firstModelOnly;var onModel=eventCallbacks.onModel;var onChain=eventCallbacks.onChain;var onGroup=eventCallbacks.onGroup;var onAtom=eventCallbacks.onAtom;var onBond=eventCallbacks.onBond;var modelIndex=0;var chainIndex=0;var groupIndex=0;var atomIndex=0;var modelFirstAtomIndex=0;var modelLastAtomIndex=-1;var chainNameList=mmtfData.chainNameList;var secStructList=mmtfData.secStructList;var insCodeList=mmtfData.insCodeList;var sequenceIndexList=mmtfData.sequenceIndexList;var atomIdList=mmtfData.atomIdList;var bFactorList=mmtfData.bFactorList;var altLocList=mmtfData.altLocList;var occupancyList=mmtfData.occupancyList;var bondAtomList=mmtfData.bondAtomList;var bondOrderList=mmtfData.bondOrderList;var o,ol,i,j,k,kl;for(o=0,ol=mmtfData.chainsPerModel.length;o<ol;++o){if(firstModelOnly&&modelIndex>0)break;var modelChainCount=mmtfData.chainsPerModel[modelIndex];if(onModel){onModel({chainCount:modelChainCount,modelIndex:modelIndex})}for(i=0;i<modelChainCount;++i){var chainGroupCount=mmtfData.groupsPerChain[chainIndex];if(onChain){var chainId=fromCharCode(mmtfData.chainIdList.subarray(chainIndex*4,chainIndex*4+4));var chainName=null;if(chainNameList){chainName=fromCharCode(chainNameList.subarray(chainIndex*4,chainIndex*4+4))}onChain({groupCount:chainGroupCount,chainIndex:chainIndex,modelIndex:modelIndex,chainId:chainId,chainName:chainName})}for(j=0;j<chainGroupCount;++j){var groupData=mmtfData.groupList[mmtfData.groupTypeList[groupIndex]];var groupAtomCount=groupData.atomNameList.length;if(onGroup){var secStruct=null;if(secStructList){secStruct=secStructList[groupIndex]}var insCode=null;if(mmtfData.insCodeList){insCode=String.fromCharCode(insCodeList[groupIndex])}var sequenceIndex=null;if(sequenceIndexList){sequenceIndex=sequenceIndexList[groupIndex]}onGroup({atomCount:groupAtomCount,groupIndex:groupIndex,chainIndex:chainIndex,modelIndex:modelIndex,groupId:mmtfData.groupIdList[groupIndex],groupType:mmtfData.groupTypeList[groupIndex],groupName:groupData.groupName,singleLetterCode:groupData.singleLetterCode,chemCompType:groupData.chemCompType,secStruct:secStruct,insCode:insCode,sequenceIndex:sequenceIndex})}for(k=0;k<groupAtomCount;++k){if(onAtom){var atomId=null;if(atomIdList){atomId=atomIdList[atomIndex]}var bFactor=null;if(bFactorList){bFactor=bFactorList[atomIndex]}var altLoc=null;if(altLocList){altLoc=String.fromCharCode(altLocList[atomIndex])}var occupancy=null;if(occupancyList){occupancy=occupancyList[atomIndex]}onAtom({atomIndex:atomIndex,groupIndex:groupIndex,chainIndex:chainIndex,modelIndex:modelIndex,atomId:atomId,element:groupData.elementList[k],atomName:groupData.atomNameList[k],formalCharge:groupData.formalChargeList[k],xCoord:mmtfData.xCoordList[atomIndex],yCoord:mmtfData.yCoordList[atomIndex],zCoord:mmtfData.zCoordList[atomIndex],bFactor:bFactor,altLoc:altLoc,occupancy:occupancy})}atomIndex+=1}if(onBond){var groupBondAtomList=groupData.bondAtomList;for(k=0,kl=groupData.bondOrderList.length;k<kl;++k){onBond({atomIndex1:atomIndex-groupAtomCount+groupBondAtomList[k*2],atomIndex2:atomIndex-groupAtomCount+groupBondAtomList[k*2+1],bondOrder:groupData.bondOrderList[k]})}}groupIndex+=1}chainIndex+=1}modelFirstAtomIndex=modelLastAtomIndex+1;modelLastAtomIndex=atomIndex-1;if(onBond){if(bondAtomList){for(k=0,kl=bondAtomList.length;k<kl;k+=2){var atomIndex1=bondAtomList[k];var atomIndex2=bondAtomList[k+1];if(atomIndex1>=modelFirstAtomIndex&&atomIndex1<=modelLastAtomIndex||atomIndex2>=modelFirstAtomIndex&&atomIndex2<=modelLastAtomIndex){onBond({atomIndex1:atomIndex1,atomIndex2:atomIndex2,bondOrder:bondOrderList?bondOrderList[k/2]:null})}}}}modelIndex+=1}}var version="v1.0.0";var baseUrl="http://mmtf.rcsb.org/v1.0/";var fetchUrl=baseUrl+"full/";var fetchReducedUrl=baseUrl+"reduced/";function encode(mmtfData){return encodeMsgpack(encodeMmtf(mmtfData))}function decode(binOrDict,params){if(binOrDict instanceof ArrayBuffer){binOrDict=new Uint8Array(binOrDict)}var inputDict;if(binOrDict instanceof Uint8Array){inputDict=decodeMsgpack(binOrDict)}else{inputDict=binOrDict}return decodeMmtf(inputDict,params)}function _fetch(pdbid,baseUrl,onLoad,onError){var xhr=new XMLHttpRequest;function _onLoad(){try{var mmtfData=decode(xhr.response);onLoad(mmtfData)}catch(error){onError(error)}}xhr.addEventListener("load",_onLoad,true);xhr.addEventListener("error",onError,true);xhr.responseType="arraybuffer";xhr.open("GET",baseUrl+pdbid.toUpperCase());xhr.send()}function fetch(pdbid,onLoad,onError){_fetch(pdbid,fetchUrl,onLoad,onError)}function fetchReduced(pdbid,onLoad,onError){_fetch(pdbid,fetchReducedUrl,onLoad,onError)}exports.encode=encode;exports.decode=decode;exports.traverse=traverseMmtf;exports.fetch=fetch;exports.fetchReduced=fetchReduced;exports.version=version;exports.fetchUrl=fetchUrl;exports.fetchReducedUrl=fetchReducedUrl;exports.encodeMsgpack=encodeMsgpack;exports.encodeMmtf=encodeMmtf;exports.decodeMsgpack=decodeMsgpack;exports.decodeMmtf=decodeMmtf;Object.defineProperty(exports,"__esModule",{value:true})})(global.MMTF=global.MMTF||{})}(this),function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define("pako",[],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var TYPED_OK="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;exports.assign=function(obj){for(var sources=Array.prototype.slice.call(arguments,1);sources.length;){var source=sources.shift();if(source){if("object"!=typeof source)throw new TypeError(source+"must be non-object");for(var p in source)source.hasOwnProperty(p)&&(obj[p]=source[p])}}return obj},exports.shrinkBuf=function(buf,size){return buf.length===size?buf:buf.subarray?buf.subarray(0,size):(buf.length=size,buf)};var fnTyped={arraySet:function(dest,src,src_offs,len,dest_offs){if(src.subarray&&dest.subarray)dest.set(src.subarray(src_offs,src_offs+len),dest_offs);else for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){var i,l,len,pos,chunk,result;for(len=0,i=0,l=chunks.length;i<l;i++)len+=chunks[i].length;for(result=new Uint8Array(len),pos=0,i=0,l=chunks.length;i<l;i++)chunk=chunks[i],result.set(chunk,pos),pos+=chunk.length;return result}},fnUntyped={arraySet:function(dest,src,src_offs,len,dest_offs){for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports.setTyped=function(on){on?(exports.Buf8=Uint8Array,exports.Buf16=Uint16Array,exports.Buf32=Int32Array,exports.assign(exports,fnTyped)):(exports.Buf8=Array,exports.Buf16=Array,exports.Buf32=Array,exports.assign(exports,fnUntyped))},exports.setTyped(TYPED_OK)},{}],2:[function(require,module,exports){"use strict";function buf2binstring(buf,len){if(len<65537&&(buf.subarray&&STR_APPLY_UIA_OK||!buf.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils.shrinkBuf(buf,len));for(var result="",i=0;i<len;i++)result+=String.fromCharCode(buf[i]);return result}var utils=require("./common"),STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(__){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1,exports.string2buf=function(str){var buf,c,c2,m_pos,i,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),buf_len+=c<128?1:c<2048?2:c<65536?3:4;for(buf=new utils.Buf8(buf_len),i=0,m_pos=0;i<buf_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),c<128?buf[i++]=c:c<2048?(buf[i++]=192|c>>>6,buf[i++]=128|63&c):c<65536?(buf[i++]=224|c>>>12,buf[i++]=128|c>>>6&63,buf[i++]=128|63&c):(buf[i++]=240|c>>>18,buf[i++]=128|c>>>12&63,buf[i++]=128|c>>>6&63,buf[i++]=128|63&c);return buf},exports.buf2binstring=function(buf){return buf2binstring(buf,buf.length)},exports.binstring2buf=function(str){for(var buf=new utils.Buf8(str.length),i=0,len=buf.length;i<len;i++)buf[i]=str.charCodeAt(i);return buf},exports.buf2string=function(buf,max){var i,out,c,c_len,len=max||buf.length,utf16buf=new Array(2*len);for(out=0,i=0;i<len;)if((c=buf[i++])<128)utf16buf[out++]=c;else if((c_len=_utf8len[c])>4)utf16buf[out++]=65533,i+=c_len-1;else{for(c&=2===c_len?31:3===c_len?15:7;c_len>1&&i<len;)c=c<<6|63&buf[i++],c_len--;c_len>1?utf16buf[out++]=65533:c<65536?utf16buf[out++]=c:(c-=65536,utf16buf[out++]=55296|c>>10&1023,utf16buf[out++]=56320|1023&c)}return buf2binstring(utf16buf,out)},exports.utf8border=function(buf,max){var pos;for((max=max||buf.length)>buf.length&&(max=buf.length),pos=max-1;pos>=0&&128==(192&buf[pos]);)pos--;return pos<0?max:0===pos?max:pos+_utf8len[buf[pos]]>max?pos:max}},{"./common":1}],3:[function(require,module,exports){"use strict";module.exports=function(adler,buf,len,pos){for(var s1=65535&adler|0,s2=adler>>>16&65535|0,n=0;0!==len;){len-=n=len>2e3?2e3:len;do{s2=s2+(s1=s1+buf[pos++]|0)|0}while(--n);s1%=65521,s2%=65521}return s1|s2<<16|0}},{}],4:[function(require,module,exports){module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(require,module,exports){"use strict";var crcTable=function(){for(var c,table=[],n=0;n<256;n++){c=n;for(var k=0;k<8;k++)c=1&c?3988292384^c>>>1:c>>>1;table[n]=c}return table}();module.exports=function(crc,buf,len,pos){var t=crcTable,end=pos+len;crc^=-1;for(var i=pos;i<end;i++)crc=crc>>>8^t[255&(crc^buf[i])];return-1^crc}},{}],6:[function(require,module,exports){"use strict";module.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],7:[function(require,module,exports){"use strict";module.exports=function(strm,start){var state,_in,last,_out,beg,end,dmax,wsize,whave,wnext,window,hold,bits,lcode,dcode,lmask,dmask,here,op,len,dist,from,from_source,input,output;state=strm.state,_in=strm.next_in,input=strm.input,last=_in+(strm.avail_in-5),_out=strm.next_out,output=strm.output,beg=_out-(start-strm.avail_out),end=_out+(strm.avail_out-257),dmax=state.dmax,wsize=state.wsize,whave=state.whave,wnext=state.wnext,window=state.window,hold=state.hold,bits=state.bits,lcode=state.lencode,dcode=state.distcode,lmask=(1<<state.lenbits)-1,dmask=(1<<state.distbits)-1;top:do{bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=lcode[hold&lmask];dolen:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,0===(op=here>>>16&255))output[_out++]=65535&here;else{if(!(16&op)){if(0==(64&op)){here=lcode[(65535&here)+(hold&(1<<op)-1)];continue dolen}if(32&op){state.mode=12;break top}strm.msg="invalid literal/length code",state.mode=30;break top}len=65535&here,(op&=15)&&(bits<op&&(hold+=input[_in++]<<bits,bits+=8),len+=hold&(1<<op)-1,hold>>>=op,bits-=op),bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=dcode[hold&dmask];dodist:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,!(16&(op=here>>>16&255))){if(0==(64&op)){here=dcode[(65535&here)+(hold&(1<<op)-1)];continue dodist}strm.msg="invalid distance code",state.mode=30;break top}if(dist=65535&here,op&=15,bits<op&&(hold+=input[_in++]<<bits,(bits+=8)<op&&(hold+=input[_in++]<<bits,bits+=8)),(dist+=hold&(1<<op)-1)>dmax){strm.msg="invalid distance too far back",state.mode=30;break top}if(hold>>>=op,bits-=op,op=_out-beg,dist>op){if((op=dist-op)>whave&&state.sane){strm.msg="invalid distance too far back",state.mode=30;break top}if(from=0,from_source=window,0===wnext){if(from+=wsize-op,op<len){len-=op;do{output[_out++]=window[from++]}while(--op);from=_out-dist,from_source=output}}else if(wnext<op){if(from+=wsize+wnext-op,(op-=wnext)<len){len-=op;do{output[_out++]=window[from++]}while(--op);if(from=0,wnext<len){len-=op=wnext;do{output[_out++]=window[from++]}while(--op);from=_out-dist,from_source=output}}}else if(from+=wnext-op,op<len){len-=op;do{output[_out++]=window[from++]}while(--op);from=_out-dist,from_source=output}for(;len>2;)output[_out++]=from_source[from++],output[_out++]=from_source[from++],output[_out++]=from_source[from++],len-=3;len&&(output[_out++]=from_source[from++],len>1&&(output[_out++]=from_source[from++]))}else{from=_out-dist;do{output[_out++]=output[from++],output[_out++]=output[from++],output[_out++]=output[from++],len-=3}while(len>2);len&&(output[_out++]=output[from++],len>1&&(output[_out++]=output[from++]))}break}}break}}while(_in<last&&_out<end);_in-=len=bits>>3,hold&=(1<<(bits-=len<<3))-1,strm.next_in=_in,strm.next_out=_out,strm.avail_in=_in<last?last-_in+5:5-(_in-last),strm.avail_out=_out<end?end-_out+257:257-(_out-end),state.hold=hold,state.bits=bits}},{}],8:[function(require,module,exports){"use strict";function ZSWAP32(q){return(q>>>24&255)+(q>>>8&65280)+((65280&q)<<8)+((255&q)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils.Buf16(320),this.work=new utils.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(strm){var state;return strm&&strm.state?(state=strm.state,strm.total_in=strm.total_out=state.total=0,strm.msg="",state.wrap&&(strm.adler=1&state.wrap),state.mode=HEAD,state.last=0,state.havedict=0,state.dmax=32768,state.head=null,state.hold=0,state.bits=0,state.lencode=state.lendyn=new utils.Buf32(ENOUGH_LENS),state.distcode=state.distdyn=new utils.Buf32(ENOUGH_DISTS),state.sane=1,state.back=-1,Z_OK):Z_STREAM_ERROR}function inflateReset(strm){var state;return strm&&strm.state?(state=strm.state,state.wsize=0,state.whave=0,state.wnext=0,inflateResetKeep(strm)):Z_STREAM_ERROR}function inflateReset2(strm,windowBits){var wrap,state;return strm&&strm.state?(state=strm.state,windowBits<0?(wrap=0,windowBits=-windowBits):(wrap=1+(windowBits>>4),windowBits<48&&(windowBits&=15)),windowBits&&(windowBits<8||windowBits>15)?Z_STREAM_ERROR:(null!==state.window&&state.wbits!==windowBits&&(state.window=null),state.wrap=wrap,state.wbits=windowBits,inflateReset(strm))):Z_STREAM_ERROR}function inflateInit2(strm,windowBits){var ret,state;return strm?(state=new InflateState,strm.state=state,state.window=null,(ret=inflateReset2(strm,windowBits))!==Z_OK&&(strm.state=null),ret):Z_STREAM_ERROR}function fixedtables(state){if(virgin){var sym;for(lenfix=new utils.Buf32(512),distfix=new utils.Buf32(32),sym=0;sym<144;)state.lens[sym++]=8;for(;sym<256;)state.lens[sym++]=9;for(;sym<280;)state.lens[sym++]=7;for(;sym<288;)state.lens[sym++]=8;for(inflate_table(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9}),sym=0;sym<32;)state.lens[sym++]=5;inflate_table(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5}),virgin=!1}state.lencode=lenfix,state.lenbits=9,state.distcode=distfix,state.distbits=5}function updatewindow(strm,src,end,copy){var dist,state=strm.state;return null===state.window&&(state.wsize=1<<state.wbits,state.wnext=0,state.whave=0,state.window=new utils.Buf8(state.wsize)),copy>=state.wsize?(utils.arraySet(state.window,src,end-state.wsize,state.wsize,0),state.wnext=0,state.whave=state.wsize):((dist=state.wsize-state.wnext)>copy&&(dist=copy),utils.arraySet(state.window,src,end-copy,dist,state.wnext),(copy-=dist)?(utils.arraySet(state.window,src,end-copy,copy,0),state.wnext=copy,state.whave=state.wsize):(state.wnext+=dist,state.wnext===state.wsize&&(state.wnext=0),state.whave<state.wsize&&(state.whave+=dist))),0}var lenfix,distfix,utils=require("../utils/common"),adler32=require("./adler32"),crc32=require("./crc32"),inflate_fast=require("./inffast"),inflate_table=require("./inftrees"),CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,DEF_WBITS=15,virgin=!0;exports.inflateReset=inflateReset,exports.inflateReset2=inflateReset2,exports.inflateResetKeep=inflateResetKeep,exports.inflateInit=function(strm){return inflateInit2(strm,DEF_WBITS)},exports.inflateInit2=inflateInit2,exports.inflate=function(strm,flush){var state,input,output,next,put,have,left,hold,bits,_in,_out,copy,from,from_source,here_bits,here_op,here_val,last_bits,last_op,last_val,len,ret,opts,n,here=0,hbuf=new utils.Buf8(4),order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&0!==strm.avail_in)return Z_STREAM_ERROR;(state=strm.state).mode===TYPE&&(state.mode=TYPEDO),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,_in=have,_out=left,ret=Z_OK;inf_leave:for(;;)switch(state.mode){case HEAD:if(0===state.wrap){state.mode=TYPEDO;break}for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(2&state.wrap&&35615===hold){state.check=0,hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0),hold=0,bits=0,state.mode=FLAGS;break}if(state.flags=0,state.head&&(state.head.done=!1),!(1&state.wrap)||(((255&hold)<<8)+(hold>>8))%31){strm.msg="incorrect header check",state.mode=BAD;break}if((15&hold)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(hold>>>=4,bits-=4,len=8+(15&hold),0===state.wbits)state.wbits=len;else if(len>state.wbits){strm.msg="invalid window size",state.mode=BAD;break}state.dmax=1<<len,strm.adler=state.check=1,state.mode=512&hold?DICTID:TYPE,hold=0,bits=0;break;case FLAGS:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.flags=hold,(255&state.flags)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(57344&state.flags){strm.msg="unknown header flags set",state.mode=BAD;break}state.head&&(state.head.text=hold>>8&1),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=TIME;case TIME:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.time=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,hbuf[2]=hold>>>16&255,hbuf[3]=hold>>>24&255,state.check=crc32(state.check,hbuf,4,0)),hold=0,bits=0,state.mode=OS;case OS:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.xflags=255&hold,state.head.os=hold>>8),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=EXLEN;case EXLEN:if(1024&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length=hold,state.head&&(state.head.extra_len=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0}else state.head&&(state.head.extra=null);state.mode=EXTRA;case EXTRA:if(1024&state.flags&&((copy=state.length)>have&&(copy=have),copy&&(state.head&&(len=state.head.extra_len-state.length,state.head.extra||(state.head.extra=new Array(state.head.extra_len)),utils.arraySet(state.head.extra,input,next,copy,len)),512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,state.length-=copy),state.length))break inf_leave;state.length=0,state.mode=NAME;case NAME:if(2048&state.flags){if(0===have)break inf_leave;copy=0;do{len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.name+=String.fromCharCode(len))}while(len&&copy<have);if(512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.name=null);state.length=0,state.mode=COMMENT;case COMMENT:if(4096&state.flags){if(0===have)break inf_leave;copy=0;do{len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.comment+=String.fromCharCode(len))}while(len&&copy<have);if(512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.comment=null);state.mode=HCRC;case HCRC:if(512&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(65535&state.check)){strm.msg="header crc mismatch",state.mode=BAD;break}hold=0,bits=0}state.head&&(state.head.hcrc=state.flags>>9&1,state.head.done=!0),strm.adler=state.check=0,state.mode=TYPE;break;case DICTID:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}strm.adler=state.check=ZSWAP32(hold),hold=0,bits=0,state.mode=DICT;case DICT:if(0===state.havedict)return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,Z_NEED_DICT;strm.adler=state.check=1,state.mode=TYPE;case TYPE:if(flush===Z_BLOCK||flush===Z_TREES)break inf_leave;case TYPEDO:if(state.last){hold>>>=7&bits,bits-=7&bits,state.mode=CHECK;break}for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}switch(state.last=1&hold,hold>>>=1,bits-=1,3&hold){case 0:state.mode=STORED;break;case 1:if(fixedtables(state),state.mode=LEN_,flush===Z_TREES){hold>>>=2,bits-=2;break inf_leave}break;case 2:state.mode=TABLE;break;case 3:strm.msg="invalid block type",state.mode=BAD}hold>>>=2,bits-=2;break;case STORED:for(hold>>>=7&bits,bits-=7&bits;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if((65535&hold)!=(hold>>>16^65535)){strm.msg="invalid stored block lengths",state.mode=BAD;break}if(state.length=65535&hold,hold=0,bits=0,state.mode=COPY_,flush===Z_TREES)break inf_leave;case COPY_:state.mode=COPY;case COPY:if(copy=state.length){if(copy>have&&(copy=have),copy>left&&(copy=left),0===copy)break inf_leave;utils.arraySet(output,input,next,copy,put),have-=copy,next+=copy,left-=copy,put+=copy,state.length-=copy;break}state.mode=TYPE;break;case TABLE:for(;bits<14;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.nlen=257+(31&hold),hold>>>=5,bits-=5,state.ndist=1+(31&hold),hold>>>=5,bits-=5,state.ncode=4+(15&hold),hold>>>=4,bits-=4,state.nlen>286||state.ndist>30){strm.msg="too many length or distance symbols",state.mode=BAD;break}state.have=0,state.mode=LENLENS;case LENLENS:for(;state.have<state.ncode;){for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.lens[order[state.have++]]=7&hold,hold>>>=3,bits-=3}for(;state.have<19;)state.lens[order[state.have++]]=0;if(state.lencode=state.lendyn,state.lenbits=7,opts={bits:state.lenbits},ret=inflate_table(CODES,state.lens,0,19,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid code lengths set",state.mode=BAD;break}state.have=0,state.mode=CODELENS;case CODELENS:for(;state.have<state.nlen+state.ndist;){for(;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_val<16)hold>>>=here_bits,bits-=here_bits,state.lens[state.have++]=here_val;else{if(16===here_val){for(n=here_bits+2;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold>>>=here_bits,bits-=here_bits,0===state.have){strm.msg="invalid bit length repeat",state.mode=BAD;break}len=state.lens[state.have-1],copy=3+(3&hold),hold>>>=2,bits-=2}else if(17===here_val){for(n=here_bits+3;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}bits-=here_bits,len=0,copy=3+(7&(hold>>>=here_bits)),hold>>>=3,bits-=3}else{for(n=here_bits+7;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}bits-=here_bits,len=0,copy=11+(127&(hold>>>=here_bits)),hold>>>=7,bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat",state.mode=BAD;break}for(;copy--;)state.lens[state.have++]=len}}if(state.mode===BAD)break;if(0===state.lens[256]){strm.msg="invalid code -- missing end-of-block",state.mode=BAD;break}if(state.lenbits=9,opts={bits:state.lenbits},ret=inflate_table(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid literal/lengths set",state.mode=BAD;break}if(state.distbits=6,state.distcode=state.distdyn,opts={bits:state.distbits},ret=inflate_table(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts),state.distbits=opts.bits,ret){strm.msg="invalid distances set",state.mode=BAD;break}if(state.mode=LEN_,flush===Z_TREES)break inf_leave;case LEN_:state.mode=LEN;case LEN:if(have>=6&&left>=258){strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,inflate_fast(strm,_out),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,state.mode===TYPE&&(state.back=-1);break}for(state.back=0;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_op&&0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(last_bits+here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,state.length=here_val,0===here_op){state.mode=LIT;break}if(32&here_op){state.back=-1,state.mode=TYPE;break}if(64&here_op){strm.msg="invalid literal/length code",state.mode=BAD;break}state.extra=15&here_op,state.mode=LENEXT;case LENEXT:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}state.was=state.length,state.mode=DIST;case DIST:for(;here=state.distcode[hold&(1<<state.distbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(last_bits+here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,64&here_op){strm.msg="invalid distance code",state.mode=BAD;break}state.offset=here_val,state.extra=15&here_op,state.mode=DISTEXT;case DISTEXT:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.offset+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back",state.mode=BAD;break}state.mode=MATCH;case MATCH:if(0===left)break inf_leave;if(copy=_out-left,state.offset>copy){if((copy=state.offset-copy)>state.whave&&state.sane){strm.msg="invalid distance too far back",state.mode=BAD;break}copy>state.wnext?(copy-=state.wnext,from=state.wsize-copy):from=state.wnext-copy,copy>state.length&&(copy=state.length),from_source=state.window}else from_source=output,from=put-state.offset,copy=state.length;copy>left&&(copy=left),left-=copy,state.length-=copy;do{output[put++]=from_source[from++]}while(--copy);0===state.length&&(state.mode=LEN);break;case LIT:if(0===left)break inf_leave;output[put++]=state.length,left--,state.mode=LEN;break;case CHECK:if(state.wrap){for(;bits<32;){if(0===have)break inf_leave;have--,hold|=input[next++]<<bits,bits+=8}if(_out-=left,strm.total_out+=_out,state.total+=_out,_out&&(strm.adler=state.check=state.flags?crc32(state.check,output,_out,put-_out):adler32(state.check,output,_out,put-_out)),_out=left,(state.flags?hold:ZSWAP32(hold))!==state.check){strm.msg="incorrect data check",state.mode=BAD;break}hold=0,bits=0}state.mode=LENGTH;case LENGTH:if(state.wrap&&state.flags){for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(4294967295&state.total)){strm.msg="incorrect length check",state.mode=BAD;break}hold=0,bits=0}state.mode=DONE;case DONE:ret=Z_STREAM_END;break inf_leave;case BAD:ret=Z_DATA_ERROR;break inf_leave;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,(state.wsize||_out!==strm.avail_out&&state.mode<BAD&&(state.mode<CHECK||flush!==Z_FINISH))&&updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)?(state.mode=MEM,Z_MEM_ERROR):(_in-=strm.avail_in,_out-=strm.avail_out,strm.total_in+=_in,strm.total_out+=_out,state.total+=_out,state.wrap&&_out&&(strm.adler=state.check=state.flags?crc32(state.check,output,_out,strm.next_out-_out):adler32(state.check,output,_out,strm.next_out-_out)),strm.data_type=state.bits+(state.last?64:0)+(state.mode===TYPE?128:0)+(state.mode===LEN_||state.mode===COPY_?256:0),(0===_in&&0===_out||flush===Z_FINISH)&&ret===Z_OK&&(ret=Z_BUF_ERROR),ret)},exports.inflateEnd=function(strm){if(!strm||!strm.state)return Z_STREAM_ERROR;var state=strm.state;return state.window&&(state.window=null),strm.state=null,Z_OK},exports.inflateGetHeader=function(strm,head){var state;return strm&&strm.state?0==(2&(state=strm.state).wrap)?Z_STREAM_ERROR:(state.head=head,head.done=!1,Z_OK):Z_STREAM_ERROR},exports.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(require,module,exports){"use strict";var utils=require("../utils/common"),lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function(type,lens,lens_index,codes,table,table_index,work,opts){var incr,fill,low,mask,next,end,here_bits,here_op,here_val,bits=opts.bits,len=0,sym=0,min=0,max=0,root=0,curr=0,drop=0,left=0,used=0,huff=0,base=null,base_index=0,count=new utils.Buf16(16),offs=new utils.Buf16(16),extra=null,extra_index=0;for(len=0;len<=15;len++)count[len]=0;for(sym=0;sym<codes;sym++)count[lens[lens_index+sym]]++;for(root=bits,max=15;max>=1&&0===count[max];max--);if(root>max&&(root=max),0===max)return table[table_index++]=20971520,table[table_index++]=20971520,opts.bits=1,0;for(min=1;min<max&&0===count[min];min++);for(root<min&&(root=min),left=1,len=1;len<=15;len++)if(left<<=1,(left-=count[len])<0)return-1;if(left>0&&(0===type||1!==max))return-1;for(offs[1]=0,len=1;len<15;len++)offs[len+1]=offs[len]+count[len];for(sym=0;sym<codes;sym++)0!==lens[lens_index+sym]&&(work[offs[lens[lens_index+sym]]++]=sym);if(0===type?(base=extra=work,end=19):1===type?(base=lbase,base_index-=257,extra=lext,extra_index-=257,end=256):(base=dbase,extra=dext,end=-1),huff=0,sym=0,len=min,next=table_index,curr=root,drop=0,low=-1,used=1<<root,mask=used-1,1===type&&used>852||2===type&&used>592)return 1;for(;;){0,here_bits=len-drop,work[sym]<end?(here_op=0,here_val=work[sym]):work[sym]>end?(here_op=extra[extra_index+work[sym]],here_val=base[base_index+work[sym]]):(here_op=96,here_val=0),incr=1<<len-drop,min=fill=1<<curr;do{table[next+(huff>>drop)+(fill-=incr)]=here_bits<<24|here_op<<16|here_val|0}while(0!==fill);for(incr=1<<len-1;huff&incr;)incr>>=1;if(0!==incr?(huff&=incr-1,huff+=incr):huff=0,sym++,0==--count[len]){if(len===max)break;len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){for(0===drop&&(drop=root),next+=min,left=1<<(curr=len-drop);curr+drop<max&&!((left-=count[curr+drop])<=0);)curr++,left<<=1;if(used+=1<<curr,1===type&&used>852||2===type&&used>592)return 1;table[low=huff&mask]=root<<24|curr<<16|next-table_index|0}}return 0!==huff&&(table[next+huff]=len-drop<<24|64<<16|0),opts.bits=root,0}},{"../utils/common":1}],10:[function(require,module,exports){"use strict";module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(require,module,exports){"use strict";module.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/lib/inflate.js":[function(require,module,exports){"use strict";function inflate(input,options){var inflator=new Inflate(options);if(inflator.push(input,!0),inflator.err)throw inflator.msg;return inflator.result}var zlib_inflate=require("./zlib/inflate.js"),utils=require("./utils/common"),strings=require("./utils/strings"),c=require("./zlib/constants"),msg=require("./zlib/messages"),zstream=require("./zlib/zstream"),gzheader=require("./zlib/gzheader"),toString=Object.prototype.toString,Inflate=function(options){this.options=utils.assign({chunkSize:16384,windowBits:0,to:""},options||{});var opt=this.options;opt.raw&&opt.windowBits>=0&&opt.windowBits<16&&(opt.windowBits=-opt.windowBits,0===opt.windowBits&&(opt.windowBits=-15)),!(opt.windowBits>=0&&opt.windowBits<16)||options&&options.windowBits||(opt.windowBits+=32),opt.windowBits>15&&opt.windowBits<48&&0==(15&opt.windowBits)&&(opt.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var status=zlib_inflate.inflateInit2(this.strm,opt.windowBits);if(status!==c.Z_OK)throw new Error(msg[status]);this.header=new gzheader,zlib_inflate.inflateGetHeader(this.strm,this.header)};Inflate.prototype.push=function(data,mode){var status,_mode,next_out_utf8,tail,utf8str,strm=this.strm,chunkSize=this.options.chunkSize;if(this.ended)return!1;_mode=mode===~~mode?mode:!0===mode?c.Z_FINISH:c.Z_NO_FLUSH,"string"==typeof data?strm.input=strings.binstring2buf(data):"[object ArrayBuffer]"===toString.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;do{if(0===strm.avail_out&&(strm.output=new utils.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),(status=zlib_inflate.inflate(strm,c.Z_NO_FLUSH))!==c.Z_STREAM_END&&status!==c.Z_OK)return this.onEnd(status),this.ended=!0,!1;strm.next_out&&(0!==strm.avail_out&&status!==c.Z_STREAM_END&&(0!==strm.avail_in||_mode!==c.Z_FINISH&&_mode!==c.Z_SYNC_FLUSH)||("string"===this.options.to?(next_out_utf8=strings.utf8border(strm.output,strm.next_out),tail=strm.next_out-next_out_utf8,utf8str=strings.buf2string(strm.output,next_out_utf8),strm.next_out=tail,strm.avail_out=chunkSize-tail,tail&&utils.arraySet(strm.output,strm.output,next_out_utf8,tail,0),this.onData(utf8str)):this.onData(utils.shrinkBuf(strm.output,strm.next_out))))}while(strm.avail_in>0&&status!==c.Z_STREAM_END);return status===c.Z_STREAM_END&&(_mode=c.Z_FINISH),_mode===c.Z_FINISH?(status=zlib_inflate.inflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===c.Z_OK):_mode!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),strm.avail_out=0,!0)},Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Inflate.prototype.onEnd=function(status){status===c.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg},exports.Inflate=Inflate,exports.inflate=inflate,exports.inflateRaw=function(input,options){return options=options||{},options.raw=!0,inflate(input,options)},exports.ungzip=inflate},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate.js":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}),function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.netcdfjs=factory():root.netcdfjs=factory()}(this,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=6)}([function(module,exports,__webpack_require__){"use strict";function padding(buffer){buffer.offset%4!=0&&buffer.skip(4-buffer.offset%4)}module.exports.notNetcdf=function(statement,reason){if(statement)throw new TypeError("Not a valid NetCDF v3.x file: "+reason)},module.exports.padding=padding,module.exports.readName=function(buffer){var nameLength=buffer.readUint32(),name=buffer.readChars(nameLength);return padding(buffer),name}},function(module,exports,__webpack_require__){"use strict";function readNumber(size,bufferReader){if(1!==size){for(var numbers=new Array(size),i=0;i<size;i++)numbers[i]=bufferReader();return numbers}return bufferReader()}function trimNull(value){return 0===value.charCodeAt(value.length-1)?value.substring(0,value.length-1):value}const notNetcdf=__webpack_require__(0).notNetcdf,types={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};module.exports=types,module.exports.num2str=function(type){switch(Number(type)){case types.BYTE:return"byte";case types.CHAR:return"char";case types.SHORT:return"short";case types.INT:return"int";case types.FLOAT:return"float";case types.DOUBLE:return"double";default:return"undefined"}},module.exports.num2bytes=function(type){switch(Number(type)){case types.BYTE:case types.CHAR:return 1;case types.SHORT:return 2;case types.INT:case types.FLOAT:return 4;case types.DOUBLE:return 8;default:return-1}},module.exports.str2num=function(type){switch(String(type)){case"byte":return types.BYTE;case"char":return types.CHAR;case"short":return types.SHORT;case"int":return types.INT;case"float":return types.FLOAT;case"double":return types.DOUBLE;default:return-1}},module.exports.readType=function(buffer,type,size){switch(type){case types.BYTE:return buffer.readBytes(size);case types.CHAR:return trimNull(buffer.readChars(size));case types.SHORT:return readNumber(size,buffer.readInt16.bind(buffer));case types.INT:return readNumber(size,buffer.readInt32.bind(buffer));case types.FLOAT:return readNumber(size,buffer.readFloat32.bind(buffer));case types.DOUBLE:return readNumber(size,buffer.readFloat64.bind(buffer));default:return void notNetcdf(!0,"non valid type "+type)}}},function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){"use strict";const types=__webpack_require__(1);module.exports.nonRecord=function(buffer,variable){const type=types.str2num(variable.type);for(var size=variable.size/types.num2bytes(type),data=new Array(size),i=0;i<size;i++)data[i]=types.readType(buffer,type,1);return data},module.exports.record=function(buffer,variable,recordDimension){const type=types.str2num(variable.type),width=variable.size?variable.size/types.num2bytes(type):1;var size=recordDimension.length,data=new Array(size);const step=recordDimension.recordStep;for(var i=0;i<size;i++){var currentOffset=buffer.offset;data[i]=types.readType(buffer,type,width),buffer.seek(currentOffset+step)}return data}},function(module,exports,__webpack_require__){"use strict";function dimensionsList(buffer){var recordId,recordName;const dimList=buffer.readUint32();if(dimList===ZERO)return utils.notNetcdf(buffer.readUint32()!==ZERO,"wrong empty tag for list of dimensions"),[];{utils.notNetcdf(dimList!==NC_DIMENSION,"wrong tag for list of dimensions");const dimensionSize=buffer.readUint32();for(var dimensions=new Array(dimensionSize),dim=0;dim<dimensionSize;dim++){var name=utils.readName(buffer);const size=buffer.readUint32();0===size&&(recordId=dim,recordName=name),dimensions[dim]={name:name,size:size}}}return{dimensions:dimensions,recordId:recordId,recordName:recordName}}function attributesList(buffer){const gAttList=buffer.readUint32();if(gAttList===ZERO)return utils.notNetcdf(buffer.readUint32()!==ZERO,"wrong empty tag for list of attributes"),[];{utils.notNetcdf(gAttList!==NC_ATTRIBUTE,"wrong tag for list of attributes");const attributeSize=buffer.readUint32();for(var attributes=new Array(attributeSize),gAtt=0;gAtt<attributeSize;gAtt++){var name=utils.readName(buffer),type=buffer.readUint32();utils.notNetcdf(type<1||type>6,"non valid type "+type);var size=buffer.readUint32(),value=types.readType(buffer,type,size);utils.padding(buffer),attributes[gAtt]={name:name,type:types.num2str(type),value:value}}}return attributes}function variablesList(buffer,recordId,version){const varList=buffer.readUint32();var recordStep=0;if(varList===ZERO)return utils.notNetcdf(buffer.readUint32()!==ZERO,"wrong empty tag for list of variables"),[];{utils.notNetcdf(varList!==NC_VARIABLE,"wrong tag for list of variables");const variableSize=buffer.readUint32();for(var variables=new Array(variableSize),v=0;v<variableSize;v++){var name=utils.readName(buffer);const dimensionality=buffer.readUint32();for(var dimensionsIds=new Array(dimensionality),dim=0;dim<dimensionality;dim++)dimensionsIds[dim]=buffer.readUint32();var attributes=attributesList(buffer),type=buffer.readUint32();utils.notNetcdf(type<1&&type>6,"non valid type "+type);const varSize=buffer.readUint32();var offset=buffer.readUint32();2===version&&(utils.notNetcdf(offset>0,"offsets larger than 4GB not supported"),offset=buffer.readUint32()),dimensionsIds[0]===recordId&&(recordStep+=varSize),variables[v]={name:name,dimensions:dimensionsIds,attributes:attributes,type:types.num2str(type),size:varSize,offset:offset,record:dimensionsIds[0]===recordId}}}return{variables:variables,recordStep:recordStep}}const utils=__webpack_require__(0),types=__webpack_require__(1),ZERO=0,NC_DIMENSION=10,NC_VARIABLE=11,NC_ATTRIBUTE=12;module.exports=function(buffer,version){var header={recordDimension:{length:buffer.readUint32()}};header.version=version;var dimList=dimensionsList(buffer);header.recordDimension.id=dimList.recordId,header.recordDimension.name=dimList.recordName,header.dimensions=dimList.dimensions,header.globalAttributes=attributesList(buffer);var variables=variablesList(buffer,dimList.recordId,version);return header.variables=variables.variables,header.recordDimension.recordStep=variables.recordStep,header}},function(module,exports,__webpack_require__){"use strict";(function(Buffer){const utf8=__webpack_require__(11),defaultByteLength=8192,charArray=[];class IOBuffer{constructor(data,options){options=options||{};var dataIsGiven=!1;void 0===data&&(data=defaultByteLength),"number"==typeof data?data=new ArrayBuffer(data):(dataIsGiven=!0,this._lastWrittenByte=data.byteLength);const offset=options.offset?options.offset>>>0:0;let byteLength=data.byteLength-offset,dvOffset=offset;data.buffer&&(data.byteLength!==data.buffer.byteLength&&(dvOffset=data.byteOffset+offset),data=data.buffer),this._lastWrittenByte=dataIsGiven?byteLength:0,this.buffer=data,this.length=byteLength,this.byteLength=byteLength,this.byteOffset=dvOffset,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,dvOffset,byteLength),this._mark=0,this._marks=[]}available(byteLength){return void 0===byteLength&&(byteLength=1),this.offset+byteLength<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(n){return void 0===n&&(n=1),this.offset+=n,this}seek(offset){return this.offset=offset,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const offset=this._marks.pop();if(void 0===offset)throw new Error("Mark stack empty");return this.seek(offset),this}rewind(){return this.offset=0,this}ensureAvailable(byteLength){if(void 0===byteLength&&(byteLength=1),!this.available(byteLength)){const newLength=2*(this.offset+byteLength),newArray=new Uint8Array(newLength);newArray.set(new Uint8Array(this.buffer)),this.buffer=newArray.buffer,this.length=this.byteLength=newLength,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(n){void 0===n&&(n=1);for(var bytes=new Uint8Array(n),i=0;i<n;i++)bytes[i]=this.readByte();return bytes}readInt16(){var value=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,value}readUint16(){var value=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,value}readInt32(){var value=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,value}readUint32(){var value=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat32(){var value=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat64(){var value=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,value}readChar(){return String.fromCharCode(this.readInt8())}readChars(n){void 0===n&&(n=1),charArray.length=n;for(var i=0;i<n;i++)charArray[i]=this.readChar();return charArray.join("")}readUtf8(n){void 0===n&&(n=1);const bString=this.readChars(n);return utf8.decode(bString)}writeBoolean(value){return this.writeUint8(value?255:0),this}writeInt8(value){return this.ensureAvailable(1),this._data.setInt8(this.offset++,value),this._updateLastWrittenByte(),this}writeUint8(value){return this.ensureAvailable(1),this._data.setUint8(this.offset++,value),this._updateLastWrittenByte(),this}writeByte(value){return this.writeUint8(value)}writeBytes(bytes){this.ensureAvailable(bytes.length);for(var i=0;i<bytes.length;i++)this._data.setUint8(this.offset++,bytes[i]);return this._updateLastWrittenByte(),this}writeInt16(value){return this.ensureAvailable(2),this._data.setInt16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(value){return this.ensureAvailable(2),this._data.setUint16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(value){return this.ensureAvailable(4),this._data.setInt32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(value){return this.ensureAvailable(4),this._data.setUint32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(value){return this.ensureAvailable(4),this._data.setFloat32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(value){return this.ensureAvailable(8),this._data.setFloat64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(str){return this.writeUint8(str.charCodeAt(0))}writeChars(str){for(var i=0;i<str.length;i++)this.writeUint8(str.charCodeAt(i));return this}writeUtf8(str){const bString=utf8.encode(str);return this.writeChars(bString)}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this._lastWrittenByte)}getBuffer(){return void 0!==Buffer?Buffer.from(this.toArray()):this.toArray()}_updateLastWrittenByte(){this.offset>this._lastWrittenByte&&(this._lastWrittenByte=this.offset)}}module.exports=IOBuffer}).call(exports,__webpack_require__(8).Buffer)},function(module,exports,__webpack_require__){"use strict";const IOBuffer=__webpack_require__(5),utils=__webpack_require__(0),data=__webpack_require__(3),readHeader=__webpack_require__(4);class NetCDFReader{constructor(data){const buffer=new IOBuffer(data);buffer.setBigEndian(),utils.notNetcdf("CDF"!==buffer.readChars(3),"should start with CDF");const version=buffer.readByte();utils.notNetcdf(version>2,"unknown version"),this.header=readHeader(buffer,version),this.buffer=buffer}get version(){return 1===this.header.version?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}get variables(){return this.header.variables}getDataVariable(variableName){var variable;return variable="string"==typeof variableName?this.header.variables.find(function(val){return val.name===variableName}):variableName,utils.notNetcdf(void 0===variable,"variable not found"),this.buffer.seek(variable.offset),variable.record?data.record(this.buffer,variable,this.header.recordDimension):data.nonRecord(this.buffer,variable)}}module.exports=NetCDFReader},function(module,exports,__webpack_require__){"use strict";function placeHoldersCount(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===b64[len-2]?2:"="===b64[len-1]?1:0}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]}function encodeChunk(uint8,start,end){for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output.push(tripletToBase64(tmp));return output.join("")}exports.byteLength=function(b64){return 3*b64.length/4-placeHoldersCount(b64)},exports.toByteArray=function(b64){var i,j,l,tmp,placeHolders,arr,len=b64.length;placeHolders=placeHoldersCount(b64),arr=new Arr(3*len/4-placeHolders),l=placeHolders>0?len-4:len;var L=0;for(i=0,j=0;i<l;i+=4,j+=3)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[L++]=tmp>>16&255,arr[L++]=tmp>>8&255,arr[L++]=255&tmp;return 2===placeHolders?(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[L++]=255&tmp):1===placeHolders&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[L++]=tmp>>8&255,arr[L++]=255&tmp),arr},exports.fromByteArray=function(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,output="",parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));return 1===extraBytes?(tmp=uint8[len-1],output+=lookup[tmp>>2],output+=lookup[tmp<<4&63],output+="=="):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],output+=lookup[tmp>>10],output+=lookup[tmp>>4&63],output+=lookup[tmp<<2&63],output+="="),parts.push(output),parts.join("")};for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},function(module,exports,__webpack_require__){"use strict";(function(global){function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length)).__proto__=Buffer.prototype:(null===that&&(that=new Buffer(length)),that.length=length),that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?fromArrayBuffer(that,value,encodingOrOffset,length):"string"==typeof value?fromString(that,value,encodingOrOffset):fromObject(that,value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function alloc(that,size,fill,encoding){return assertSize(size),size<=0?createBuffer(that,size):void 0!==fill?"string"==typeof encoding?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill):createBuffer(that,size)}function allocUnsafe(that,size){if(assertSize(size),that=createBuffer(that,size<0?0:0|checked(size)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromString(that,string,encoding){if("string"==typeof encoding&&""!==encoding||(encoding="utf8"),!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding),actual=(that=createBuffer(that,length)).write(string,encoding);return actual!==length&&(that=that.slice(0,actual)),that}function fromArrayLike(that,array){var length=array.length<0?0:0|checked(array.length);that=createBuffer(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function fromArrayBuffer(that,array,byteOffset,length){if(array.byteLength,byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");return array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length),Buffer.TYPED_ARRAY_SUPPORT?(that=array).__proto__=Buffer.prototype:that=fromArrayLike(that,array),that}function fromObject(that,obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length);return 0===(that=createBuffer(that,len)).length?that:(obj.copy(that,0,0,len),that)}if(obj){if("undefined"!=typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return"number"!=typeof obj.length||isnan(obj.length)?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if(end>>>=0,start>>>=0,end<=start)return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}var indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if((str=stringtrim(str).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)hi=(c=str.charCodeAt(i))>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isnan(val){return val!==val}var base64=__webpack_require__(7),ieee754=__webpack_require__(9),isArray=__webpack_require__(10);exports.Buffer=Buffer,exports.SlowBuffer=function(length){return+length!=length&&(length=0),Buffer.alloc(+length)},exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(arr){return arr.__proto__=Buffer.prototype,arr},Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(size,fill,encoding){return alloc(null,size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)},Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(start>>>=0,end>>>=0,thisStart>>>=0,thisEnd>>>=0,this===target)return 0;for(var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset|=0,isFinite(length)?(length|=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,start<0?(start+=len)<0&&(start=0):start>len&&(start=len),end<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)(newBuf=this.subarray(start,end)).__proto__=Buffer.prototype;else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;i<sliceLen;++i)newBuf[i]=this[i+start]}return newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset|=0,byteLength|=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset|=0,byteLength|=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0);var i;if("number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString()),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g}).call(exports,__webpack_require__(2))},function(module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),(value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias))*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},function(module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},function(module,exports,__webpack_require__){(function(module,global){var __WEBPACK_AMD_DEFINE_RESULT__;!function(root){function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)(value=string.charCodeAt(counter++))>=55296&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function ucs2encode(array){for(var value,length=array.length,index=-1,output="";++index<length;)(value=array[index])>65535&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value);return output}function checkScalarValue(codePoint){if(codePoint>=55296&&codePoint<=57343)throw Error("Lone surrogate U+"+codePoint.toString(16).toUpperCase()+" is not a scalar value")}function createByte(codePoint,shift){return stringFromCharCode(codePoint>>shift&63|128)}function encodeCodePoint(codePoint){if(0==(4294967168&codePoint))return stringFromCharCode(codePoint);var symbol="";return 0==(4294965248&codePoint)?symbol=stringFromCharCode(codePoint>>6&31|192):0==(4294901760&codePoint)?(checkScalarValue(codePoint),symbol=stringFromCharCode(codePoint>>12&15|224),symbol+=createByte(codePoint,6)):0==(4292870144&codePoint)&&(symbol=stringFromCharCode(codePoint>>18&7|240),symbol+=createByte(codePoint,12),symbol+=createByte(codePoint,6)),symbol+=stringFromCharCode(63&codePoint|128)}function readContinuationByte(){if(byteIndex>=byteCount)throw Error("Invalid byte index");var continuationByte=255&byteArray[byteIndex];if(byteIndex++,128==(192&continuationByte))return 63&continuationByte;throw Error("Invalid continuation byte")}function decodeSymbol(){var byte1,byte2,byte3,byte4,codePoint;if(byteIndex>byteCount)throw Error("Invalid byte index");if(byteIndex==byteCount)return!1;if(byte1=255&byteArray[byteIndex],byteIndex++,0==(128&byte1))return byte1;if(192==(224&byte1)){if(byte2=readContinuationByte(),(codePoint=(31&byte1)<<6|byte2)>=128)return codePoint;throw Error("Invalid continuation byte")}if(224==(240&byte1)){if(byte2=readContinuationByte(),byte3=readContinuationByte(),(codePoint=(15&byte1)<<12|byte2<<6|byte3)>=2048)return checkScalarValue(codePoint),codePoint;throw Error("Invalid continuation byte")}if(240==(248&byte1)&&(byte2=readContinuationByte(),byte3=readContinuationByte(),byte4=readContinuationByte(),(codePoint=(7&byte1)<<18|byte2<<12|byte3<<6|byte4)>=65536&&codePoint<=1114111))return codePoint;throw Error("Invalid UTF-8 detected")}var freeExports="object"==typeof exports&&exports,freeGlobal=("object"==typeof module&&module&&module.exports,"object"==typeof global&&global);var byteArray,byteCount,byteIndex,stringFromCharCode=String.fromCharCode,utf8={version:"2.1.2",encode:function(string){for(var codePoints=ucs2decode(string),length=codePoints.length,index=-1,byteString="";++index<length;)byteString+=encodeCodePoint(codePoints[index]);return byteString},decode:function(byteString){byteArray=ucs2decode(byteString),byteCount=byteArray.length,byteIndex=0;for(var tmp,codePoints=[];!1!==(tmp=decodeSymbol());)codePoints.push(tmp);return ucs2encode(codePoints)}};void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){return utf8}.call(exports,__webpack_require__,exports,module))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(exports,__webpack_require__(12)(module),__webpack_require__(2))},function(module,exports){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),module.webpackPolyfill=1),module}}])}),$3Dmol=function(window){return window.$3Dmol||{}}(window),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=$3Dmol),$3Dmol.notrack||$.get("https://3dmol.csb.pitt.edu/track/report.cgi"),String.prototype.startsWith||(String.prototype.startsWith=function(str){return 0===this.lastIndexOf(str,0)}),String.prototype.endsWith||(String.prototype.endsWith=function(suffix){return-1!==this.indexOf(suffix,this.length-suffix.length)}),$.ajaxTransport("+binary",function(options,originalOptions,jqXHR){if(window.FormData&&(options.dataType&&"binary"==options.dataType||options.data&&(window.ArrayBuffer&&options.data instanceof ArrayBuffer||window.Blob&&options.data instanceof Blob)))return{send:function(headers,callback){var xhr=new XMLHttpRequest,url=options.url,type=options.type,async=options.async||!0,dataType=options.responseType||"blob",data=options.data||null,username=options.username||null,password=options.password||null,xhrret=function(){var data={};data[options.dataType]=xhr.response,callback(xhr.status,xhr.statusText,data,xhr.getAllResponseHeaders())};xhr.addEventListener("load",xhrret),xhr.addEventListener("error",xhrret),xhr.addEventListener("abort",xhrret),xhr.open(type,url,async,username,password);for(var i in headers)xhr.setRequestHeader(i,headers[i]);xhr.responseType=dataType,xhr.send(data)},abort:function(){jqXHR.abort()}}}),$3Dmol.createViewer=function(element,config){if("string"===$.type(element)&&(element=$("#"+element)),element){config=config||{};try{return new $3Dmol.GLViewer(element,config)}catch(e){throw"error creating viewer: "+e}return null}},$3Dmol.createViewerGrid=function(element,config,viewer_config){if("string"===$.type(element)&&(element=$("#"+element)),element){config=config||{};var viewers=[],canvas=document.createElement("canvas");viewer_config.rows=config.rows,viewer_config.cols=config.cols,viewer_config.control_all=void 0!=config.control_all&&config.control_all,$(element).append($(canvas));try{for(var r=0;r<config.rows;r++){for(var row=new Array,c=0;c<config.cols;c++){viewer_config.row=r,viewer_config.col=c,viewer_config.canvas=canvas,viewer_config.viewers=viewers,viewer_config.control_all=config.control_all;var viewer=$3Dmol.createViewer(element,viewer_config);row.push(viewer)}viewers.unshift(row)}}catch(e){throw"error creating viewer grid: "+e}return viewers}},$3Dmol.viewers={},$3Dmol.getbin=function(uri,callback,request,postdata){var promise=new Promise(function(resolve,reject){request=void 0==request?"GET":request,$.ajax({url:uri,dataType:"binary",method:request,data:postdata,responseType:"arraybuffer",processData:!1}).done(function(ret,txt,response){resolve(ret)}).fail(function(e,txt){console.log(txt),reject()})});return callback?promise.then(callback):promise},$3Dmol.download=function(query,viewer,options,callback){var type="",pdbUri="",mmtfUri="",m=viewer.addModel();if("mmtf:"===query.substr(0,5)){var uri=(pdbUri=options&&options.pdbUri?options.pdbUri:"https://mmtf.rcsb.org/v1.0/full/")+(query=query.substr(5).toUpperCase());options&&void 0===options.noComputeSecondaryStructure&&(options.noComputeSecondaryStructure=!0);promise=new Promise(function(resolve,reject){$3Dmol.getbin(uri).then(function(ret){m.addMolData(ret,"mmtf",options),viewer.zoomTo(),viewer.render(),resolve(m)})})}else{if("pdb:"===query.substr(0,4)){if(type="mmtf",options&&options.format&&(type=options.format),options&&void 0===options.noComputeSecondaryStructure&&(options.noComputeSecondaryStructure=!0),!(query=query.substr(4).toUpperCase()).match(/^[1-9][A-Za-z0-9]{3}$/))return void alert("Wrong PDB ID");"mmtf"==type?(mmtfUri=options&&options.mmtfUri?options.mmtfUri:"https://mmtf.rcsb.org/v1.0/full/",uri=mmtfUri+query.toUpperCase()):(pdbUri=options&&options.pdbUri?options.pdbUri:"https://files.rcsb.org/view/",uri=pdbUri+query+"."+type)}else if("cid:"==query.substr(0,4)){if(type="sdf",!(query=query.substr(4)).match(/^[0-9]+$/))return void alert("Wrong Compound ID");uri="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+query+"/SDF?record_type=3d"}else"url:"==query.substr(0,4)&&(uri=query.substr(4),type=uri);var handler=function(ret){m.addMolData(ret,type,options),viewer.zoomTo(),viewer.render()},promise=new Promise(function(resolve,reject){"mmtf"==type?$3Dmol.getbin(uri).then(function(ret){handler(ret),resolve(m)}):$.get(uri,function(ret){handler(ret),resolve(m)}).fail(function(e){console.log("fetch of "+uri+" failed: "+e.statusText)})})}return callback?(promise.then(function(m){callback(m)}),m):promise},$3Dmol.SurfaceType={VDW:1,MS:2,SAS:3,SES:4},$3Dmol.mergeGeos=function(geometry,mesh){var meshGeo=mesh.geometry;void 0!==meshGeo&&geometry.geometryGroups.push(meshGeo.geometryGroups[0])},$3Dmol.multiLineString=function(f){return f.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"")},$3Dmol.syncSurface=!1,(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&($3Dmol.syncSurface=!0),$3Dmol.specStringToObject=function(str){if("object"==typeof str)return str;if(void 0===str||null==str)return str;var massage=function(val){return $.isNumeric(val)?Math.floor(parseFloat(val))==parseInt(val)?parseFloat(val):val.indexOf(".")>=0?parseFloat(val):parseInt(val):"true"===val||"false"!==val&&val},ret={};if("all"===(str=str.replace(/%7E/,"~")))return ret;for(var fields=str.split(";"),i=0;i<fields.length;i++){var fv=fields[i].split(":"),f=fv[0],val={},vstr=fv[1];if(vstr)if(-1!==(vstr=vstr.replace(/~/g,"=")).indexOf("="))for(var kvs=vstr.split(","),j=0;j<kvs.length;j++){var kv=kvs[j].split("=",2);val[kv[0]]=massage(kv[1])}else val=-1!==vstr.indexOf(",")?vstr.split(","):massage(vstr);ret[f]=val}return ret},$3Dmol.getExtent=function(atomlist,ignoreSymmetries){var xmin,ymin,zmin,xmax,ymax,zmax,xsum,ysum,zsum,cnt,includeSym=!ignoreSymmetries;if(xmin=ymin=zmin=9999,xmax=ymax=zmax=-9999,xsum=ysum=zsum=cnt=0,0===atomlist.length)return[[0,0,0],[0,0,0],[0,0,0]];for(var i=0;i<atomlist.length;i++){var atom=atomlist[i];if(void 0!==atom&&isFinite(atom.x)&&isFinite(atom.y)&&isFinite(atom.z)&&(cnt++,xsum+=atom.x,ysum+=atom.y,zsum+=atom.z,xmin=xmin<atom.x?xmin:atom.x,ymin=ymin<atom.y?ymin:atom.y,zmin=zmin<atom.z?zmin:atom.z,xmax=xmax>atom.x?xmax:atom.x,ymax=ymax>atom.y?ymax:atom.y,zmax=zmax>atom.z?zmax:atom.z,atom.symmetries&&includeSym))for(var n=0;n<atom.symmetries.length;n++)cnt++,xsum+=atom.symmetries[n].x,ysum+=atom.symmetries[n].y,zsum+=atom.symmetries[n].z,xmin=xmin<atom.symmetries[n].x?xmin:atom.symmetries[n].x,ymin=ymin<atom.symmetries[n].y?ymin:atom.symmetries[n].y,zmin=zmin<atom.symmetries[n].z?zmin:atom.symmetries[n].z,xmax=xmax>atom.symmetries[n].x?xmax:atom.symmetries[n].x,ymax=ymax>atom.symmetries[n].y?ymax:atom.symmetries[n].y,zmax=zmax>atom.symmetries[n].z?zmax:atom.symmetries[n].z}return[[xmin,ymin,zmin],[xmax,ymax,zmax],[xsum/cnt,ysum/cnt,zsum/cnt]]},$3Dmol.getAtomProperty=function(atom,prop){var val=null;return atom.properties&&void 0!==atom.properties[prop]?val=atom.properties[prop]:void 0!==atom[prop]&&(val=atom[prop]),val},$3Dmol.getPropertyRange=function(atomlist,prop){for(var min=Number.POSITIVE_INFINITY,max=Number.NEGATIVE_INFINITY,i=0,n=atomlist.length;i<n;i++){var atom=atomlist[i],val=$3Dmol.getAtomProperty(atom,prop);null!=val&&(val<min&&(min=val),val>max&&(max=val))}return isFinite(min)||isFinite(max)?isFinite(min)?isFinite(max)||(max=min):min=max:min=max=0,[min,max]},"function"==typeof define&&define.amd&&define("$3Dmol",$3Dmol),$3Dmol.createStereoViewer=function(divId,eyeSeparation){var that=this;eyeSeparation=void 0!=eyeSeparation?eyeSeparation:6;var element=document.getElementById(divId),gldiv1=document.createElement("div"),gldiv2=document.createElement("div");gldiv1.id="gldiv1",gldiv2.id="gldiv2",gldiv1.style.cssText=gldiv2.style.cssText="position: relative; float: left; width: 50%; height: 100%; margin: 0; padding: 0; border: 0;",element.appendChild(gldiv1),element.appendChild(gldiv2),this.glviewer1=$3Dmol.createViewer($("#gldiv1"),{camerax:-eyeSeparation/2}),this.glviewer2=$3Dmol.createViewer($("#gldiv2"),{camerax:eyeSeparation/2});var singleClickEvent=function(){that.glviewer1.rotate(15),that.glviewer2.rotate(15),that.glviewer1.render(),that.glviewer2.render()},doubleClickEvent=function(){that.glviewer1.zoom(1.05),that.glviewer2.zoom(1.05)},clicks=0,timer=null;element.addEventListener("click",function(){1==++clicks?timer=setTimeout(function(){singleClickEvent(),clicks=0},700):(clearTimeout(timer),doubleClickEvent(),clicks=0)},!1),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var methods=Object.getOwnPropertyNames(this.glviewer1).filter(function(property){return"function"==typeof that.glviewer1[property]}),i=0;i<methods.length;i++)this[methods[i]]=function(method){return function(){return[this.glviewer1[method].apply(this.glviewer1,arguments),this.glviewer2[method].apply(this.glviewer2,arguments)]}}(methods[i]);this.setCoordinates=function(models,data,format){for(var i=0;i<models.length;i++)models[i].setCoordinates(data,format)}};var $3Dmol=$3Dmol||{};$3Dmol.Math={clamp:function(x,min,max){return Math.min(Math.max(x,min),max)},degToRad:function(){var degreeToRadiansFactor=Math.PI/180;return function(deg){return deg*degreeToRadiansFactor}}()},$3Dmol.Quaternion=function(x,y,z,w){this.x=x||0,this.y=y||0,this.z=z||0,this.w=void 0!==w?w:1},$3Dmol.Quaternion.prototype={constructor:$3Dmol.Quaternion,set:function(x,y,z,w){return this.x=x,this.y=y,this.z=z,this.w=w,this},copy:function(q){return this.x=q.x,this.y=q.y,this.z=q.z,this.w=q.w,this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},inverse:function(){return this.conjugate().normalize()},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var l=this.length();return 0===l?(this.x=0,this.y=0,this.z=0,this.w=1):(l=1/l,this.x*=l,this.y*=l,this.z*=l,this.w*=l),this},multiply:function(q){return this.multiplyQuaternions(this,q)},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this.w*=s,this},multiplyQuaternions:function(a,b){var qax=a.x,qay=a.y,qaz=a.z,qaw=a.w,qbx=b.x,qby=b.y,qbz=b.z,qbw=b.w;return this.x=qax*qbw+qaw*qbx+qay*qbz-qaz*qby,this.y=qay*qbw+qaw*qby+qaz*qbx-qax*qbz,this.z=qaz*qbw+qaw*qbz+qax*qby-qay*qbx,this.w=qaw*qbw-qax*qbx-qay*qby-qaz*qbz,this},sub:function(q){return this.x-=q.x,this.y-=q.y,this.z-=q.z,this.w-=q.w,this},clone:function(){return new $3Dmol.Quaternion(this.x,this.y,this.z,this.w)}},$3Dmol.Vector2=function(x,y){this.x=x||0,this.y=y||0},$3Dmol.Vector2.prototype={constructor:$3Dmol.Vector2,set:function(x,y){return this.x=x,this.y=y,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},copy:function(v){return this.x=v.x,this.y=v.y,this},clone:function(){return new $3Dmol.Vector2(this.x,this.y)}},$3Dmol.Vector3=function(x,y,z){this.x=x||0,this.y=y||0,this.z=z||0},$3Dmol.Vector3.prototype={constructor:$3Dmol.Vector3,set:function(x,y,z){return this.x=x,this.y=y,this.z=z,this},copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this},add:function(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},sub:function(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this},divideScalar:function(s){return 0!==s?(this.x/=s,this.y/=s,this.z/=s):(this.x=0,this.y=0,this.z=0),this},max:function(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this.z=Math.max(this.z,s.z),this},min:function(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this.z=Math.min(this.z,s.z),this},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this.x-v.x,dy=this.y-v.y,dz=this.z-v.z;return dx*dx+dy*dy+dz*dz},applyMatrix4:function(m){var x=this.x,y=this.y,z=this.z,e=m.elements;return this.x=e[0]*x+e[4]*y+e[8]*z+e[12],this.y=e[1]*x+e[5]*y+e[9]*z+e[13],this.z=e[2]*x+e[6]*y+e[10]*z+e[14],this},applyProjection:function(m){var x=this.x,y=this.y,z=this.z,e=m.elements,d=e[3]*x+e[7]*y+e[11]*z+e[15];return this.x=(e[0]*x+e[4]*y+e[8]*z+e[12])/d,this.y=(e[1]*x+e[5]*y+e[9]*z+e[13])/d,this.z=(e[2]*x+e[6]*y+e[10]*z+e[14])/d,this},applyQuaternion:function(q){var x=this.x,y=this.y,z=this.z,qx=q.x,qy=q.y,qz=q.z,t=(q.w,{});t.x=2*(y*qz-z*qy),t.y=2*(z*qx-x*qz),t.z=2*(x*qy-y*qx);var t2={};return t2.x=t.y*qz-t.z*qy,t2.y=t.z*qx-t.x*qz,t2.z=t.x*qy-t.y*qx,this.x=x+q.w*t.x+t2.x,this.y=y+q.w*t.y+t2.y,this.z=z+q.w*t.z+t2.z,this},negate:function(){return this.multiplyScalar(-1)},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},normalize:function(){return this.divideScalar(this.length())},cross:function(v){var x=this.x,y=this.y,z=this.z;return this.x=y*v.z-z*v.y,this.y=z*v.x-x*v.z,this.z=x*v.y-y*v.x,this},crossVectors:function(a,b){return this.x=a.y*b.z-a.z*b.y,this.y=a.z*b.x-a.x*b.z,this.z=a.x*b.y-a.y*b.x,this},getPositionFromMatrix:function(m){return this.x=m.elements[12],this.y=m.elements[13],this.z=m.elements[14],this},setEulerFromRotationMatrix:function(m,order){var te=m.elements,m11=te[0],m12=te[4],m13=te[8],m22=(te[1],te[5]),m23=te[9],m32=(te[2],te[6]),m33=te[10];return void 0===order||"XYZ"===order?(this.y=Math.asin($3Dmol.Math.clamp(m13,-1,1)),Math.abs(m13)<.99999?(this.x=Math.atan2(-m23,m33),this.z=Math.atan2(-m12,m11)):(this.x=Math.atan2(m32,m22),this.z=0)):console.error("Error with vector's setEulerFromRotationMatrix: Unknown order: "+order),this},rotateAboutVector:function(axis,ang){axis.normalize();var cosang=Math.cos(ang),sinang=Math.sin(ang),term1=this.clone().multiplyScalar(cosang),term2=axis.clone().cross(this).multiplyScalar(sinang),term3=axis.clone().multiplyScalar(axis.clone().dot(this)).multiplyScalar(1-cosang),rot=term1.add(term2).add(term3);return this.x=rot.x,this.y=rot.y,this.z=rot.z,this},clone:function(){return new $3Dmol.Vector3(this.x,this.y,this.z)}},$3Dmol.Matrix3=function(n11,n12,n13,n21,n22,n23,n31,n32,n33){this.elements=new Float32Array(9),this.set(void 0!==n11?n11:1,n12||0,n13||0,n21||0,void 0!==n22?n22:1,n23||0,n31||0,n32||0,void 0!==n33?n33:1)},$3Dmol.Matrix3.prototype={constructor:$3Dmol.Matrix3,set:function(n11,n12,n13,n21,n22,n23,n31,n32,n33){var te=this.elements;return te[0]=n11,te[3]=n12,te[6]=n13,te[1]=n21,te[4]=n22,te[7]=n23,te[2]=n31,te[5]=n32,te[8]=n33,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(m){var me=m.elements;this.set(me[0],me[3],me[6],me[1],me[4],me[7],me[2],me[5],me[8])},multiplyScalar:function(s){var te=this.elements;return te[0]*=s,te[3]*=s,te[6]*=s,te[1]*=s,te[4]*=s,te[7]*=s,te[2]*=s,te[5]*=s,te[8]*=s,this},getInverse:function(matrix,throwOnInvertible){var me=matrix.elements,te=this.elements;te[0]=me[10]*me[5]-me[6]*me[9],te[1]=-me[10]*me[1]+me[2]*me[9],te[2]=me[6]*me[1]-me[2]*me[5],te[3]=-me[10]*me[4]+me[6]*me[8],te[4]=me[10]*me[0]-me[2]*me[8],te[5]=-me[6]*me[0]+me[2]*me[4],te[6]=me[9]*me[4]-me[5]*me[8],te[7]=-me[9]*me[0]+me[1]*me[8],te[8]=me[5]*me[0]-me[1]*me[4];var det=me[0]*te[0]+me[1]*te[3]+me[2]*te[6];if(0===det){var msg="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(throwOnInvertible)throw new Error(msg);return console.warn(msg),this.identity(),this}return this.multiplyScalar(1/det),this},getDeterminant:function(){var m=this.elements;return m[0]*m[4]*m[8]+m[1]*m[5]*m[6]+m[2]*m[3]*m[7]-m[2]*m[4]*m[6]-m[1]*m[3]*m[8]-m[0]*m[5]*m[7]},transpose:function(){var tmp,m=this.elements;return tmp=m[1],m[1]=m[3],m[3]=tmp,tmp=m[2],m[2]=m[6],m[6]=tmp,tmp=m[5],m[5]=m[7],m[7]=tmp,this},clone:function(){var te=this.elements;return new $3Dmol.Matrix3(te[0],te[3],te[6],te[1],te[4],te[7],te[2],te[5],te[8])}},$3Dmol.Matrix4=function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44){if(void 0===n12&&void 0!==n11)this.elements=new Float32Array(n11);else{var te=this.elements=new Float32Array(16);te[0]=void 0!==n11?n11:1,te[4]=n12||0,te[8]=n13||0,te[12]=n14||0,te[1]=n21||0,te[5]=void 0!==n22?n22:1,te[9]=n23||0,te[13]=n24||0,te[2]=n31||0,te[6]=n32||0,te[10]=void 0!==n33?n33:1,te[14]=n34||0,te[3]=n41||0,te[7]=n42||0,te[11]=n43||0,te[15]=void 0!==n44?n44:1}},$3Dmol.Matrix4.prototype={constructor:$3Dmol.Matrix4,set:function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44){var te=this.elements;return te[0]=n11,te[4]=n12,te[8]=n13,te[12]=n14,te[1]=n21,te[5]=n22,te[9]=n23,te[13]=n24,te[2]=n31,te[6]=n32,te[10]=n33,te[14]=n34,te[3]=n41,te[7]=n42,te[11]=n43,te[15]=n44,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(m){var me=m.elements;return this.set(me[0],me[4],me[8],me[12],me[1],me[5],me[9],me[13],me[2],me[6],me[10],me[14],me[3],me[7],me[11],me[15]),this},matrix3FromTopLeft:function(){var te=this.elements;return new $3Dmol.Matrix3(te[0],te[4],te[8],te[1],te[5],te[9],te[2],te[6],te[10])},setRotationFromEuler:function(v,order){var te=this.elements,x=v.x,y=v.y,z=v.z,a=Math.cos(x),b=Math.sin(x),c=Math.cos(y),d=Math.sin(y),e=Math.cos(z),f=Math.sin(z);if(void 0===order||"XYZ"===order){var ae=a*e,af=a*f,be=b*e,bf=b*f;te[0]=c*e,te[4]=-c*f,te[8]=d,te[1]=af+be*d,te[5]=ae-bf*d,te[9]=-b*c,te[2]=bf-ae*d,te[6]=be+af*d,te[10]=a*c}else console.error("Error with matrix4 setRotationFromEuler. Order: "+order);return this},setRotationFromQuaternion:function(q){var te=this.elements,x=q.x,y=q.y,z=q.z,w=q.w,x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return te[0]=1-(yy+zz),te[4]=xy-wz,te[8]=xz+wy,te[1]=xy+wz,te[5]=1-(xx+zz),te[9]=yz-wx,te[2]=xz-wy,te[6]=yz+wx,te[10]=1-(xx+yy),this},lookAt:function(){var x=new $3Dmol.Vector3,y=new $3Dmol.Vector3,z=new $3Dmol.Vector3;return function(eye,target,up){var te=this.elements;return z.subVectors(eye,target).normalize(),0===z.length()&&(z.z=1),x.crossVectors(up,z).normalize(),0===x.length()&&(z.x+=1e-4,x.crossVectors(up,z).normalize()),y.crossVectors(z,x),te[0]=x.x,te[4]=y.x,te[8]=z.x,te[1]=x.y,te[5]=y.y,te[9]=z.y,te[2]=x.z,te[6]=y.z,te[10]=z.z,this}}(),multiplyMatrices:function(a,b){var ae=a.elements,be=b.elements,te=this.elements,a11=ae[0],a12=ae[4],a13=ae[8],a14=ae[12],a21=ae[1],a22=ae[5],a23=ae[9],a24=ae[13],a31=ae[2],a32=ae[6],a33=ae[10],a34=ae[14],a41=ae[3],a42=ae[7],a43=ae[11],a44=ae[15],b11=be[0],b12=be[4],b13=be[8],b14=be[12],b21=be[1],b22=be[5],b23=be[9],b24=be[13],b31=be[2],b32=be[6],b33=be[10],b34=be[14],b41=be[3],b42=be[7],b43=be[11],b44=be[15];return te[0]=a11*b11+a12*b21+a13*b31+a14*b41,te[4]=a11*b12+a12*b22+a13*b32+a14*b42,te[8]=a11*b13+a12*b23+a13*b33+a14*b43,te[12]=a11*b14+a12*b24+a13*b34+a14*b44,te[1]=a21*b11+a22*b21+a23*b31+a24*b41,te[5]=a21*b12+a22*b22+a23*b32+a24*b42,te[9]=a21*b13+a22*b23+a23*b33+a24*b43,te[13]=a21*b14+a22*b24+a23*b34+a24*b44,te[2]=a31*b11+a32*b21+a33*b31+a34*b41,te[6]=a31*b12+a32*b22+a33*b32+a34*b42,te[10]=a31*b13+a32*b23+a33*b33+a34*b43,te[14]=a31*b14+a32*b24+a33*b34+a34*b44,te[3]=a41*b11+a42*b21+a43*b31+a44*b41,te[7]=a41*b12+a42*b22+a43*b32+a44*b42,te[11]=a41*b13+a42*b23+a43*b33+a44*b43,te[15]=a41*b14+a42*b24+a43*b34+a44*b44,this},multiplyScalar:function(s){var te=this.elements;return te[0]*=s,te[4]*=s,te[8]*=s,te[12]*=s,te[1]*=s,te[5]*=s,te[9]*=s,te[13]*=s,te[2]*=s,te[6]*=s,te[10]*=s,te[14]*=s,te[3]*=s,te[7]*=s,te[11]*=s,te[15]*=s,this},makeTranslation:function(x,y,z){return this.set(1,0,0,x,0,1,0,y,0,0,1,z,0,0,0,1),this},transpose:function(){var tmp,te=this.elements;return tmp=te[1],te[1]=te[4],te[4]=tmp,tmp=te[2],te[2]=te[8],te[8]=tmp,tmp=te[6],te[6]=te[9],te[9]=tmp,tmp=te[3],te[3]=te[12],te[12]=tmp,tmp=te[7],te[7]=te[13],te[13]=tmp,tmp=te[11],te[11]=te[14],te[14]=tmp,this},getPosition:function(){var v1=new $3Dmol.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var te=this.elements;return v1.set(te[12],te[13],te[14])}}(),setPosition:function(v){var te=this.elements;return te[12]=v.x,te[13]=v.y,te[14]=v.z,this},getInverse:function(m,throwOnInvertible){var te=this.elements,me=m.elements,n11=me[0],n12=me[4],n13=me[8],n14=me[12],n21=me[1],n22=me[5],n23=me[9],n24=me[13],n31=me[2],n32=me[6],n33=me[10],n34=me[14],n41=me[3],n42=me[7],n43=me[11],n44=me[15];te[0]=n23*n34*n42-n24*n33*n42+n24*n32*n43-n22*n34*n43-n23*n32*n44+n22*n33*n44,te[4]=n14*n33*n42-n13*n34*n42-n14*n32*n43+n12*n34*n43+n13*n32*n44-n12*n33*n44,te[8]=n13*n24*n42-n14*n23*n42+n14*n22*n43-n12*n24*n43-n13*n22*n44+n12*n23*n44,te[12]=n14*n23*n32-n13*n24*n32-n14*n22*n33+n12*n24*n33+n13*n22*n34-n12*n23*n34,te[1]=n24*n33*n41-n23*n34*n41-n24*n31*n43+n21*n34*n43+n23*n31*n44-n21*n33*n44,te[5]=n13*n34*n41-n14*n33*n41+n14*n31*n43-n11*n34*n43-n13*n31*n44+n11*n33*n44,te[9]=n14*n23*n41-n13*n24*n41-n14*n21*n43+n11*n24*n43+n13*n21*n44-n11*n23*n44,te[13]=n13*n24*n31-n14*n23*n31+n14*n21*n33-n11*n24*n33-n13*n21*n34+n11*n23*n34,te[2]=n22*n34*n41-n24*n32*n41+n24*n31*n42-n21*n34*n42-n22*n31*n44+n21*n32*n44,te[6]=n14*n32*n41-n12*n34*n41-n14*n31*n42+n11*n34*n42+n12*n31*n44-n11*n32*n44,te[10]=n12*n24*n41-n14*n22*n41+n14*n21*n42-n11*n24*n42-n12*n21*n44+n11*n22*n44,te[14]=n14*n22*n31-n12*n24*n31-n14*n21*n32+n11*n24*n32+n12*n21*n34-n11*n22*n34,te[3]=n23*n32*n41-n22*n33*n41-n23*n31*n42+n21*n33*n42+n22*n31*n43-n21*n32*n43,te[7]=n12*n33*n41-n13*n32*n41+n13*n31*n42-n11*n33*n42-n12*n31*n43+n11*n32*n43,te[11]=n13*n22*n41-n12*n23*n41-n13*n21*n42+n11*n23*n42+n12*n21*n43-n11*n22*n43,te[15]=n12*n23*n31-n13*n22*n31+n13*n21*n32-n11*n23*n32-n12*n21*n33+n11*n22*n33;var det=me[0]*te[0]+me[1]*te[4]+me[2]*te[8]+me[3]*te[12];if(0===det){var msg="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(throwOnInvertible)throw new Error(msg);return console.warn(msg),this.identity(),this}return this.multiplyScalar(1/det),this},isReflected:function(){return this.matrix3FromTopLeft().getDeterminant()<0},compose:function(){var mRotation=new $3Dmol.Matrix4,mScale=new $3Dmol.Matrix4;return function(translation,rotation,scale){var te=this.elements;return mRotation.identity(),mRotation.setRotationFromQuaternion(rotation),mScale.makeScale(scale.x,scale.y,scale.z),this.multiplyMatrices(mRotation,mScale),te[12]=translation.x,te[13]=translation.y,te[14]=translation.z,this}}(),decompose:function(){var x=new $3Dmol.Vector3,y=new $3Dmol.Vector3,z=new $3Dmol.Vector3,matrix=new $3Dmol.Matrix4;return function(translation,rotation,scale){var te=this.elements;return x.set(te[0],te[1],te[2]),y.set(te[4],te[5],te[6]),z.set(te[8],te[9],te[10]),translation=translation instanceof $3Dmol.Vector3?translation:new $3Dmol.Vector3,rotation=rotation instanceof $3Dmol.Quaternion?rotation:new $3Dmol.Quaternion,scale=scale instanceof $3Dmol.Vector3?scale:new $3Dmol.Vector3,scale.x=x.length(),scale.y=y.length(),scale.z=z.length(),translation.x=te[12],translation.y=te[13],translation.z=te[14],matrix.copy(this),matrix.elements[0]/=scale.x,matrix.elements[1]/=scale.x,matrix.elements[2]/=scale.x,matrix.elements[4]/=scale.y,matrix.elements[5]/=scale.y,matrix.elements[6]/=scale.y,matrix.elements[8]/=scale.z,matrix.elements[9]/=scale.z,matrix.elements[10]/=scale.z,rotation.setFromRotationMatrix(matrix),[translation,rotation,scale]}}(),scale:function(v){var te=this.elements,x=v.x,y=v.y,z=v.z;return te[0]*=x,te[4]*=y,te[8]*=z,te[1]*=x,te[5]*=y,te[9]*=z,te[2]*=x,te[6]*=y,te[10]*=z,te[3]*=x,te[7]*=y,te[11]*=z,this},getMaxScaleOnAxis:function(){var te=this.elements,scaleXSq=te[0]*te[0]+te[1]*te[1]+te[2]*te[2],scaleYSq=te[4]*te[4]+te[5]*te[5]+te[6]*te[6],scaleZSq=te[8]*te[8]+te[9]*te[9]+te[10]*te[10];return Math.sqrt(Math.max(scaleXSq,Math.max(scaleYSq,scaleZSq)))},makeFrustum:function(left,right,bottom,top,near,far){var te=this.elements,x=2*near/(right-left),y=2*near/(top-bottom),a=(right+left)/(right-left),b=(top+bottom)/(top-bottom),c=-(far+near)/(far-near),d=-2*far*near/(far-near);return te[0]=x,te[4]=0,te[8]=a,te[12]=0,te[1]=0,te[5]=y,te[9]=b,te[13]=0,te[2]=0,te[6]=0,te[10]=c,te[14]=d,te[3]=0,te[7]=0,te[11]=-1,te[15]=0,this},makePerspective:function(fov,aspect,near,far){var ymax=near*Math.tan($3Dmol.Math.degToRad(.5*fov)),ymin=-ymax,xmin=ymin*aspect,xmax=ymax*aspect;return this.makeFrustum(xmin,xmax,ymin,ymax,near,far)},makeOrthographic:function(left,right,top,bottom,near,far){var te=this.elements,w=1/(right-left),h=1/(top-bottom),p=1/(far-near),x=(right+left)*w,y=(top+bottom)*h,z=(far+near)*p;return te[0]=2*w,te[4]=0,te[8]=0,te[12]=-x,te[1]=0,te[5]=2*h,te[9]=0,te[13]=-y,te[2]=0,te[6]=0,te[10]=-2*p,te[14]=-z,te[3]=0,te[7]=0,te[11]=0,te[15]=1,this},isEqual:function(m){var me=m.elements,te=this.elements;return te[0]==me[0]&&te[4]==me[4]&&te[8]==me[8]&&te[12]==me[12]&&te[1]==me[1]&&te[5]==me[5]&&te[9]==me[9]&&te[13]==me[13]&&te[2]==me[2]&&te[6]==me[6]&&te[10]==me[10]&&te[14]==me[14]&&te[3]==me[3]&&te[7]==me[7]&&te[11]==me[11]&&te[15]==me[15]},clone:function(){var te=this.elements;return new $3Dmol.Matrix4(te[0],te[4],te[8],te[12],te[1],te[5],te[9],te[13],te[2],te[6],te[10],te[14],te[3],te[7],te[11],te[15])},isIdentity:function(){var te=this.elements;return 1==te[0]&&0==te[4]&&0==te[8]&&0==te[12]&&0==te[1]&&1==te[5]&&0==te[9]&&0==te[13]&&0==te[2]&&0==te[6]&&1==te[10]&&0==te[14]&&0==te[3]&&0==te[7]&&0==te[11]&&1==te[15]}},$3Dmol.Ray=function(origin,direction){this.origin=void 0!==origin?origin:new $3Dmol.Vector3,this.direction=void 0!==direction?direction:new $3Dmol.Vector3},$3Dmol.Ray.prototype={constructor:$3Dmol.Ray,set:function(origin,direction){return this.origin.copy(origin),this.direction.copy(direction),this},copy:function(ray){return this.origin.copy(ray.origin),this.direction.copy(ray.direction),this},at:function(t,optionalTarget){return(optionalTarget||new $3Dmol.Vector3).copy(this.direction).multiplyScalar(t).add(this.origin)},recast:function(){var v1=new $3Dmol.Vector3;return function(t){return this.origin.copy(this.at(t,v1)),this}}(),closestPointToPoint:function(point,optionalTarget){var result=optionalTarget||new $3Dmol.Vector3;result.subVectors(point,this.origin);var directionDistance=result.dot(this.direction);return result.copy(this.direction).multiplyScalar(directionDistance).add(this.origin)},distanceToPoint:function(point){var v1=new $3Dmol.Vector3;return function(point){var directionDistance=v1.subVectors(point,this.origin).dot(this.direction);return v1.copy(this.direction).multiplyScalar(directionDistance).add(this.origin),v1.distanceTo(point)}}(),isIntersectionCylinder:function(){},isIntersectionSphere:function(sphere){return this.distanceToPoint(sphere.center)<=sphere.radius},isIntersectionPlane:function(plane){return 0!==plane.normal.dot(this.direction)||0===plane.distanceToPoint(this.origin)},distanceToPlane:function(plane){var denominator=plane.normal.dot(this.direction);if(0!==denominator)return-(this.origin.dot(plane.normal)+plane.constant)/denominator;if(0===plane.distanceToPoint(this.origin))return 0},intersectPlane:function(plane,optionalTarget){var t=this.distanceToPlane(plane);if(void 0!==t)return this.at(t,optionalTarget)},applyMatrix4:function(matrix4){return this.direction.add(this.origin).applyMatrix4(matrix4),this.origin.applyMatrix4(matrix4),this.direction.sub(this.origin),this},equals:function(ray){return ray.origin.equals(this.origin)&&ray.direction.equals(this.direction)},clone:function(){return(new $3Dmol.Ray).copy(this)}},$3Dmol.Sphere=function(center,radius){this.center=void 0!==center?center:new $3Dmol.Vector3,this.radius=void 0!==radius?radius:0},$3Dmol.Sphere.prototype={constructor:$3Dmol.Sphere,set:function(center,radius){return this.center.copy(center),this.radius=radius,this},copy:function(sphere){return this.center.copy(sphere.center),this.radius=sphere.radius,this},applyMatrix4:function(matrix){return this.center.applyMatrix4(matrix),this.radius=this.radius*matrix.getMaxScaleOnAxis(),this},translate:function(offset){return this.center.add(offset),this},equals:function(sphere){return sphere.center.equals(this.center)&&sphere.radius===this.radius},clone:function(){return(new $3Dmol.Sphere).copy(this)}},$3Dmol.Cylinder=function(c1,c2,radius){this.c1=void 0!==c1?c1:new $3Dmol.Vector3,this.c2=void 0!==c2?c2:new $3Dmol.Vector3,this.direction=(new $3Dmol.Vector3).subVectors(this.c2,this.c1).normalize(),this.radius=void 0!==radius?radius:0},$3Dmol.Cylinder.prototype={constructor:$3Dmol.Cylinder,copy:function(cylinder){return this.c1.copy(cylinder.c1),this.c2.copy(cylinder.c2),this.direction.copy(cylinder.direction),this.radius=cylinder.radius,this},lengthSq:function(){var vector=new $3Dmol.Vector3;return function(){return vector.subVectors(this.c2,this.c1).lengthSq()}}(),applyMatrix4:function(matrix){return this.direction.add(this.c1).applyMatrix4(matrix),this.c1.applyMatrix4(matrix),this.c2.applyMatrix4(matrix),this.direction.sub(this.c1).normalize(),this.radius=this.radius*matrix.getMaxScaleOnAxis(),this}},$3Dmol.Triangle=function(a,b,c){this.a=void 0!==a?a:new $3Dmol.Vector3,this.b=void 0!==b?b:new $3Dmol.Vector3,this.c=void 0!==c?c:new $3Dmol.Vector3},$3Dmol.Triangle.prototype={constructor:$3Dmol.Triangle,copy:function(triangle){return this.a.copy(triangle.a),this.b.copy(triangle.b),this.c.copy(triangle.c),this},applyMatrix4:function(matrix){return this.a.applyMatrix4(matrix),this.b.applyMatrix4(matrix),this.c.applyMatrix4(matrix),this},getNormal:function(){var v1=new $3Dmol.Vector3;return function(){var norm=this.a.clone();return norm.sub(this.b),v1.subVectors(this.c,this.b),norm.cross(v1),norm.normalize(),norm}}()},$3Dmol.EventDispatcher=function(){var listeners={};this.addEventListener=function(type,listener){void 0===listeners[type]&&(listeners[type]=[]),-1===listeners[type].indexOf(listener)&&listeners[type].push(listener)},this.removeEventListener=function(type,listener){var index=listeners[type].indexOf(listener);-1!==index&&listeners[type].splice(index,1)},this.dispatchEvent=function(event){var listenerArray=listeners[event.type];if(void 0!==listenerArray){event.target=this;for(var i=0,l=listenerArray.length;i<l;i++)listenerArray[i].call(this,event)}}},$3Dmol.Color=function(color){return arguments.length>1?(this.r=arguments[0]||0,this.g=arguments[1]||0,this.b=arguments[2]||0,this):this.set(color)},$3Dmol.Color.prototype={constructor:$3Dmol.Color,r:0,g:0,b:0,set:function(val){if(val instanceof $3Dmol.Color)return val.clone();"number"==typeof val?this.setHex(val):"object"==typeof val&&"r"in val&&"g"in val&&"b"in val&&(this.r=val.r,this.g=val.g,this.b=val.b)},setHex:function(hex){return hex=Math.floor(hex),this.r=(hex>>16&255)/255,this.g=(hex>>8&255)/255,this.b=(255&hex)/255,this},getHex:function(){return Math.round(255*this.r)<<16|Math.round(255*this.g)<<8|Math.round(255*this.b)},clone:function(){return new $3Dmol.Color(this.r,this.g,this.b)},copy:function(color){return this.r=color.r,this.g=color.g,this.b=color.b,this},scaled:function(){var ret={};return ret.r=Math.round(255*this.r),ret.g=Math.round(255*this.g),ret.b=Math.round(255*this.b),ret.a=1,ret}},$3Dmol.Object3D=function(){this.id=$3Dmol.Object3DIDCount++,this.name="",this.parent=void 0,this.children=[],this.position=new $3Dmol.Vector3,this.rotation=new $3Dmol.Vector3,this.matrix=new $3Dmol.Matrix4,this.matrixWorld=new $3Dmol.Matrix4,this.quaternion=new $3Dmol.Quaternion,this.eulerOrder="XYZ",this.up=new $3Dmol.Vector3(0,1,0),this.scale=new $3Dmol.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0},$3Dmol.Object3D.prototype={constructor:$3Dmol.Object3D,lookAt:function(vector){this.matrix.lookAt(vector,this.position,this.up),this.rotationAutoUpdate&&(!0===this.useQuaternion?this.quaternion.copy(this.matrix.decompose()[1]):this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))},add:function(object){if(object!==this){object.parent=this,this.children.push(object);for(var scene=this;void 0!==scene.parent;)scene=scene.parent;void 0!==scene&&scene instanceof $3Dmol.Scene&&scene.__addObject(object)}else console.error("Can't add $3Dmol.Object3D to itself")},remove:function(object){var index=this.children.indexOf(object);if(-1!==index){object.parent=void 0,this.children.splice(index,1);for(var scene=this;void 0!==scene.parent;)scene=scene.parent;void 0!==scene&&scene instanceof $3Dmol.Scene&&scene.__removeObject(object)}},updateMatrix:function(){this.matrix.setPosition(this.position),!1===this.useQuaternion?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),1===this.scale.x&&1===this.scale.y&&1===this.scale.z||this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(force){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==force||(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var i=0;i<this.children.length;i++)this.children[i].updateMatrixWorld(!0)},clone:function(object){void 0===object&&(object=new $3Dmol.Object3D),object.name=this.name,object.up.copy(this.up),object.position.copy(this.position),object.rotation.copy(this.rotation),object.eulerOrder=this.eulerOrder,object.scale.copy(this.scale),object.rotationAutoUpdate=this.rotationAutoUpdate,object.matrix.copy(this.matrix),object.matrixWorld.copy(this.matrixWorld),object.quaternion.copy(this.quaternion),object.matrixAutoUpdate=this.matrixAutoUpdate,object.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,object.useQuaternion=this.useQuaternion,object.visible=this.visible;for(var i=0;i<this.children.length;i++){var child=this.children[i];object.add(child.clone())}return object},setVisible:function(val){this.visible=val;for(var i=0;i<this.children.length;i++)this.children[i].setVisible(val)}},$3Dmol.Object3DIDCount=0,$3Dmol.Geometry=function(){var geometryGroup=function(id){this.id=id||0,this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.faceArray=null,this.radiusArray=null,this.lineArray=null,this.vertices=0,this.faceidx=0,this.lineidx=0};geometryGroup.prototype.setColors=function(setcolor){var v=this.vertexArray,c=this.colorArray;if(v.length==c.length)for(var i=0;i<v.length;i+=3){var col=setcolor(v[i],v[i+1],v[i+2]);col instanceof $3Dmol.Color||(col=$3Dmol.CC.color(col)),c[i]=col.r,c[i+1]=col.g,c[i+2]=col.b}else console.log("Cannot re-color geometry group due to mismatched lengths.")},geometryGroup.prototype.getNumVertices=function(){return this.vertices},geometryGroup.prototype.getVertices=function(){return this.vertexArray},geometryGroup.prototype.getCentroid=function(){for(var offset,x,y,z,centroid=new $3Dmol.Vector3,i=0;i<this.vertices;++i)offset=3*i,x=this.vertexArray[offset],y=this.vertexArray[offset+1],z=this.vertexArray[offset+2],centroid.x+=x,centroid.y+=y,centroid.z+=z;return centroid.divideScalar(this.vertices),centroid},geometryGroup.prototype.setNormals=function(){var faces=this.faceArray,verts=this.vertexArray,norms=this.normalArray;if(this.vertices&&this.faceidx)for(var a,b,c,vA,vB,vC,norm,i=0;i<faces.length/3;++i)a=3*faces[3*i],b=3*faces[3*i+1],c=3*faces[3*i+2],vA=new $3Dmol.Vector3(verts[a],verts[a+1],verts[a+2]),vB=new $3Dmol.Vector3(verts[b],verts[b+1],verts[b+2]),vC=new $3Dmol.Vector3(verts[c],verts[c+1],verts[c+2]),vA.subVectors(vA,vB),vC.subVectors(vC,vB),vC.cross(vA),(norm=vC).normalize(),norms[a]+=norm.x,norms[b]+=norm.x,norms[c]+=norm.x,norms[a+1]+=norm.y,norms[b+1]+=norm.y,norms[c+1]+=norm.y,norms[a+2]+=norm.z,norms[b+2]+=norm.z,norms[c+2]+=norm.z},geometryGroup.prototype.setLineIndices=function(){if(this.faceidx){var faceArr=this.faceArray,lineArr=this.lineArray=new Uint16Array(2*this.faceidx);this.lineidx=2*this.faceidx;for(var i=0;i<this.faceidx/3;++i){var faceoffset=3*i,lineoffset=2*faceoffset,a=faceArr[faceoffset],b=faceArr[faceoffset+1],c=faceArr[faceoffset+2];lineArr[lineoffset]=a,lineArr[lineoffset+1]=b,lineArr[lineoffset+2]=a,lineArr[lineoffset+3]=c,lineArr[lineoffset+4]=b,lineArr[lineoffset+5]=c}}},geometryGroup.prototype.truncateArrayBuffers=function(mesh,reallocatemem){mesh=!0===mesh;var vertexArr=this.vertexArray,colorArr=this.colorArray,normalArr=this.normalArray,faceArr=this.faceArray,lineArr=this.lineArray,radiusArr=this.radiusArray;this.vertexArray=vertexArr.subarray(0,3*this.vertices),this.colorArray=colorArr.subarray(0,3*this.vertices),mesh?(this.normalArray=normalArr.subarray(0,3*this.vertices),this.faceArray=faceArr.subarray(0,this.faceidx),this.lineidx>0?this.lineArray=lineArr.subarray(0,this.lineidx):this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),radiusArr&&(this.radiusArray=radiusArr.subarray(0,this.vertices)),reallocatemem&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0};var addGroup=function(geo){var ret=new geometryGroup(geo.geometryGroups.length);return geo.geometryGroups.push(ret),geo.groups=geo.geometryGroups.length,ret.vertexArray=new Float32Array(196605),ret.colorArray=new Float32Array(196605),geo.mesh&&(ret.normalArray=new Float32Array(196605),ret.faceArray=new Uint16Array(393210),ret.lineArray=new Uint16Array(393210)),geo.radii&&(ret.radiusArray=new Float32Array(65535)),ret.useOffset=geo.offset,ret},Geometry=function(mesh,radii,offset){$3Dmol.EventDispatcher.call(this),this.id=$3Dmol.GeometryIDCount++,this.name="",this.hasTangents=!1,this.dynamic=!0,this.mesh=!0===mesh,this.radii=radii||!1,this.offset=offset||!1,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.geometryGroups=[],this.groups=0};return Geometry.prototype={constructor:Geometry,updateGeoGroup:function(addVertices){addVertices=addVertices||0;var retGroup=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!retGroup||retGroup.vertices+addVertices>retGroup.vertexArray.length/3)&&(retGroup=addGroup(this)),retGroup},addGeoGroup:function(){return addGroup(this)},setUpNormals:function(three){three=three||!1;for(var g=0;g<this.groups;g++)this.geometryGroups[g].setNormals(three)},setColors:function(setcolor){for(var len=this.geometryGroups.length,g=0;g<len;g++)this.geometryGroups[g].setColors(setcolor)},setUpWireframe:function(){for(var g=0;g<this.groups;g++)this.geometryGroups[g].setLineIndices()},initTypedArrays:function(){for(var g=0;g<this.groups;g++){var group=this.geometryGroups[g];!0!==group.__inittedArrays&&group.truncateArrayBuffers(this.mesh,!1)}},dispose:function(){this.dispatchEvent({type:"dispose"})}},Geometry}(),Object.defineProperty($3Dmol.Geometry.prototype,"vertices",{get:function(){for(var vertices=0,g=0;g<this.groups;g++)vertices+=this.geometryGroups[g].vertices;return vertices}}),$3Dmol.GeometryIDCount=0,$3Dmol.Raycaster=function(){var Raycaster=function(origin,direction,far,near){this.ray=new $3Dmol.Ray(origin,direction),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=near||0,this.far=far||1/0},sphere=new $3Dmol.Sphere,cylinder=new $3Dmol.Cylinder,triangle=new $3Dmol.Triangle,w_0=new $3Dmol.Vector3,v1=new $3Dmol.Vector3,v2=new $3Dmol.Vector3,v3=new $3Dmol.Vector3,matrixPosition=(new $3Dmol.Ray,new $3Dmol.Vector3,new $3Dmol.Vector3),descSort=(new $3Dmol.Matrix4,function(a,b){return a.distance-b.distance}),clamp=function(x){return Math.min(Math.max(x,-1),1)},intersectObject=function(group,clickable,raycaster,intersects){if(matrixPosition.getPositionFromMatrix(group.matrixWorld),void 0===clickable.intersectionShape)return intersects;var intersectionShape=clickable.intersectionShape,precision=raycaster.linePrecision,precisionSq=(precision*=group.matrixWorld.getMaxScaleOnAxis())*precision;if(void 0!==clickable.boundingSphere&&clickable.boundingSphere instanceof $3Dmol.Sphere&&(sphere.copy(clickable.boundingSphere),sphere.applyMatrix4(group.matrixWorld),!raycaster.ray.isIntersectionSphere(sphere)))return intersects;var i,il,norm,normProj,cylProj,rayProj,distance,closestDistSq,denom,discriminant,s,t,s_c,t_c;for(i=0,il=intersectionShape.triangle.length;i<il;i++)if(intersectionShape.triangle[i]instanceof $3Dmol.Triangle){if(triangle.copy(intersectionShape.triangle[i]),triangle.applyMatrix4(group.matrixWorld),norm=triangle.getNormal(),(normProj=raycaster.ray.direction.dot(norm))>=0)continue;if(w_0.subVectors(triangle.a,raycaster.ray.origin),(distance=norm.dot(w_0)/normProj)<0)continue;v1.copy(raycaster.ray.direction).multiplyScalar(distance).add(raycaster.ray.origin),v1.sub(triangle.a),v2.copy(triangle.b).sub(triangle.a),v3.copy(triangle.c).sub(triangle.a);var b_dot_c=v2.dot(v3),b_sq=v2.lengthSq(),c_sq=v3.lengthSq();if((t=(b_sq*v1.dot(v3)-b_dot_c*v1.dot(v2))/(b_sq*c_sq-b_dot_c*b_dot_c))<0||t>1)continue;if((s=(v1.dot(v2)-t*b_dot_c)/b_sq)<0||s>1||s+t>1)continue;intersects.push({clickable:clickable,distance:distance})}for(i=0,il=intersectionShape.cylinder.length;i<il;i++)if(intersectionShape.cylinder[i]instanceof $3Dmol.Cylinder){if(cylinder.copy(intersectionShape.cylinder[i]),cylinder.applyMatrix4(group.matrixWorld),w_0.subVectors(cylinder.c1,raycaster.ray.origin),cylProj=w_0.dot(cylinder.direction),rayProj=w_0.dot(raycaster.ray.direction),normProj=clamp(raycaster.ray.direction.dot(cylinder.direction)),0===(denom=1-normProj*normProj))continue;s_c=(normProj*rayProj-cylProj)/denom,t_c=(rayProj-normProj*cylProj)/denom,v1.copy(cylinder.direction).multiplyScalar(s_c).add(cylinder.c1),v2.copy(raycaster.ray.direction).multiplyScalar(t_c).add(raycaster.ray.origin),closestDistSq=v3.subVectors(v1,v2).lengthSq();var radiusSq=cylinder.radius*cylinder.radius;if(closestDistSq<=radiusSq){if(discriminant=(normProj*cylProj-rayProj)*(normProj*cylProj-rayProj)-denom*(w_0.lengthSq()-cylProj*cylProj-radiusSq),t=distance=discriminant<=0?Math.sqrt(closestDistSq):(rayProj-normProj*cylProj-Math.sqrt(discriminant))/denom,(s=normProj*t-cylProj)<0||s*s>cylinder.lengthSq()||t<0)continue;intersects.push({clickable:clickable,distance:distance})}}for(i=0,il=intersectionShape.line.length;i<il;i+=2){v1.copy(intersectionShape.line[i]),v1.applyMatrix4(group.matrixWorld),v2.copy(intersectionShape.line[i+1]),v2.applyMatrix4(group.matrixWorld),v3.subVectors(v2,v1);var bondLengthSq=v3.lengthSq();v3.normalize(),w_0.subVectors(v1,raycaster.ray.origin);var lineProj=w_0.dot(v3);rayProj=w_0.dot(raycaster.ray.direction),0!==(denom=1-(normProj=clamp(raycaster.ray.direction.dot(v3)))*normProj)&&(s_c=(normProj*rayProj-lineProj)/denom,t_c=(rayProj-normProj*lineProj)/denom,v1.add(v3.multiplyScalar(s_c)),v2.copy(raycaster.ray.direction).multiplyScalar(t_c).add(raycaster.ray.origin),(closestDistSq=v3.subVectors(v2,v1).lengthSq())<precisionSq&&s_c*s_c<bondLengthSq&&intersects.push({clickable:clickable,distance:t_c}))}for(i=0,il=intersectionShape.sphere.length;i<il;i++)if(intersectionShape.sphere[i]instanceof $3Dmol.Sphere&&(sphere.copy(intersectionShape.sphere[i]),sphere.applyMatrix4(group.matrixWorld),raycaster.ray.isIntersectionSphere(sphere))){v1.subVectors(sphere.center,raycaster.ray.origin);var distanceToCenter=v1.dot(raycaster.ray.direction);return discriminant=distanceToCenter*distanceToCenter-(v1.lengthSq()-sphere.radius*sphere.radius),distanceToCenter<0?intersects:(distance=discriminant<=0?distanceToCenter:distanceToCenter-Math.sqrt(discriminant),intersects.push({clickable:clickable,distance:distance}),intersects)}};return Raycaster.prototype.precision=1e-4,Raycaster.prototype.linePrecision=.2,Raycaster.prototype.set=function(origin,direction){this.ray.set(origin,direction)},Raycaster.prototype.intersectObjects=function(group,objects){for(var intersects=[],i=0,l=objects.length;i<l;i++)intersectObject(group,objects[i],this,intersects);return intersects.sort(descSort),intersects},Raycaster}(),$3Dmol.Projector=function(){new $3Dmol.Matrix4;var _viewProjectionMatrix=new $3Dmol.Matrix4;this.projectVector=function(vector,camera){return camera.matrixWorldInverse.getInverse(camera.matrixWorld),_viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix,camera.matrixWorldInverse),vector.applyProjection(_viewProjectionMatrix)},this.unprojectVector=function(vector,camera){return camera.projectionMatrixInverse.getInverse(camera.projectionMatrix),_viewProjectionMatrix.multiplyMatrices(camera.matrixWorld,camera.projectionMatrixInverse),vector.applyProjection(_viewProjectionMatrix)}},$3Dmol.Camera=function(fov,aspect,near,far,ortho){$3Dmol.Object3D.call(this),this.fov=void 0!==fov?fov:50,this.aspect=void 0!==aspect?aspect:1,this.near=void 0!==near?near:.1,this.far=void 0!==far?far:2e3,this.projectionMatrix=new $3Dmol.Matrix4,this.projectionMatrixInverse=new $3Dmol.Matrix4,this.matrixWorldInverse=new $3Dmol.Matrix4;var center=this.position.z;this.right=center*Math.tan(Math.PI/180*fov),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!ortho,this.updateProjectionMatrix()},$3Dmol.Camera.prototype=Object.create($3Dmol.Object3D.prototype),$3Dmol.Camera.prototype.lookAt=function(vector){this.matrix.lookAt(this.position,vector,this.up),this.rotationAutoUpdate&&(!1===this.useQuaternion?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):this.quaternion.copy(this.matrix.decompose()[1]))},$3Dmol.Camera.prototype.updateProjectionMatrix=function(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},$3Dmol.SpritePlugin=function(){function createProgram(shader,precision){var program=_gl.createProgram(),fragmentShader=_gl.createShader(_gl.FRAGMENT_SHADER),vertexShader=_gl.createShader(_gl.VERTEX_SHADER),prefix="precision "+precision+" float;\n";return _gl.shaderSource(fragmentShader,prefix+shader.fragmentShader),_gl.shaderSource(vertexShader,prefix+shader.vertexShader),_gl.compileShader(fragmentShader),_gl.compileShader(vertexShader),_gl.getShaderParameter(fragmentShader,_gl.COMPILE_STATUS)&&_gl.getShaderParameter(vertexShader,_gl.COMPILE_STATUS)?(_gl.attachShader(program,fragmentShader),_gl.attachShader(program,vertexShader),_gl.linkProgram(program),_gl.getProgramParameter(program,_gl.LINK_STATUS)||console.error("Could not initialize shader"),program):(console.error(_gl.getShaderInfoLog(fragmentShader)),console.error("could not initialize shader"),null)}function painterSortStable(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var _gl,_renderer,_precision,_sprite={};this.init=function(renderer){_gl=renderer.context,_renderer=renderer,_precision=renderer.getPrecision(),_sprite.vertices=new Float32Array(16),_sprite.faces=new Uint16Array(6);var i=0;_sprite.vertices[i++]=-1,_sprite.vertices[i++]=-1,_sprite.vertices[i++]=0,_sprite.vertices[i++]=0,_sprite.vertices[i++]=1,_sprite.vertices[i++]=-1,_sprite.vertices[i++]=1,_sprite.vertices[i++]=0,_sprite.vertices[i++]=1,_sprite.vertices[i++]=1,_sprite.vertices[i++]=1,_sprite.vertices[i++]=1,_sprite.vertices[i++]=-1,_sprite.vertices[i++]=1,_sprite.vertices[i++]=0,_sprite.vertices[i++]=1,i=0,_sprite.faces[i++]=0,_sprite.faces[i++]=1,_sprite.faces[i++]=2,_sprite.faces[i++]=0,_sprite.faces[i++]=2,_sprite.faces[i++]=3,_sprite.vertexBuffer=_gl.createBuffer(),_sprite.elementBuffer=_gl.createBuffer(),_gl.bindBuffer(_gl.ARRAY_BUFFER,_sprite.vertexBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,_sprite.vertices,_gl.STATIC_DRAW),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,_sprite.elementBuffer),_gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER,_sprite.faces,_gl.STATIC_DRAW),_sprite.program=createProgram($3Dmol.ShaderLib.sprite,_precision),_sprite.attributes={},_sprite.uniforms={},_sprite.attributes.position=_gl.getAttribLocation(_sprite.program,"position"),_sprite.attributes.uv=_gl.getAttribLocation(_sprite.program,"uv"),_sprite.uniforms.uvOffset=_gl.getUniformLocation(_sprite.program,"uvOffset"),_sprite.uniforms.uvScale=_gl.getUniformLocation(_sprite.program,"uvScale"),_sprite.uniforms.rotation=_gl.getUniformLocation(_sprite.program,"rotation"),_sprite.uniforms.scale=_gl.getUniformLocation(_sprite.program,"scale"),_sprite.uniforms.alignment=_gl.getUniformLocation(_sprite.program,"alignment"),_sprite.uniforms.color=_gl.getUniformLocation(_sprite.program,"color"),_sprite.uniforms.map=_gl.getUniformLocation(_sprite.program,"map"),_sprite.uniforms.opacity=_gl.getUniformLocation(_sprite.program,"opacity"),_sprite.uniforms.useScreenCoordinates=_gl.getUniformLocation(_sprite.program,"useScreenCoordinates"),_sprite.uniforms.screenPosition=_gl.getUniformLocation(_sprite.program,"screenPosition"),_sprite.uniforms.modelViewMatrix=_gl.getUniformLocation(_sprite.program,"modelViewMatrix"),_sprite.uniforms.projectionMatrix=_gl.getUniformLocation(_sprite.program,"projectionMatrix"),_sprite.uniforms.fogType=_gl.getUniformLocation(_sprite.program,"fogType"),_sprite.uniforms.fogDensity=_gl.getUniformLocation(_sprite.program,"fogDensity"),_sprite.uniforms.fogNear=_gl.getUniformLocation(_sprite.program,"fogNear"),_sprite.uniforms.fogFar=_gl.getUniformLocation(_sprite.program,"fogFar"),_sprite.uniforms.fogColor=_gl.getUniformLocation(_sprite.program,"fogColor"),_sprite.uniforms.alphaTest=_gl.getUniformLocation(_sprite.program,"alphaTest")},this.render=function(scene,camera,viewportWidth,viewportHeight){var sprites=scene.__webglSprites,nSprites=sprites.length;if(nSprites){var attributes=_sprite.attributes,uniforms=_sprite.uniforms,halfViewportWidth=.5*viewportWidth,halfViewportHeight=.5*viewportHeight;_gl.useProgram(_sprite.program),_gl.enableVertexAttribArray(attributes.position),_gl.enableVertexAttribArray(attributes.uv),_gl.disable(_gl.CULL_FACE),_gl.enable(_gl.BLEND),_gl.bindBuffer(_gl.ARRAY_BUFFER,_sprite.vertexBuffer),_gl.vertexAttribPointer(attributes.position,2,_gl.FLOAT,!1,16,0),_gl.vertexAttribPointer(attributes.uv,2,_gl.FLOAT,!1,16,8),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,_sprite.elementBuffer),_gl.uniformMatrix4fv(uniforms.projectionMatrix,!1,camera.projectionMatrix.elements),_gl.activeTexture(_gl.TEXTURE0),_gl.uniform1i(uniforms.map,0);var oldFogType=0,sceneFogType=0,fog=scene.fog;fog?(_gl.uniform3f(uniforms.fogColor,fog.color.r,fog.color.g,fog.color.b),_gl.uniform1f(uniforms.fogNear,fog.near),_gl.uniform1f(uniforms.fogFar,fog.far),_gl.uniform1i(uniforms.fogType,1),oldFogType=1,sceneFogType=1):(_gl.uniform1i(uniforms.fogType,0),oldFogType=0,sceneFogType=0);var i,sprite,material,size,fogType,scale=[];for(i=0;i<nSprites;i++)material=(sprite=sprites[i]).material,sprite.visible&&0!==material.opacity&&(material.useScreenCoordinates?sprite.z=-sprite.position.z:(sprite._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,sprite.matrixWorld),sprite.z=-sprite._modelViewMatrix.elements[14]));for(sprites.sort(painterSortStable),i=0;i<nSprites;i++)if(sprite=sprites[i],material=sprite.material,sprite.visible&&0!==material.opacity&&material.map&&material.map.image&&material.map.image.width){_gl.uniform1f(uniforms.alphaTest,material.alphaTest);var w=material.map.image.width,h=material.map.image.height;scale[0]=w*_renderer.devicePixelRatio/viewportWidth,scale[1]=h*_renderer.devicePixelRatio/viewportHeight,!0===material.useScreenCoordinates?(_gl.uniform1i(uniforms.useScreenCoordinates,1),_gl.uniform3f(uniforms.screenPosition,(sprite.position.x*_renderer.devicePixelRatio-halfViewportWidth)/halfViewportWidth,(halfViewportHeight-sprite.position.y*_renderer.devicePixelRatio)/halfViewportHeight,Math.max(0,Math.min(1,sprite.position.z)))):(_gl.uniform1i(uniforms.useScreenCoordinates,0),_gl.uniformMatrix4fv(uniforms.modelViewMatrix,!1,sprite._modelViewMatrix.elements)),oldFogType!==(fogType=scene.fog&&material.fog?sceneFogType:0)&&(_gl.uniform1i(uniforms.fogType,fogType),oldFogType=fogType),size=1/(material.scaleByViewport?viewportHeight:1),scale[0]*=size*sprite.scale.x,scale[1]*=size*sprite.scale.y,_gl.uniform2f(uniforms.uvScale,material.uvScale.x,material.uvScale.y),_gl.uniform2f(uniforms.uvOffset,material.uvOffset.x,material.uvOffset.y),_gl.uniform2f(uniforms.alignment,material.alignment.x,material.alignment.y),_gl.uniform1f(uniforms.opacity,material.opacity),_gl.uniform3f(uniforms.color,material.color.r,material.color.g,material.color.b),_gl.uniform1f(uniforms.rotation,sprite.rotation),_gl.uniform2fv(uniforms.scale,scale),_renderer.setDepthTest(material.depthTest),_renderer.setDepthWrite(material.depthWrite),_renderer.setTexture(material.map,0),_gl.drawElements(_gl.TRIANGLES,6,_gl.UNSIGNED_SHORT,0)}_gl.enable(_gl.CULL_FACE)}}},$3Dmol.Light=function(hex,intensity){$3Dmol.Object3D.call(this),this.color=new $3Dmol.Color(hex),this.position=new $3Dmol.Vector3(0,1,0),this.target=new $3Dmol.Object3D,this.intensity=void 0!==intensity?intensity:1,this.castShadow=!1,this.onlyShadow=!1},$3Dmol.Light.prototype=Object.create($3Dmol.Object3D.prototype),$3Dmol.Material=function(){$3Dmol.EventDispatcher.call(this),this.id=$3Dmol.MaterialIdCount++,this.name="",this.side=$3Dmol.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.stencilTest=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0},$3Dmol.Material.prototype.setValues=function(values){if(void 0!==values)for(var key in values){var newValue=values[key];if(void 0!==newValue){if(key in this){var currentValue=this[key];currentValue instanceof $3Dmol.Color&&newValue instanceof $3Dmol.Color?currentValue.copy(newValue):currentValue instanceof $3Dmol.Color?currentValue.set(newValue):currentValue instanceof $3Dmol.Vector3&&newValue instanceof $3Dmol.Vector3?currentValue.copy(newValue):this[key]=newValue}}else console.warn("$3Dmol.Material: '"+key+"' parameter is undefined.")}},$3Dmol.Material.prototype.clone=function(material){return void 0===material&&(material=new $3Dmol.Material),material.name=this.name,material.side=this.side,material.opacity=this.opacity,material.transparent=this.transparent,material.depthTest=this.depthTest,material.depthWrite=this.depthWrite,material.stencilTest=this.stencilTest,material.polygonOffset=this.polygonOffset,material.polygonOffsetFactor=this.polygonOffsetFactor,material.polygonOffsetUnits=this.polygonOffsetUnits,material.alphaTest=this.alphaTest,material.overdraw=this.overdraw,material.visible=this.visible,material},$3Dmol.Material.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})},$3Dmol.MaterialIdCount=0,$3Dmol.LineBasicMaterial=function(parameters){$3Dmol.Material.call(this),this.color=new $3Dmol.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(parameters)},$3Dmol.LineBasicMaterial.prototype=Object.create($3Dmol.Material.prototype),$3Dmol.LineBasicMaterial.prototype.clone=function(){var material=new $3Dmol.LineBasicMaterial;return $3Dmol.Material.prototype.clone.call(this,material),material.color.copy(this.color),material},$3Dmol.MeshLambertMaterial=function(parameters){$3Dmol.Material.call(this),this.color=new $3Dmol.Color(16777215),this.ambient=new $3Dmol.Color(1048575),this.emissive=new $3Dmol.Color(0),this.wrapAround=!1,this.wrapRGB=new $3Dmol.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=$3Dmol.SmoothShading,this.shaderID="lambert",this.vertexColors=$3Dmol.NoColors,this.skinning=!1,this.setValues(parameters)},$3Dmol.MeshLambertMaterial.prototype=Object.create($3Dmol.Material.prototype),$3Dmol.MeshLambertMaterial.prototype.clone=function(material){return void 0===material&&(material=new $3Dmol.MeshLambertMaterial),$3Dmol.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.ambient.copy(this.ambient),material.emissive.copy(this.emissive),material.wrapAround=this.wrapAround,material.wrapRGB.copy(this.wrapRGB),material.map=this.map,material.lightMap=this.lightMap,material.specularMap=this.specularMap,material.envMap=this.envMap,material.combine=this.combine,material.reflectivity=this.reflectivity,material.refractionRatio=this.refractionRatio,material.fog=this.fog,material.shading=this.shading,material.shaderID=this.shaderID,material.vertexColors=this.vertexColors,material.skinning=this.skinning,material.morphTargets=this.morphTargets,material.morphNormals=this.morphNormals,material},$3Dmol.MeshDoubleLambertMaterial=function(parameters){$3Dmol.MeshLambertMaterial.call(this,parameters),this.shaderID="lambertdouble",this.side=$3Dmol.DoubleSide},$3Dmol.MeshDoubleLambertMaterial.prototype=Object.create($3Dmol.MeshLambertMaterial.prototype),$3Dmol.MeshDoubleLambertMaterial.prototype.clone=function(){var material=new $3Dmol.MeshDoubleLambertMaterial;return $3Dmol.MeshLambertMaterial.prototype.clone.call(this,material),material},$3Dmol.MeshOutlineMaterial=function(parameters){$3Dmol.Material.call(this),parameters=parameters||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=parameters.color||new $3Dmol.Color(0,0,0),this.outlineWidth=parameters.width||.1,this.outlinePushback=parameters.pushback||1},$3Dmol.MeshOutlineMaterial.prototype=Object.create($3Dmol.Material.prototype),$3Dmol.MeshOutlineMaterial.prototype.clone=function(material){return void 0===material&&(material=new $3Dmol.MeshOutlineMaterial),$3Dmol.Material.prototype.clone.call(this,material),material.fog=this.fog,material.shaderID=this.shaderID,material.wireframe=this.wireframe,material},$3Dmol.ImposterMaterial=function(parameters){$3Dmol.Material.call(this),this.color=new $3Dmol.Color(16777215),this.ambient=new $3Dmol.Color(1048575),this.emissive=new $3Dmol.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new $3Dmol.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=$3Dmol.SmoothShading,this.shaderID=null,this.vertexColors=$3Dmol.NoColors,this.skinning=!1,this.setValues(parameters)},$3Dmol.ImposterMaterial.prototype=Object.create($3Dmol.Material.prototype),$3Dmol.ImposterMaterial.prototype.clone=function(){var material=new $3Dmol.ImposterMaterial;return $3Dmol.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.ambient.copy(this.ambient),material.emissive.copy(this.emissive),material.wrapAround=this.wrapAround,material.wrapRGB.copy(this.wrapRGB),material.map=this.map,material.lightMap=this.lightMap,material.specularMap=this.specularMap,material.envMap=this.envMap,material.combine=this.combine,material.reflectivity=this.reflectivity,material.refractionRatio=this.refractionRatio,material.fog=this.fog,material.shading=this.shading,material.shaderID=this.shaderID,material.vertexColors=this.vertexColors,material.skinning=this.skinning,material.morphTargets=this.morphTargets,material.morphNormals=this.morphNormals,material},$3Dmol.SphereImposterMaterial=function(parameters){$3Dmol.ImposterMaterial.call(this),this.shaderID="sphereimposter",this.setValues(parameters)},$3Dmol.SphereImposterMaterial.prototype=Object.create($3Dmol.ImposterMaterial.prototype),$3Dmol.SphereImposterMaterial.prototype.clone=function(){var material=new $3Dmol.SphereImposterMaterial;return $3Dmol.ImposterMaterial.prototype.clone.call(this,material),material},$3Dmol.SphereImposterOutlineMaterial=function(parameters){$3Dmol.ImposterMaterial.call(this),parameters=parameters||{},this.shaderID="sphereimposteroutline",this.outlineColor=parameters.color||new $3Dmol.Color(0,0,0),this.outlineWidth=parameters.width||.1,this.outlinePushback=parameters.pushback||1,this.setValues(parameters)},$3Dmol.SphereImposterOutlineMaterial.prototype=Object.create($3Dmol.ImposterMaterial.prototype),$3Dmol.SphereImposterOutlineMaterial.prototype.clone=function(){var material=new $3Dmol.SphereImposterOutlineMaterial;return $3Dmol.ImposterMaterial.prototype.clone.call(this,material),material.outlineColor=this.outlineColor,material.outlineWidth=this.outlineWidth,material.outlinePushback=this.outlinePushback,material},$3Dmol.StickImposterMaterial=function(parameters){$3Dmol.ImposterMaterial.call(this),this.shaderID="stickimposter",this.setValues(parameters)},$3Dmol.StickImposterMaterial.prototype=Object.create($3Dmol.ImposterMaterial.prototype),$3Dmol.StickImposterMaterial.prototype.clone=function(){var material=new $3Dmol.StickImposterMaterial;return $3Dmol.ImposterMaterial.prototype.clone.call(this,material),material},$3Dmol.StickImposterOutlineMaterial=function(parameters){$3Dmol.ImposterMaterial.call(this),parameters=parameters||{},this.shaderID="stickimposteroutline",this.outlineColor=parameters.color||new $3Dmol.Color(0,0,0),this.outlineWidth=parameters.width||.1,this.outlinePushback=parameters.pushback||1,this.setValues(parameters)},$3Dmol.StickImposterOutlineMaterial.prototype=Object.create($3Dmol.ImposterMaterial.prototype),$3Dmol.StickImposterOutlineMaterial.prototype.clone=function(){var material=new $3Dmol.StickImposterOutlineMaterial;return $3Dmol.ImposterMaterial.prototype.clone.call(this,material),material.outlineColor=this.outlineColor,material.outlineWidth=this.outlineWidth,material.outlinePushback=this.outlinePushback,material},$3Dmol.InstancedMaterial=function(parameters){$3Dmol.Material.call(this),this.color=new $3Dmol.Color(16777215),this.ambient=new $3Dmol.Color(1048575),this.emissive=new $3Dmol.Color(0),this.wrapAround=!1,this.wrapRGB=new $3Dmol.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=$3Dmol.SmoothShading,this.shaderID="instanced",this.vertexColors=$3Dmol.NoColors,this.skinning=!1,this.sphere=null,this.setValues(parameters)},$3Dmol.InstancedMaterial.prototype=Object.create($3Dmol.Material.prototype),$3Dmol.InstancedMaterial.prototype.clone=function(){var material=new $3Dmol.InstancedMaterial;return $3Dmol.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.ambient.copy(this.ambient),material.emissive.copy(this.emissive),material.wrapAround=this.wrapAround,material.wrapRGB.copy(this.wrapRGB),material.map=this.map,material.lightMap=this.lightMap,material.specularMap=this.specularMap,material.envMap=this.envMap,material.combine=this.combine,material.reflectivity=this.reflectivity,material.refractionRatio=this.refractionRatio,material.fog=this.fog,material.shading=this.shading,material.shaderID=this.shaderID,material.vertexColors=this.vertexColors,material.skinning=this.skinning,material.morphTargets=this.morphTargets,material.morphNormals=this.morphNormals,material.sphere=this.sphere,material},$3Dmol.SpriteMaterial=function(parameters){$3Dmol.Material.call(this),this.color=new $3Dmol.Color(16777215),this.map=new $3Dmol.Texture,this.useScreenCoordinates=!0,this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=$3Dmol.SpriteAlignment.center.clone(),this.fog=!1,this.uvOffset=new $3Dmol.Vector2(0,0),this.uvScale=new $3Dmol.Vector2(1,1),this.setValues(parameters),void 0===(parameters=parameters||{}).depthTest&&(this.depthTest=!this.useScreenCoordinates),void 0===parameters.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates),void 0===parameters.scaleByViewPort&&(this.scaleByViewPort=!this.sizeAttenuation)},$3Dmol.SpriteMaterial.prototype=Object.create($3Dmol.Material.prototype),$3Dmol.SpriteMaterial.prototype.clone=function(){var material=new $3Dmol.SpriteMaterial;return $3Dmol.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.map=this.map,material.useScreenCoordinates=useScreenCoordinates,material.sizeAttenuation=this.sizeAttenuation,material.scaleByViewport=this.scaleByViewPort,material.alignment.copy(this.alignment),material.uvOffset.copy(this.uvOffset),material},$3Dmol.SpriteAlignment={},$3Dmol.SpriteAlignment.topLeft=new $3Dmol.Vector2(1,-1),$3Dmol.SpriteAlignment.topCenter=new $3Dmol.Vector2(0,-1),$3Dmol.SpriteAlignment.topRight=new $3Dmol.Vector2(-1,-1),$3Dmol.SpriteAlignment.centerLeft=new $3Dmol.Vector2(1,0),$3Dmol.SpriteAlignment.center=new $3Dmol.Vector2(0,0),$3Dmol.SpriteAlignment.centerRight=new $3Dmol.Vector2(-1,0),$3Dmol.SpriteAlignment.bottomLeft=new $3Dmol.Vector2(1,1),$3Dmol.SpriteAlignment.bottomCenter=new $3Dmol.Vector2(0,1),$3Dmol.SpriteAlignment.bottomRight=new $3Dmol.Vector2(-1,1),$3Dmol.Texture=function(image){$3Dmol.EventDispatcher.call(this),this.id=$3Dmol.TextureIdCount++,this.name="",this.image=image,this.mipmaps=[],this.mapping=new $3Dmol.UVMapping,this.wrapS=$3Dmol.ClampToEdgeWrapping,this.wrapT=$3Dmol.ClampToEdgeWrapping,this.magFilter=$3Dmol.LinearFilter,this.minFilter=$3Dmol.LinearMipMapLinearFilter,this.anisotropy=1,this.format=$3Dmol.RGBAFormat,this.type=$3Dmol.UnsignedByteType,this.offset=new $3Dmol.Vector2(0,0),this.repeat=new $3Dmol.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.needsUpdate=!1,this.onUpdate=null},$3Dmol.Texture.prototype={constructor:$3Dmol.Texture,clone:function(texture){return void 0===texture&&(texture=new $3Dmol.Texture),texture.image=this.image,texture.mipmaps=this.mipmaps.slice(0),texture.mapping=this.mapping,texture.wrapS=this.wrapS,texture.wrapT=this.wrapT,texture.magFilter=this.magFilter,texture.minFilter=this.minFilter,texture.anisotropy=this.anisotropy,texture.format=this.format,texture.type=this.type,texture.offset.copy(this.offset),texture.repeat.copy(this.repeat),texture.generateMipmaps=this.generateMipmaps,texture.premultiplyAlpha=this.premultiplyAlpha,texture.flipY=this.flipY,texture.unpackAlignment=this.unpackAlignment,texture},dispose:function(){this.dispatchEvent({type:"dispose"})}},$3Dmol.TextureIdCount=0,$3Dmol.FrontSide=0,$3Dmol.BackSide=1,$3Dmol.DoubleSide=2,$3Dmol.NoShading=0,$3Dmol.FlatShading=1,$3Dmol.SmoothShading=2,$3Dmol.NoColors=0,$3Dmol.FaceColors=1,$3Dmol.VertexColors=2,$3Dmol.MultiplyOperation=0,$3Dmol.MixOperation=1,$3Dmol.AddOperation=2,$3Dmol.UVMapping=function(){},$3Dmol.ClampToEdgeWrapping=1001,$3Dmol.LinearFilter=1006,$3Dmol.LinearMipMapLinearFilter=1008,$3Dmol.UnsignedByteType=1009,$3Dmol.RGBAFormat=1021,$3Dmol.Line=function(geometry,material,type){$3Dmol.Object3D.call(this),this.geometry=geometry,this.material=void 0!==material?material:new $3Dmol.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==type?type:$3Dmol.LineStrip},$3Dmol.LineStrip=0,$3Dmol.LinePieces=1,$3Dmol.Line.prototype=Object.create($3Dmol.Object3D.prototype),$3Dmol.Line.prototype.clone=function(object){return void 0===object&&(object=new $3Dmol.Line(this.geometry,this.material,this.type)),$3Dmol.Object3D.prototype.clone.call(this,object),object},$3Dmol.Mesh=function(geometry,material){$3Dmol.Object3D.call(this),this.geometry=geometry,this.material=void 0!==material?material:new $3Dmol.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0})},$3Dmol.Mesh.prototype=Object.create($3Dmol.Object3D.prototype),$3Dmol.Mesh.prototype.clone=function(object){return void 0===object&&(object=new $3Dmol.Mesh(this.geometry,this.material)),$3Dmol.Object3D.prototype.clone.call(this,object),object},$3Dmol.Sprite=function(material){$3Dmol.Object3D.call(this),this.material=void 0!==material?material:new $3Dmol.SpriteMaterial,this.rotation3d=this.rotation,this.rotation=0},$3Dmol.Sprite.prototype=Object.create($3Dmol.Object3D.prototype),$3Dmol.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),1===this.scale.x&&1===this.scale.y||this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0},$3Dmol.Sprite.prototype.clone=function(object){return void 0===object&&(object=new $3Dmol.Sprite(this.material)),$3Dmol.Object3D.prototype.clone.call(this,object),object},$3Dmol.Renderer=function(parameters){function enableAttribute(attribute){_enabledAttributes[attribute]||(_gl.enableVertexAttribArray(attribute),_enabledAttributes[attribute]=!0)}function disableAttributes(){for(var attribute in _enabledAttributes)_enabledAttributes[attribute]&&(_gl.disableVertexAttribArray(attribute),_enabledAttributes[attribute]=!1)}function setPolygonOffset(polygonOffset,factor,units){_oldPolygonOffset!==polygonOffset&&(polygonOffset?_gl.enable(_gl.POLYGON_OFFSET_FILL):_gl.disable(_gl.POLYGON_OFFSET_FILL))}function setLineWidth(width){width!==_oldLineWidth&&(_gl.lineWidth(width),_oldLineWidth=width)}function getShader(type,str){var shader;return"fragment"===type?shader=_gl.createShader(_gl.FRAGMENT_SHADER):"vertex"===type&&(shader=_gl.createShader(_gl.VERTEX_SHADER)),_gl.shaderSource(shader,str),_gl.compileShader(shader),_gl.getShaderParameter(shader,_gl.COMPILE_STATUS)?shader:(console.error(_gl.getShaderInfoLog(shader)),console.error("could not initialize shader"),null)}function buildProgram(fragmentShader,vertexShader,uniforms,parameters){var p,pl,program,code,chunks=[];chunks.push(fragmentShader),chunks.push(vertexShader);for(p in parameters)chunks.push(p),chunks.push(parameters[p]);for(code=chunks.join(),p=0,pl=_programs.length;p<pl;p++){var programInfo=_programs[p];if(programInfo.code===code)return programInfo.usedTimes++,programInfo.program}program=_gl.createProgram();var prefix="precision "+_precision+" float;",prefix_vertex=[prefix].join("\n"),glFragmentShader=getShader("fragment",[parameters.fragdepth?"#extension GL_EXT_frag_depth: enable":"",parameters.wireframe?"#define WIREFRAME 1":"",prefix].join("\n")+fragmentShader),glVertexShader=getShader("vertex",prefix_vertex+vertexShader);_gl.attachShader(program,glVertexShader),_gl.attachShader(program,glFragmentShader),_gl.linkProgram(program),_gl.getProgramParameter(program,_gl.LINK_STATUS)||console.error("Could not initialize shader"),program.uniforms={},program.attributes={};var identifiers,u,i;identifiers=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix"];for(u in uniforms)identifiers.push(u);for(i=0;i<identifiers.length;i++){var uniformVar=identifiers[i];program.uniforms[uniformVar]=_gl.getUniformLocation(program,uniformVar)}for(identifiers=["position","normal","color","lineDistance","offset","radius"],i=0;i<identifiers.length;i++){var attributeVar=identifiers[i];program.attributes[attributeVar]=_gl.getAttribLocation(program,attributeVar)}return program.id=_programs_counter++,_programs.push({program:program,code:code,usedTimes:1}),_this.info.memory.programs=_programs.length,program}function setProgram(camera,lights,fog,material,object){material.needsUpdate&&(material.program&&deallocateMaterial(material),_this.initMaterial(material,lights,fog,object),material.needsUpdate=!1);var refreshMaterial=!1,program=material.program,p_uniforms=program.uniforms,m_uniforms=material.uniforms;return program!=_currentProgram&&(_gl.useProgram(program),_currentProgram=program,refreshMaterial=!0),material.id!=_currentMaterialId&&(_currentMaterialId=material.id,refreshMaterial=!0),camera!=_currentCamera&&(_currentCamera=camera,refreshMaterial=!0),_gl.uniformMatrix4fv(p_uniforms.projectionMatrix,!1,camera.projectionMatrix.elements),_gl.uniformMatrix4fv(p_uniforms.modelViewMatrix,!1,object._modelViewMatrix.elements),_gl.uniformMatrix3fv(p_uniforms.normalMatrix,!1,object._normalMatrix.elements),refreshMaterial&&(m_uniforms.fogColor.value=fog.color,m_uniforms.fogNear.value=fog.near,m_uniforms.fogFar.value=fog.far,material.shaderID.startsWith("lambert")||"instanced"===material.shaderID||material.shaderID.endsWith("imposter")?(_gl.uniformMatrix4fv(p_uniforms.viewMatrix,!1,camera.matrixWorldInverse.elements),_lightsNeedUpdate&&(setupLights(program,lights),_lightsNeedUpdate=!1),m_uniforms.directionalLightColor.value=_lights.directional.colors,m_uniforms.directionalLightDirection.value=_lights.directional.positions):material.shaderID.endsWith("outline")?(m_uniforms.outlineColor.value=material.outlineColor,m_uniforms.outlineWidth.value=material.outlineWidth,m_uniforms.outlinePushback.value=material.outlinePushback):"sphereimposter"===material.shaderID&&(_gl.uniformMatrix4fv(p_uniforms.viewMatrix,!1,camera.matrixWorldInverse.elements),_gl.uniformMatrix3fv(p_uniforms.normalMatrix,!1,object._normalMatrix.elements),m_uniforms.directionalLightColor.value=_lights.directional.colors,m_uniforms.directionalLightDirection.value=_lights.directional.positions),m_uniforms.opacity.value=material.opacity,loadMaterialUniforms(p_uniforms,m_uniforms)),program}function loadMaterialUniforms(p_uniforms,m_uniforms){var uniformVar,type,uniformVal,uniformLoc;for(uniformVar in m_uniforms)p_uniforms[uniformVar]&&(type=m_uniforms[uniformVar].type,uniformVal=m_uniforms[uniformVar].value,uniformLoc=p_uniforms[uniformVar],"f"===type?_gl.uniform1f(uniformLoc,uniformVal):"fv"===type?_gl.uniform3fv(uniformLoc,uniformVal):"c"===type?_gl.uniform3f(uniformLoc,uniformVal.r,uniformVal.g,uniformVal.b):"f4"===type&&_gl.uniform4f(uniformLoc,uniformVal[0],uniformVal[1],uniformVal[2],uniformVal[3]))}function renderObjects(renderList,reverse,materialType,camera,lights,fog,useBlending,overrideMaterial){var webglObject,object,buffer,material,start,end,delta;reverse?(start=renderList.length-1,end=-1,delta=-1):(start=0,end=renderList.length,delta=1);for(var i=start;i!==end;i+=delta)if((webglObject=renderList[i]).render){if(object=webglObject.object,buffer=webglObject.buffer,!(material=webglObject[materialType]))continue;useBlending&&_this.setBlending(!0),_this.setDepthTest(material.depthTest),_this.setDepthWrite(material.depthWrite),setPolygonOffset(material.polygonOffset,material.polygonOffsetFactor,material.polygonOffsetUnits);var reflected=object._modelViewMatrix.isReflected();_this.setMaterialFaces(material,reflected),_this.renderBuffer(camera,lights,fog,material,buffer,object),(_outlineEnabled||material.outline)&&("sphereimposter"==material.shaderID?_this.renderBuffer(camera,lights,fog,_outlineSphereImposterMaterial,buffer,object):"stickimposter"==material.shaderID?_this.renderBuffer(camera,lights,fog,_outlineStickImposterMaterial,buffer,object):material.wireframe||"basic"===material.shaderID||0===material.opacity||_this.renderBuffer(camera,lights,fog,_outlineMaterial,buffer,object))}}function renderPlugins(plugins,scene,camera){if(_currentGeometryGroupHash=-1,_currentProgram=null,_currentCamera=null,_oldBlending=-1,_oldDepthWrite=-1,_oldDepthTest=-1,_oldDoubleSided=-1,_currentMaterialId=-1,_oldFlipSided=-1,plugins.length)for(var i=0,il=plugins.length;i<il;i++)_lightsNeedUpdate=!0,plugins[i].render(scene,camera,_currentWidth,_currentHeight),_currentGeometryGroupHash=-1,_currentProgram=null,_currentCamera=null,_oldBlending=-1,_oldDepthWrite=-1,_oldDepthTest=-1,_oldDoubleSided=-1,_currentMaterialId=-1,_oldFlipSided=-1}function addObject(object,scene){var g,gl,geometry,geometryGroup;if(!object.__webglInit&&(object.__webglInit=!0,object._modelViewMatrix=new $3Dmol.Matrix4,object._normalMatrix=new $3Dmol.Matrix3,void 0!==object.geometry&&void 0===object.geometry.__webglInit&&(object.geometry.__webglInit=!0,object.geometry.addEventListener("dispose",onGeometryDispose)),object instanceof $3Dmol.Mesh||object instanceof $3Dmol.Line))for(geometry=object.geometry,object.material,g=0,gl=geometry.geometryGroups.length;g<gl;g++)(geometryGroup=geometry.geometryGroups[g]).id=_geometryGroupCounter++,geometryGroup.__webglVertexBuffer||(object instanceof $3Dmol.Mesh?(createMeshBuffers(geometryGroup),geometry.elementsNeedUpdate=!0,geometry.normalsNeedUpdate=!0):object instanceof $3Dmol.Line&&createLineBuffers(geometryGroup),geometry.verticesNeedUpdate=!0,geometry.colorsNeedUpdate=!0);if(!object.__webglActive){if(object instanceof $3Dmol.Mesh||object instanceof $3Dmol.Line)for(g=0,gl=(geometry=object.geometry).geometryGroups.length;g<gl;g++)geometryGroup=geometry.geometryGroups[g],addBuffer(scene.__webglObjects,geometryGroup,object);else object instanceof $3Dmol.Sprite&&scene.__webglSprites.push(object);object.__webglActive=!0}}function updateObject(object){var geometryGroup,geometry=object.geometry;object.material;if(object instanceof $3Dmol.Mesh||object instanceof $3Dmol.Line){for(var g=0,gl=geometry.geometryGroups.length;g<gl;g++)geometryGroup=geometry.geometryGroups[g],(geometry.verticesNeedUpdate||geometry.elementsNeedUpdate||geometry.colorsNeedUpdate||geometry.normalsNeedUpdate)&&setBuffers(geometryGroup,_gl.STATIC_DRAW);geometry.verticesNeedUpdate=!1,geometry.elementsNeedUpdate=!1,geometry.normalsNeedUpdate=!1,geometry.colorsNeedUpdate=!1,geometry.buffersNeedUpdate=!1}}function removeObject(object,scene){object instanceof $3Dmol.Mesh||object instanceof $3Dmol.Line?removeInstances(scene.__webglObjects,object):object instanceof $3Dmol.Sprite&&removeInstancesDirect(scene.__webglSprites,object),object.__webglActive=!1}function removeInstances(objList,object){for(var o=objList.length-1;o>=0;--o)objList[o].object===object&&objList.splice(o,1)}function removeInstancesDirect(objList,object){for(var o=objList.length-1;o>=0;--o)objList[o]===object&&objList.splice(o,1)}function unrollBufferMaterial(globject){var material=globject.object.material;if(material.transparent){if(globject.opaque=null,globject.transparent=material,!material.wireframe){var blankMaterial=material.clone();blankMaterial.opacity=0,globject.blank=blankMaterial}}else globject.opaque=material,globject.transparent=null}function setBuffers(geometryGroup,hint,line){var vertexArray=geometryGroup.vertexArray,colorArray=geometryGroup.colorArray;if(void 0!==geometryGroup.__webglOffsetBuffer?(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglOffsetBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,vertexArray,hint)):(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglVertexBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,vertexArray,hint)),_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglColorBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,colorArray,hint),geometryGroup.normalArray&&void 0!==geometryGroup.__webglNormalBuffer){var normalArray=geometryGroup.normalArray;_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglNormalBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,normalArray,hint)}if(geometryGroup.radiusArray&&void 0!==geometryGroup.__webglRadiusBuffer&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglRadiusBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,geometryGroup.radiusArray,hint)),geometryGroup.faceArray&&void 0!==geometryGroup.__webglFaceBuffer){var faceArray=geometryGroup.faceArray;_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,geometryGroup.__webglFaceBuffer),_gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER,faceArray,hint)}if(geometryGroup.lineArray&&void 0!==geometryGroup.__webglLineBuffer){var lineArray=geometryGroup.lineArray;_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,geometryGroup.__webglLineBuffer),_gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER,lineArray,hint)}}function createMeshBuffers(geometryGroup){geometryGroup.radiusArray&&(geometryGroup.__webglRadiusBuffer=_gl.createBuffer()),geometryGroup.useOffset&&(geometryGroup.__webglOffsetBuffer=_gl.createBuffer()),geometryGroup.__webglVertexBuffer=_gl.createBuffer(),geometryGroup.__webglNormalBuffer=_gl.createBuffer(),geometryGroup.__webglColorBuffer=_gl.createBuffer(),geometryGroup.__webglFaceBuffer=_gl.createBuffer(),geometryGroup.__webglLineBuffer=_gl.createBuffer(),_this.info.memory.geometries++}function createLineBuffers(geometry){geometry.__webglVertexBuffer=_gl.createBuffer(),geometry.__webglColorBuffer=_gl.createBuffer(),_this.info.memory.geometries++}function addBuffer(objlist,buffer,object){objlist.push({buffer:buffer,object:object,opaque:null,transparent:null})}function setupMatrices(object,camera){object._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,object.matrixWorld),object._normalMatrix.getInverse(object._modelViewMatrix),object._normalMatrix.transpose()}function isPowerOfTwo(value){return 0==(value&value-1)}function filterFallback(f){return _gl.LINEAR}function setTextureParameters(textureType,texture,isImagePowerOfTwo){isImagePowerOfTwo?(_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_S,paramToGL(texture.wrapS)),_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_T,paramToGL(texture.wrapT)),_gl.texParameteri(textureType,_gl.TEXTURE_MAG_FILTER,paramToGL(texture.magFilter)),_gl.texParameteri(textureType,_gl.TEXTURE_MIN_FILTER,paramToGL(texture.minFilter))):(_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_S,_gl.CLAMP_TO_EDGE),_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_T,_gl.CLAMP_TO_EDGE),_gl.texParameteri(textureType,_gl.TEXTURE_MAG_FILTER,filterFallback(texture.magFilter)),_gl.texParameteri(textureType,_gl.TEXTURE_MIN_FILTER,filterFallback(texture.minFilter)))}function paramToGL(p){return p===$3Dmol.UnsignedByteType?_gl.UNSIGNED_BYTE:p===$3Dmol.RGBAFormat?_gl.RGBA:0}function setupLights(program,lights){var l,ll,light,color,intensity,zlights=_lights,dirColors=zlights.directional.colors,dirPositions=zlights.directional.positions,dirLength=0,dirOffset=0;for(l=0,ll=lights.length;l<ll;l++)if(light=lights[l],color=light.color,intensity=light.intensity,light.distance,light instanceof $3Dmol.Light){if(0,_direction.getPositionFromMatrix(light.matrixWorld),_vector3.getPositionFromMatrix(light.target.matrixWorld),_direction.sub(_vector3),_direction.normalize(),0===_direction.x&&0===_direction.y&&0===_direction.z)continue;dirPositions[dirOffset]=_direction.x,dirPositions[dirOffset+1]=_direction.y,dirPositions[dirOffset+2]=_direction.z,dirColors[dirOffset]=color.r*intensity,dirColors[dirOffset+1]=color.g*intensity,dirColors[dirOffset+2]=color.b*intensity,dirOffset+=3,dirLength++}zlights.ambient[0]=0,zlights.ambient[1]=0,zlights.ambient[2]=0,zlights.directional.length=dirLength}parameters=parameters||{},this.row=parameters.row,this.col=parameters.col,this.rows=parameters.rows,this.cols=parameters.cols;var _canvas=void 0!==parameters.canvas?parameters.canvas:document.createElement("canvas"),_precision=void 0!==parameters.precision?parameters.precision:"highp",_alpha=void 0===parameters.alpha||parameters.alpha,_premultipliedAlpha=void 0===parameters.premultipliedAlpha||parameters.premultipliedAlpha,_antialias=void 0!==parameters.antialias&&parameters.antialias,_stencil=void 0===parameters.stencil||parameters.stencil,_preserveDrawingBuffer=void 0!==parameters.preserveDrawingBuffer&&parameters.preserveDrawingBuffer,_clearColor=void 0!==parameters.clearColor?new $3Dmol.Color(parameters.clearColor):new $3Dmol.Color(0),_clearAlpha=void 0!==parameters.clearAlpha?parameters.clearAlpha:0,_outlineMaterial=new $3Dmol.MeshOutlineMaterial(parameters.outline),_outlineSphereImposterMaterial=new $3Dmol.SphereImposterOutlineMaterial(parameters.outline),_outlineStickImposterMaterial=new $3Dmol.StickImposterOutlineMaterial(parameters.outline),_outlineEnabled=!!parameters.outline;this.domElement=_canvas,this.context=null,this.devicePixelRatio=void 0!==parameters.devicePixelRatio?parameters.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1,_canvas.id=parameters.id,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var _gl,_this=this,_programs=[],_programs_counter=0,_currentProgram=null,_currentMaterialId=-1,_currentGeometryGroupHash=null,_currentCamera=null,_geometryGroupCounter=0,_oldDoubleSided=-1,_oldFlipSided=-1,_oldBlending=-1,_oldDepthTest=-1,_oldDepthWrite=-1,_oldPolygonOffset=null,_oldLineWidth=null,_viewportWidth=0,_viewportHeight=0,_currentWidth=0,_currentHeight=0,_enabledAttributes={},_projScreenMatrix=new $3Dmol.Matrix4,_vector3=new $3Dmol.Vector3,_direction=new $3Dmol.Vector3,_lightsNeedUpdate=!0,_lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};!function(){try{if(!(_gl=_canvas.getContext("experimental-webgl",{alpha:_alpha,premultipliedAlpha:_premultipliedAlpha,antialias:_antialias,stencil:_stencil,preserveDrawingBuffer:_preserveDrawingBuffer}))&&!(_gl=_canvas.getContext("webgl",{alpha:_alpha,premultipliedAlpha:_premultipliedAlpha,antialias:_antialias,stencil:_stencil,preserveDrawingBuffer:_preserveDrawingBuffer})))throw"Error creating WebGL context."}catch(error){console.error(error)}}(),_gl.clearColor(0,0,0,1),_gl.clearDepth(1),_gl.clearStencil(0),_gl.enable(_gl.DEPTH_TEST),_gl.depthFunc(_gl.LEQUAL),_gl.frontFace(_gl.CCW),_gl.cullFace(_gl.BACK),_gl.enable(_gl.CULL_FACE),_gl.enable(_gl.BLEND),_gl.blendEquation(_gl.FUNC_ADD),_gl.blendFunc(_gl.SRC_ALPHA,_gl.ONE_MINUS_SRC_ALPHA),_gl.clearColor(_clearColor.r,_clearColor.g,_clearColor.b,_clearAlpha),this.context=_gl;var _extInstanced=_gl.getExtension("ANGLE_instanced_arrays"),_extFragDepth=_gl.getExtension("EXT_frag_depth");this.supportedExtensions=function(){return{supportsAIA:Boolean(_extInstanced),supportsImposters:Boolean(_extFragDepth)}},this.getContext=function(){return _gl},this.getPrecision=function(){return _precision},this.setClearColorHex=function(hex,alpha){_clearColor.setHex(hex),_clearAlpha=alpha,_gl.clearColor(_clearColor.r,_clearColor.g,_clearColor.b,_clearAlpha)},this.enableOutline=function(parameters){_outlineMaterial=new $3Dmol.MeshOutlineMaterial(parameters),_outlineSphereImposterMaterial=new $3Dmol.SphereImposterOutlineMaterial(parameters),_outlineStickImposterMaterial=new $3Dmol.StickImposterOutlineMaterial(parameters),_outlineEnabled=!0},this.disableOutline=function(){_outlineEnabled=!1},this.setViewport=function(){if(void 0!=this.rows&&void 0!=this.cols&&void 0!=this.row&&void 0!=this.col){var wid=_canvas.width/this.cols,hei=_canvas.height/this.rows;_viewportWidth=wid*this.devicePixelRatio,_viewportHeight=hei*this.devicePixelRatio,_gl.drawingBufferWidth=3*_viewportWidth,_gl.drawingBufferHeight=_viewportHeight,_gl.enable(_gl.SCISSOR_TEST),_gl.scissor(wid*this.col,hei*this.row,wid,hei),_gl.viewport(wid*this.col,hei*this.row,wid,hei)}},this.setSize=function(width,height){if(void 0!=this.rows&&void 0!=this.cols&&void 0!=this.row&&void 0!=this.col){var wid=width/this.cols,hei=height/this.rows;_canvas.width=width*this.devicePixelRatio,_canvas.height=height*this.devicePixelRatio,_viewportWidth=wid*this.devicePixelRatio,_viewportHeight=hei*this.devicePixelRatio,_canvas.style.width=width+"px",_canvas.style.height=height+"px",this.setViewport()}else _viewportWidth=_canvas.width=width*this.devicePixelRatio,_viewportHeight=_canvas.height=height*this.devicePixelRatio,_canvas.style.width=width+"px",_canvas.style.height=height+"px",_gl.viewport(0,0,_gl.drawingBufferWidth,_gl.drawingBufferHeight)},this.clear=function(color,depth,stencil){var bits=0;(void 0===color||color)&&(bits|=_gl.COLOR_BUFFER_BIT),(void 0===depth||depth)&&(bits|=_gl.DEPTH_BUFFER_BIT),(void 0===stencil||stencil)&&(bits|=_gl.STENCIL_BUFFER_BIT),_gl.clear(bits)},this.clearTarget=function(color,depth,stencil){this.clear(color,depth,stencil)},this.setMaterialFaces=function(material,reflected){var doubleSided=material.side===$3Dmol.DoubleSide,flipSided=material.side===$3Dmol.BackSide;flipSided=reflected?!flipSided:flipSided,_oldDoubleSided!==doubleSided&&(doubleSided?_gl.disable(_gl.CULL_FACE):_gl.enable(_gl.CULL_FACE),_oldDoubleSided=doubleSided),_oldFlipSided!==flipSided&&(flipSided?_gl.frontFace(_gl.CW):_gl.frontFace(_gl.CCW),_oldFlipSided=flipSided)},this.setDepthTest=function(depthTest){_oldDepthTest!==depthTest&&(depthTest?_gl.enable(_gl.DEPTH_TEST):_gl.disable(_gl.DEPTH_TEST),_oldDepthTest=depthTest)},this.setDepthWrite=function(depthWrite){_oldDepthWrite!==depthWrite&&(_gl.depthMask(depthWrite),_oldDepthWrite=depthWrite)},this.setBlending=function(blending){blending?(_gl.enable(_gl.BLEND),_gl.blendEquationSeparate(_gl.FUNC_ADD,_gl.FUNC_ADD),_gl.blendFuncSeparate(_gl.SRC_ALPHA,_gl.ONE_MINUS_SRC_ALPHA,_gl.ONE,_gl.ONE_MINUS_SRC_ALPHA)):_gl.disable(_gl.BLEND),_oldBlending=blending},this.addPostPlugin=function(plugin){plugin.init(this),this.renderPluginsPost.push(plugin)};var onGeometryDispose=function(event){var geometry=event.target;geometry.removeEventListener("dispose",onGeometryDispose),deallocateGeometry(geometry),_this.info.memory.geometries--},onTextureDispose=function(event){var texture=event.target;texture.removeEventListener("dispose",onTextureDispose),deallocateTexture(texture),_this.info.memory.textures--},onMaterialDispose=function(event){var material=event.target;material.removeEventListener("dispose",onMaterialDispose),deallocateMaterial(material)},deallocateGeometry=function(geometry){if(geometry.__webglInit=void 0,void 0!==geometry.__webglVertexBuffer&&_gl.deleteBuffer(geometry.__webglVertexBuffer),void 0!==geometry.__webglColorBuffer&&_gl.deleteBuffer(geometry.__webglColorBuffer),void 0!==geometry.geometryGroups)for(var g=0,gl=geometry.groups;g<gl;g++){var geometryGroup=geometry.geometryGroups[g];void 0!==geometryGroup.__webglVertexBuffer&&_gl.deleteBuffer(geometryGroup.__webglVertexBuffer),void 0!==geometryGroup.__webglColorBuffer&&_gl.deleteBuffer(geometryGroup.__webglColorBuffer),void 0!==geometryGroup.__webglNormalBuffer&&_gl.deleteBuffer(geometryGroup.__webglNormalBuffer),void 0!==geometryGroup.__webglFaceBuffer&&_gl.deleteBuffer(geometryGroup.__webglFaceBuffer),void 0!==geometryGroup.__webglLineBuffer&&_gl.deleteBuffer(geometryGroup.__webglLineBuffer)}},deallocateMaterial=function(material){var program=material.program;if(void 0!==program){material.program=void 0;var i,il,programInfo,deleteProgram=!1;for(i=0,il=_programs.length;i<il;i++)if((programInfo=_programs[i]).program===program){programInfo.usedTimes--,0===programInfo.usedTimes&&(deleteProgram=!0);break}if(!0===deleteProgram){var newPrograms=[];for(i=0,il=_programs.length;i<il;i++)(programInfo=_programs[i]).program!==program&&newPrograms.push(programInfo);_programs=newPrograms,_gl.deleteProgram(program),_this.info.memory.programs--}}},deallocateTexture=function(texture){if(texture.image&&texture.image.__webglTextureCube)_gl.deleteTexture(texture.image.__webglTextureCube);else{if(!texture.__webglInit)return;texture.__webglInit=!1,_gl.deleteTexture(texture.__webglTexture)}};this.initMaterial=function(material,lights,fog,object){material.addEventListener("dispose",onMaterialDispose);var parameters,shaderID;if(shaderID=material.shaderID){var shader=$3Dmol.ShaderLib[shaderID];material.vertexShader=shader.vertexShader,material.fragmentShader=shader.fragmentShader,material.uniforms=$3Dmol.ShaderUtils.clone(shader.uniforms)}parameters={wireframe:material.wireframe,fragdepth:material.imposter},material.program=buildProgram(material.fragmentShader,material.vertexShader,material.uniforms,parameters)},this.renderBuffer=function(camera,lights,fog,material,geometryGroup,object){if(material.visible){var program,attributes;attributes=(program=setProgram(camera,lights,fog,material,object)).attributes;var updateBuffers=!1,wireframeBit=material.wireframe?1:0,geometryGroupHash=16777215*geometryGroup.id+2*program.id+wireframeBit;geometryGroupHash!==_currentGeometryGroupHash&&(_currentGeometryGroupHash=geometryGroupHash,updateBuffers=!0),updateBuffers&&(disableAttributes(),attributes.position>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglVertexBuffer),enableAttribute(attributes.position),_gl.vertexAttribPointer(attributes.position,3,_gl.FLOAT,!1,0,0)),attributes.color>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglColorBuffer),enableAttribute(attributes.color),_gl.vertexAttribPointer(attributes.color,3,_gl.FLOAT,!1,0,0)),attributes.normal>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglNormalBuffer),enableAttribute(attributes.normal),_gl.vertexAttribPointer(attributes.normal,3,_gl.FLOAT,!1,0,0)),attributes.offset>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglOffsetBuffer),enableAttribute(attributes.offset),_gl.vertexAttribPointer(attributes.offset,3,_gl.FLOAT,!1,0,0)),attributes.radius>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglRadiusBuffer),enableAttribute(attributes.radius),_gl.vertexAttribPointer(attributes.radius,1,_gl.FLOAT,!1,0,0)));var faceCount,lineCount;if(object instanceof $3Dmol.Mesh){if("instanced"===material.shaderID){var sphereGeometryGroup=material.sphere.geometryGroups[0];updateBuffers&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglVertexBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,sphereGeometryGroup.vertexArray,_gl.STATIC_DRAW),_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglNormalBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,sphereGeometryGroup.normalArray,_gl.STATIC_DRAW),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,geometryGroup.__webglFaceBuffer),_gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER,sphereGeometryGroup.faceArray,_gl.STATIC_DRAW)),faceCount=sphereGeometryGroup.faceidx,_extInstanced.vertexAttribDivisorANGLE(attributes.offset,1),_extInstanced.vertexAttribDivisorANGLE(attributes.radius,1),_extInstanced.vertexAttribDivisorANGLE(attributes.color,1),_extInstanced.drawElementsInstancedANGLE(_gl.TRIANGLES,faceCount,_gl.UNSIGNED_SHORT,0,geometryGroup.radiusArray.length),_extInstanced.vertexAttribDivisorANGLE(attributes.offset,0),_extInstanced.vertexAttribDivisorANGLE(attributes.radius,0),_extInstanced.vertexAttribDivisorANGLE(attributes.color,0)}else material.wireframe?(lineCount=geometryGroup.lineidx,setLineWidth(material.wireframeLinewidth),updateBuffers&&_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,geometryGroup.__webglLineBuffer),_gl.drawElements(_gl.LINES,lineCount,_gl.UNSIGNED_SHORT,0)):(faceCount=geometryGroup.faceidx,updateBuffers&&_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,geometryGroup.__webglFaceBuffer),_gl.drawElements(_gl.TRIANGLES,faceCount,_gl.UNSIGNED_SHORT,0));_this.info.render.calls++,_this.info.render.vertices+=faceCount,_this.info.render.faces+=faceCount/3}else object instanceof $3Dmol.Line&&(lineCount=geometryGroup.vertices,setLineWidth(material.linewidth),_gl.drawArrays(_gl.LINES,0,lineCount),_this.info.render.calls++)}},this.render=function(scene,camera,forceClear){if(camera instanceof $3Dmol.Camera!=!1){var i,il,webglObject,object,renderList,lights=scene.__lights,fog=scene.fog;for(_currentMaterialId=-1,_lightsNeedUpdate=!0,this.autoUpdateScene&&scene.updateMatrixWorld(),void 0===camera.parent&&camera.updateMatrixWorld(),camera.matrixWorldInverse.getInverse(camera.matrixWorld),_projScreenMatrix.multiplyMatrices(camera.projectionMatrix,camera.matrixWorldInverse),this.autoUpdateObjects&&this.initWebGLObjects(scene),_this.info.render.calls=0,_this.info.render.vertices=0,_this.info.render.faces=0,_this.info.render.points=0,_currentWidth=_viewportWidth,_currentHeight=_viewportHeight,this.setViewport(),(this.autoClear||forceClear)&&(_gl.clearColor(_clearColor.r,_clearColor.g,_clearColor.b,_clearAlpha),this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil)),i=0,il=(renderList=scene.__webglObjects).length;i<il;i++)object=(webglObject=renderList[i]).object,webglObject.render=!1,object.visible&&(setupMatrices(object,camera),unrollBufferMaterial(webglObject),webglObject.render=!0);this.setBlending(!1),renderObjects(scene.__webglObjects,!0,"opaque",camera,lights,fog,!1),renderObjects(scene.__webglObjects,!0,"blank",camera,lights,fog,!0),renderObjects(scene.__webglObjects,!1,"transparent",camera,lights,fog,!0),renderPlugins(this.renderPluginsPost,scene,camera),this.setDepthTest(!0),this.setDepthWrite(!0)}else console.error("$3Dmol.Renderer.render: camera is not an instance of $3Dmol.Camera.")},this.initWebGLObjects=function(scene){if(scene.__webglObjects||(scene.__webglObjects=[],scene.__webglObjectsImmediate=[],scene.__webglSprites=[],scene.__webglFlares=[]),scene.__objectsAdded.length){for(;scene.__objectsAdded.length;)addObject(scene.__objectsAdded[0],scene),scene.__objectsAdded.splice(0,1);_currentGeometryGroupHash=-1}for(;scene.__objectsRemoved.length;)removeObject(scene.__objectsRemoved[0],scene),scene.__objectsRemoved.splice(0,1);for(var o=0,ol=scene.__webglObjects.length;o<ol;o++)updateObject(scene.__webglObjects[o].object)},this.getXYRatio=function(){return void 0!=this.rows&&void 0!=this.cols&&void 0!=this.row&&void 0!=this.col?[this.cols,this.rows]:[1,1]},this.getAspect=function(width,height){void 0!=width&&void 0!=height||(width=_canvas.width,height=_canvas.height);var aspect=width/height;return void 0!=this.rows&&void 0!=this.cols&&void 0!=this.row&&void 0!=this.col&&(aspect=width/this.cols/(height/this.rows)),aspect},this.setTexture=function(texture,slot){if(texture.needsUpdate){texture.__webglInit||(texture.__webglInit=!0,texture.addEventListener("dispose",onTextureDispose),texture.__webglTexture=_gl.createTexture(),_this.info.memory.textures++),_gl.activeTexture(_gl.TEXTURE0+slot),_gl.bindTexture(_gl.TEXTURE_2D,texture.__webglTexture),_gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL,texture.flipY),_gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,texture.premultiplyAlpha),_gl.pixelStorei(_gl.UNPACK_ALIGNMENT,texture.unpackAlignment);var image=texture.image,isImagePowerOfTwo=isPowerOfTwo(image.width)&&isPowerOfTwo(image.height),glFormat=paramToGL(texture.format),glType=paramToGL(texture.type);setTextureParameters(_gl.TEXTURE_2D,texture,isImagePowerOfTwo);var mipmap,mipmaps=texture.mipmaps;if(mipmaps.length>0&&isImagePowerOfTwo){for(var i=0,il=mipmaps.length;i<il;i++)mipmap=mipmaps[i],_gl.texImage2D(_gl.TEXTURE_2D,i,glFormat,glFormat,glType,mipmap);texture.generateMipmaps=!1}else _gl.texImage2D(_gl.TEXTURE_2D,0,glFormat,glFormat,glType,texture.image);texture.generateMipmaps&&isImagePowerOfTwo&&_gl.generateMipmap(_gl.TEXTURE_2D),texture.needsUpdate=!1,texture.onUpdate&&texture.onUpdate()}else _gl.activeTexture(_gl.TEXTURE0+slot),_gl.bindTexture(_gl.TEXTURE_2D,texture.__webglTexture)},this.addPostPlugin(new $3Dmol.SpritePlugin)},$3Dmol.Scene=function(){$3Dmol.Object3D.call(this),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},$3Dmol.Scene.prototype=Object.create($3Dmol.Object3D.prototype),$3Dmol.Scene.prototype.__addObject=function(object){object instanceof $3Dmol.Light?(-1===this.__lights.indexOf(object)&&this.__lights.push(object),object.target&&void 0===object.target.parent&&this.add(object.target)):-1===this.__objects.indexOf(object)&&(this.__objects.push(object),this.__objectsAdded.push(object),-1!==this.__objectsRemoved.indexOf(object)&&this.__objectsRemoved.splice(i,1));for(var i=0;i<object.children.length;i++)this.__addObject(object.children[i])},$3Dmol.Scene.prototype.__removeObject=function(object){var idx;object instanceof $3Dmol.Light?-1!==(idx=this.__lights.indexOf(object))&&this.__lights.splice(idx,1):-1!==(idx=this.__objects.indexOf(object))&&(this.__objects.splice(idx,1),this.__objectsRemoved.push(object),-1!==this.__objectsAdded.indexOf(object)&&this.__objectsAdded.splice(idx,1));for(var i=0;i<object.children.length;i++)this.__removeObject(object.children[i])},$3Dmol.Fog=function(hex,near,far){this.name="",this.color=new $3Dmol.Color(hex),this.near=void 0!==near?near:1,this.far=void 0!==far?far:1e3},$3Dmol.Fog.prototype.clone=function(){return new $3Dmol.Fog(this.color.getHex(),this.near,this.far)},$3Dmol.ShaderUtils={clone:function(uniforms_src){var u,uniforms_clone={};for(u in uniforms_src){uniforms_clone[u]={},uniforms_clone[u].type=uniforms_src[u].type;var srcValue=uniforms_src[u].value;srcValue instanceof $3Dmol.Color?uniforms_clone[u].value=srcValue.clone():"number"==typeof srcValue?uniforms_clone[u].value=srcValue:srcValue instanceof Array?uniforms_clone[u].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return uniforms_clone},stickimposterFragmentShader:["uniform float opacity;","uniform mat4 projectionMatrix;","uniform vec3 fogColor;","uniform float fogNear;","uniform float fogFar;","varying vec3 vLight;","varying vec3 vColor;","varying vec3 cposition;","varying vec3 p1;","varying vec3 p2;","varying float r;","void main() {","    vec3 color = abs(vColor);","    vec3 pos = cposition;","    vec3 p = pos;","    vec3 v = normalize(pos);","    vec3 pa = p1;","    vec3 va = normalize(p2-p1);","    vec3 tmp1 = v-(dot(v,va)*va);","    vec3 deltap = p-pa;","    float A = dot(tmp1,tmp1);","    if(A == 0.0) discard;","    vec3 tmp2 = deltap-(dot(deltap,va)*va);","    float B = 2.0*dot(tmp1, tmp2);","    float C = dot(tmp2,tmp2)-r*r;","    float det = (B*B) - (4.0*A*C);","    if(det < 0.0) discard;","    float sqrtDet = sqrt(det);","    float posT = (-B+sqrtDet)/(2.0*A);","    float negT = (-B-sqrtDet)/(2.0*A);","    float intersectionT = min(posT,negT);","    vec3 qi = p+v*intersectionT;","    float dotp1 = dot(va,qi-p1);","    float dotp2 = dot(va,qi-p2);","    vec3 norm;","    if( dotp1 < 0.0 || dotp2 > 0.0) {","       vec3 cp;","       if( dotp1 < 0.0) {        cp = p1;","       } else {","          cp = p2;","       }","       vec3 diff = p-cp;","       A = dot(v,v);","       B = dot(diff,v)*2.0;","       C = dot(diff,diff)-r*r;","       det = (B*B) - (4.0*C);","       if(det < 0.0) discard;","       sqrtDet = sqrt(det);","       posT = (-B+sqrtDet)/(2.0);","       negT = (-B-sqrtDet)/(2.0);","       float t = min(posT,negT);","       qi = p+v*t;","       norm = normalize(qi-cp);","    } else {","       norm = normalize(qi-(dotp1*va + p1));","    }","    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);","    float ndcDepth = clipPos.z / clipPos.w;","    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;","    gl_FragDepthEXT = depth;"].join("\n")},$3Dmol.ShaderLib={basic:{fragmentShader:["uniform mat4 viewMatrix;","uniform float opacity;","uniform vec3 fogColor;","uniform float fogNear;","uniform float fogFar;","varying vec3 vColor;","void main() {","    gl_FragColor = vec4( vColor, opacity );","    float depth = gl_FragCoord.z / gl_FragCoord.w;","    float fogFactor = smoothstep( fogNear, fogFar, depth );","    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}"].join("\n"),vertexShader:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","void main() {","    vColor = color;","    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","    gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}},sphereimposter:{fragmentShader:["uniform mat4 viewMatrix;","uniform float opacity;","uniform mat4 projectionMatrix;","uniform vec3 fogColor;","uniform float fogNear;","uniform float fogFar;","uniform float uDepth;","uniform vec3 directionalLightColor[ 1 ];","varying vec3 vColor;","varying vec2 mapping;","varying float rval;","varying vec3 vLight;","varying vec3 center;","void main() {","    float lensqr = dot(mapping,mapping);","    float rsqr = rval*rval;","    if(lensqr > rsqr)","       discard;","    float z = sqrt(rsqr-lensqr);","    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);","    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);","    float ndcDepth = clipPos.z / clipPos.w;","    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;","    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));","    float dotProduct = dot( norm, vLight );","    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;","    gl_FragColor = vec4(vLight*vColor, opacity*opacity );","    float fogFactor = smoothstep( fogNear, fogFar, gl_FragDepthEXT/gl_FragCoord.w );","    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}"].join("\n"),vertexShader:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 directionalLightColor[ 1 ];","uniform vec3 directionalLightDirection[ 1 ];","attribute vec3 position;","attribute vec3 normal;","attribute vec3 color;","varying vec2 mapping;","varying vec3 vColor;","varying float rval;","varying vec3 vLight;","varying vec3 center;","void main() {","    vColor = color;","    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","    center = mvPosition.xyz;","    vec4 projPosition = projectionMatrix * mvPosition;","    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;","    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );","    vLight = normalize( lDirection.xyz );","    mapping = normal.xy;","    rval = abs(normal.x);","    gl_Position = projPosition+adjust;","}"].join("\n"),uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},lambert:{fragmentShader:["uniform mat4 viewMatrix;","uniform float opacity;","uniform vec3 fogColor;","uniform float fogNear;","uniform float fogFar;","varying vec3 vLightFront;","varying vec3 vColor;","void main() {","    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );","    #ifndef WIREFRAME","    gl_FragColor.xyz *= vLightFront;","    #endif","    gl_FragColor = gl_FragColor * vec4( vColor, opacity );","    float depth = gl_FragCoord.z / gl_FragCoord.w;","    float fogFactor = smoothstep( fogNear, fogFar, depth );","    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}"].join("\n"),vertexShader:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 directionalLightColor[ 1 ];","uniform vec3 directionalLightDirection[ 1 ];","attribute vec3 position;","attribute vec3 normal;","attribute vec3 color;","varying vec3 vColor;","varying vec3 vLightFront;","void main() {","    vColor = color;","    vec3 objectNormal = normal;","    vec3 transformedNormal = normalMatrix * objectNormal;","    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","    vLightFront = vec3( 0.0 );","    transformedNormal = normalize( transformedNormal );","    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );","    vec3 dirVector = normalize( lDirection.xyz );","    float dotProduct = dot( transformedNormal, dirVector );","    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;","    gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},instanced:{fragmentShader:["uniform mat4 viewMatrix;","uniform float opacity;","uniform vec3 fogColor;","uniform float fogNear;","uniform float fogFar;","varying vec3 vLightFront;","varying vec3 vColor;","void main() {","    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );","    #ifndef WIREFRAME","    gl_FragColor.xyz *= vLightFront;","    #endif","    gl_FragColor = gl_FragColor * vec4( vColor, opacity );","    float depth = gl_FragCoord.z / gl_FragCoord.w;","    float fogFactor = smoothstep( fogNear, fogFar, depth );","    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}"].join("\n"),vertexShader:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 directionalLightColor[ 1 ];","uniform vec3 directionalLightDirection[ 1 ];","attribute vec3 offset;","attribute vec3 position;","attribute vec3 normal;","attribute vec3 color;","attribute float radius;","varying vec3 vColor;","varying vec3 vLightFront;","void main() {","    vColor = color;","    vec3 objectNormal = normal;","    vec3 transformedNormal = normalMatrix * objectNormal;","    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );","    vLightFront = vec3( 0.0 );","    transformedNormal = normalize( transformedNormal );","    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );","    vec3 dirVector = normalize( lDirection.xyz );","    float dotProduct = dot( transformedNormal, dirVector );","    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;","    gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},outline:{fragmentShader:["uniform float opacity;","uniform vec3 outlineColor;","uniform vec3 fogColor;","uniform float fogNear;","uniform float fogFar;","void main() {","    gl_FragColor = vec4( outlineColor, 1 );","}"].join("\n"),vertexShader:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float outlineWidth;","uniform float outlinePushback;","attribute vec3 position;","attribute vec3 normal;","attribute vec3 color;","void main() {","    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);","    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","    mvPosition.xy += norm.xy*outlineWidth;","    gl_Position = projectionMatrix * mvPosition;","    mvPosition.z -= outlinePushback;","    vec4 pushpos = projectionMatrix*mvPosition;","    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;","}"].join("\n"),uniforms:{opacity:{type:"f",value:1},outlineColor:{type:"c",value:new $3Dmol.Color(0,0,0)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}},sphereimposteroutline:{fragmentShader:["uniform float opacity;","uniform vec3 outlineColor;","uniform vec3 fogColor;","uniform float fogNear;","uniform float fogFar;","uniform mat4 projectionMatrix;","varying vec2 mapping;","varying float rval;","varying vec3 center;","uniform float outlinePushback;","void main() {","    float lensqr = dot(mapping,mapping);","    float rsqr = rval*rval;","    if(lensqr > rsqr)","       discard;","    float z = sqrt(rsqr-lensqr);","    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);","    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);","    float ndcDepth = clipPos.z / clipPos.w;","    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;","    gl_FragColor = vec4(outlineColor, 1 );","}"].join("\n"),vertexShader:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float outlineWidth;","uniform float outlinePushback;","attribute vec3 position;","attribute vec3 normal;","attribute vec3 color;","varying vec2 mapping;","varying float rval;","varying vec3 center;","void main() {","    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","    center = mvPosition.xyz;","    vec4 projPosition = projectionMatrix * mvPosition;","    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);","    vec4 adjust = projectionMatrix* vec4(norm,normal.z,0.0); adjust.z = 0.0; adjust.w = 0.0;","    mapping = norm.xy;","    rval = abs(norm.x);","    gl_Position = projPosition+adjust;","}"].join("\n"),uniforms:{opacity:{type:"f",value:1},outlineColor:{type:"c",value:new $3Dmol.Color(0,0,0)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}},stickimposter:{fragmentShader:[$3Dmol.ShaderUtils.stickimposterFragmentShader,"    float dotProduct = dot( norm, vLight );","    vec3 light = vec3( max( dotProduct, 0.0 ) );","    gl_FragColor = vec4(light*color, opacity*opacity );","    float fogFactor = smoothstep( fogNear, fogFar, depth );","    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}"].join("\n"),vertexShader:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 directionalLightColor[ 1 ];","uniform vec3 directionalLightDirection[ 1 ];","attribute vec3 position;","attribute vec3 normal;","attribute vec3 color;","attribute float radius;","varying vec3 vColor;","varying vec3 vLight;","varying vec3 cposition;","varying vec3 p1;","varying vec3 p2;","varying float r;","void main() {","    vColor = color; vColor.z = abs(vColor.z);","    r = abs(radius);","    vec4 to = modelViewMatrix*vec4(normal, 1.0);","    vec4 pt = modelViewMatrix*vec4(position, 1.0);","    vec4 mvPosition = pt;","    p1 = pt.xyz; p2 = to.xyz;","    vec3 norm = to.xyz-pt.xyz;","    float mult = 1.1;","    if(length(p1) > length(p2)) {","       mvPosition = to;","    }","    vec3 n = normalize(mvPosition.xyz);","    if(color.z >= 0.0) {","       vec3 pnorm = normalize(p1);","       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);","       mvPosition.xyz = p1+t*pnorm;","    } else {","       vec3 pnorm = normalize(p2);","       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);","       mvPosition.xyz = p2+t*pnorm;","       mult *= -1.0;","    }","    vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;","    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;","    mvPosition.xy +=  mult*(cr + doublecr).xy;","    cposition = mvPosition.xyz;","    gl_Position = projectionMatrix * mvPosition;","    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );","    vLight = normalize( lDirection.xyz )*directionalLightColor[0];","}"].join("\n"),uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},stickimposteroutline:{fragmentShader:$3Dmol.ShaderUtils.stickimposterFragmentShader+"gl_FragColor = vec4(color,1.0);}",vertexShader:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 directionalLightColor[ 1 ];","uniform vec3 directionalLightDirection[ 1 ];","uniform vec3 outlineColor;","uniform float outlineWidth;","uniform float outlinePushback;","attribute vec3 position;","attribute vec3 normal;","attribute vec3 color;","attribute float radius;","varying vec3 vColor;","varying vec3 vLight;","varying vec3 cposition;","varying vec3 p1;","varying vec3 p2;","varying float r;","void main() {","    vColor = outlineColor;","    float rad = radius+sign(radius)*outlineWidth;","    r = abs(rad);","    vec4 to = modelViewMatrix*vec4(normal, 1.0);","    vec4 pt = modelViewMatrix*vec4(position, 1.0);","    to.xyz += normalize(to.xyz)*outlinePushback;","    pt.xyz += normalize(pt.xyz)*outlinePushback;","    vec4 mvPosition = pt;","    p1 = pt.xyz; p2 = to.xyz;","    vec3 norm = to.xyz-pt.xyz;","    float mult = 1.1;","    if(length(p1) > length(p2)) {","       mvPosition = to;","    }","    vec3 n = normalize(mvPosition.xyz);","    if(color.z >= 0.0) {","       vec3 pnorm = normalize(p1);","       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);","       mvPosition.xyz = p1+t*pnorm;","    } else {","       vec3 pnorm = normalize(p2);","       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);","       mvPosition.xyz = p2+t*pnorm;","       mult *= -1.0;","    }","    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;","    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;","    mvPosition.xy +=  mult*(cr + doublecr).xy;","    cposition = mvPosition.xyz;","    gl_Position = projectionMatrix * mvPosition;","    vLight = vec3(1.0,1.0,1.0);","}"].join("\n"),uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new $3Dmol.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}},lambertdouble:{fragmentShader:["uniform mat4 viewMatrix;","uniform float opacity;","uniform vec3 fogColor;","uniform float fogNear;","uniform float fogFar;","varying vec3 vLightFront;","varying vec3 vLightBack;","varying vec3 vColor;","void main() {","    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );","    #ifndef WIREFRAME","    if ( gl_FrontFacing )","       gl_FragColor.xyz *= vLightFront;","    else","       gl_FragColor.xyz *= vLightBack;","    #endif","    gl_FragColor = gl_FragColor * vec4( vColor, opacity );","    float depth = gl_FragCoord.z / gl_FragCoord.w;","    float fogFactor = smoothstep( fogNear, fogFar, depth );","    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}"].join("\n"),vertexShader:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 directionalLightColor[ 1 ];","uniform vec3 directionalLightDirection[ 1 ];","attribute vec3 position;","attribute vec3 normal;","attribute vec3 color;","varying vec3 vColor;","varying vec3 vLightFront;","varying vec3 vLightBack;","void main() {","    vColor = color;","    vec3 objectNormal = normal;","    vec3 transformedNormal = normalMatrix * objectNormal;","    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","    vLightFront = vec3( 0.0 );","    vLightBack = vec3( 0.0 );","    transformedNormal = normalize( transformedNormal );","    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );","    vec3 dirVector = normalize( lDirection.xyz );","    float dotProduct = dot( transformedNormal, dirVector );","    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;","    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;","    gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),uniforms:{opacity:{type:"f",value:1},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},sprite:{fragmentShader:["uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","    vec4 texture = texture2D(map, vUV);","    if (texture.a < alphaTest) discard;","    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);","    if (fogType > 0) {","        float depth = gl_FragCoord.z / gl_FragCoord.w;","        float fogFactor = 0.0;","        if (fogType == 1) {","            fogFactor = smoothstep(fogNear, fogFar, depth);","        }","        else {","            const float LOG2 = 1.442695;","            float fogFactor = exp2(- fogDensity * fogDensity * depth * depth * LOG2);","            fogFactor = 1.0 - clamp(fogFactor, 0.0, 1.0);","        }","        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);","    }","}"].join("\n"),vertexShader:["uniform int useScreenCoordinates;","uniform vec3 screenPosition;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 alignment;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","    vUV = uvOffset + uv * uvScale;","    vec2 alignedPosition = position + alignment;","    vec2 rotatedPosition;","    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;","    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;","    vec4 finalPosition;","    if(useScreenCoordinates != 0) {","        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);","    }","    else {","        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;","        finalPosition.xy += rotatedPosition; ","    }","    gl_Position = finalPosition;","}"].join("\n"),uniforms:{}}},"undefined"==typeof console&&(console={log:function(){}}),$3Dmol.ProteinSurface=function(){var faces,verts,origextent,ptranx=0,ptrany=0,ptranz=0,scaleFactor=2,pHeight=0,pWidth=0,pLength=0,cutRadius=0,vpBits=null,vpDistance=null,vpAtomID=null,pminx=0,pminy=0,pminz=0,pmaxx=0,pmaxy=0,pmaxz=0,vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},getVDWIndex=function(atom){return atom.elem&&void 0!==vdwRadii[atom.elem]?atom.elem:"X"},depty={},widxz={},nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.getFacesAndVertices=function(atomlist){var i,il,atomsToShow={};for(i=0,il=atomlist.length;i<il;i++)atomsToShow[atomlist[i]]=!0;var vertices=verts;for(i=0,il=vertices.length;i<il;i++)vertices[i].x=vertices[i].x/scaleFactor-ptranx,vertices[i].y=vertices[i].y/scaleFactor-ptrany,vertices[i].z=vertices[i].z/scaleFactor-ptranz;var finalfaces=[];for(i=0,il=faces.length;i<il;i+=3){var fa=faces[i],fb=faces[i+1],fc=faces[i+2],a=vertices[fa].atomid,b=vertices[fb].atomid,c=vertices[fc].atomid,which=a;if(b<which&&(which=b),c<which&&(which=c),atomsToShow[which]){vertices[faces[i]],vertices[faces[i+1]],vertices[faces[i+2]];fa!==fb&&fb!==fc&&fa!==fc&&(finalfaces.push(fa),finalfaces.push(fb),finalfaces.push(fc))}}return vpBits=null,vpDistance=null,vpAtomID=null,{vertices:vertices,faces:finalfaces}},this.initparm=function(extent,btype,volume){volume>1e6&&(scaleFactor=1);var margin=1/scaleFactor*5.5;origextent=extent,pminx=extent[0][0],pmaxx=extent[1][0],pminy=extent[0][1],pmaxy=extent[1][1],pminz=extent[0][2],pmaxz=extent[1][2],btype?(pminx-=1.4+margin,pminy-=1.4+margin,pminz-=1.4+margin,pmaxx+=1.4+margin,pmaxy+=1.4+margin,pmaxz+=1.4+margin):(pminx-=margin,pminy-=margin,pminz-=margin,pmaxx+=margin,pmaxy+=margin,pmaxz+=margin),pminx=Math.floor(pminx*scaleFactor)/scaleFactor,pminy=Math.floor(pminy*scaleFactor)/scaleFactor,pminz=Math.floor(pminz*scaleFactor)/scaleFactor,pmaxx=Math.ceil(pmaxx*scaleFactor)/scaleFactor,pmaxy=Math.ceil(pmaxy*scaleFactor)/scaleFactor,pmaxz=Math.ceil(pmaxz*scaleFactor)/scaleFactor,ptranx=-pminx,ptrany=-pminy,ptranz=-pminz,pLength=Math.ceil(scaleFactor*(pmaxx-pminx))+1,pWidth=Math.ceil(scaleFactor*(pmaxy-pminy))+1,pHeight=Math.ceil(scaleFactor*(pmaxz-pminz))+1,this.boundingatom(btype),cutRadius=1.4*scaleFactor,vpBits=new Uint8Array(pLength*pWidth*pHeight),vpDistance=new Float64Array(pLength*pWidth*pHeight),vpAtomID=new Int32Array(pLength*pWidth*pHeight)},this.boundingatom=function(btype){var txz,tdept,sradius,tradius=[];flagradius=btype;for(var i in vdwRadii)if(vdwRadii.hasOwnProperty(i)){var r=vdwRadii[i];for(tradius[i]=btype?(r+1.4)*scaleFactor+.5:r*scaleFactor+.5,sradius=tradius[i]*tradius[i],widxz[i]=Math.floor(tradius[i])+1,depty[i]=new Int32Array(widxz[i]*widxz[i]),indx=0,j=0;j<widxz[i];j++)for(k=0;k<widxz[i];k++)(txz=j*j+k*k)>sradius?depty[i][indx]=-1:(tdept=Math.sqrt(sradius-txz),depty[i][indx]=Math.floor(tdept)),indx++}},this.fillvoxels=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;i<il;i++)vpBits[i]=0,vpDistance[i]=-1,vpAtomID[i]=-1;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtom(atom,atoms)}for(i=0,il=vpBits.length;i<il;i++)1&vpBits[i]&&(vpBits[i]|=2)},this.fillAtom=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,i,j,k,si,sj,sk,ii,jj,kk,n;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),nind=0,pWH=pWidth*pHeight;for(i=0,n=widxz[at];i<n;i++)for(j=0;j<n;j++){if(-1!=depty[at][nind])for(ii=-1;ii<2;ii++)for(jj=-1;jj<2;jj++)for(kk=-1;kk<2;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(si<0||sj<0||sk<0||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(1&vpBits[index]){var atom2=atoms[vpAtomID[index]];atom2.serial!=atom.serial&&mi*mi+mj*mj+mk*mk<(ox=cx+mi-Math.floor(.5+scaleFactor*(atom2.x+ptranx)))*ox+(oy=cy+mj-Math.floor(.5+scaleFactor*(atom2.y+ptrany)))*oy+(oz=cz+mk-Math.floor(.5+scaleFactor*(atom2.z+ptranz)))*oz&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=1,vpAtomID[index]=atom.serial}nind++}},this.fillvoxelswaals=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;i<il;i++)vpBits[i]&=-3;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtomWaals(atom,atoms)}},this.fillAtomWaals=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,si,sj,sk,i,j,k,ii,jj,kk,n,nind=0;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),pWH=pWidth*pHeight;for(i=0,n=widxz[at];i<n;i++)for(j=0;j<n;j++){if(-1!=depty[at][nind])for(ii=-1;ii<2;ii++)for(jj=-1;jj<2;jj++)for(kk=-1;kk<2;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(si<0||sj<0||sk<0||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(2&vpBits[index]){var atom2=atoms[vpAtomID[index]];atom2.serial!=atom.serial&&mi*mi+mj*mj+mk*mk<(ox=cx+mi-Math.floor(.5+scaleFactor*(atom2.x+ptranx)))*ox+(oy=cy+mj-Math.floor(.5+scaleFactor*(atom2.y+ptrany)))*oy+(oz=cz+mk-Math.floor(.5+scaleFactor*(atom2.z+ptranz)))*oz&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=2,vpAtomID[index]=atom.serial}nind++}},this.buildboundary=function(){var pWH=pWidth*pHeight;for(i=0;i<pLength;i++)for(j=0;j<pHeight;j++)for(k=0;k<pWidth;k++){var index=i*pWH+k*pHeight+j;if(1&vpBits[index])for(var ii=0;ii<26;){var ti=i+nb[ii][0],tj=j+nb[ii][2],tk=k+nb[ii][1];if(ti>-1&&ti<pLength&&tk>-1&&tk<pWidth&&tj>-1&&tj<pHeight&&!(1&vpBits[ti*pWH+tk*pHeight+tj])){vpBits[index]|=4;break}ii++}}};var PointGrid=function(length,width,height){var data=new Int32Array(length*width*height*3);this.set=function(x,y,z,pt){var index=3*((x*width+y)*height+z);data[index]=pt.ix,data[index+1]=pt.iy,data[index+2]=pt.iz},this.get=function(x,y,z){var index=3*((x*width+y)*height+z);return{ix:data[index],iy:data[index+1],iz:data[index+2]}}};this.fastdistancemap=function(){var i,j,k,n,index,boundPoint=new PointGrid(pLength,pWidth,pHeight),pWH=pWidth*pHeight,cutRSq=cutRadius*cutRadius,inarray=[],outarray=[];for(i=0;i<pLength;i++)for(j=0;j<pWidth;j++)for(k=0;k<pHeight;k++)if(index=i*pWH+j*pHeight+k,vpBits[index]&=-3,1&vpBits[index]&&4&vpBits[index]){var triple={ix:i,iy:j,iz:k};boundPoint.set(i,j,k,triple),inarray.push(triple),vpDistance[index]=0,vpBits[index]|=2,vpBits[index]&=-5}do{for(outarray=this.fastoneshell(inarray,boundPoint),inarray=[],i=0,n=outarray.length;i<n;i++)index=pWH*outarray[i].ix+pHeight*outarray[i].iy+outarray[i].iz,vpBits[index]&=-5,vpDistance[index]<=1.0404*cutRSq&&inarray.push({ix:outarray[i].ix,iy:outarray[i].iy,iz:outarray[i].iz})}while(0!==inarray.length);inarray=[],outarray=[],boundPoint=null;var cutsf=scaleFactor-.5;cutsf<0&&(cutsf=0);var cutoff=cutRSq-.5/(.1+cutsf);for(i=0;i<pLength;i++)for(j=0;j<pWidth;j++)for(k=0;k<pHeight;k++)vpBits[index=i*pWH+j*pHeight+k]&=-5,1&vpBits[index]&&(2&vpBits[index]&&!(2&vpBits[index]&&vpDistance[index]>=cutoff)||(vpBits[index]|=4))},this.fastoneshell=function(inarray,boundPoint){var tx,ty,tz,dx,dy,dz,i,j,n,square,bp,index,outarray=[];if(0===inarray.length)return outarray;tnv={ix:-1,iy:-1,iz:-1};var pWH=pWidth*pHeight;for(i=0,n=inarray.length;i<n;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=0;j<6;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,1&vpBits[index]&&!(2&vpBits[index])?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),square=(dx=tnv.ix-bp.ix)*dx+(dy=tnv.iy-bp.iy)*dy+(dz=tnv.iz-bp.iz)*dz,vpDistance[index]=square,vpBits[index]|=2,vpBits[index]|=4,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):1&vpBits[index]&&2&vpBits[index]&&(square=(dx=tnv.ix-bp.ix)*dx+(dy=tnv.iy-bp.iy)*dy+(dz=tnv.iz-bp.iz)*dz)<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,4&vpBits[index]||(vpBits[index]|=4,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz}))));for(i=0,n=inarray.length;i<n;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=6;j<18;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,1&vpBits[index]&&!(2&vpBits[index])?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),square=(dx=tnv.ix-bp.ix)*dx+(dy=tnv.iy-bp.iy)*dy+(dz=tnv.iz-bp.iz)*dz,vpDistance[index]=square,vpBits[index]|=2,vpBits[index]|=4,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):1&vpBits[index]&&2&vpBits[index]&&(square=(dx=tnv.ix-bp.ix)*dx+(dy=tnv.iy-bp.iy)*dy+(dz=tnv.iz-bp.iz)*dz)<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,4&vpBits[index]||(vpBits[index]|=4,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz}))));for(i=0,n=inarray.length;i<n;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=18;j<26;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,1&vpBits[index]&&!(2&vpBits[index])?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),square=(dx=tnv.ix-bp.ix)*dx+(dy=tnv.iy-bp.iy)*dy+(dz=tnv.iz-bp.iz)*dz,vpDistance[index]=square,vpBits[index]|=2,vpBits[index]|=4,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):1&vpBits[index]&&2&vpBits[index]&&(square=(dx=tnv.ix-bp.ix)*dx+(dy=tnv.iy-bp.iy)*dy+(dz=tnv.iz-bp.iz)*dz)<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,4&vpBits[index]||(vpBits[index]|=4,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz}))));return outarray},this.marchingcubeinit=function(stype){for(var i=0,lim=vpBits.length;i<lim;i++)1==stype?vpBits[i]&=-5:4==stype?(vpBits[i]&=-3,4&vpBits[i]&&(vpBits[i]|=2),vpBits[i]&=-5):2==stype?4&vpBits[i]&&2&vpBits[i]?vpBits[i]&=-5:4&vpBits[i]&&!(2&vpBits[i])&&(vpBits[i]|=2):3==stype&&(vpBits[i]&=-5)};this.marchingcube=function(stype){this.marchingcubeinit(stype),verts=[],faces=[],$3Dmol.MarchingCube.march(vpBits,verts,faces,{smooth:1,nX:pLength,nY:pWidth,nZ:pHeight});for(var pWH=pWidth*pHeight,i=0,vlen=verts.length;i<vlen;i++)verts[i].atomid=vpAtomID[verts[i].x*pWH+pHeight*verts[i].y+verts[i].z];$3Dmol.MarchingCube.laplacianSmooth(1,verts,faces)}},$3Dmol.autoload=function(viewer,callback){if(void 0!==$(".viewer_3Dmoljs")[0]&&($3Dmol.autoinit=!0),$3Dmol.autoinit){viewer=void 0!=viewer?viewer:null,$3Dmol.viewers={};var nviewers=0;$(".viewer_3Dmoljs").each(function(){var viewerdiv=$(this),datauri=[],datatypes=[];"static"==viewerdiv.css("position")&&viewerdiv.css("position","relative");var type=null;if(viewerdiv.data("pdb"))datauri.push("https://files.rcsb.org/view/"+viewerdiv.data("pdb")+".pdb"),datatypes.push("pdb");else if(viewerdiv.data("cid"))datatypes.push("sdf"),datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+viewerdiv.data("cid")+"/SDF?record_type=3d");else if(viewerdiv.data("href")||viewerdiv.data("url")){var uri=viewerdiv.data("href");datauri.push(uri);var type=uri.substr(uri.lastIndexOf(".")+1);datatypes.push(type)}var divdata=viewerdiv.data();for(var i in divdata)if("pdb"===i.substring(0,3)&&"pdb"!==i)datauri.push("https://files.rcsb.org/view/"+divdata[i]+".pdb"),datatypes.push("pdb");else if("href"===i.substring(0,4)&&"href"!==i){var uri=divdata[i];datauri.push(uri),datatypes.push(uri.substr(uri.lastIndexOf(".")+1))}else"cid"===i.substring(0,3)&&"cid"!==i&&(datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+divdata[i]+"/SDF?record_type=3d"),datatypes.push("sdf"));var options={};viewerdiv.data("options")&&(options=$3Dmol.specStringToObject(viewerdiv.data("options")));var bgcolor=$3Dmol.CC.color(viewerdiv.data("backgroundcolor")),style={line:{}};viewerdiv.data("style")&&(style=$3Dmol.specStringToObject(viewerdiv.data("style")));var select={};viewerdiv.data("select")&&(select=$3Dmol.specStringToObject(viewerdiv.data("select")));var selectstylelist=[],surfaces=[],labels=[],d=viewerdiv.data(),stylere=/style(.+)/,surfre=/surface(.*)/,reslabre=/labelres(.*)/,keys=[];for(var dataname in d)d.hasOwnProperty(dataname)&&keys.push(dataname);keys.sort();for(var i=0;i<keys.length;i++){var dataname=keys[i],m=stylere.exec(dataname);if(m){var selname="select"+m[1],newsel=$3Dmol.specStringToObject(d[selname]),styleobj=$3Dmol.specStringToObject(d[dataname]);selectstylelist.push([newsel,styleobj])}if(m=surfre.exec(dataname)){var selname="select"+m[1],newsel=$3Dmol.specStringToObject(d[selname]),styleobj=$3Dmol.specStringToObject(d[dataname]);surfaces.push([newsel,styleobj])}if(m=reslabre.exec(dataname)){var selname="select"+m[1],newsel=$3Dmol.specStringToObject(d[selname]),styleobj=$3Dmol.specStringToObject(d[dataname]);labels.push([newsel,styleobj])}}var applyStyles=function(glviewer){glviewer.setStyle(select,style);for(i=0;i<selectstylelist.length;i++){var sel=selectstylelist[i][0]||{},sty=selectstylelist[i][1]||{line:{}};glviewer.setStyle(sel,sty)}for(i=0;i<surfaces.length;i++){var sel=surfaces[i][0]||{},sty=surfaces[i][1]||{};glviewer.addSurface($3Dmol.SurfaceType.VDW,sty,sel,sel)}for(var i=0;i<labels.length;i++){var sel=labels[i][0]||{},sty=labels[i][1]||{};glviewer.addResLabels(sel,sty)}glviewer.zoomTo(),glviewer.render()},glviewer=viewer;try{null==glviewer&&(glviewer=$3Dmol.viewers[this.id||nviewers++]=$3Dmol.createViewer(viewerdiv,{defaultcolors:$3Dmol.rasmolElementColors})),glviewer.setBackgroundColor(bgcolor)}catch(error){console.log(error),window.location="http://get.webgl.org"}if(0!=datauri.length){var i=0,process=function(moldata){uri=datauri[i];var type=viewerdiv.data("type")||viewerdiv.data("datatype")||datatypes[i];if(glviewer.addModel(moldata,type,options),(i+=1)<datauri.length)$.get(datauri[i],process,"text");else{if(applyStyles(glviewer),viewerdiv.data("callback")){var runres=eval(viewerdiv.data("callback"));"function"==typeof runres&&runres(glviewer)}callback&&callback(glviewer)}};$.get(datauri[0],process,"text")}else{if(viewerdiv.data("element")){var moldata=$("#"+viewerdiv.data("element")).val()||"",type=viewerdiv.data("type")||viewerdiv.data("datatype");type||(console.log("Warning: No type specified for embedded viewer with moldata from "+viewerdiv.data("element")+"\n assuming type 'pdb'"),type="pdb"),glviewer.addModel(moldata,type,options)}if(applyStyles(glviewer),viewerdiv.data("callback")){var runres=eval(viewerdiv.data("callback"));"function"==typeof runres&&runres(glviewer)}callback&&callback(glviewer)}})}},$(document).ready(function(){$3Dmol.autoload()});var htmlColors={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$3Dmol.CC={cache:{0:new $3Dmol.Color(0)},color:function color_(hex){if(!hex)return this.cache[0];if(void 0!==this.cache[hex])return this.cache[hex];if(hex&&hex.constructor===Array)return hex.map(color_,this);if("number"==typeof(hex=this.getHex(hex))){var c=new $3Dmol.Color(hex);return this.cache[hex]=c,c}return hex},getHex:function(hex){return isNaN(parseInt(hex))?"string"==typeof hex?(4==(hex=hex.trim()).length&&"#"==hex[0]&&(hex="#"+hex[1]+hex[1]+hex[2]+hex[2]+hex[3]+hex[3]),7==hex.length&&"#"==hex[0]?parseInt(hex.substring(1),16):htmlColors[hex.toLowerCase()]||0):hex:parseInt(hex)}},$3Dmol.CC=$3Dmol.CC,$3Dmol.CC.color=$3Dmol.CC.color,$3Dmol.ssColors=$3Dmol.ssColors||{},$3Dmol.ssColors.pyMol={h:16711680,s:16776960,c:65280},$3Dmol.ssColors.Jmol={h:16711808,s:16762880,c:16777215},$3Dmol.elementColors=$3Dmol.elementColors||{},$3Dmol.elementColors.defaultColor=16716947,$3Dmol.elementColors.Jmol={H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ca:4062976,CA:4062976,Ti:12567239,TI:12567239,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Br:10889513,BR:10889513,Ag:12632256,AG:12632256,I:9699476,Ba:51456,BA:51456,Au:16765219,AU:16765219},$3Dmol.elementColors.rasmol={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},$3Dmol.elementColors.defaultColors=$3Dmol.elementColors.rasmol,$3Dmol.elementColors.greenCarbon=$.extend({},$3Dmol.elementColors.defaultColors),$3Dmol.elementColors.greenCarbon.C=65280,$3Dmol.elementColors.cyanCarbon=$.extend({},$3Dmol.elementColors.defaultColors),$3Dmol.elementColors.cyanCarbon.C=65535,$3Dmol.elementColors.magentaCarbon=$.extend({},$3Dmol.elementColors.defaultColors),$3Dmol.elementColors.magentaCarbon.C=16711935,$3Dmol.elementColors.yellowCarbon=$.extend({},$3Dmol.elementColors.defaultColors),$3Dmol.elementColors.yellowCarbon.C=16776960,$3Dmol.elementColors.whiteCarbon=$.extend({},$3Dmol.elementColors.defaultColors),$3Dmol.elementColors.whiteCarbon.C=16777215,$3Dmol.elementColors.orangeCarbon=$.extend({},$3Dmol.elementColors.defaultColors),$3Dmol.elementColors.orangeCarbon.C=16753920,$3Dmol.elementColors.purpleCarbon=$.extend({},$3Dmol.elementColors.defaultColors),$3Dmol.elementColors.purpleCarbon.C=8388736,$3Dmol.elementColors.blueCarbon=$.extend({},$3Dmol.elementColors.defaultColors),$3Dmol.elementColors.blueCarbon.C=255,$3Dmol.residues={},$3Dmol.residues.amino={ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},$3Dmol.residues.shapely={ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},$3Dmol.residues.nucleic={A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576},$3Dmol.chains={},$3Dmol.chains.atom={A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},$3Dmol.chains.hetatm={A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834},$3Dmol.builtinColorSchemes={ssPyMol:{prop:"ss",map:$3Dmol.ssColors.pyMol},ssJmol:{prop:"ss",map:$3Dmol.ssColors.Jmol},Jmol:{prop:"elem",map:$3Dmol.elementColors.Jmol},greenCarbon:{prop:"elem",map:$3Dmol.elementColors.greenCarbon},default:{prop:"elem",map:$3Dmol.elementColors.defaultColors},amino:{prop:"resn",map:$3Dmol.residues.amino},shapely:{prop:"resn",map:$3Dmol.residues.shapely},nucleic:{prop:"resn",map:$3Dmol.residues.nucleic},chain:{prop:"chain",map:$3Dmol.chains.atom},chainHetatm:{prop:"chain",map:$3Dmol.chains.hetatm}},$3Dmol.getColorFromStyle=function(atom,style){var scheme=style.colorscheme;if(void 0!==$3Dmol.builtinColorSchemes[scheme])scheme=$3Dmol.builtinColorSchemes[scheme];else if("string"==typeof scheme&&scheme.endsWith("Carbon")){var ccolor=scheme.substring(0,scheme.lastIndexOf("Carbon")).toLowerCase();if(void 0!==htmlColors[ccolor]){var newscheme=$.extend({},$3Dmol.elementColors.defaultColors);newscheme.C=htmlColors[ccolor],$3Dmol.builtinColorSchemes[scheme]={prop:"elem",map:newscheme},scheme=$3Dmol.builtinColorSchemes[scheme]}}var color=atom.color;if(void 0!==style.color&&"spectrum"!=style.color&&(color=style.color),void 0!==scheme)if(void 0!==$3Dmol.elementColors[scheme])void 0!==(scheme=$3Dmol.elementColors[scheme])[atom[scheme.prop]]&&(color=scheme.map[atom[scheme.prop]]);else if(void 0!==scheme[atom[scheme.prop]])color=scheme.map[atom[scheme.prop]];else if(void 0!==scheme.prop&&void 0!==scheme.gradient){var prop=scheme.prop,grad=scheme.gradient;void 0!==$3Dmol.Gradient.builtinGradients[grad]&&(grad=new $3Dmol.Gradient.builtinGradients[grad](scheme.min,scheme.max,scheme.mid));var range=grad.range()||[-1,1];null!=(val=$3Dmol.getAtomProperty(atom,prop))&&(color=grad.valueToHex(val,range))}else if(void 0!==scheme.prop&&void 0!==scheme.map){var prop=scheme.prop,val=$3Dmol.getAtomProperty(atom,prop);void 0!==scheme.map[val]&&(color=scheme.map[val])}else void 0!==style.colorscheme[atom.elem]?color=style.colorscheme[atom.elem]:console.log("Could not interpret colorscheme "+scheme);else void 0!==style.colorfunc&&(color=style.colorfunc(atom));return $3Dmol.CC.color(color)};var $3Dmol=$3Dmol||{};$3Dmol.drawCartoon=function(){var subdivide=function(_points,DIV){var ret=[],points=_points;(points=[]).push(_points[0]);var i,lim,size,p0,p1,p2,p3,v0,v1;for(i=1,lim=_points.length-1;i<lim;i++)if(p1=_points[i],p2=_points[i+1],p1.smoothen){var np=new $3Dmol.Vector3((p1.x+p2.x)/2,(p1.y+p2.y)/2,(p1.z+p2.z)/2);np.atom=p1.atom,points.push(np)}else points.push(p1);for(points.push(_points[_points.length-1]),i=-1,size=points.length;i<=size-3;i++)if(p0=points[-1===i?0:i],p1=points[i+1],p2=points[i+2],p3=points[i===size-3?size-1:i+3],v0=(new $3Dmol.Vector3).subVectors(p2,p0).multiplyScalar(.5),v1=(new $3Dmol.Vector3).subVectors(p3,p1).multiplyScalar(.5),!p2.skip)for(var j=0;j<DIV;j++){var t=1/DIV*j,x=p1.x+t*v0.x+t*t*(-3*p1.x+3*p2.x-2*v0.x-v1.x)+t*t*t*(2*p1.x-2*p2.x+v0.x+v1.x),y=p1.y+t*v0.y+t*t*(-3*p1.y+3*p2.y-2*v0.y-v1.y)+t*t*t*(2*p1.y-2*p2.y+v0.y+v1.y),z=p1.z+t*v0.z+t*t*(-3*p1.z+3*p2.z-2*v0.z-v1.z)+t*t*t*(2*p1.z-2*p2.z+v0.z+v1.z),pt=new $3Dmol.Vector3(x,y,z);pt.atom=j<DIV/2?p1.atom:p2.atom,ret.push(pt)}return ret.push(points[points.length-1]),ret},drawThinStrip=function(geo,p1,p2,colors,div,opacity){for(var offset,vertoffset,color,colori,i=0,lim=p1.length;i<lim;i++){colori=Math.round(i*(colors.length-1)/lim),color=$3Dmol.CC.color(colors[colori]),geoGroup=geo.updateGeoGroup(2);var vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray,faceArray=geoGroup.faceArray;vertexArray[vertoffset=3*(offset=geoGroup.vertices)]=p1[i].x,vertexArray[vertoffset+1]=p1[i].y,vertexArray[vertoffset+2]=p1[i].z,vertexArray[vertoffset+3]=p2[i].x,vertexArray[vertoffset+4]=p2[i].y,vertexArray[vertoffset+5]=p2[i].z;for(var j=0;j<6;++j)colorArray[vertoffset+3*j]=color.r,colorArray[vertoffset+1+3*j]=color.g,colorArray[vertoffset+2+3*j]=color.b;if(i>0){var faces=[offset,offset+1,offset-1,offset-2],faceoffset=geoGroup.faceidx;faceArray[faceoffset]=faces[0],faceArray[faceoffset+1]=faces[1],faceArray[faceoffset+2]=faces[3],faceArray[faceoffset+3]=faces[1],faceArray[faceoffset+4]=faces[2],faceArray[faceoffset+5]=faces[3],geoGroup.faceidx+=6}geoGroup.vertices+=2}},drawShapeStrip=function(geo,points,colors,div,thickness,opacity,shape){var i,j,num,len;if(!((num=points.length)<2||points[0].length<2)){for(div=div||axisDIV,i=0;i<num;i++)points[i]=subdivide(points[i],div);if(len=points[0].length,!thickness)return drawThinStrip(geo,points[0],points[num-1],colors);var axis,cs_shape,cs_bottom,cs_top,last_cs_bottom,last_cs_top,cs_ellipse=[],cs_rectangle=[],cs_parabola=[];for(j=0;j<num;j++)cs_ellipse.push(.25+1.5*Math.sqrt((num-1)*j-Math.pow(j,2))/(num-1)),cs_rectangle.push(.5),cs_parabola.push(2*(Math.pow(j/num,2)-j/num)+.6);var face_refs=[];for(j=0;j<2*num-1;j++)face_refs[j]=[j,j+1,j+1-2*num,j-2*num];face_refs[2*num-1]=[j,j+1-2*num,j+1-4*num,j-2*num];var v_offset,va_offset,f_offset,currentAtom,color,colori,geoGroup=geo.updateGeoGroup(2*num*len);for(i=0;i<len;i++){colori=Math.round(i*(colors.length-1)/len),color=$3Dmol.CC.color(colors[colori]),last_cs_bottom=cs_bottom,last_cs_top=cs_top,cs_bottom=[],cs_top=[],axis=[],void 0!==points[0][i].atom&&(currentAtom=points[0][i].atom,"oval"===shape?cs_shape=cs_ellipse:"rectangle"===shape?cs_shape=cs_rectangle:"parabola"===shape&&(cs_shape=cs_parabola)),cs_shape||(cs_shape=cs_rectangle);var toNext,toSide;for(j=0;j<num;j++)toNext=i<len-1?points[j][i+1].clone().sub(points[j][i]):points[j][i-1].clone().sub(points[j][i]).negate(),toSide=j<num-1?points[j+1][i].clone().sub(points[j][i]):points[j-1][i].clone().sub(points[j][i]).negate(),axis[j]=toSide.cross(toNext).normalize().multiplyScalar(thickness*cs_shape[j]);for(j=0;j<num;j++)cs_bottom[j]=points[j][i].clone().add(axis[j].clone().negate());for(j=0;j<num;j++)cs_top[j]=points[j][i].clone().add(axis[j]);var vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray,faceArray=geoGroup.faceArray;for(va_offset=3*(v_offset=geoGroup.vertices),j=0;j<num;j++)vertexArray[va_offset+3*j+0]=cs_bottom[j].x,vertexArray[va_offset+3*j+1]=cs_bottom[j].y,vertexArray[va_offset+3*j+2]=cs_bottom[j].z;for(j=0;j<num;j++)vertexArray[va_offset+3*j+0+3*num]=cs_top[num-1-j].x,vertexArray[va_offset+3*j+1+3*num]=cs_top[num-1-j].y,vertexArray[va_offset+3*j+2+3*num]=cs_top[num-1-j].z;for(j=0;j<2*num;++j)colorArray[va_offset+3*j+0]=color.r,colorArray[va_offset+3*j+1]=color.g,colorArray[va_offset+3*j+2]=color.b;if(i>0){for(j=0;j<2*num;j++){face=[v_offset+face_refs[j][0],v_offset+face_refs[j][1],v_offset+face_refs[j][2],v_offset+face_refs[j][3]];faceArray[f_offset=geoGroup.faceidx]=face[0],faceArray[f_offset+1]=face[1],faceArray[f_offset+2]=face[3],faceArray[f_offset+3]=face[1],faceArray[f_offset+4]=face[2],faceArray[f_offset+5]=face[3],geoGroup.faceidx+=6}if(currentAtom.clickable){var faces=[];faces.push(new $3Dmol.Triangle(last_cs_bottom[0],cs_bottom[0],cs_bottom[num-1])),faces.push(new $3Dmol.Triangle(last_cs_bottom[0],cs_bottom[num-1],last_cs_bottom[num-1])),faces.push(new $3Dmol.Triangle(last_cs_bottom[num-1],cs_bottom[num-1],cs_top[num-1])),faces.push(new $3Dmol.Triangle(last_cs_bottom[num-1],cs_top[num-1],last_cs_top[num-1])),faces.push(new $3Dmol.Triangle(cs_top[0],last_cs_top[0],last_cs_top[num-1])),faces.push(new $3Dmol.Triangle(cs_top[num-1],cs_top[0],last_cs_top[num-1])),faces.push(new $3Dmol.Triangle(cs_bottom[0],last_cs_bottom[0],last_cs_top[0])),faces.push(new $3Dmol.Triangle(cs_top[0],cs_bottom[0],last_cs_top[0]));for(j in faces)currentAtom.intersectionShape.triangle.push(faces[j])}}geoGroup.vertices+=2*num,currentAtom}var vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray,faceArray=geoGroup.faceArray;for(va_offset=3*(v_offset=geoGroup.vertices),f_offset=geoGroup.faceidx,i=0;i<num-1;i++){face=[i,i+1,2*num-2-i,2*num-1-i];faceArray[f_offset=geoGroup.faceidx]=face[0],faceArray[f_offset+1]=face[1],faceArray[f_offset+2]=face[3],faceArray[f_offset+3]=face[1],faceArray[f_offset+4]=face[2],faceArray[f_offset+5]=face[3],geoGroup.faceidx+=6}for(i=0;i<num-1;i++){var face=[v_offset-1-i,v_offset-2-i,v_offset-2*num+i+1,v_offset-2*num+i];faceArray[f_offset=geoGroup.faceidx]=face[0],faceArray[f_offset+1]=face[1],faceArray[f_offset+2]=face[3],faceArray[f_offset+3]=face[1],faceArray[f_offset+4]=face[2],faceArray[f_offset+5]=face[3],geoGroup.faceidx+=6}}},drawPlainStrip=function(geo,points,colors,div,thickness,opacity){if(!(points.length<2)){var p1,p2;if(p1=points[0],p2=points[points.length-1],div=div||axisDIV,p1=subdivide(p1,div),p2=subdivide(p2,div),!thickness)return drawThinStrip(geo,p1,p2,colors);var axis,p1v,p2v,a1v,a2v,offset,vertoffset,faceoffset,color,colori,currentAtom,lastAtom,i,lim,j,face1,face2,face3,geoGroup,vs=[],faces=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]];for(i=0,lim=p1.length;i<lim;i++){if(colori=Math.round(i*(colors.length-1)/lim),color=$3Dmol.CC.color(colors[colori]),vs.push(p1v=p1[i]),vs.push(p1v),vs.push(p2v=p2[i]),vs.push(p2v),i<lim-1){var toNext=p1[i+1].clone().sub(p1[i]);axis=p2[i].clone().sub(p1[i]).cross(toNext).normalize().multiplyScalar(thickness)}vs.push(a1v=p1[i].clone().add(axis)),vs.push(a1v),vs.push(a2v=p2[i].clone().add(axis)),vs.push(a2v),void 0!==p1v.atom&&(currentAtom=p1v.atom);var vertexArray=(geoGroup=geo.updateGeoGroup(8)).vertexArray,colorArray=geoGroup.colorArray,faceArray=geoGroup.faceArray;for(vertexArray[vertoffset=3*(offset=geoGroup.vertices)]=p1v.x,vertexArray[vertoffset+1]=p1v.y,vertexArray[vertoffset+2]=p1v.z,vertexArray[vertoffset+3]=p1v.x,vertexArray[vertoffset+4]=p1v.y,vertexArray[vertoffset+5]=p1v.z,vertexArray[vertoffset+6]=p2v.x,vertexArray[vertoffset+7]=p2v.y,vertexArray[vertoffset+8]=p2v.z,vertexArray[vertoffset+9]=p2v.x,vertexArray[vertoffset+10]=p2v.y,vertexArray[vertoffset+11]=p2v.z,vertexArray[vertoffset+12]=a1v.x,vertexArray[vertoffset+13]=a1v.y,vertexArray[vertoffset+14]=a1v.z,vertexArray[vertoffset+15]=a1v.x,vertexArray[vertoffset+16]=a1v.y,vertexArray[vertoffset+17]=a1v.z,vertexArray[vertoffset+18]=a2v.x,vertexArray[vertoffset+19]=a2v.y,vertexArray[vertoffset+20]=a2v.z,vertexArray[vertoffset+21]=a2v.x,vertexArray[vertoffset+22]=a2v.y,vertexArray[vertoffset+23]=a2v.z,j=0;j<8;++j)colorArray[vertoffset+3*j]=color.r,colorArray[vertoffset+1+3*j]=color.g,colorArray[vertoffset+2+3*j]=color.b;if(i>0){var diffAtoms=void 0!==lastAtom&&void 0!==currentAtom&&lastAtom.serial!==currentAtom.serial;for(j=0;j<4;j++){var face=[offset+faces[j][0],offset+faces[j][1],offset+faces[j][2],offset+faces[j][3]];if(faceoffset=geoGroup.faceidx,faceArray[faceoffset]=face[0],faceArray[faceoffset+1]=face[1],faceArray[faceoffset+2]=face[3],faceArray[faceoffset+3]=face[1],faceArray[faceoffset+4]=face[2],faceArray[faceoffset+5]=face[3],geoGroup.faceidx+=6,currentAtom.clickable||lastAtom.clickable){var p1a=vs[face[3]].clone(),p1b=vs[face[0]].clone(),p2a=vs[face[2]].clone(),p2b=vs[face[1]].clone();if(p1a.atom=vs[face[3]].atom||null,p2a.atom=vs[face[2]].atom||null,p1b.atom=vs[face[0]].atom||null,p2b.atom=vs[face[1]].atom||null,diffAtoms){var m1=p1a.clone().add(p1b).multiplyScalar(.5),m2=p2a.clone().add(p2b).multiplyScalar(.5),m=p1a.clone().add(p2b).multiplyScalar(.5);j%2==0?(lastAtom.clickable&&(face1=new $3Dmol.Triangle(m1,m,p1a),face2=new $3Dmol.Triangle(m2,p2a,m),face3=new $3Dmol.Triangle(m,p2a,p1a),lastAtom.intersectionShape.triangle.push(face1),lastAtom.intersectionShape.triangle.push(face2),lastAtom.intersectionShape.triangle.push(face3)),currentAtom.clickable&&(face1=new $3Dmol.Triangle(p1b,p2b,m),face2=new $3Dmol.Triangle(p2b,m2,m),face3=new $3Dmol.Triangle(p1b,m,m1),currentAtom.intersectionShape.triangle.push(face1),currentAtom.intersectionShape.triangle.push(face2),currentAtom.intersectionShape.triangle.push(face3))):(currentAtom.clickable&&(face1=new $3Dmol.Triangle(m1,m,p1a),face2=new $3Dmol.Triangle(m2,p2a,m),face3=new $3Dmol.Triangle(m,p2a,p1a),currentAtom.intersectionShape.triangle.push(face1),currentAtom.intersectionShape.triangle.push(face2),currentAtom.intersectionShape.triangle.push(face3)),lastAtom.clickable&&(face1=new $3Dmol.Triangle(p1b,p2b,m),face2=new $3Dmol.Triangle(p2b,m2,m),face3=new $3Dmol.Triangle(p1b,m,m1),lastAtom.intersectionShape.triangle.push(face1),lastAtom.intersectionShape.triangle.push(face2),lastAtom.intersectionShape.triangle.push(face3)))}else currentAtom.clickable&&(face1=new $3Dmol.Triangle(p1b,p2b,p1a),face2=new $3Dmol.Triangle(p2b,p2a,p1a),currentAtom.intersectionShape.triangle.push(face1),currentAtom.intersectionShape.triangle.push(face2))}}}geoGroup.vertices+=8,lastAtom=currentAtom}var vsize=vs.length-8,vertexArray=(geoGroup=geo.updateGeoGroup(8)).vertexArray,colorArray=geoGroup.colorArray,faceArray=geoGroup.faceArray;for(vertoffset=3*(offset=geoGroup.vertices),faceoffset=geoGroup.faceidx,i=0;i<4;i++){vs.push(vs[2*i]),vs.push(vs[vsize+2*i]);var v1=vs[2*i],v2=vs[vsize+2*i];vertexArray[vertoffset+6*i]=v1.x,vertexArray[vertoffset+1+6*i]=v1.y,vertexArray[vertoffset+2+6*i]=v1.z,vertexArray[vertoffset+3+6*i]=v2.x,vertexArray[vertoffset+4+6*i]=v2.y,vertexArray[vertoffset+5+6*i]=v2.z,colorArray[vertoffset+6*i]=color.r,colorArray[vertoffset+1+6*i]=color.g,colorArray[vertoffset+2+6*i]=color.b,colorArray[vertoffset+3+6*i]=color.r,colorArray[vertoffset+4+6*i]=color.g,colorArray[vertoffset+5+6*i]=color.b}vsize+=8,face1=[offset,offset+2,offset+6,offset+4],face2=[offset+1,offset+5,offset+7,offset+3],faceArray[faceoffset]=face1[0],faceArray[faceoffset+1]=face1[1],faceArray[faceoffset+2]=face1[3],faceArray[faceoffset+3]=face1[1],faceArray[faceoffset+4]=face1[2],faceArray[faceoffset+5]=face1[3],faceArray[faceoffset+6]=face2[0],faceArray[faceoffset+7]=face2[1],faceArray[faceoffset+8]=face2[3],faceArray[faceoffset+9]=face2[1],faceArray[faceoffset+10]=face2[2],faceArray[faceoffset+11]=face2[3],geoGroup.faceidx+=12,geoGroup.vertices+=8}},drawSmoothCurve=function(group,_points,width,colors,div){if(0!==_points.length){div=void 0===div?5:div;var geo=new $3Dmol.Geometry,lineMaterial=(subdivide(_points,div),new $3Dmol.LineBasicMaterial({linewidth:width}));lineMaterial.vertexColors=!0;var line=new $3Dmol.Line(geo,lineMaterial);line.type=$3Dmol.LineStrip,group.add(line)}},drawStrip=function(geo,points,colors,div,thickness,opacity,shape){shape&&"default"!==shape||(shape="rectangle"),"edged"===shape?drawPlainStrip(geo,points,colors,div,thickness):"rectangle"!==shape&&"oval"!==shape&&"parabola"!==shape||drawShapeStrip(geo,points,colors,div,thickness,0,shape)},isAlphaCarbon=function(atom){return atom&&"C"===atom.elem&&"CA"===atom.atom},inConnectedResidues=function(a,b){if(a&&b&&a.chain===b.chain){if(a.reschain===b.reschain&&(a.resi===b.resi||a.resi===b.resi-1))return!0;if(a.resi<b.resi){var dx=a.x-b.x,dy=a.y-b.y,dz=a.z-b.z;if(dx*dx+dy*dy+dz*dz<16)return!0}}return!1},setGeo=function(group,geo,opacity,outline,setNormals){if(null!=geo&&0!=geo.vertices){setNormals&&(geo.initTypedArrays(),geo.setUpNormals());var cartoonMaterial=new $3Dmol.MeshDoubleLambertMaterial;cartoonMaterial.vertexColors=$3Dmol.FaceColors,"number"==typeof opacity&&opacity>=0&&opacity<1&&(cartoonMaterial.transparent=!0,cartoonMaterial.opacity=opacity),cartoonMaterial.outline=outline;var cartoonMesh=new $3Dmol.Mesh(geo,cartoonMaterial);group.add(cartoonMesh)}},cartoonAtoms={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},purResns={DA:!0,DG:!0,A:!0,G:!0},pyrResns={DT:!0,DC:!0,U:!0,C:!0,T:!0},naResns={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0},drawCartoon=function(group,atomList,gradientrange,fill,doNotSmoothen,num,div){num=num||5,div=div||5;var cartoon,prev,curr,next,currColor,nextColor,thickness,backbonePt,orientPt,prevOrientPt,terminalPt,termOrientPt,baseStartPt,baseEndPt,tubeStart,tubeEnd,drawingTube,shapeGeo=new $3Dmol.Geometry(!0),geo=new $3Dmol.Geometry(!0),colors=[],points=[],opacity=1,outline=!1,gradients={};for(var g in $3Dmol.Gradient.builtinGradients)$3Dmol.Gradient.builtinGradients.hasOwnProperty(g)&&(gradients[g]=new $3Dmol.Gradient.builtinGradients[g](gradientrange[1],gradientrange[0]));for(var cartoonColor=function(next,cartoon){return gradientrange&&"spectrum"===cartoon.color?cartoon.colorscheme in gradients?gradients[cartoon.colorscheme].valueToHex(next.resi):gradients.sinebow.valueToHex(next.resi):$3Dmol.getColorFromStyle(next,cartoon).getHex()},i=0;i<num;i++)points[i]=[];var inSheet=!1,inHelix=!1;i=0;var atoms=[];for(i in atomList){if("C"===(next=atomList[i]).elem&&"CA"===next.atom){var connected=inConnectedResidues(curr,next);connected&&"s"===next.ss?inSheet=!0:inSheet&&(curr&&prev&&curr.style.cartoon.arrows&&prev.style.cartoon.arrows&&(curr.ss="arrow end",prev.ss="arrow start"),inSheet=!1),connected&&"h"===curr.ss?(!inHelix&&next.style.cartoon.tubes&&(next.ss="tube start"),inHelix=!0):inHelix&&"tube start"!==curr.ss&&(prev&&prev.style.cartoon.tubes&&(prev.ss="tube end"),inHelix=!1),prev=curr,curr=next}next&&next.atom in cartoonAtoms&&atoms.push(next)}var flushGeom=function(connect){for(var i=0;!thickness&&i<num;i++)drawSmoothCurve(group,points[i],1,0,div);if(fill&&points[0].length>0&&drawStrip(geo,points,colors,div,thickness,0,points.style),connect){var saved=[];for(i=0;i<num;i++)saved[i]=points[i][points[i].length-1];var savedc=colors[colors.length-1]}for(points=[],i=0;i<num;i++)points[i]=[];if(colors=[],connect){for(i=0;i<num;i++)points[i].push(saved[i]);colors.push(savedc)}setGeo(group,geo,opacity,outline,!0),setGeo(group,shapeGeo,opacity,outline,!1),geo=new $3Dmol.Geometry(!0),shapeGeo=new $3Dmol.Geometry(!0)};curr=void 0;for(var a=0;a<atoms.length;a++){var nextresn=(next=atoms[a]).resn.trim(),inNucleicAcid=nextresn in naResns;if(opacity=1,cartoon=next.style.cartoon,curr&&curr.style.cartoon&&(opacity=curr.style.cartoon.opacity),curr&&curr.style.cartoon&&curr.style.cartoon.outline&&(outline=curr.style.cartoon.outline),!curr||!curr.style.cartoon||next.style.cartoon&&curr.style.cartoon.opacity==next.style.cartoon.opacity||flushGeom(curr.chain==next.chain),points.length&&points[0].length>3e4/num/div/2&&flushGeom(!0),"trace"===cartoon.style){if(next.hetflag);else if("C"===next.elem&&"CA"===next.atom||inNucleicAcid&&"P"===next.atom){if(nextColor=cartoonColor(next,cartoon),thickness=$.isNumeric(cartoon.thickness)?cartoon.thickness:.4,inConnectedResidues(curr,next))if(nextColor==currColor){var color=$3Dmol.CC.color(nextColor);$3Dmol.GLDraw.drawCylinder(shapeGeo,curr,next,thickness,color,2,2)}else{var midpoint=(new $3Dmol.Vector3).addVectors(curr,next).multiplyScalar(.5),color1=$3Dmol.CC.color(currColor),color2=$3Dmol.CC.color(nextColor);$3Dmol.GLDraw.drawCylinder(shapeGeo,curr,midpoint,thickness,color1,2,0),$3Dmol.GLDraw.drawCylinder(shapeGeo,midpoint,next,thickness,color2,0,2)}curr=next,currColor=nextColor}}else{if(isAlphaCarbon(next)||inNucleicAcid&&("P"===next.atom||0==next.atom.indexOf("O5"))){if(drawingTube){if("tube end"!==next.ss)continue;drawingTube=!1,tubeEnd=new $3Dmol.Vector3(next.x,next.y,next.z),$3Dmol.GLDraw.drawCylinder(shapeGeo,tubeStart,tubeEnd,2,$3Dmol.CC.color(currColor),1,1),next.ss="h"}if(curr&&(!inConnectedResidues(curr,next)||"tube start"===curr.ss)){for("tube start"===curr.ss&&(drawingTube=!0,tubeStart=new $3Dmol.Vector3(curr.x,curr.y,curr.z),curr.ss="h"),baseEndPt&&(baseStartPt=terminalPt?(new $3Dmol.Vector3).addVectors(curr,terminalPt).multiplyScalar(.5):new $3Dmol.Vector3(curr.x,curr.y,curr.z),$3Dmol.GLDraw.drawCylinder(shapeGeo,baseStartPt,baseEndPt,.4,$3Dmol.CC.color(baseEndPt.color),0,2),addBackbonePoints(points,num,!doNotSmoothen,terminalPt,termOrientPt,prevOrientPt,curr,atoms,a),colors.push(nextColor),baseStartPt=null,baseEndPt=null),i=0;!thickness&&i<num;i++)drawSmoothCurve(group,points[i],1,0,div);for(fill&&points[0].length>0&&drawStrip(geo,points,colors,div,thickness,0,points.style),points=[],i=0;i<num;i++)points[i]=[];colors=[]}if(void 0===curr||curr.rescode!=next.rescode||curr.resi!=next.resi){if(baseEndPt){var startFix=(baseStartPt=(new $3Dmol.Vector3).addVectors(curr,next).multiplyScalar(.5)).clone().sub(baseEndPt).multiplyScalar(.02);baseStartPt.add(startFix),$3Dmol.GLDraw.drawCylinder(shapeGeo,baseStartPt,baseEndPt,.4,$3Dmol.CC.color(baseEndPt.color),0,2),baseStartPt=null,baseEndPt=null}nextColor=cartoonColor(next,cartoon),colors.push(nextColor),thickness=$.isNumeric(cartoon.thickness)?cartoon.thickness:.4,curr=next,(backbonePt=new $3Dmol.Vector3(curr.x,curr.y,curr.z)).resi=curr.resi,currColor=nextColor}!0!==next.clickable||void 0!==next.intersectionShape&&void 0!==next.intersectionShape.triangle||(next.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else isAlphaCarbon(curr)&&"O"===next.atom||inNucleicAcid&&"P"===curr.atom&&("OP2"===next.atom||"O2P"===next.atom)||inNucleicAcid&&0==curr.atom.indexOf("O5")&&0==next.atom.indexOf("C5")?((orientPt=new $3Dmol.Vector3(next.x,next.y,next.z)).resi=next.resi,"OP2"!==next.atom&&"O2P"!==next.atom||(termOrientPt=new $3Dmol.Vector3(next.x,next.y,next.z))):inNucleicAcid&&0==next.atom.indexOf("O3")?terminalPt=new $3Dmol.Vector3(next.x,next.y,next.z):("N1"===next.atom&&nextresn in purResns||"N3"===next.atom&&nextresn in pyrResns)&&((baseEndPt=new $3Dmol.Vector3(next.x,next.y,next.z)).color=$3Dmol.getColorFromStyle(next,cartoon).getHex());orientPt&&backbonePt&&orientPt.resi===backbonePt.resi&&(addBackbonePoints(points,num,!doNotSmoothen,backbonePt,orientPt,prevOrientPt,curr,atoms,a),prevOrientPt=orientPt,backbonePt=null,orientPt=null,colors.push(nextColor))}}baseEndPt&&(baseStartPt=terminalPt?(new $3Dmol.Vector3).addVectors(curr,terminalPt).multiplyScalar(.5):new $3Dmol.Vector3(curr.x,curr.y,curr.z),$3Dmol.GLDraw.drawCylinder(shapeGeo,baseStartPt,baseEndPt,.4,$3Dmol.CC.color(baseEndPt.color),0,2),addBackbonePoints(points,num,!doNotSmoothen,terminalPt,termOrientPt,prevOrientPt,curr,atoms,a),colors.push(nextColor)),flushGeom()},addBackbonePoints=function(points,num,smoothen,backbonePt,orientPt,prevOrientPt,backboneAtom,atoms,atomi){var widthScalar,delta,v,addArrowPoints,testStyle;if(backbonePt&&orientPt&&backboneAtom){var sideVec=orientPt.sub(backbonePt);sideVec.normalize();for(var forwardVec=atoms[atomi],i=atomi+1;i<atoms.length&&(forwardVec=atoms[i]).atom!=backboneAtom.atom;i++);if((forwardVec=forwardVec?new $3Dmol.Vector3(forwardVec.x,forwardVec.y,forwardVec.z):new $3Dmol.Vector3(0,0,0)).sub(backbonePt),"arrow start"===backboneAtom.ss){var adjustment=forwardVec.clone().multiplyScalar(.3).cross(orientPt);backbonePt.add(adjustment);var upVec=forwardVec.clone().cross(sideVec).normalize();sideVec.rotateAboutVector(upVec,.43)}for(backboneAtom.style.cartoon.ribbon?widthScalar=backboneAtom.style.cartoon.thickness||.4:backboneAtom.style.cartoon.width?widthScalar=backboneAtom.style.cartoon.width:"c"===backboneAtom.ss?widthScalar="P"===backboneAtom.atom?.8:.5:"arrow start"===backboneAtom.ss?(widthScalar=1.3,addArrowPoints=!0):widthScalar="arrow end"===backboneAtom.ss?.5:"h"===backboneAtom.ss&&backboneAtom.style.cartoon.tubes||"tube start"===backboneAtom.ss?.5:1.3,null!=prevOrientPt&&sideVec.dot(prevOrientPt)<0&&sideVec.negate(),sideVec.multiplyScalar(widthScalar),i=0;i<num;i++)delta=2*i/(num-1)-1,(v=new $3Dmol.Vector3(backbonePt.x+delta*sideVec.x,backbonePt.y+delta*sideVec.y,backbonePt.z+delta*sideVec.z)).atom=backboneAtom,smoothen&&"s"===backboneAtom.ss&&(v.smoothen=!0),points[i].push(v);if(addArrowPoints)for(sideVec.multiplyScalar(2),i=0;i<num;i++)delta=2*i/(num-1)-1,(v=new $3Dmol.Vector3(backbonePt.x+delta*sideVec.x,backbonePt.y+delta*sideVec.y,backbonePt.z+delta*sideVec.z)).atom=backboneAtom,v.smoothen=!1,v.skip=!0,points[i].push(v);return testStyle=backboneAtom.style.cartoon.style||"default",points.style?points.style!=testStyle&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),points.style="default"):points.style=testStyle,"arrow start"!==backboneAtom.ss&&"arrow end"!==backboneAtom.ss||(backboneAtom.ss="s"),addArrowPoints}};return function(group,atomList,gradientrange,quality){drawCartoon(group,atomList,gradientrange,!0,!1,quality=quality||5,quality)}}();var $3Dmol=$3Dmol||{};$3Dmol.GLDraw=function(){var draw={},getRotationMatrix=function(){var d=new $3Dmol.Vector3;return function(dir){d.set(dir[0],dir[1],dir[2]);var dyz,sinA,cosA,sinB,cosB,dx=d.x,dy=d.y,dz=d.z,dxy=Math.sqrt(dx*dx+dy*dy);dxy<1e-4?(sinA=0,cosA=1):(sinA=-dx/dxy,cosA=dy/dxy),dy=-sinA*dx+cosA*dy,(dyz=Math.sqrt(dy*dy+dz*dz))<1e-4?(sinB=0,cosB=1):(sinB=dz/dyz,cosB=dy/dyz);var rot=new Float32Array(9);return rot[0]=cosA,rot[1]=sinA,rot[2]=0,rot[3]=-sinA*cosB,rot[4]=cosA*cosB,rot[5]=sinB,rot[6]=sinA*sinB,rot[7]=-cosA*sinB,rot[8]=cosB,rot}}(),basisVectors=function(){var j,nvecs=[],N=Math.pow(2,4),i=2,M=Math.pow(2,i),spacing=N/M;for(nvecs[0]=new $3Dmol.Vector3(-1,0,0),nvecs[spacing]=new $3Dmol.Vector3(0,0,1),nvecs[2*spacing]=new $3Dmol.Vector3(1,0,0),nvecs[3*spacing]=new $3Dmol.Vector3(0,0,-1),i=3;i<=4;i++){for(spacing=N/(M=Math.pow(2,i-1)),j=0;j<M-1;j++)nvecs[spacing/2+j*spacing]=nvecs[j*spacing].clone().add(nvecs[(j+1)*spacing]).normalize();nvecs[spacing/2+(j=M-1)*spacing]=nvecs[j*spacing].clone().add(nvecs[0]).normalize()}return nvecs}(),cylVertexCache={cache:{},getVerticesForRadius:function(radius,cap,capType){if(void 0!==typeof this.chache&&void 0!==this.cache[radius]&&void 0!==this.cache[radius][cap+capType])return this.cache[radius][cap+capType];new $3Dmol.Vector3(0,1,0);for(var n,w=basisVectors.length,nvecs=[],norms=[],i=0;i<w;i++)nvecs.push(basisVectors[i].clone().multiplyScalar(radius)),nvecs.push(basisVectors[i].clone().multiplyScalar(radius)),n=basisVectors[i].clone().normalize(),norms.push(n),norms.push(n);var x,y,verticesRows=[],widthSegments=w,phiLength=2*Math.PI,thetaLength=Math.PI,polar=!1,equator=!1;for(y=0;y<=10;y++){polar=0===y||10===y,equator=5===y;var verticesRow=[],toRow=[];for(x=0;x<=widthSegments;x++)if(equator){var xi=x<widthSegments?2*x:0;toRow.push(xi+1),verticesRow.push(xi)}else{var u=x/widthSegments,v=y/10;if(polar&&0!==x)polar&&verticesRow.push(nvecs.length-1);else if(x<widthSegments){var vertex=new $3Dmol.Vector3;vertex.x=-radius*Math.cos(0+u*phiLength)*Math.sin(0+v*thetaLength),vertex.y=1==cap?0:radius*Math.cos(0+v*thetaLength),vertex.z=radius*Math.sin(0+u*phiLength)*Math.sin(0+v*thetaLength),Math.abs(vertex.x)<1e-5&&(vertex.x=0),Math.abs(vertex.y)<1e-5&&(vertex.y=0),Math.abs(vertex.z)<1e-5&&(vertex.z=0),1===cap?(n=new $3Dmol.Vector3(0,Math.cos(0+v*thetaLength),0)).normalize():(n=new $3Dmol.Vector3(vertex.x,vertex.y,vertex.z)).normalize(),nvecs.push(vertex),norms.push(n),verticesRow.push(nvecs.length-1)}else verticesRow.push(nvecs.length-widthSegments)}equator&&verticesRows.push(toRow),verticesRows.push(verticesRow)}var obj={vertices:nvecs,normals:norms,verticesRows:verticesRows,w:widthSegments,h:10};return this.cache[radius]={},this.cache[radius][cap+capType]=obj,obj}};this.caps={NONE:0,FLAT:1,ROUND:2};var drawnC=0;draw.drawCylinder=function(geo,from,to,radius,color,fromCap,toCap){if(from&&to){drawnC++;var drawcaps=toCap||fromCap;color=color||{r:0,g:0,b:0};var dir=[to.x,to.y,to.z];dir[0]-=from.x,dir[1]-=from.y,dir[2]-=from.z;var offset,faceoffset,i,x,y,z,e=getRotationMatrix(dir),vobj=cylVertexCache.getVerticesForRadius(radius,toCap,"to"),n=vobj.w,h=vobj.h,n_verts=drawcaps?h*n+2:2*n,geoGroup=geo.updateGeoGroup(n_verts),vertices=vobj.vertices,normals=vobj.normals,verticesRows=vobj.verticesRows,toRow=verticesRows[h/2],fromRow=verticesRows[h/2+1],start=geoGroup.vertices,vertexArray=geoGroup.vertexArray,normalArray=geoGroup.normalArray,colorArray=geoGroup.colorArray,faceArray=geoGroup.faceArray;for(i=0;i<n;++i){var vi=2*i;x=e[0]*vertices[vi].x+e[3]*vertices[vi].y+e[6]*vertices[vi].z,y=e[1]*vertices[vi].x+e[4]*vertices[vi].y+e[7]*vertices[vi].z,z=e[5]*vertices[vi].y+e[8]*vertices[vi].z,offset=3*(start+vi),faceoffset=geoGroup.faceidx,vertexArray[offset]=x+from.x,vertexArray[offset+1]=y+from.y,vertexArray[offset+2]=z+from.z,vertexArray[offset+3]=x+to.x,vertexArray[offset+4]=y+to.y,vertexArray[offset+5]=z+to.z,normalArray[offset]=x,normalArray[offset+3]=x,normalArray[offset+1]=y,normalArray[offset+4]=y,normalArray[offset+2]=z,normalArray[offset+5]=z,colorArray[offset]=color.r,colorArray[offset+3]=color.r,colorArray[offset+1]=color.g,colorArray[offset+4]=color.g,colorArray[offset+2]=color.b,colorArray[offset+5]=color.b,faceArray[faceoffset]=fromRow[i]+start,faceArray[faceoffset+1]=fromRow[i+1]+start,faceArray[faceoffset+2]=toRow[i]+start,faceArray[faceoffset+3]=toRow[i]+start,faceArray[faceoffset+4]=fromRow[i+1]+start,faceArray[faceoffset+5]=toRow[i+1]+start,geoGroup.faceidx+=6}if(drawcaps){var v1,v2,v3,v4,x1,x2,x3,x4,y1,y2,y3,y4,z1,z2,z3,z4,nx1,nx2,nx3,nx4,ny1,ny2,ny3,ny4,nz1,nz2,nz3,nz4,v1offset,v2offset,v3offset,v4offset,ystart=toCap?0:h/2,yend=fromCap?h+1:h/2+1;for(y=ystart;y<yend;y++)if(y!==h/2){var cap=y<=h/2?to:from,toObj=cylVertexCache.getVerticesForRadius(radius,toCap,"to"),fromObj=cylVertexCache.getVerticesForRadius(radius,fromCap,"from");for(cap===to?(vertices=toObj.vertices,normals=toObj.normals,verticesRows=toObj.verticesRows):cap==from&&(vertices=fromObj.vertices,normals=fromObj.normals,verticesRows=fromObj.verticesRows),x=0;x<n;x++)faceoffset=geoGroup.faceidx,v1offset=3*((v1=verticesRows[y][x+1])+start),v2offset=3*((v2=verticesRows[y][x])+start),v3offset=3*((v3=verticesRows[y+1][x])+start),v4offset=3*((v4=verticesRows[y+1][x+1])+start),x1=e[0]*vertices[v1].x+e[3]*vertices[v1].y+e[6]*vertices[v1].z,x2=e[0]*vertices[v2].x+e[3]*vertices[v2].y+e[6]*vertices[v2].z,x3=e[0]*vertices[v3].x+e[3]*vertices[v3].y+e[6]*vertices[v3].z,x4=e[0]*vertices[v4].x+e[3]*vertices[v4].y+e[6]*vertices[v4].z,y1=e[1]*vertices[v1].x+e[4]*vertices[v1].y+e[7]*vertices[v1].z,y2=e[1]*vertices[v2].x+e[4]*vertices[v2].y+e[7]*vertices[v2].z,y3=e[1]*vertices[v3].x+e[4]*vertices[v3].y+e[7]*vertices[v3].z,y4=e[1]*vertices[v4].x+e[4]*vertices[v4].y+e[7]*vertices[v4].z,z1=e[5]*vertices[v1].y+e[8]*vertices[v1].z,z2=e[5]*vertices[v2].y+e[8]*vertices[v2].z,z3=e[5]*vertices[v3].y+e[8]*vertices[v3].z,z4=e[5]*vertices[v4].y+e[8]*vertices[v4].z,vertexArray[v1offset]=x1+cap.x,vertexArray[v2offset]=x2+cap.x,vertexArray[v3offset]=x3+cap.x,vertexArray[v4offset]=x4+cap.x,vertexArray[v1offset+1]=y1+cap.y,vertexArray[v2offset+1]=y2+cap.y,vertexArray[v3offset+1]=y3+cap.y,vertexArray[v4offset+1]=y4+cap.y,vertexArray[v1offset+2]=z1+cap.z,vertexArray[v2offset+2]=z2+cap.z,vertexArray[v3offset+2]=z3+cap.z,vertexArray[v4offset+2]=z4+cap.z,colorArray[v1offset]=color.r,colorArray[v2offset]=color.r,colorArray[v3offset]=color.r,colorArray[v4offset]=color.r,colorArray[v1offset+1]=color.g,colorArray[v2offset+1]=color.g,colorArray[v3offset+1]=color.g,colorArray[v4offset+1]=color.g,colorArray[v1offset+2]=color.b,colorArray[v2offset+2]=color.b,colorArray[v3offset+2]=color.b,colorArray[v4offset+2]=color.b,nx1=e[0]*normals[v1].x+e[3]*normals[v1].y+e[6]*normals[v1].z,nx2=e[0]*normals[v2].x+e[3]*normals[v2].y+e[6]*normals[v2].z,nx3=e[0]*normals[v3].x+e[3]*normals[v3].y+e[6]*normals[v3].z,nx4=e[0]*normals[v4].x+e[3]*normals[v4].y+e[6]*normals[v4].z,ny1=e[1]*normals[v1].x+e[4]*normals[v1].y+e[7]*normals[v1].z,ny2=e[1]*normals[v2].x+e[4]*normals[v2].y+e[7]*normals[v2].z,ny3=e[1]*normals[v3].x+e[4]*normals[v3].y+e[7]*normals[v3].z,ny4=e[1]*normals[v4].x+e[4]*normals[v4].y+e[7]*normals[v4].z,nz1=e[5]*normals[v1].y+e[8]*normals[v1].z,nz2=e[5]*normals[v2].y+e[8]*normals[v2].z,nz3=e[5]*normals[v3].y+e[8]*normals[v3].z,nz4=e[5]*normals[v4].y+e[8]*normals[v4].z,0===y?(normalArray[v1offset]=nx1,normalArray[v3offset]=nx3,normalArray[v4offset]=nx4,normalArray[v1offset+1]=ny1,normalArray[v3offset+1]=ny3,normalArray[v4offset+1]=ny4,normalArray[v1offset+2]=nz1,normalArray[v3offset+2]=nz3,normalArray[v4offset+2]=nz4,faceArray[faceoffset]=v1+start,faceArray[faceoffset+1]=v3+start,faceArray[faceoffset+2]=v4+start,geoGroup.faceidx+=3):y===yend-1?(normalArray[v1offset]=nx1,normalArray[v2offset]=nx2,normalArray[v3offset]=nx3,normalArray[v1offset+1]=ny1,normalArray[v2offset+1]=ny2,normalArray[v3offset+1]=ny3,normalArray[v1offset+2]=nz1,normalArray[v2offset+2]=nz2,normalArray[v3offset+2]=nz3,faceArray[faceoffset]=v1+start,faceArray[faceoffset+1]=v2+start,faceArray[faceoffset+2]=v3+start,geoGroup.faceidx+=3):(normalArray[v1offset]=nx1,normalArray[v2offset]=nx2,normalArray[v4offset]=nx4,normalArray[v1offset+1]=ny1,normalArray[v2offset+1]=ny2,normalArray[v4offset+1]=ny4,normalArray[v1offset+2]=nz1,normalArray[v2offset+2]=nz2,normalArray[v4offset+2]=nz4,normalArray[v2offset]=nx2,normalArray[v3offset]=nx3,normalArray[v4offset]=nx4,normalArray[v2offset+1]=ny2,normalArray[v3offset+1]=ny3,normalArray[v4offset+1]=ny4,normalArray[v2offset+2]=nz2,normalArray[v3offset+2]=nz3,normalArray[v4offset+2]=nz4,faceArray[faceoffset]=v1+start,faceArray[faceoffset+1]=v2+start,faceArray[faceoffset+2]=v4+start,faceArray[faceoffset+3]=v2+start,faceArray[faceoffset+4]=v3+start,faceArray[faceoffset+5]=v4+start,geoGroup.faceidx+=6)}}geoGroup.vertices+=n_verts}};draw.drawCone=function(geo,from,to,radius,color){if(from&&to){console.log(from),console.log(to),color=color||{r:0,g:0,b:0};var dir=[to.x,to.y,to.z];dir.x-=from.x,dir.y-=from.y,dir.z-=from.z;var i,x,y,z,e=getRotationMatrix(dir),n=basisVectors.length,basis=basisVectors,n_verts=n+2,geoGroup=geo.updateGeoGroup(n_verts),start=geoGroup.vertices,vertexArray=geoGroup.vertexArray,normalArray=geoGroup.normalArray,colorArray=geoGroup.colorArray,faceArray=geoGroup.faceArray,offset=3*start,ndir=new $3Dmol.Vector3(dir[0],dir[1],dir[2]).normalize();for(vertexArray[offset]=from.x,vertexArray[offset+1]=from.y,vertexArray[offset+2]=from.z,normalArray[offset]=-ndir.x,normalArray[offset+1]=-ndir.y,normalArray[offset+2]=-ndir.z,colorArray[offset]=color.r,colorArray[offset+1]=color.g,colorArray[offset+2]=color.b,vertexArray[offset+3]=to.x,vertexArray[offset+4]=to.y,vertexArray[offset+5]=to.z,normalArray[offset+3]=ndir.x,normalArray[offset+4]=ndir.y,normalArray[offset+5]=ndir.z,colorArray[offset+3]=color.r,colorArray[offset+4]=color.g,colorArray[offset+5]=color.b,offset+=6,i=0;i<n;++i){var vec=basis[i].clone();vec.multiplyScalar(radius),x=e[0]*vec.x+e[3]*vec.y+e[6]*vec.z,y=e[1]*vec.x+e[4]*vec.y+e[7]*vec.z,z=e[5]*vec.y+e[8]*vec.z,vertexArray[offset]=x+from.x,vertexArray[offset+1]=y+from.y,vertexArray[offset+2]=z+from.z,normalArray[offset]=x,normalArray[offset+1]=y,normalArray[offset+2]=z,colorArray[offset]=color.r,colorArray[offset+1]=color.g,colorArray[offset+2]=color.b,offset+=3}geoGroup.vertices+=n+2;var faceoffset=geoGroup.faceidx;for(i=0;i<n;i++){var v1=start+2+i,v2=start+2+(i+1)%n;faceArray[faceoffset]=v1,faceArray[faceoffset+1]=v2,faceArray[faceoffset+2]=start,faceArray[faceoffset+=3]=v1,faceArray[faceoffset+1]=v2,faceArray[faceoffset+2]=start+1,faceoffset+=3}geoGroup.faceidx+=6*n}};var sphereVertexCache={cache:{},getVerticesForRadius:function(radius){if(void 0!==this.cache[radius])return this.cache[radius];var obj={vertices:[],verticesRows:[],normals:[]},widthSegments=16,heightSegments=10;radius<1&&(widthSegments=10,heightSegments=8);var x,y,phiLength=2*Math.PI,thetaLength=Math.PI;for(y=0;y<=heightSegments;y++){var verticesRow=[];for(x=0;x<=widthSegments;x++){var u=x/widthSegments,v=y/heightSegments,vertex={};vertex.x=-radius*Math.cos(0+u*phiLength)*Math.sin(0+v*thetaLength),vertex.y=radius*Math.cos(0+v*thetaLength),vertex.z=radius*Math.sin(0+u*phiLength)*Math.sin(0+v*thetaLength);var n=new $3Dmol.Vector3(vertex.x,vertex.y,vertex.z);n.normalize(),obj.vertices.push(vertex),obj.normals.push(n),verticesRow.push(obj.vertices.length-1)}obj.verticesRows.push(verticesRow)}return this.cache[radius]=obj,obj}};return draw.drawSphere=function(geo,pos,radius,color){new $3Dmol.Vector3(pos.x,pos.y,pos.z);for(var x,y,vobj=sphereVertexCache.getVerticesForRadius(radius),vertices=vobj.vertices,normals=vobj.normals,geoGroup=geo.updateGeoGroup(vertices.length),start=geoGroup.vertices,vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray,faceArray=geoGroup.faceArray,lineArray=geoGroup.lineArray,normalArray=geoGroup.normalArray,i=0,il=vertices.length;i<il;++i){var offset=3*(start+i),v=vertices[i];vertexArray[offset]=v.x+pos.x,vertexArray[offset+1]=v.y+pos.y,vertexArray[offset+2]=v.z+pos.z,colorArray[offset]=color.r,colorArray[offset+1]=color.g,colorArray[offset+2]=color.b}geoGroup.vertices+=vertices.length;var verticesRows=vobj.verticesRows,h=verticesRows.length-1;for(y=0;y<h;y++){var w=verticesRows[y].length-1;for(x=0;x<w;x++){var faceoffset=geoGroup.faceidx,lineoffset=geoGroup.lineidx,v1=verticesRows[y][x+1]+start,v1offset=3*v1,v2=verticesRows[y][x]+start,v2offset=3*v2,v3=verticesRows[y+1][x]+start,v3offset=3*v3,v4=verticesRows[y+1][x+1]+start,v4offset=3*v4,n1=normals[v1-start],n2=normals[v2-start],n3=normals[v3-start],n4=normals[v4-start];Math.abs(vertices[v1-start].y)===radius?(normalArray[v1offset]=n1.x,normalArray[v3offset]=n3.x,normalArray[v4offset]=n4.x,normalArray[v1offset+1]=n1.y,normalArray[v3offset+1]=n3.y,normalArray[v4offset+1]=n4.y,normalArray[v1offset+2]=n1.z,normalArray[v3offset+2]=n3.z,normalArray[v4offset+2]=n4.z,faceArray[faceoffset]=v1,faceArray[faceoffset+1]=v3,faceArray[faceoffset+2]=v4,lineArray[lineoffset]=v1,lineArray[lineoffset+1]=v3,lineArray[lineoffset+2]=v1,lineArray[lineoffset+3]=v4,lineArray[lineoffset+4]=v3,lineArray[lineoffset+5]=v4,geoGroup.faceidx+=3,geoGroup.lineidx+=6):Math.abs(vertices[v3-start].y)===radius?(normalArray[v1offset]=n1.x,normalArray[v2offset]=n2.x,normalArray[v3offset]=n3.x,normalArray[v1offset+1]=n1.y,normalArray[v2offset+1]=n2.y,normalArray[v3offset+1]=n3.y,normalArray[v1offset+2]=n1.z,normalArray[v2offset+2]=n2.z,normalArray[v3offset+2]=n3.z,faceArray[faceoffset]=v1,faceArray[faceoffset+1]=v2,faceArray[faceoffset+2]=v3,lineArray[lineoffset]=v1,lineArray[lineoffset+1]=v2,lineArray[lineoffset+2]=v1,lineArray[lineoffset+3]=v3,lineArray[lineoffset+4]=v2,lineArray[lineoffset+5]=v3,geoGroup.faceidx+=3,geoGroup.lineidx+=6):(normalArray[v1offset]=n1.x,normalArray[v2offset]=n2.x,normalArray[v4offset]=n4.x,normalArray[v1offset+1]=n1.y,normalArray[v2offset+1]=n2.y,normalArray[v4offset+1]=n4.y,normalArray[v1offset+2]=n1.z,normalArray[v2offset+2]=n2.z,normalArray[v4offset+2]=n4.z,normalArray[v2offset]=n2.x,normalArray[v3offset]=n3.x,normalArray[v4offset]=n4.x,normalArray[v2offset+1]=n2.y,normalArray[v3offset+1]=n3.y,normalArray[v4offset+1]=n4.y,normalArray[v2offset+2]=n2.z,normalArray[v3offset+2]=n3.z,normalArray[v4offset+2]=n4.z,faceArray[faceoffset]=v1,faceArray[faceoffset+1]=v2,faceArray[faceoffset+2]=v4,faceArray[faceoffset+3]=v2,faceArray[faceoffset+4]=v3,faceArray[faceoffset+5]=v4,lineArray[lineoffset]=v1,lineArray[lineoffset+1]=v2,lineArray[lineoffset+2]=v1,lineArray[lineoffset+3]=v4,lineArray[lineoffset+4]=v2,lineArray[lineoffset+5]=v3,lineArray[lineoffset+6]=v3,lineArray[lineoffset+7]=v4,geoGroup.faceidx+=6,geoGroup.lineidx+=8)}}},draw}();var $3Dmol=$3Dmol||{};$3Dmol.GLModel=function(){function GLModel(mid,options){var atoms=[],frames=[],box=null,atomdfs=null,id=mid,hidden=!1,molObj=null,renderedMolObj=null,lastColors=null,modelData={},idMatrix=new $3Dmol.Matrix4,dontDuplicateAtoms=!0,defaultColor=$3Dmol.elementColors.defaultColor,ElementColors=(options=options||{}).defaultcolors?options.defaultcolors:$3Dmol.elementColors.defaultColors,defaultSphereRadius=options.defaultSphereRadius?options.defaultSphereRadius:1.5,defaultCartoonQuality=options.cartoonQuality?options.cartoonQuality:5,getRadiusFromStyle=function(atom,style){var r=defaultSphereRadius;return void 0!==style.radius?r=style.radius:vdwRadii[atom.elem]&&(r=vdwRadii[atom.elem]),void 0!==style.scale&&(r*=style.scale),r},drawAtomCross=function(atom,geos){if(atom.style.cross){var style=atom.style.cross;if(!style.hidden){var linewidth=style.linewidth||defaultlineWidth;geos[linewidth]||(geos[linewidth]=new $3Dmol.Geometry);var geoGroup=geos[linewidth].updateGeoGroup(6),delta=getRadiusFromStyle(atom,style),points=[[delta,0,0],[-delta,0,0],[0,delta,0],[0,-delta,0],[0,0,delta],[0,0,-delta]],clickable=atom.clickable||atom.hoverable;clickable&&void 0===atom.intersectionShape&&(atom.intersectionShape={sphere:[],cylinder:[],line:[]});for(var c=$3Dmol.getColorFromStyle(atom,style),vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray,j=0;j<6;j++){var offset=3*geoGroup.vertices;if(geoGroup.vertices++,vertexArray[offset]=atom.x+points[j][0],vertexArray[offset+1]=atom.y+points[j][1],vertexArray[offset+2]=atom.z+points[j][2],colorArray[offset]=c.r,colorArray[offset+1]=c.g,colorArray[offset+2]=c.b,clickable){var point=new $3Dmol.Vector3(points[j][0],points[j][1],points[j][2]);point.multiplyScalar(.1),point.set(point.x+atom.x,point.y+atom.y,point.z+atom.z),atom.intersectionShape.line.push(point)}}}}},getSideBondV=function(atom,atom2,i){var p1=new $3Dmol.Vector3(atom.x,atom.y,atom.z),dir=new $3Dmol.Vector3(atom2.x,atom2.y,atom2.z).clone(),v=null;dir.sub(p1);var i2,j2,atom3,dir2;return 1===atom.bonds.length?1===atom2.bonds.length?(v=dir.clone(),Math.abs(v.x)>1e-4?v.y+=1:v.x+=1):(i2=(i+1)%atom2.bonds.length,j2=atom2.bonds[i2],atom3=atoms[j2],(dir2=new $3Dmol.Vector3(atom3.x,atom3.y,atom3.z).clone()).sub(p1),(v=dir2.clone()).cross(dir)):(i2=(i+1)%atom.bonds.length,j2=atom.bonds[i2],atom3=atoms[j2],(dir2=new $3Dmol.Vector3(atom3.x,atom3.y,atom3.z).clone()).sub(p1),(v=dir2.clone()).cross(dir)),v.lengthSq()<.01&&(v=dir.clone(),Math.abs(v.x)>1e-4?v.y+=1:v.x+=1),v.cross(dir),v.normalize(),v},addLine=function(vertexArray,colorArray,offset,p1,p2,c1){vertexArray[offset]=p1.x,vertexArray[offset+1]=p1.y,vertexArray[offset+2]=p1.z,colorArray[offset]=c1.r,colorArray[offset+1]=c1.g,colorArray[offset+2]=c1.b,vertexArray[offset+3]=p2.x,vertexArray[offset+4]=p2.y,vertexArray[offset+5]=p2.z,colorArray[offset+3]=c1.r,colorArray[offset+4]=c1.g,colorArray[offset+5]=c1.b},drawBondLines=function(atom,atoms,geos){if(atom.style.line){var style=atom.style.line;if(!style.hidden){var p1a,p1b,p2a,p2b,linewidth=style.linewidth||defaultlineWidth;geos[linewidth]||(geos[linewidth]=new $3Dmol.Geometry);for(var geoGroup=geos[linewidth].updateGeoGroup(6*atom.bonds.length),vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray,i=0;i<atom.bonds.length;i++){var atom2=atoms[atom.bonds[i]];if(atom2.style.line&&!(atom.serial>=atom2.serial)){var p1=new $3Dmol.Vector3(atom.x,atom.y,atom.z),p2=new $3Dmol.Vector3(atom2.x,atom2.y,atom2.z),mp=p1.clone().add(p2).multiplyScalar(.5),singleBond=!1,atomneedsi=atom.clickable||atom.hoverable,atom2needsi=atom2.clickable||atom2.hoverable;(atomneedsi||atom2needsi)&&(atomneedsi&&(void 0===atom.intersectionShape&&(atom.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),atom.intersectionShape.line.push(p1),atom.intersectionShape.line.push(mp)),atom2needsi&&(void 0===atom2.intersectionShape&&(atom2.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),atom2.intersectionShape.line.push(mp),atom2.intersectionShape.line.push(p2)));var c1=$3Dmol.getColorFromStyle(atom,atom.style.line),c2=$3Dmol.getColorFromStyle(atom2,atom2.style.line);if(atom.bondStyles&&atom.bondStyles[i]){var bstyle=atom.bondStyles[i];if(!bstyle.iswire)continue;bstyle.radius&&(bondR=bstyle.radius),bstyle.singleBond&&(singleBond=!0),void 0!==bstyle.color1&&(c1=$3Dmol.CC.color(bstyle.color1)),void 0!==bstyle.color2&&(c2=$3Dmol.CC.color(bstyle.color2))}var offset=3*geoGroup.vertices;if(atom.bondOrder[i]>1&&atom.bondOrder[i]<4&&!singleBond){var v=getSideBondV(atom,atom2,i),dir=p2.clone();if(dir.sub(p1),2==atom.bondOrder[i])v.multiplyScalar(.1),(p1a=p1.clone()).add(v),(p1b=p1.clone()).sub(v),(p2a=p1a.clone()).add(dir),(p2b=p1b.clone()).add(dir),c1==c2?(geoGroup.vertices+=4,addLine(vertexArray,colorArray,offset,p1a,p2a,c1),addLine(vertexArray,colorArray,offset+6,p1b,p2b,c1)):(geoGroup.vertices+=8,dir.multiplyScalar(.5),(mpa=p1a.clone()).add(dir),(mpb=p1b.clone()).add(dir),addLine(vertexArray,colorArray,offset,p1a,mpa,c1),addLine(vertexArray,colorArray,offset+6,mpa,p2a,c2),addLine(vertexArray,colorArray,offset+12,p1b,mpb,c1),addLine(vertexArray,colorArray,offset+18,mpb,p2b,c2));else if(3==atom.bondOrder[i])if(v.multiplyScalar(.1),(p1a=p1.clone()).add(v),(p1b=p1.clone()).sub(v),(p2a=p1a.clone()).add(dir),(p2b=p1b.clone()).add(dir),c1==c2)geoGroup.vertices+=6,addLine(vertexArray,colorArray,offset,p1,p2,c1),addLine(vertexArray,colorArray,offset+6,p1a,p2a,c1),addLine(vertexArray,colorArray,offset+12,p1b,p2b,c1);else{geoGroup.vertices+=12,dir.multiplyScalar(.5);var mpa=p1a.clone();mpa.add(dir);var mpb=p1b.clone();mpb.add(dir),addLine(vertexArray,colorArray,offset,p1,mp,c1),addLine(vertexArray,colorArray,offset+6,mp,p2,c2),addLine(vertexArray,colorArray,offset+12,p1a,mpa,c1),addLine(vertexArray,colorArray,offset+18,mpa,p2a,c2),addLine(vertexArray,colorArray,offset+24,p1b,mpb,c1),addLine(vertexArray,colorArray,offset+30,mpb,p2b,c2)}}else c1==c2?(geoGroup.vertices+=2,addLine(vertexArray,colorArray,offset,p1,p2,c1)):(geoGroup.vertices+=4,addLine(vertexArray,colorArray,offset,p1,mp,c1),addLine(vertexArray,colorArray,offset+6,mp,p2,c2))}}}}},drawAtomSphere=function(atom,geo){if(atom.style.sphere){var style=atom.style.sphere;if(!style.hidden){var C=$3Dmol.getColorFromStyle(atom,style),radius=getRadiusFromStyle(atom,style);if((!0===atom.clickable||atom.hoverable)&&void 0!==atom.intersectionShape){var center=new $3Dmol.Vector3(atom.x,atom.y,atom.z);atom.intersectionShape.sphere.push(new $3Dmol.Sphere(center,radius))}$3Dmol.GLDraw.drawSphere(geo,atom,radius,C)}}},drawAtomInstanced=function(atom,geo){if(atom.style.sphere){var style=atom.style.sphere;if(!style.hidden){var radius=getRadiusFromStyle(atom,style),C=$3Dmol.getColorFromStyle(atom,style),geoGroup=geo.updateGeoGroup(1),startv=geoGroup.vertices,start=3*startv,vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray,radiusArray=geoGroup.radiusArray;vertexArray[start]=atom.x,vertexArray[start+1]=atom.y,vertexArray[start+2]=atom.z;geoGroup.normalArray;if((colorArray=geoGroup.colorArray)[start]=C.r,colorArray[start+1]=C.g,colorArray[start+2]=C.b,radiusArray[startv]=radius,(!0===atom.clickable||atom.hoverable)&&void 0!==atom.intersectionShape){var center=new $3Dmol.Vector3(atom.x,atom.y,atom.z);atom.intersectionShape.sphere.push(new $3Dmol.Sphere(center,radius))}geoGroup.vertices+=1}}},drawSphereImposter=function(geo,center,radius,C){for(var geoGroup=geo.updateGeoGroup(4),startv=geoGroup.vertices,start=3*startv,vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray,i=0;i<4;i++)vertexArray[start+3*i]=center.x,vertexArray[start+3*i+1]=center.y,vertexArray[start+3*i+2]=center.z;for(var normalArray=geoGroup.normalArray,colorArray=geoGroup.colorArray,i=0;i<4;i++)colorArray[start+3*i]=C.r,colorArray[start+3*i+1]=C.g,colorArray[start+3*i+2]=C.b;normalArray[start+0]=-radius,normalArray[start+1]=radius,normalArray[start+2]=0,normalArray[start+3]=-radius,normalArray[start+4]=-radius,normalArray[start+5]=0,normalArray[start+6]=radius,normalArray[start+7]=-radius,normalArray[start+8]=0,normalArray[start+9]=radius,normalArray[start+10]=radius,normalArray[start+11]=0,geoGroup.vertices+=4;var faceArray=geoGroup.faceArray,faceoffset=geoGroup.faceidx;faceArray[faceoffset+0]=startv,faceArray[faceoffset+1]=startv+1,faceArray[faceoffset+2]=startv+2,faceArray[faceoffset+3]=startv+2,faceArray[faceoffset+4]=startv+3,faceArray[faceoffset+5]=startv,geoGroup.faceidx+=6},drawAtomImposter=function(atom,geo){if(atom.style.sphere){var style=atom.style.sphere;if(!style.hidden){var radius=getRadiusFromStyle(atom,style),C=$3Dmol.getColorFromStyle(atom,style);if((!0===atom.clickable||atom.hoverable)&&void 0!==atom.intersectionShape){var center=new $3Dmol.Vector3(atom.x,atom.y,atom.z);atom.intersectionShape.sphere.push(new $3Dmol.Sphere(center,radius))}drawSphereImposter(geo,atom,radius,C)}}},drawStickImposter=function(geo,from,to,radius,color,fromCap,toCap){for(var geoGroup=geo.updateGeoGroup(4),startv=geoGroup.vertices,start=3*startv,vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray,radiusArray=geoGroup.radiusArray,normalArray=geoGroup.normalArray,r=color.r,g=color.g,b=color.b,pos=start,i=0;i<4;i++)vertexArray[pos]=from.x,normalArray[pos]=to.x,colorArray[pos]=r,vertexArray[++pos]=from.y,normalArray[pos]=to.y,colorArray[pos]=g,vertexArray[++pos]=from.z,normalArray[pos]=to.z,colorArray[pos]=i<2?b:function(c){var n=-c;return 0==n&&(n=-1e-4),n}(b),pos++;geoGroup.vertices+=4,radiusArray[startv]=-radius,radiusArray[startv+1]=radius,radiusArray[startv+2]=-radius,radiusArray[startv+3]=radius;var faceArray=geoGroup.faceArray,faceoffset=geoGroup.faceidx;faceArray[faceoffset+0]=startv,faceArray[faceoffset+1]=startv+1,faceArray[faceoffset+2]=startv+2,faceArray[faceoffset+3]=startv+2,faceArray[faceoffset+4]=startv+3,faceArray[faceoffset+5]=startv,geoGroup.faceidx+=6},drawBondSticks=function(atom,atoms,geo){if(atom.style.stick){var style=atom.style.stick;if(!style.hidden){var mp,mp2,atomBondR=style.radius||.25,bondR=atomBondR,atomSingleBond=style.singleBonds||!1,fromCap=0,toCap=0,C1=$3Dmol.getColorFromStyle(atom,style);!atom.capDrawn&&atom.bonds.length<4&&(fromCap=2);var drawCyl=$3Dmol.GLDraw.drawCylinder;geo.imposter&&(drawCyl=drawStickImposter);for(i=0;i<atom.bonds.length;i++){var atom2=atoms[atom.bonds[i]];if(atom.serial<atom2.serial){var style2=atom2.style;if(!style2.stick)continue;var C2=$3Dmol.getColorFromStyle(atom2,style2.stick);bondR=atomBondR;singleBond=atomSingleBond;if(atom.bondStyles&&atom.bondStyles[i]){if((bstyle=atom.bondStyles[i]).iswire)continue;bstyle.radius&&(bondR=bstyle.radius),bstyle.singleBond&&(singleBond=!0),void 0!==bstyle.color1&&(C1=$3Dmol.CC.color(bstyle.color1)),void 0!==bstyle.color2&&(C2=$3Dmol.CC.color(bstyle.color2))}var p1=new $3Dmol.Vector3(atom.x,atom.y,atom.z),p2=new $3Dmol.Vector3(atom2.x,atom2.y,atom2.z);if(1===atom.bondOrder[i]||singleBond){!atom2.capDrawn&&atom2.bonds.length<4&&(toCap=2),C1!=C2?(drawCyl(geo,p1,mp=(new $3Dmol.Vector3).addVectors(p1,p2).multiplyScalar(.5),bondR,C1,fromCap,0),drawCyl(geo,mp,p2,bondR,C2,0,toCap)):drawCyl(geo,p1,p2,bondR,C1,fromCap,toCap);var atomneedsi=atom.clickable||atom.hoverable,atom2needsi=atom2.clickable||atom2.hoverable;if(atomneedsi||atom2needsi){if(mp||(mp=(new $3Dmol.Vector3).addVectors(p1,p2).multiplyScalar(.5)),atomneedsi){var cylinder1=new $3Dmol.Cylinder(p1,mp,bondR),sphere1=new $3Dmol.Sphere(p1,bondR);atom.intersectionShape.cylinder.push(cylinder1),atom.intersectionShape.sphere.push(sphere1)}if(atom2needsi){var cylinder2=new $3Dmol.Cylinder(p2,mp,bondR),sphere2=new $3Dmol.Sphere(p2,bondR);atom2.intersectionShape.cylinder.push(cylinder2),atom2.intersectionShape.sphere.push(sphere2)}}}else if(atom.bondOrder[i]>1){var mfromCap=0,mtoCap=0;bondR!=atomBondR&&(mfromCap=2,mtoCap=2);var dir=p2.clone(),v=null;dir.sub(p1);var p1a,p1b,p2a,p2b,v=getSideBondV(atom,atom2,i);if(2==atom.bondOrder[i]){var r=bondR/2.5;(v=getSideBondV(atom,atom2,i)).multiplyScalar(1.5*r),(p1a=p1.clone()).add(v),(p1b=p1.clone()).sub(v),(p2a=p1a.clone()).add(dir),(p2b=p1b.clone()).add(dir),C1!=C2?(mp=(new $3Dmol.Vector3).addVectors(p1a,p2a).multiplyScalar(.5),mp2=(new $3Dmol.Vector3).addVectors(p1b,p2b).multiplyScalar(.5),drawCyl(geo,p1a,mp,r,C1,mfromCap,0),drawCyl(geo,mp,p2a,r,C2,0,mtoCap),drawCyl(geo,p1b,mp2,r,C1,mfromCap,0),drawCyl(geo,mp2,p2b,r,C2,0,mtoCap)):(drawCyl(geo,p1a,p2a,r,C1,mfromCap,mtoCap),drawCyl(geo,p1b,p2b,r,C1,mfromCap,mtoCap));var atomneedsi=atom.clickable||atom.hoverable,atom2needsi=atom2.clickable||atom2.hoverable;if(atomneedsi||atom2needsi){if(mp||(mp=(new $3Dmol.Vector3).addVectors(p1a,p2a).multiplyScalar(.5)),mp2||(mp2=(new $3Dmol.Vector3).addVectors(p1b,p2b).multiplyScalar(.5)),atomneedsi){var cylinder1a=new $3Dmol.Cylinder(p1a,mp,r),cylinder1b=new $3Dmol.Cylinder(p1b,mp2,r);atom.intersectionShape.cylinder.push(cylinder1a),atom.intersectionShape.cylinder.push(cylinder1b)}if(atom2needsi){var cylinder2a=new $3Dmol.Cylinder(p2a,mp,r),cylinder2b=new $3Dmol.Cylinder(p2b,mp2,r);atom2.intersectionShape.cylinder.push(cylinder2a),atom2.intersectionShape.cylinder.push(cylinder2b)}}}else if(3==atom.bondOrder[i]){r=bondR/4,v.cross(dir),v.normalize(),v.multiplyScalar(3*r),(p1a=p1.clone()).add(v),(p1b=p1.clone()).sub(v),(p2a=p1a.clone()).add(dir),(p2b=p1b.clone()).add(dir),C1!=C2?(mp=(new $3Dmol.Vector3).addVectors(p1a,p2a).multiplyScalar(.5),mp2=(new $3Dmol.Vector3).addVectors(p1b,p2b).multiplyScalar(.5),mp3=(new $3Dmol.Vector3).addVectors(p1,p2).multiplyScalar(.5),drawCyl(geo,p1a,mp,r,C1,mfromCap,0),drawCyl(geo,mp,p2a,r,C2,0,mtoCap),drawCyl(geo,p1,mp3,r,C1,fromCap,0),drawCyl(geo,mp3,p2,r,C2,0,toCap),drawCyl(geo,p1b,mp2,r,C1,mfromCap,0),drawCyl(geo,mp2,p2b,r,C2,0,mtoCap)):(drawCyl(geo,p1a,p2a,r,C1,mfromCap,mtoCap),drawCyl(geo,p1,p2,r,C1,fromCap,toCap),drawCyl(geo,p1b,p2b,r,C1,mfromCap,mtoCap));var atomneedsi=atom.clickable||atom.hoverable,atom2needsi=atom2.clickable||atom2.hoverable;if(atomneedsi||atom2needsi){if(mp||(mp=(new $3Dmol.Vector3).addVectors(p1a,p2a).multiplyScalar(.5)),mp2||(mp2=(new $3Dmol.Vector3).addVectors(p1b,p2b).multiplyScalar(.5)),mp3||(mp3=(new $3Dmol.Vector3).addVectors(p1,p2).multiplyScalar(.5)),atomneedsi){var cylinder1a=new $3Dmol.Cylinder(p1a.clone(),mp.clone(),r),cylinder1b=new $3Dmol.Cylinder(p1b.clone(),mp2.clone(),r),cylinder1c=new $3Dmol.Cylinder(p1.clone(),mp3.clone(),r);atom.intersectionShape.cylinder.push(cylinder1a),atom.intersectionShape.cylinder.push(cylinder1b),atom.intersectionShape.cylinder.push(cylinder1c)}if(atom2needsi){var cylinder2a=new $3Dmol.Cylinder(p2a.clone(),mp.clone(),r),cylinder2b=new $3Dmol.Cylinder(p2b.clone(),mp2.clone(),r),cylinder2c=new $3Dmol.Cylinder(p2.clone(),mp3.clone(),r);atom2.intersectionShape.cylinder.push(cylinder2a),atom2.intersectionShape.cylinder.push(cylinder2b),atom2.intersectionShape.cylinder.push(cylinder2c)}}}}}}for(var drawSphere=!1,numsinglebonds=0,differentradii=!1,i=0;i<atom.bonds.length;i++){var singleBond=atomSingleBond;if(atom.bondStyles&&atom.bondStyles[i]){var bstyle=atom.bondStyles[i];bstyle.singleBond&&(singleBond=!0),bstyle.radius&&bstyle.radius!=atomBondR&&(differentradii=!0)}(singleBond||1==atom.bondOrder[i])&&numsinglebonds++}if(differentradii?numsinglebonds>0&&(drawSphere=!0):0==numsinglebonds&&atom.bonds.length>0&&(drawSphere=!0),drawSphere){atom.style;bondR=atomBondR,geo.imposter?drawSphereImposter(geo.sphereGeometry,atom,bondR,C1):$3Dmol.GLDraw.drawSphere(geo,atom,bondR,C1)}}}},createMolObj=function(atoms,options){options=options||{};var ret=new $3Dmol.Object3D,cartoonAtoms=[],lineGeometries={},crossGeometries={},drawSphereFunc=drawAtomSphere,sphereGeometry=null,stickGeometry=null;options.supportsImposters?(drawSphereFunc=drawAtomImposter,(sphereGeometry=new $3Dmol.Geometry(!0)).imposter=!0,(stickGeometry=new $3Dmol.Geometry(!0,!0)).imposter=!0,stickGeometry.sphereGeometry=new $3Dmol.Geometry(!0),stickGeometry.sphereGeometry.imposter=!0,stickGeometry.drawnCaps={}):options.supportsAIA?(drawSphereFunc=drawAtomInstanced,(sphereGeometry=new $3Dmol.Geometry(!1,!0,!0)).instanced=!0,stickGeometry=new $3Dmol.Geometry(!0)):(sphereGeometry=new $3Dmol.Geometry(!0),stickGeometry=new $3Dmol.Geometry(!0));var i,j,n,testOpacities,opacities={},range=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(i=0,n=atoms.length;i<n;i++){var atom=atoms[i];if(atom&&atom.style){(atom.clickable||atom.hoverable)&&void 0===atom.intersectionShape&&(atom.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),testOpacities={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(j in testOpacities)atom.style[j]?atom.style[j].opacity?testOpacities[j]=parseFloat(atom.style[j].opacity):testOpacities[j]=1:testOpacities[j]=void 0,opacities[j]?void 0!=testOpacities[j]&&opacities[j]!=testOpacities[j]&&(console.log("Warning: "+j+" opacity is ambiguous"),opacities[j]=1):opacities[j]=testOpacities[j];drawSphereFunc(atom,sphereGeometry),drawAtomCross(atom,crossGeometries),drawBondLines(atom,atoms,lineGeometries),drawBondSticks(atom,atoms,stickGeometry),void 0===atom.style.cartoon||atom.style.cartoon.hidden||("spectrum"!==atom.style.cartoon.color||"number"!=typeof atom.resi||atom.hetflag||(atom.resi<range[0]&&(range[0]=atom.resi),atom.resi>range[1]&&(range[1]=atom.resi)),cartoonAtoms.push(atom))}}if(cartoonAtoms.length>0&&$3Dmol.drawCartoon(ret,cartoonAtoms,range,defaultCartoonQuality),sphereGeometry&&sphereGeometry.vertices>0){sphereGeometry.initTypedArrays();sphereMaterial=null;if(sphereGeometry.imposter)sphereMaterial=new $3Dmol.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0});else if(sphereGeometry.instanced){sphere=new $3Dmol.Geometry(!0);$3Dmol.GLDraw.drawSphere(sphere,{x:0,y:0,z:0},1,new $3Dmol.Color(.5,.5,.5)),sphere.initTypedArrays(),sphereMaterial=new $3Dmol.InstancedMaterial({sphereMaterial:new $3Dmol.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:sphere})}else var sphereMaterial=new $3Dmol.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0});opacities.sphere<1&&opacities.sphere>=0&&(sphereMaterial.transparent=!0,sphereMaterial.opacity=opacities.sphere);var sphere=new $3Dmol.Mesh(sphereGeometry,sphereMaterial);ret.add(sphere)}if(stickGeometry.vertices>0){var stickMaterial=null,ballMaterial=null,balls=stickGeometry.sphereGeometry;balls&&void 0!==balls.vertices&&0!=balls.vertices||(balls=null),stickGeometry.initTypedArrays(),balls&&balls.initTypedArrays();var matvals={ambient:0,vertexColors:!0,reflectivity:0};if(stickGeometry.imposter){stickMaterial=new $3Dmol.StickImposterMaterial(matvals);ballMaterial=new $3Dmol.SphereImposterMaterial(matvals)}else stickMaterial=new $3Dmol.MeshLambertMaterial(matvals),ballMaterial=new $3Dmol.MeshLambertMaterial(matvals),stickMaterial.wireframe&&(stickGeometry.setUpWireframe(),balls&&balls.setUpWireframe());opacities.stick<1&&opacities.stick>=0&&(stickMaterial.transparent=!0,stickMaterial.opacity=opacities.stick,ballMaterial.transparent=!0,ballMaterial.opacity=opacities.stick);var sticks=new $3Dmol.Mesh(stickGeometry,stickMaterial);if(ret.add(sticks),balls){var stickspheres=new $3Dmol.Mesh(balls,ballMaterial);ret.add(stickspheres)}}for(i in lineGeometries)if(lineGeometries.hasOwnProperty(i)){var linewidth=i,lineMaterial=new $3Dmol.LineBasicMaterial({linewidth:linewidth,vertexColors:!0});opacities.line<1&&opacities.line>=0&&(lineMaterial.transparent=!0,lineMaterial.opacity=opacities.line),lineGeometries[i].initTypedArrays();var line=new $3Dmol.Line(lineGeometries[i],lineMaterial,$3Dmol.LinePieces);ret.add(line)}for(i in crossGeometries)if(crossGeometries.hasOwnProperty(i)){var linewidth=i,crossMaterial=new $3Dmol.LineBasicMaterial({linewidth:linewidth,vertexColors:!0});opacities.cross<1&&opacities.cross>=0&&(crossMaterial.transparent=!0,crossMaterial.opacity=opacities.cross),crossGeometries[i].initTypedArrays();var cross=new $3Dmol.Line(crossGeometries[i],crossMaterial,$3Dmol.LinePieces);ret.add(cross)}if(dontDuplicateAtoms&&modelData.symmetries&&modelData.symmetries.length>0){var t,finalRet=new $3Dmol.Object3D;for(t=0;t<modelData.symmetries.length;t++){var transformedRet=new $3Dmol.Object3D;(transformedRet=ret.clone()).matrix.copy(modelData.symmetries[t]),transformedRet.matrixAutoUpdate=!1,finalRet.add(transformedRet)}return finalRet}return ret};this.getCrystData=function(){return modelData.cryst?modelData.cryst:null},this.getSymmetries=function(){return void 0===modelData.symmetries&&(modelData.symmetries=[idMatrix]),modelData.symmetries},this.setSymmetries=function(list){modelData.symmetries=void 0===list?[idMatrix]:list},this.getID=function(){return id},this.getNumFrames=function(){return void 0!=frames.numFrames?frames.numFrames:frames.length};var adjustCoord=function(x1,x2,margin,adjust){var dist=x2-x1;return dist<-margin?x2+adjust:dist>margin?x2-adjust:x2},adjustCoordinatesToBox=function(){if(box&&atomdfs)for(var bx=box[0],by=box[1],bz=box[2],mx=.9*bx,my=.9*by,mz=.9*bz,c=0;c<atomdfs.length;c++)for(var component=atomdfs[c],i=1;i<component.length;i++){var atom=atoms[component[i][0]],prev=atoms[component[i][1]];atom.x=adjustCoord(prev.x,atom.x,mx,bx),atom.y=adjustCoord(prev.y,atom.y,my,by),atom.z=adjustCoord(prev.z,atom.z,mz,bz)}};this.setFrame=function(framenum){var numFrames=this.getNumFrames();return new Promise(function(resolve,reject){if(0==numFrames&&resolve(),(framenum<0||framenum>=numFrames)&&(framenum=numFrames-1),void 0!=frames.url){var url=frames.url;$3Dmol.getbin(url+"/traj/frame/"+framenum+"/"+frames.path,null,"POST").then(function(buffer){for(var values=new Float32Array(buffer,44),count=0,i=0;i<atoms.length;i++)atoms[i].x=values[count++],atoms[i].y=values[count++],atoms[i].z=values[count++];box&&atomdfs&&adjustCoordinatesToBox(),resolve()}).catch(reject)}else atoms=frames[framenum],resolve();molObj=null})},this.addFrame=function(atoms){frames.push(atoms)},this.vibrate=function(numFrames,amplitude){var amplitude=amplitude||1,numFrames=numFrames||10;numFrames--;for(var i=1;i<=numFrames;i++){for(var newAtoms=[],j=0;j<atoms.length;j++){var newVector=new $3Dmol.Vector3($3Dmol.getAtomProperty(atoms[j],"dx"),$3Dmol.getAtomProperty(atoms[j],"dy"),$3Dmol.getAtomProperty(atoms[j],"dz")),starting=new $3Dmol.Vector3(atoms[j].x,atoms[j].y,atoms[j].z);newVector.multiplyScalar(i*amplitude/numFrames),starting.add(newVector);var newAtom={};for(var k in atoms[j])newAtom[k]=atoms[j][k];newAtom.x=starting.x,newAtom.y=starting.y,newAtom.z=starting.z,newAtoms.push(newAtom)}frames.push(newAtoms)}frames.unshift(atoms)},this.setAtomDefaults=function(atoms){for(var i=0;i<atoms.length;i++){var atom=atoms[i];atom&&(atom.style=atom.style||defaultAtomStyle,atom.color=atom.color||ElementColors[atom.elem]||defaultColor,atom.model=id,(atom.clickable||atom.hoverable)&&(atom.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}},this.addMolData=function(data,format,options){options=options||{};var parsedAtoms=$3Dmol.GLModel.parseMolData(data,format,options);dontDuplicateAtoms=!options.duplicateAssemblyAtoms;var mData=parsedAtoms.modelData;if(mData&&(modelData=Array.isArray(mData)?mData[0]:mData),box=parsedAtoms.box?parsedAtoms.box:null,0==frames.length){for(i=0;i<parsedAtoms.length;i++)0!=parsedAtoms[i].length&&frames.push(parsedAtoms[i]);frames[0]&&(atoms=frames[0])}else if(options.frames)for(i=0;i<parsedAtoms.length;i++)frames.push(parsedAtoms[i]);else for(i=0;i<parsedAtoms.length;i++)this.addAtoms(parsedAtoms[i]);for(var i=0;i<frames.length;i++)this.setAtomDefaults(frames[i],id);options.vibrate&&options.vibrate.frames&&options.vibrate.amplitude&&this.vibrate(options.vibrate.frames,options.vibrate.amplitude),options.style&&this.setStyle({},options.style)},this.setDontDuplicateAtoms=function(dup){dontDuplicateAtoms=dup},this.setModelData=function(mData){modelData=mData};var propertyMatches=function(atomval,val){if(atomval==val)return!0;if("string"==typeof val&&"number"==typeof atomval){var match=val.match(/(-?\d+)\s*-\s*(-?\d+)/);if(match){var lo=parseInt(match[1]),hi=parseInt(match[2]);if(match&&atomval>=lo&&atomval<=hi)return!0}}return!1};this.atomIsSelected=function(atom,sel){if(void 0===sel)return!0;var invert=!!sel.invert,ret=!0;for(var key in sel)if("and"==key||"or"==key||"not"==key){if("not"==key){if(this.atomIsSelected(atom,sel[key])){ret=!1;break}}else if("and"==key){for(var and=sel[key],i=0;i<and.length;i++)if(!this.atomIsSelected(atom,and[i])){ret=!1;break}}else if("or"==key){for(var or=sel[key],condition=!0,i=0;i<or.length;i++){if(this.atomIsSelected(atom,or[i])){condition=!0;break}condition=!1}ret=condition}}else if("predicate"===key){if(!sel.predicate(atom)){ret=!1;break}}else if("properties"==key&&atom[key])for(var propkey in sel.properties){if(void 0===atom.properties[propkey]){ret=!1;break}if(atom.properties[propkey]!=sel.properties[propkey]){ret=!1;break}}else if(sel.hasOwnProperty(key)&&"props"!=key&&"invert"!=key&&"model"!=key&&"byres"!=key&&"expand"!=key&&"within"!=key&&"and"!=key&&"or"!=key&&"not"!=key){if(void 0===atom[key]){ret=!1;break}var isokay=!1;if("bonds"===key){if((val=sel[key])!=atom.bonds.length){ret=!1;break}}else if($.isArray(sel[key])){for(var valarr=sel[key],atomval=atom[key],i=0;i<valarr.length;i++)if(propertyMatches(atomval,valarr[i])){isokay=!0;break}if(!isokay){ret=!1;break}}else{var val=sel[key];if(!propertyMatches(atom[key],val)){ret=!1;break}}}return invert?!ret:ret},this.selectedAtoms=function(sel,from){var ret=[];sel=sel||{},from||(from=atoms);for(var aLength=from.length,i=0;i<aLength;i++)(atom=from[i])&&this.atomIsSelected(atom,sel)&&ret.push(atom);if(sel.hasOwnProperty("expand"))for(var expand=expandAtomList(ret,parseFloat(sel.expand)),retlen=ret.length,i=0;i<expand.length;i++)for(j=0;j<retlen;j++)(dist=squaredDistance(expand[i],ret[j]))<(thresh=Math.pow(sel.expand,2))&&dist>0&&ret.push(expand[i]);if(sel.hasOwnProperty("within")&&sel.within.hasOwnProperty("sel")&&sel.within.hasOwnProperty("distance")){for(var sel2=this.selectedAtoms(sel.within.sel,atoms),within={},i=0;i<sel2.length;i++)for(j=0;j<ret.length;j++){var dist=squaredDistance(sel2[i],ret[j]),thresh=Math.pow(parseFloat(sel.within.distance),2);dist<thresh&&dist>0&&(within[j]=1)}var newret=[];if(sel.within.invert)for(j=0;j<ret.length;j++)within[j]||newret.push(ret[j]);else for(j in within)newret.push(ret[j]);ret=newret}if(sel.hasOwnProperty("byres"))for(var vResis={},vAtoms=[],stack=[],i=0;i<ret.length;i++){var atom=ret[i],c=atom.chain,r=atom.resi;if(void 0===vResis[c]&&(vResis[c]={}),atom.hasOwnProperty("resi")&&void 0===vResis[c][r])for(vResis[c][r]=!0,stack.push(atom);stack.length>0;)if(atom=stack.pop(),c=atom.chain,r=atom.resi,void 0===vAtoms[atom.index]){vAtoms[atom.index]=!0;for(var j=0;j<atom.bonds.length;j++){var atom2=atoms[atom.bonds[j]];void 0===vAtoms[atom2.index]&&atom2.hasOwnProperty("resi")&&atom2.chain==c&&atom2.resi==r&&(stack.push(atom2),ret.push(atom2))}}}return ret};var squaredDistance=function(atom1,atom2){var xd=atom2.x-atom1.x,yd=atom2.y-atom1.y,zd=atom2.z-atom1.z;return Math.pow(xd,2)+Math.pow(yd,2)+Math.pow(zd,2)},expandAtomList=function(atomList,amt){if(amt<=0)return atomList;for(var pb=$3Dmol.getExtent(atomList),nb=[[],[],[]],i=0;i<3;i++)nb[0][i]=pb[0][i]-amt,nb[1][i]=pb[1][i]+amt,nb[2][i]=pb[2][i];for(var expand=[],i=0;i<atoms.length;i++){var x=atoms[i].x,y=atoms[i].y,z=atoms[i].z;x>=nb[0][0]&&x<=nb[1][0]&&y>=nb[0][1]&&y<=nb[1][1]&&z>=nb[0][2]&&z<=nb[1][2]&&(x>=pb[0][0]&&x<=pb[1][0]&&y>=pb[0][1]&&y<=pb[1][1]&&z>=pb[0][2]&&z<=pb[1][2]||expand.push(atoms[i]))}return expand};this.addAtoms=function(newatoms){molObj=null;var i,start=atoms.length,indexmap=[];for(i=0;i<newatoms.length;i++)void 0===newatoms[i].index&&(newatoms[i].index=i),void 0===newatoms[i].serial&&(newatoms[i].serial=i),indexmap[newatoms[i].index]=start+i;for(i=0;i<newatoms.length;i++){var olda=newatoms[i],nindex=indexmap[olda.index],a=$.extend(!1,{},olda);a.index=nindex,a.bonds=[],a.bondOrder=[],a.model=id,a.style=a.style||defaultAtomStyle,void 0===a.color&&(a.color=ElementColors[a.elem]||defaultColor);for(var nbonds=olda.bonds?olda.bonds.length:0,j=0;j<nbonds;j++){var neigh=indexmap[olda.bonds[j]];void 0!==neigh&&(a.bonds.push(neigh),a.bondOrder.push(olda.bondOrder?olda.bondOrder[j]:1))}atoms.push(a)}},this.removeAtoms=function(badatoms){molObj=null;var i,baddies=[];for(i=0;i<badatoms.length;i++)baddies[badatoms[i].index]=!0;var newatoms=[];for(i=0;i<atoms.length;i++){var a=atoms[i];baddies[a.index]||newatoms.push(a)}atoms=[],this.addAtoms(newatoms)},this.setStyle=function(sel,style,add){void 0===style&&void 0===add&&(style=sel,sel={});var s;for(s in sel)GLModel.validAtomSelectionSpecs.hasOwnProperty(s)||console.log("Unknown selector "+s);for(s in style)GLModel.validAtomStyleSpecs.hasOwnProperty(s)||console.log("Unknown style "+s);var changedAtoms=!1,setStyleHelper=function(atomArr){for(var selected=that.selectedAtoms(sel,atomArr),i=0;i<atomArr.length;i++)atomArr[i]&&(atomArr[i].capDrawn=!1);for(i=0;i<selected.length;i++){changedAtoms=!0,(selected[i].clickable||selected[i].hoverable)&&(selected[i].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),add||(selected[i].style={});for(s in style)if(style.hasOwnProperty(s)){selected[i].style[s]=selected[i].style[s]||{};for(var prop in style[s])selected[i].style[s][prop]=style[s][prop]}}},that=this;setStyleHelper(atoms);for(var i=0;i<frames.length;i++)frames[i]!==atoms&&setStyleHelper(frames[i]);changedAtoms&&(molObj=null)},this.setClickable=function(sel,clickable,callback){var s;for(s in sel)GLModel.validAtomSelectionSpecs.hasOwnProperty(s)||console.log("Unknown selector "+s);if(clickable=!!clickable,callback&&"function"!=typeof callback)console.log("Callback is not a function");else{var i,selected=this.selectedAtoms(sel,atoms),len=selected.length;for(i=0;i<len;i++)selected[i].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},selected[i].clickable=clickable,callback&&(selected[i].callback=callback);len>0&&(molObj=null)}},this.setHoverable=function(sel,hoverable,hover_callback,unhover_callback){var s;for(s in sel)GLModel.validAtomSelectionSpecs.hasOwnProperty(s)||console.log("Unknown selector "+s);if(hoverable=!!hoverable,hover_callback&&"function"!=typeof hover_callback)console.log("Hover_callback is not a function");else if(unhover_callback&&"function"!=typeof unhover_callback)console.log("Unhover_callback is not a function");else{var i,selected=this.selectedAtoms(sel,atoms),len=selected.length;for(i=0;i<len;i++)selected[i].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},selected[i].hoverable=hoverable,hover_callback&&(selected[i].hover_callback=hover_callback),unhover_callback&&(selected[i].unhover_callback=unhover_callback);len>0&&(molObj=null)}},this.setColorByElement=function(sel,colors){if(null===molObj||!sameObj(colors,lastColors)){lastColors=colors;var atoms=this.selectedAtoms(sel,atoms);atoms.length>0&&(molObj=null);for(var i=0;i<atoms.length;i++){var a=atoms[i];void 0!==colors[a.elem]&&(a.color=colors[a.elem])}}},this.setColorByProperty=function(sel,prop,scheme,range){var i,a,atoms=this.selectedAtoms(sel,atoms);for(lastColors=null,atoms.length>0&&(molObj=null),void 0!==$3Dmol.Gradient.builtinGradients[scheme]&&(scheme=new $3Dmol.Gradient.builtinGradients[scheme]),range||(range=scheme.range()),range||(range=$3Dmol.getPropertyRange(atoms,prop)),i=0;i<atoms.length;i++)a=atoms[i],null!=$3Dmol.getAtomProperty(a,prop)&&(a.color=scheme.valueToHex(parseFloat(a.properties[prop]),range))},this.setColorByFunction=function(sel,colorfun){var atoms=this.selectedAtoms(sel,atoms);if("function"==typeof colorfun)for(lastColors=null,atoms.length>0&&(molObj=null),i=0;i<atoms.length;i++)a=atoms[i],a.color=colorfun(a)},this.toCDObject=function(includeStyles){var out={a:[],b:[]};includeStyles&&(out.s=[]);for(var i=0;i<atoms.length;i++){var atomJSON={},atom=atoms[i];if(atomJSON.x=atom.x,atomJSON.y=atom.y,atomJSON.z=atom.z,"C"!=atom.elem&&(atomJSON.l=atom.elem),includeStyles){for(var s=0;s<out.s.length&&JSON.stringify(atom.style)!==JSON.stringify(out.s[s]);)s++;s===out.s.length&&out.s.push(atom.style),0!==s&&(atomJSON.s=s)}out.a.push(atomJSON);for(var b=0;b<atom.bonds.length;b++){var firstAtom=i,secondAtom=atom.bonds[b];if(!(firstAtom>=secondAtom)){var bond={b:firstAtom,e:secondAtom},bondOrder=atom.bondOrder[b];1!=bondOrder&&(bond.o=bondOrder),out.b.push(bond)}}}return out},this.globj=function(group,options){new Date;if(null===molObj){molObj=createMolObj(atoms,options);new Date;renderedMolObj&&(group.remove(renderedMolObj),renderedMolObj=null),renderedMolObj=molObj.clone(),hidden&&(renderedMolObj.setVisible(!1),molObj.setVisible(!1)),group.add(renderedMolObj)}},this.removegl=function(group){renderedMolObj&&(void 0!==renderedMolObj.geometry&&renderedMolObj.geometry.dispose(),void 0!==renderedMolObj.material&&renderedMolObj.material.dispose(),group.remove(renderedMolObj),renderedMolObj=null),molObj=null},this.hide=function(){hidden=!0,renderedMolObj&&renderedMolObj.setVisible(!1),molObj&&molObj.setVisible(!1)},this.show=function(){hidden=!1,renderedMolObj&&renderedMolObj.setVisible(!0),molObj&&molObj.setVisible(!0)},this.addResLabels=function(sel,viewer,style){for(var atoms=this.selectedAtoms(sel,atoms),bylabel={},i=0;i<atoms.length;i++){var c=(a=atoms[i]).chain,label=a.resn+""+a.resi;bylabel[c]||(bylabel[c]={}),bylabel[c][label]||(bylabel[c][label]=[]),bylabel[c][label].push(a)}var mystyle=$.extend(!0,{},style);for(var c in bylabel)if(bylabel.hasOwnProperty(c)){var labels=bylabel[c];for(var label in labels)if(labels.hasOwnProperty(label)){for(var atoms=labels[label],sum=new $3Dmol.Vector3(0,0,0),i=0;i<atoms.length;i++){var a=atoms[i];sum.x+=a.x,sum.y+=a.y,sum.z+=a.z}sum.divideScalar(atoms.length),mystyle.position=sum,viewer.addLabel(label,mystyle)}}};var setupDFS=function(){atomdfs=[];var visited=new Int8Array(atoms.length);visited.fill(0);for(var search=function(i,prev,component){component.push([i,prev]);var atom=atoms[i];visited[i]=1;for(var b=0;b<atom.bonds.length;b++){var nexti=atom.bonds[b];atoms[nexti]&&!visited[nexti]&&search(nexti,i,component)}},i=0;i<atoms.length;i++)if(atoms[i]&&!visited[i]){var component=[];search(i,-1,component),atomdfs.push(component)}};this.setCoordinatesFromURL=function(url,path){atoms.length;frames=[];var self=this;return box&&setupDFS(),new Promise(function(resolve,reject){url.startsWith("http://")||(url="http://"+url),$.get(url+"/traj/numframes/"+path,function(numFrames){isNaN(parseInt(numFrames))||(frames.push(atoms),frames.numFrames=numFrames,frames.url=url,frames.path=path,self.setFrame(0).then(function(){resolve()}).catch(reject))})})},this.setCoordinates=function(str,format){if(format=format||"",!str)return[];if(/\.gz$/.test(format)){format=format.replace(/\.gz$/,"");try{str=pako.inflate(str,{to:"string"})}catch(err){console.log(err)}}if({mdcrd:"",inpcrd:"",pdb:"",netcdf:""}.hasOwnProperty(format)){frames=[];for(var atomCount=atoms.length,values=GLModel.parseCrd(str,format),count=0;count<values.length;){for(var temp=[],i=0;i<atomCount;i++){var newAtom={};for(var k in atoms[i])newAtom[k]=atoms[i][k];temp[i]=newAtom,temp[i].x=values[count++],temp[i].y=values[count++],temp[i].z=values[count++]}frames.push(temp)}return atoms=frames[0],frames}return[]},this.addAtomSpecs=function(customAtomSpecs){for(var i=0;i<customAtomSpecs.length;i++)GLModel.validAtomSelectionSpecs.hasOwnProperty(customAtomSpecs[i])&&GLModel.validAtomSelectionSpecs.push(customAtomSpecs[i])}}var defaultAtomStyle={line:{}},defaultlineWidth=1,vdwRadii={H:1.2,Li:1.82,LI:1.82,Na:2.27,NA:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,Cl:1.75,BR:1.85,Br:1.85,SE:1.9,Se:1.9,ZN:1.39,Zn:1.39,CU:1.4,Cu:1.4,NI:1.63,Ni:1.63};GLModel.validElements=["H","Li","LI","Na","NA","K","C","N","O","F","P","S","CL","Cl","BR","Br","SE","Se","ZN","Zn","CU","Cu","NI","Ni"],GLModel.validAtomSpecs={resn:{type:"string",valid:!0},x:{type:"number",valid:!1,step:.1},y:{type:"number",valid:!1,step:.1},z:{type:"number",valid:!1,step:.1},color:{type:"color",gui:!0},surfaceColor:{type:"color",gui:!0},elem:{type:"element",gui:!0},hetflag:{type:"boolean",valid:!1},chain:{type:"string",gui:!0},resi:{type:"number",gui:!0},icode:{type:"number",valid:!1,step:.1},rescode:{type:"number",valid:!1,step:.1},serial:{type:"number",valid:!1,step:.1},atom:{type:"string",valid:!1},bonds:{type:"array",valid:!1},ss:{type:"string",valid:!1},singleBonds:{type:"boolean",valid:!1},bondOrder:{type:"array",valid:!1},properties:{type:"properties",valid:!1},b:{type:"number",valid:!1,step:.1},pdbline:{type:"string",valid:!1},clickable:{type:"boolean",valid:!1},callback:{type:"function",valid:!1},invert:{type:"boolean",valid:!1},reflectivity:{type:"number",gui:!0,step:.1},altLoc:{type:"invalid",valid:!1}};var validExtras={model:{type:"string",valid:!1},bonds:{type:"string",valid:!1},predicate:{type:"string",valid:!1},invert:{type:"string",valid:!1},byres:{type:"string",valid:!1},expand:{type:"string",valid:!1},within:{type:"string",valid:!1},and:{type:"string",valid:!1},or:{type:"string",valid:!1},not:{type:"string",valid:!1}};GLModel.validAtomSelectionSpecs=function(obj1,src1){for(var key in src1)src1.hasOwnProperty(key)&&(obj1[key]=src1[key]);return obj1}(GLModel.validAtomSpecs,validExtras);var validLineSpec={hidden:{type:"boolean",gui:!0},linewidth:{type:"number",gui:!0,step:.1,default:defaultlineWidth},colorscheme:{type:"colorscheme",gui:!0},color:{type:"color",gui:!0}},validCrossSpec={hidden:{type:"boolean",gui:!0},linewidth:{type:"number",gui:!1,step:.1,default:defaultlineWidth,min:0},colorscheme:{type:"colorscheme",gui:!0},color:{type:"color",gui:!0},radius:{type:"number",gui:!0,step:.1,default:1,min:.1},scale:{type:"number",gui:!0,step:.1,default:1,min:0}},validStickSpec={hidden:{type:"boolean",gui:!0},colorscheme:{type:"colorscheme",gui:!0},color:{type:"color",gui:!0},radius:{type:"number",gui:!0,step:.1,default:.25,min:.1},singleBonds:{type:"boolean",gui:!0}},validSphereSpec={hidden:{type:"boolean",gui:!0},singleBonds:{type:"boolean",gui:!0},colorscheme:{type:"colorscheme",gui:!0},color:{type:"color",gui:!0},radius:{type:"number",gui:!0,step:.1,default:1.5,min:0}},validCartoonSpec={style:{validItems:["trace","oval","rectangle","parabola","edged"],gui:!0},color:{type:"color",gui:!0},arrows:{type:"boolean",gui:!0},ribbon:{type:"boolean",gui:!0},hidden:{type:"boolean",gui:!0},tubes:{type:"boolean",gui:!0},thickness:{type:"number",gui:!0,step:.1,default:1,min:0},width:{type:"number",gui:!0,step:.1,default:1,min:0},opacity:{type:"number",gui:!0,step:.1,default:1,min:0,max:1}};GLModel.validAtomStyleSpecs={line:{validItems:validLineSpec,gui:!0},cross:{validItems:validCrossSpec,gui:!0},stick:{validItems:validStickSpec,gui:!0},sphere:{validItems:validSphereSpec,gui:!0},cartoon:{validItems:validCartoonSpec,gui:!0},colorfunc:{validItems:null,valid:!1}},GLModel.validSurfaceSpecs={opacity:{type:"number",gui:!0,step:.1,default:1,min:0,max:1},colorscheme:{type:"colorscheme",gui:!0},color:{type:"color",gui:!0},voldata:{type:"number",gui:!1},volscheme:{type:"number",gui:!1},map:{type:"number",gui:!1}},GLModel.validLabelResSpecs={font:{type:"string",gui:!0},fontSize:{type:"number",gui:!0,step:1,default:12,min:1},fontColor:{type:"color",gui:!0},fontOpacity:{type:"number",gui:!0,step:.1,default:1,min:0,max:1},borderThickness:{type:"number",gui:!0,step:.1,default:1,min:0},borderColor:{type:"color",gui:!0},borderOpacity:{type:"number",gui:!0,step:.1,default:1,min:0,max:1},backgroundColor:{type:"color",gui:!0},backgroundOpacity:{type:"number",gui:!0,step:.1,default:1,min:0,max:1},position:{type:"array",valid:!1},inFront:{type:"boolean",gui:!0},showBackground:{type:"boolean",gui:!0},fixed:{type:"boolean",gui:!0},alignment:{validItems:["topLeft","topCenter","topRight","centerLeft","center","centerRight","bottomLeft","bottomCenter","bottomRight"],gui:!0},scale:{type:"boolean",gui:!1}};var sameObj=function(a,b){return a&&b?JSON.stringify(a)==JSON.stringify(b):a==b};return GLModel.parseCrd=function(data,format){var values=[],counter=0;if("pdb"==format)for(index=data.indexOf("\nATOM");-1!=index;){for(;"\nATOM"==data.slice(index,index+5)||"\nHETATM"==data.slice(index,index+7);)values[counter++]=parseFloat(data.slice(index+31,index+39)),values[counter++]=parseFloat(data.slice(index+39,index+47)),values[counter++]=parseFloat(data.slice(index+47,index+55)),index=data.indexOf("\n",index+54),"\nTER"==data.slice(index,index+4)&&(index=data.indexOf("\n",index+5));index=data.indexOf("\nATOM",index)}else if("netcdf"==format){var reader=new netcdfjs(data);values=[].concat.apply([],reader.getDataVariable("coordinates"))}else{var index=data.indexOf("\n");"inpcrd"==format&&(index=data.indexOf("\n",index+1)),values=(data=data.slice(index+1)).match(/\S+/g).map(parseFloat)}return values},GLModel.parseMolData=function(data,format,options){if(format=format||"",!data)return[];if(/\.gz$/.test(format)){format=format.replace(/\.gz$/,"");try{data=pako.inflate(data,{to:"string"})}catch(err){console.log(err)}}return void 0===$3Dmol.Parsers[format]&&(format=format.split(".").pop(),void 0===$3Dmol.Parsers[format]&&(console.log("Unknown format: "+format),format=data.match(/^@<TRIPOS>MOLECULE/gm)?"mol2":data.match(/^HETATM/gm)||data.match(/^ATOM/gm)?"pdb":data.match(/ITEM: TIMESTEP/gm)?"lammpstrj":data.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?"sdf":data.match(/^%VERSION\s+\VERSION_STAMP/gm)?"prmtop":"xyz",console.log("Best guess: "+format))),(0,$3Dmol.Parsers[format])(data,options)},GLModel.setAtomDefaults=function(atoms,id){for(var i=0;i<atoms.length;i++){var atom=atoms[i];atom&&(atom.style=atom.style||defaultAtomStyle,atom.color=atom.color||ElementColors[atom.elem]||defaultColor,atom.model=id,(atom.clickable||atom.hoverable)&&(atom.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}},GLModel}(),$3Dmol.GLShape=function(){function GLShape(stylespec){stylespec=stylespec||{},$3Dmol.ShapeIDCount++,this.boundingSphere=new $3Dmol.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},updateFromStyle(this,stylespec);var components=[],shapeObj=null,renderedShapeObj=null,geo=new $3Dmol.Geometry(!0),linegeo=new $3Dmol.Geometry(!0);this.updateStyle=function(newspec){for(var prop in newspec)stylespec[prop]=newspec[prop];updateFromStyle(this,stylespec)},this.addCustom=function(customSpec){customSpec.vertexArr=customSpec.vertexArr||[],customSpec.faceArr=customSpec.faceArr||[],customSpec.normalArr=customSpec.normalArr||[];geo.geometryGroups.length;drawCustom(this,geo,customSpec)},this.addSphere=function(sphereSpec){sphereSpec.center=sphereSpec.center||{x:0,y:0,z:0},sphereSpec.radius=sphereSpec.radius?$3Dmol.Math.clamp(sphereSpec.radius,0,1/0):1.5,sphereSpec.color=$3Dmol.CC.color(sphereSpec.color),this.intersectionShape.sphere.push(new $3Dmol.Sphere(sphereSpec.center,sphereSpec.radius)),$3Dmol.GLDraw.drawSphere(geo,sphereSpec.center,sphereSpec.radius,sphereSpec.color),components.push({centroid:new $3Dmol.Vector3(sphereSpec.center.x,sphereSpec.center.y,sphereSpec.center.z)});var geoGroup=geo.updateGeoGroup(0);updateBoundingFromPoints(this.boundingSphere,components,geoGroup.vertexArray)},this.addCylinder=function(cylinderSpec){cylinderSpec.start=cylinderSpec.start||{},cylinderSpec.end=cylinderSpec.end||{};var start=new $3Dmol.Vector3(cylinderSpec.start.x||0,cylinderSpec.start.y||0,cylinderSpec.start.z||0),end=new $3Dmol.Vector3(cylinderSpec.end.x,cylinderSpec.end.y||0,cylinderSpec.end.z||0);void 0===end.x&&(end.x=3);var radius=cylinderSpec.radius||.1,color=$3Dmol.CC.color(cylinderSpec.color);this.intersectionShape.cylinder.push(new $3Dmol.Cylinder(start,end,radius)),$3Dmol.GLDraw.drawCylinder(geo,start,end,radius,color,cylinderSpec.fromCap,cylinderSpec.toCap);var centroid=new $3Dmol.Vector3;components.push({centroid:centroid.addVectors(start,end).multiplyScalar(.5)});var geoGroup=geo.updateGeoGroup(0);updateBoundingFromPoints(this.boundingSphere,components,geoGroup.vertexArray)},this.addDashedCylinder=function(cylinderSpec){cylinderSpec.start=cylinderSpec.start||{},cylinderSpec.end=cylinderSpec.end||{},cylinderSpec.dashLength=cylinderSpec.dashLength||.25,cylinderSpec.gapLength=cylinderSpec.gapLength||.25;var start=new $3Dmol.Vector3(cylinderSpec.start.x||0,cylinderSpec.start.y||0,cylinderSpec.start.z||0),end=new $3Dmol.Vector3(cylinderSpec.end.x,cylinderSpec.end.y||0,cylinderSpec.end.z||0);void 0===end.x&&(end.x=3);for(var radius=cylinderSpec.radius||.1,color=$3Dmol.CC.color(cylinderSpec.color),cylinderLength=Math.sqrt(Math.pow(start.x-end.x,2)+Math.pow(start.y-end.y,2)+Math.pow(start.z-end.z,2)),count=cylinderLength/(cylinderSpec.gapLength+cylinderSpec.dashLength),new_start=new $3Dmol.Vector3(cylinderSpec.start.x||0,cylinderSpec.start.y||0,cylinderSpec.start.z||0),new_end=new $3Dmol.Vector3(cylinderSpec.end.x,cylinderSpec.end.y||0,cylinderSpec.end.z||0),gapVector=new $3Dmol.Vector3((end.x-start.x)/(cylinderLength/cylinderSpec.gapLength),(end.y-start.y)/(cylinderLength/cylinderSpec.gapLength),(end.z-start.z)/(cylinderLength/cylinderSpec.gapLength)),dashVector=new $3Dmol.Vector3((end.x-start.x)/(cylinderLength/cylinderSpec.dashLength),(end.y-start.y)/(cylinderLength/cylinderSpec.dashLength),(end.z-start.z)/(cylinderLength/cylinderSpec.dashLength)),place=0;place<count;place++)new_end=new $3Dmol.Vector3(new_start.x+dashVector.x,new_start.y+dashVector.y,new_start.z+dashVector.z),this.intersectionShape.cylinder.push(new $3Dmol.Cylinder(new_start,new_end,radius)),$3Dmol.GLDraw.drawCylinder(geo,new_start,new_end,radius,color,cylinderSpec.fromCap,cylinderSpec.toCap),new_start=new $3Dmol.Vector3(new_end.x+gapVector.x,new_end.y+gapVector.y,new_end.z+gapVector.z);var centroid=new $3Dmol.Vector3;components.push({centroid:centroid.addVectors(start,end).multiplyScalar(.5)});var geoGroup=geo.updateGeoGroup(0);updateBoundingFromPoints(this.boundingSphere,components,geoGroup.vertexArray)},this.addLine=function(lineSpec){lineSpec.start=lineSpec.start||{},lineSpec.end=lineSpec.end||{};var start=new $3Dmol.Vector3(lineSpec.start.x||0,lineSpec.start.y||0,lineSpec.start.z||0),end=new $3Dmol.Vector3(lineSpec.end.x,lineSpec.end.y||0,lineSpec.end.z||0);void 0===end.x&&(end.x=3);var vstart=(geoGroup=geo.updateGeoGroup(2)).vertices,i=3*vstart,vertexArray=geoGroup.vertexArray;vertexArray[i]=start.x,vertexArray[i+1]=start.y,vertexArray[i+2]=start.z,vertexArray[i+3]=end.x,vertexArray[i+4]=end.y,vertexArray[i+5]=end.z,geoGroup.vertices+=2;var lineArray=geoGroup.lineArray,li=geoGroup.lineidx;lineArray[li]=vstart,lineArray[li+1]=vstart+1,geoGroup.lineidx+=2;var centroid=new $3Dmol.Vector3;components.push({centroid:centroid.addVectors(start,end).multiplyScalar(.5)});var geoGroup=geo.updateGeoGroup(0);updateBoundingFromPoints(this.boundingSphere,components,geoGroup.vertexArray)},this.addArrow=function(arrowSpec){if(arrowSpec.start=arrowSpec.start||{},arrowSpec.end=arrowSpec.end||{},arrowSpec.start=new $3Dmol.Vector3(arrowSpec.start.x||0,arrowSpec.start.y||0,arrowSpec.start.z||0),arrowSpec.dir instanceof $3Dmol.Vector3&&arrowSpec.length instanceof number){var end=arrowSpec.dir.clone().multiplyScalar(arrowSpec.length).add(start);arrowSpec.end=end}else arrowSpec.end=new $3Dmol.Vector3(arrowSpec.end.x,arrowSpec.end.y||0,arrowSpec.end.z||0),void 0===arrowSpec.end.x&&(arrowSpec.end.x=3);arrowSpec.radius=arrowSpec.radius||.1,arrowSpec.radiusRatio=arrowSpec.radiusRatio||1.618034,arrowSpec.mid=0<arrowSpec.mid&&arrowSpec.mid<1?arrowSpec.mid:.618034,drawArrow(this,geo,arrowSpec);var centroid=new $3Dmol.Vector3;components.push({centroid:centroid.addVectors(arrowSpec.start,arrowSpec.end).multiplyScalar(.5)});var geoGroup=geo.updateGeoGroup(0);updateBoundingFromPoints(this.boundingSphere,components,geoGroup.vertexArray)},this.addIsosurface=function(data,volSpec,callback){var il,isoval=void 0!==volSpec.isoval&&"number"==typeof volSpec.isoval?volSpec.isoval:0,voxel=!!volSpec.voxel,smoothness=void 0===volSpec.smoothness?1:volSpec.smoothness,nX=data.size.x,nY=data.size.y,nZ=data.size.z,vertnums=new Int16Array(nX*nY*nZ),vals=data.data;for(i=0,il=vertnums.length;i<il;++i)vertnums[i]=-1;var bitdata=new Uint8Array(nX*nY*nZ);for(i=0,il=vals.length;i<il;++i)(isoval>=0?vals[i]-isoval:isoval-vals[i])>0&&(bitdata[i]|=ISDONE);var verts=[],faces=[];$3Dmol.MarchingCube.march(bitdata,verts,faces,{fulltable:!0,voxel:voxel,unitCube:data.unit,origin:data.origin,matrix:data.matrix,nX:nX,nY:nY,nZ:nZ}),!voxel&&smoothness>0&&$3Dmol.MarchingCube.laplacianSmooth(smoothness,verts,faces);var vertexmapping=[],newvertices=[],newfaces=[];if(volSpec.selectedRegion&&void 0===volSpec.coords&&(volSpec.coords=volSpec.selectedRegion),void 0!==volSpec.coords){for(var xmax=volSpec.coords[0].x,ymax=volSpec.coords[0].y,zmax=volSpec.coords[0].z,xmin=volSpec.coords[0].x,ymin=volSpec.coords[0].y,zmin=volSpec.coords[0].z,i=0;i<volSpec.coords.length;i++)volSpec.coords[i].x>xmax?xmax=volSpec.coords[i].x:volSpec.coords[i].x<xmin&&(xmin=volSpec.coords[i].x),volSpec.coords[i].y>ymax?ymax=volSpec.coords[i].y:volSpec.coords[i].y<ymin&&(ymin=volSpec.coords[i].y),volSpec.coords[i].z>zmax?zmax=volSpec.coords[i].z:volSpec.coords[i].z<zmin&&(zmin=volSpec.coords[i].z);var rad=2;void 0!==volSpec.radius&&(rad=volSpec.radius),void 0!==volSpec.selectedOffset&&(rad=volSpec.selectedOffset),void 0!==volSpec.seldist&&(rad=volSpec.seldist),xmin-=rad,xmax+=rad,ymin-=rad,ymax+=rad,zmin-=rad,zmax+=rad;for(i=0;i<verts.length;i++)verts[i].x>xmin&&verts[i].x<xmax&&verts[i].y>ymin&&verts[i].y<ymax&&verts[i].z>zmin&&verts[i].z<zmax&&inSelectedRegion(verts[i],volSpec.coords,rad)?(vertexmapping.push(newvertices.length),newvertices.push(verts[i])):vertexmapping.push(-1);for(i=0;i+2<faces.length;i+=3)-1!==vertexmapping[faces[i]]&&-1!==vertexmapping[faces[i+1]]&&-1!==vertexmapping[faces[i+2]]&&(newfaces.push(faces[i]-(faces[i]-vertexmapping[faces[i]])),newfaces.push(faces[i+1]-(faces[i+1]-vertexmapping[faces[i+1]])),newfaces.push(faces[i+2]-(faces[i+2]-vertexmapping[faces[i+2]])));verts=newvertices,faces=newfaces}drawCustom(this,geo,{vertexArr:verts,faceArr:faces,normalArr:[],clickable:volSpec.clickable,hoverable:volSpec.hoverable}),this.updateStyle(volSpec);for(var origin=new $3Dmol.Vector3(data.origin.x,data.origin.y,data.origin.z),size=new $3Dmol.Vector3(data.size.x*data.unit.x,data.size.y*data.unit.y,data.size.z*data.unit.z),total=new $3Dmol.Vector3(0,0,0),maxv=origin.clone(),minv=origin.clone().add(size),i=0;i<verts.length;i++)total.add(verts[i]),maxv.max(verts[i]),minv.min(verts[i]);total.divideScalar(verts.length);var len1=total.distanceTo(minv),len2=total.distanceTo(maxv);this.boundingSphere.center=total,this.boundingSphere.radius=Math.max(len1,len2),"function"==typeof callback&&callback()};var inSelectedRegion=function(coordinate,selectedRegion,radius){for(var i=0;i<selectedRegion.length;i++)if(distance_from(selectedRegion[i],coordinate)<=radius)return!0;return!1},distance_from=function(c1,c2){return Math.sqrt(Math.pow(c1.x-c2.x,2)+Math.pow(c1.y-c2.y,2)+Math.pow(c1.z-c2.z,2))};this.addVolumetricData=function(data,fmt,volSpec){var data=new $3Dmol.VolumeData(data,fmt);this.addIsosurface(data,volSpec)},this.globj=function(group){if(renderedShapeObj&&(group.remove(renderedShapeObj),renderedShapeObj=null),!this.hidden){finalizeGeo(geo),geo.initTypedArrays(),void 0!==this.color&&updateColor(geo,this.color),shapeObj=new $3Dmol.Object3D;material=null;if(this.side==$3Dmol.DoubleSide)material=new $3Dmol.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth});else var material=new $3Dmol.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth});var mesh=new $3Dmol.Mesh(geo,material);shapeObj.add(mesh);var lineMaterial=new $3Dmol.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),line=new $3Dmol.Line(linegeo,lineMaterial,$3Dmol.LinePieces);shapeObj.add(line),renderedShapeObj=shapeObj.clone(),group.add(renderedShapeObj)}},this.removegl=function(group){renderedShapeObj&&(void 0!==renderedShapeObj.geometry&&renderedShapeObj.geometry.dispose(),void 0!==renderedShapeObj.material&&renderedShapeObj.material.dispose(),group.remove(renderedShapeObj),renderedShapeObj=null),shapeObj=null}}var ISDONE=2,finalizeGeo=function(geo){var geoGroup=geo.updateGeoGroup(0);geoGroup.vertices>0&&geoGroup.truncateArrayBuffers(!0,!0)},updateColor=function(geo,color){color||$3Dmol.CC.color(color);geo.colorsNeedUpdate=!0;var r,g,b;color.constructor!==Array&&(r=color.r,g=color.g,b=color.b);for(var gg in geo.geometryGroups)for(var geoGroup=geo.geometryGroups[gg],colorArr=geoGroup.colorArray,i=0,il=geoGroup.vertices;i<il;++i){if(color.constructor===Array){var c=color[i];r=c.r,g=c.g,b=c.b}colorArr[3*i]=r,colorArr[3*i+1]=g,colorArr[3*i+2]=b}},drawArrow=function(shape,geo,spec){var from=spec.start,end=spec.end,radius=spec.radius,radiusRatio=spec.radiusRatio,mid=spec.mid;if(from&&end){var geoGroup=geo.updateGeoGroup(51),dir=end.clone();dir.sub(from).multiplyScalar(mid);var to=from.clone().add(dir),negDir=dir.clone().negate();shape.intersectionShape.cylinder.push(new $3Dmol.Cylinder(from.clone(),to.clone(),radius)),shape.intersectionShape.sphere.push(new $3Dmol.Sphere(from.clone(),radius));var nvecs=[];nvecs[0]=dir.clone(),Math.abs(nvecs[0].x)>1e-4?nvecs[0].y+=1:nvecs[0].x+=1,nvecs[0].cross(dir),nvecs[0].normalize(),nvecs[0]=nvecs[0],nvecs[4]=nvecs[0].clone(),nvecs[4].crossVectors(nvecs[0],dir),nvecs[4].normalize(),nvecs[8]=nvecs[0].clone().negate(),nvecs[12]=nvecs[4].clone().negate(),nvecs[2]=nvecs[0].clone().add(nvecs[4]).normalize(),nvecs[6]=nvecs[4].clone().add(nvecs[8]).normalize(),nvecs[10]=nvecs[8].clone().add(nvecs[12]).normalize(),nvecs[14]=nvecs[12].clone().add(nvecs[0]).normalize(),nvecs[1]=nvecs[0].clone().add(nvecs[2]).normalize(),nvecs[3]=nvecs[2].clone().add(nvecs[4]).normalize(),nvecs[5]=nvecs[4].clone().add(nvecs[6]).normalize(),nvecs[7]=nvecs[6].clone().add(nvecs[8]).normalize(),nvecs[9]=nvecs[8].clone().add(nvecs[10]).normalize(),nvecs[11]=nvecs[10].clone().add(nvecs[12]).normalize(),nvecs[13]=nvecs[12].clone().add(nvecs[14]).normalize(),nvecs[15]=nvecs[14].clone().add(nvecs[0]).normalize();var offset,i,n,start=geoGroup.vertices,vertexArray=geoGroup.vertexArray,faceArray=(geoGroup.colorArray,geoGroup.faceArray),normalArray=geoGroup.normalArray,lineArray=geoGroup.lineArray;for(i=0,n=nvecs.length;i<n;++i){offset=3*(start+3*i);var bottom=nvecs[i].clone().multiplyScalar(radius).add(from),top=nvecs[i].clone().multiplyScalar(radius).add(to),conebase=nvecs[i].clone().multiplyScalar(radius*radiusRatio).add(to);if(vertexArray[offset]=bottom.x,vertexArray[offset+1]=bottom.y,vertexArray[offset+2]=bottom.z,vertexArray[offset+3]=top.x,vertexArray[offset+4]=top.y,vertexArray[offset+5]=top.z,vertexArray[offset+6]=conebase.x,vertexArray[offset+7]=conebase.y,vertexArray[offset+8]=conebase.z,i>0){var prev_x=vertexArray[offset-3],prev_y=vertexArray[offset-2],prev_z=vertexArray[offset-1],c=new $3Dmol.Vector3(prev_x,prev_y,prev_z),b=end.clone(),b2=to.clone(),a=new $3Dmol.Vector3(conebase.x,conebase.y,conebase.z);shape.intersectionShape.triangle.push(new $3Dmol.Triangle(a,b,c)),shape.intersectionShape.triangle.push(new $3Dmol.Triangle(c.clone(),b2,a.clone()))}}geoGroup.vertices+=48,vertexArray[offset=3*geoGroup.vertices]=from.x,vertexArray[offset+1]=from.y,vertexArray[offset+2]=from.z,vertexArray[offset+3]=to.x,vertexArray[offset+4]=to.y,vertexArray[offset+5]=to.z,vertexArray[offset+6]=end.x,vertexArray[offset+7]=end.y,vertexArray[offset+8]=end.z,geoGroup.vertices+=3;var face,faceoffset,lineoffset,t1,t2,t2b,t3,t3b,t4,t1offset,t2offset,t2boffset,t3offset,t3boffset,t4offset,n1,n2,n3,n4,fromi=geoGroup.vertices-3,toi=geoGroup.vertices-2,endi=geoGroup.vertices-1,fromoffset=3*fromi,tooffset=3*toi,endoffset=3*endi;for(i=0,n=nvecs.length-1;i<n;++i){var ti=start+3*i;offset=3*ti,faceoffset=geoGroup.faceidx,lineoffset=geoGroup.lineidx,t1offset=3*(t1=ti),t2offset=3*(t2=ti+1),t2boffset=3*(t2b=ti+2),t3offset=3*(t3=ti+4),t3boffset=3*(t3b=ti+5),t4offset=3*(t4=ti+3),[nvecs[i],nvecs[i],nvecs[i+1],nvecs[i+1]],n1=n2=nvecs[i],n3=n4=nvecs[i+1],normalArray[t1offset]=n1.x,normalArray[t2offset]=n2.x,normalArray[t4offset]=n4.x,normalArray[t1offset+1]=n1.y,normalArray[t2offset+1]=n2.y,normalArray[t4offset+1]=n4.y,normalArray[t1offset+2]=n1.z,normalArray[t2offset+2]=n2.z,normalArray[t4offset+2]=n4.z,normalArray[t2offset]=n2.x,normalArray[t3offset]=n3.x,normalArray[t4offset]=n4.x,normalArray[t2offset+1]=n2.y,normalArray[t3offset+1]=n3.y,normalArray[t4offset+1]=n4.y,normalArray[t2offset+2]=n2.z,normalArray[t3offset+2]=n3.z,normalArray[t4offset+2]=n4.z,normalArray[t2boffset]=n2.x,normalArray[t3boffset]=n3.x,normalArray[t2boffset+1]=n2.y,normalArray[t3boffset+1]=n3.y,normalArray[t2boffset+2]=n2.z,normalArray[t3boffset+2]=n3.z,faceArray[faceoffset]=t1,faceArray[faceoffset+1]=t2,faceArray[faceoffset+2]=t4,faceArray[faceoffset+3]=t2,faceArray[faceoffset+4]=t3,faceArray[faceoffset+5]=t4,faceArray[faceoffset+6]=t1,faceArray[faceoffset+7]=t4,faceArray[faceoffset+8]=fromi,faceArray[faceoffset+9]=t2b,faceArray[faceoffset+10]=toi,faceArray[faceoffset+11]=t3b,faceArray[faceoffset+12]=t2b,faceArray[faceoffset+13]=endi,faceArray[faceoffset+14]=t3b,lineArray[lineoffset]=t1,lineArray[lineoffset+1]=t2,lineArray[lineoffset+2]=t1,lineArray[lineoffset+3]=t4,lineArray[lineoffset+4]=t3,lineArray[lineoffset+5]=t4,lineArray[lineoffset+6]=t1,lineArray[lineoffset+7]=t4,lineArray[lineoffset+8]=t2b,lineArray[lineoffset+9]=t2,lineArray[lineoffset+10]=t2b,lineArray[lineoffset+11]=t3b,lineArray[lineoffset+12]=t3,lineArray[lineoffset+13]=t3b,lineArray[lineoffset+14]=t2b,lineArray[lineoffset+15]=endi,lineArray[lineoffset+16]=t2b,lineArray[lineoffset+17]=t3b,lineArray[lineoffset+18]=endi,lineArray[lineoffset+19]=t3b,geoGroup.faceidx+=15,geoGroup.lineidx+=20}face=[start+45,start+46,start+1,start,start+47,start+2],[nvecs[15],nvecs[15],nvecs[0],nvecs[0]],faceoffset=geoGroup.faceidx,lineoffset=geoGroup.lineidx,t1offset=3*(t1=face[0]),t2offset=3*(t2=face[1]),t2boffset=3*(t2b=face[4]),t3offset=3*(t3=face[2]),t3boffset=3*(t3b=face[5]),t4offset=3*(t4=face[3]),n1=n2=nvecs[15],n3=n4=nvecs[0],normalArray[t1offset]=n1.x,normalArray[t2offset]=n2.x,normalArray[t4offset]=n4.x,normalArray[t1offset+1]=n1.y,normalArray[t2offset+1]=n2.y,normalArray[t4offset+1]=n4.y,normalArray[t1offset+2]=n1.z,normalArray[t2offset+2]=n2.z,normalArray[t4offset+2]=n4.z,normalArray[t2offset]=n2.x,normalArray[t3offset]=n3.x,normalArray[t4offset]=n4.x,normalArray[t2offset+1]=n2.y,normalArray[t3offset+1]=n3.y,normalArray[t4offset+1]=n4.y,normalArray[t2offset+2]=n2.z,normalArray[t3offset+2]=n3.z,normalArray[t4offset+2]=n4.z,normalArray[t2boffset]=n2.x,normalArray[t3boffset]=n3.x,normalArray[t2boffset+1]=n2.y,normalArray[t3boffset+1]=n3.y,normalArray[t2boffset+2]=n2.z,normalArray[t3boffset+2]=n3.z,dir.normalize(),negDir.normalize(),normalArray[fromoffset]=negDir.x,normalArray[tooffset]=normalArray[endoffset]=dir.x,normalArray[fromoffset+1]=negDir.y,normalArray[tooffset+1]=normalArray[endoffset+1]=dir.y,normalArray[fromoffset+2]=negDir.z,normalArray[tooffset+2]=normalArray[endoffset+2]=dir.z,faceArray[faceoffset]=t1,faceArray[faceoffset+1]=t2,faceArray[faceoffset+2]=t4,faceArray[faceoffset+3]=t2,faceArray[faceoffset+4]=t3,faceArray[faceoffset+5]=t4,faceArray[faceoffset+6]=t1,faceArray[faceoffset+7]=t4,faceArray[faceoffset+8]=fromi,faceArray[faceoffset+9]=t2b,faceArray[faceoffset+10]=toi,faceArray[faceoffset+11]=t3b,faceArray[faceoffset+12]=t2b,faceArray[faceoffset+13]=endi,faceArray[faceoffset+14]=t3b,lineArray[lineoffset]=t1,lineArray[lineoffset+1]=t2,lineArray[lineoffset+2]=t1,lineArray[lineoffset+3]=t4,lineArray[lineoffset+4]=t3,lineArray[lineoffset+5]=t4,lineArray[lineoffset+6]=t1,lineArray[lineoffset+7]=t4,lineArray[lineoffset+8]=t2b,lineArray[lineoffset+9]=t2,lineArray[lineoffset+10]=t2b,lineArray[lineoffset+11]=t3b,lineArray[lineoffset+12]=t3,lineArray[lineoffset+13]=t3b,lineArray[lineoffset+14]=t2b,lineArray[lineoffset+15]=endi,lineArray[lineoffset+16]=t2b,lineArray[lineoffset+17]=t3b,lineArray[lineoffset+18]=endi,lineArray[lineoffset+19]=t3b,geoGroup.faceidx+=15,geoGroup.lineidx+=20}},addCustomGeo=function(shape,geo,mesh,color,clickable){var geoGroup=geo.addGeoGroup(),vertexArr=mesh.vertexArr,normalArr=mesh.normalArr,faceArr=mesh.faceArr;geoGroup.vertices=vertexArr.length,geoGroup.faceidx=faceArr.length;var offset,v,a,c,i,il,vertexArray=geoGroup.vertexArray,colorArray=geoGroup.colorArray;if(color.constructor!==Array)var r=color.r,g=color.g,b=color.b;for(i=0,il=geoGroup.vertices;i<il;++i){if(offset=3*i,v=vertexArr[i],vertexArray[offset]=v.x,vertexArray[offset+1]=v.y,vertexArray[offset+2]=v.z,color.constructor===Array)var r=(c=color[i]).r,g=c.g,b=c.b;colorArray[offset]=r,colorArray[offset+1]=g,colorArray[offset+2]=b}if(clickable)for(i=0,il=geoGroup.faceidx/3;i<il;++i){a=faceArr[offset=3*i],b=faceArr[offset+1],c=faceArr[offset+2];var vA=new $3Dmol.Vector3,vB=new $3Dmol.Vector3,vC=new $3Dmol.Vector3;shape.intersectionShape.triangle.push(new $3Dmol.Triangle(vA.copy(vertexArr[a]),vB.copy(vertexArr[b]),vC.copy(vertexArr[c])))}if(clickable){for(var center=new $3Dmol.Vector3(0,0,0),cnt=0,g=0;g<geo.geometryGroups.length;g++)center.add(geo.geometryGroups[g].getCentroid()),cnt++;center.divideScalar(cnt),updateBoundingFromPoints(shape.boundingSphere,{centroid:center},vertexArray)}if(geoGroup.faceArray=new Uint16Array(faceArr),geoGroup.truncateArrayBuffers(!0,!0),normalArr.length<geoGroup.vertices)geoGroup.setNormals();else{var n,normalArray=geoGroup.normalArray=new Float32Array(3*geoGroup.vertices);for(i=0,il=geoGroup.vertices;i<il;++i)offset=3*i,n=normalArr[i],normalArray[offset]=n.x,normalArray[offset+1]=n.y,normalArray[offset+2]=n.z}geoGroup.setLineIndices(),geoGroup.lineidx=geoGroup.lineArray.length},drawCustom=function(shape,geo,customSpec){var mesh=customSpec,vertexArr=mesh.vertexArr,faceArr=(mesh.normalArr,mesh.faceArr);0!==vertexArr.length&&0!==faceArr.length||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var color=customSpec.color;void 0===color&&(color=shape.color),color=$3Dmol.CC.color(color);for(var splits=$3Dmol.splitMesh(mesh),i=0,n=splits.length;i<n;i++)addCustomGeo(shape,geo,splits[i],splits[i].colorArr?splits[i].colorArr:color,customSpec.clickable)},updateBoundingFromPoints=function(sphere,components,points){sphere.center.set(0,0,0);var i,il;if(components.length>0){for(i=0,il=components.length;i<il;++i){var centroid=components[i].centroid;sphere.center.add(centroid)}sphere.center.divideScalar(components.length)}var maxRadiusSq=sphere.radius*sphere.radius;for(i=0,il=points.length/3;i<il;i++){var x=points[3*i],y=points[3*i+1],z=points[3*i+2],radiusSq=sphere.center.distanceToSquared({x:x,y:y,z:z});maxRadiusSq=Math.max(maxRadiusSq,radiusSq)}sphere.radius=Math.sqrt(maxRadiusSq)},updateFromStyle=function(shape,stylespec){void 0!==stylespec.color?(shape.color=stylespec.color||new $3Dmol.Color,stylespec.color instanceof $3Dmol.Color||(shape.color=$3Dmol.CC.color(stylespec.color))):shape.color=$3Dmol.CC.color(0),shape.wireframe=!!stylespec.wireframe,shape.opacity=stylespec.alpha?$3Dmol.Math.clamp(stylespec.alpha,0,1):1,void 0!==stylespec.opacity&&(shape.opacity=$3Dmol.Math.clamp(stylespec.opacity,0,1)),shape.side=void 0!==stylespec.side?stylespec.side:$3Dmol.DoubleSide,shape.linewidth=void 0===stylespec.linewidth?1:stylespec.linewidth,shape.clickable=!!stylespec.clickable,shape.callback="function"==typeof stylespec.callback?stylespec.callback:null,shape.hoverable=!!stylespec.hoverable,shape.hover_callback="function"==typeof stylespec.hover_callback?stylespec.hover_callback:null,shape.unhover_callback="function"==typeof stylespec.unhover_callback?stylespec.unhover_callback:null,shape.hidden=stylespec.hidden};return Object.defineProperty(GLShape.prototype,"position",{get:function(){return this.boundingSphere.center}}),Object.defineProperty(GLShape.prototype,"x",{get:function(){return this.boundingSphere.center.x}}),Object.defineProperty(GLShape.prototype,"y",{get:function(){return this.boundingSphere.center.y}}),Object.defineProperty(GLShape.prototype,"z",{get:function(){return this.boundingSphere.center.z}}),GLShape}(),$3Dmol.ShapeIDCount=0,$3Dmol.splitMesh=function(mesh){if(mesh.vertexArr.length<64e3)return[mesh];mesh.vertexArr.length;var slices=[{vertexArr:[],normalArr:[],faceArr:[]}];mesh.colorArr&&(slices.colorArr=[]);for(var vertSlice=[],vertIndex=[],currentSlice=0,faces=mesh.faceArr,i=0,nf=faces.length;i<nf;i+=3){for(var slice=slices[currentSlice],j=0;j<3;j++){var v=faces[i+j];vertSlice[v]!==currentSlice&&(vertSlice[v]=currentSlice,vertIndex[v]=slice.vertexArr.length,slice.vertexArr.push(mesh.vertexArr[v]),mesh.normalArr&&mesh.normalArr[v]&&slice.normalArr.push(mesh.normalArr[v]),mesh.colorArr&&mesh.colorArr[v]&&slice.colorArr.push(mesh.colorArr[v])),slice.faceArr.push(vertIndex[v])}slice.vertexArr.length>=64e3&&(slices.push({vertexArr:[],normalArr:[],faceArr:[]}),mesh.colorArr&&(slices.colorArr=[]),currentSlice++)}return slices},$3Dmol.GLViewer=function(){var numWorkers=4,maxVolume=64e3;return function(element,config){function getAtomsFromSel(sel){var atoms=[];void 0===sel&&(sel={});var i,ms=[];if(void 0===sel.model)for(i=0;i<models.length;i++)models[i]&&ms.push(models[i]);else ms=sel.model,$.isArray(ms)||(ms=[ms]);for(i=0;i<ms.length;i++)atoms=atoms.concat(ms[i].selectedAtoms(sel));return atoms}function atomIsSelected(atom,sel){void 0===sel&&(sel={});var i,ms=[];if(void 0===sel.model)for(i=0;i<models.length;i++)models[i]&&ms.push(models[i]);else ms=sel.model,$.isArray(ms)||(ms=[ms]);for(i=0;i<ms.length;i++)if(ms[i].atomIsSelected(atom,sel))return!0;return!1}function addLineDashed(spec,s){spec.dashLength=spec.dashLength||.5,spec.gapLength=spec.gapLength||.5,spec.start=spec.start||{},spec.end=spec.end||{};var length,dashAmt,gapAmt,p1=new $3Dmol.Vector3(spec.start.x||0,spec.start.y||0,spec.start.z||0),p2=new $3Dmol.Vector3(spec.end.x,spec.end.y||0,spec.end.z||0),dir=new $3Dmol.Vector3,dash=new $3Dmol.Vector3,gap=new $3Dmol.Vector3,temp=p1.clone(),drawn=0;for(dir.subVectors(p2,p1),length=dir.length(),dir.normalize(),dash=dir.clone(),gap=dir.clone(),dash.multiplyScalar(spec.dashLength),gap.multiplyScalar(spec.gapLength),dashAmt=dash.length(),gapAmt=gap.length();drawn<length;){if(drawn+dashAmt>length){spec.start=p1,spec.end=p2,s.addLine(spec);break}temp.addVectors(p1,dash),spec.start=p1,spec.end=temp,s.addLine(spec),p1=temp.clone(),drawn+=dashAmt,temp.addVectors(p1,gap),p1=temp.clone(),drawn+=gapAmt}return s}function applyToModels(func,sel,value1,value2,value3){var ms=[];if(void 0===sel.model)for(i=0;i<models.length;i++)models[i]&&ms.push(models[i]);else ms=sel.model,$.isArray(ms)||(ms=[ms]);for(var i=0;i<ms.length;i++)(ms[i]||"number"==typeof ms[i])&&("number"==typeof ms[i]?models[ms[i]][func](sel,value1,value2,value3):ms[i][func](sel,value1,value2,value3))}function getMatWithStyle(style){var mat=new $3Dmol.MeshLambertMaterial;mat.vertexColors=$3Dmol.VertexColors;for(var prop in style)"color"===prop||"map"===prop||style.hasOwnProperty(prop)&&(mat[prop]=style[prop]);return void 0!==style.opacity&&(1===style.opacity?mat.transparent=!1:mat.transparent=!0),mat}var callback=(config=config||{}).callback,defaultcolors=config.defaultcolors;defaultcolors||(defaultcolors=$3Dmol.elementColors.defaultColors);var nomouse=config.nomouse,bgColor=0;config.backgroundColor=config.backgroundColor||"#ffffff",void 0!=typeof config.backgroundColor&&(bgColor=$3Dmol.CC.color(config.backgroundColor).getHex());var camerax=0;void 0!=typeof config.camerax&&(camerax=parseFloat(config.camerax));var _viewer=this,container=element,glDOM=(container.id,null),models=[],surfaces={},shapes=[],labels=[],fixed_labels=[],clickables=[],hoverables=[],current_hover=null,hoverDuration=500;void 0!=typeof config.hoverDuration&&(hoverDuration=config.hoverDuration);var WIDTH=container.width(),HEIGHT=container.height(),linkedViewers=[],renderer=new $3Dmol.Renderer({antialias:!0,preserveDrawingBuffer:!0,premultipliedAlpha:!1,id:config.id,row:config.row,col:config.col,rows:config.rows,cols:config.cols,canvas:config.canvas});renderer.domElement.style.width="100%",renderer.domElement.style.height="100%",renderer.domElement.style.padding="0",renderer.domElement.style.position="absolute",renderer.domElement.style.top="0px",renderer.domElement.style.left="0px",renderer.domElement.style.zIndex="0";var row=config.row,col=config.col,cols=config.cols,rows=config.rows,viewers=config.viewers,control_all=config.control_all,ASPECT=renderer.getAspect(WIDTH,HEIGHT),camera=new $3Dmol.Camera(20,ASPECT,1,800,config.orthographic);camera.position=new $3Dmol.Vector3(camerax,0,150);var lookingAt=new $3Dmol.Vector3;camera.lookAt(lookingAt);var raycaster=new $3Dmol.Raycaster(new $3Dmol.Vector3(0,0,0),new $3Dmol.Vector3(0,0,0)),projector=new $3Dmol.Projector,mouseVector=new $3Dmol.Vector3(0,0,0),scene=null,rotationGroup=null,modelGroup=null,slabNear=-50,slabFar=50,cq=new $3Dmol.Quaternion(0,0,0,1),dq=new $3Dmol.Quaternion(0,0,0,1),animated=0,isDragging=!1,mouseStartX=0,mouseStartY=0,touchDistanceStart=0,currentModelPos=0,cz=0,cslabNear=0,cslabFar=0,decAnim=function(){--animated<0&&(animated=0)},incAnim=function(){animated++},nextSurfID=function(){var max=0;for(var i in surfaces)if(surfaces.hasOwnProperty(i)){var val=parseInt(i);isNaN(val)||(i=val),i>max&&(max=i)}return max+1},setSlabAndFog=function(){var center=camera.position.z-rotationGroup.position.z;center<1&&(center=1),camera.near=center+slabNear,camera.near<1&&(camera.near=1),camera.far=center+slabFar,camera.near+1>camera.far&&(camera.far=camera.near+1),camera.fov=20,camera.right=center*Math.tan(Math.PI/180*20),camera.left=-camera.right,camera.top=camera.right/ASPECT,camera.bottom=-camera.top,camera.updateProjectionMatrix(),scene.fog.near=camera.near+.4*(camera.far-camera.near),scene.fog.far=camera.far,config.disableFog&&(scene.fog.near=scene.fog.far)},show=function(nolink){if(renderer.setViewport(),scene&&(setSlabAndFog(),renderer.render(scene,camera),!nolink&&linkedViewers.length>0))for(var view=_viewer.getView(),i=0;i<linkedViewers.length;i++)linkedViewers[i].setView(view,!0)};!function(){(scene=new $3Dmol.Scene).fog=new $3Dmol.Fog(bgColor,100,200),modelGroup=new $3Dmol.Object3D,(rotationGroup=new $3Dmol.Object3D).useQuaternion=!0,rotationGroup.quaternion=new $3Dmol.Quaternion(0,0,0,1),rotationGroup.add(modelGroup),scene.add(rotationGroup);var directionalLight=new $3Dmol.Light(16777215);directionalLight.position=new $3Dmol.Vector3(.2,.2,1).normalize(),directionalLight.intensity=1,scene.add(directionalLight)}(),renderer.setClearColorHex(bgColor,1),scene.fog.color=$3Dmol.CC.color(bgColor);var clickedAtom=null,updateClickables=function(){clickables.splice(0,clickables.length),hoverables.splice(0,hoverables.length);var i,il;for(i=0,il=models.length;i<il;i++){var model=models[i];if(model){var atoms=model.selectedAtoms({clickable:!0}),hoverable_atoms=model.selectedAtoms({hoverable:!0});Array.prototype.push.apply(hoverables,hoverable_atoms),Array.prototype.push.apply(clickables,atoms)}}for(i=0,il=shapes.length;i<il;i++){var shape=shapes[i];shape&&shape.clickable&&clickables.push(shape),shape&&shape.hoverable&&hoverables.push(shape)}},handleClickSelection=function(mouseX,mouseY,event){if(0!=clickables.length){var mouse={x:mouseX,y:mouseY,z:-1};mouseVector.set(mouse.x,mouse.y,mouse.z),projector.unprojectVector(mouseVector,camera),mouseVector.sub(camera.position).normalize(),raycaster.set(camera.position,mouseVector);var intersects=[];if((intersects=raycaster.intersectObjects(modelGroup,clickables)).length){var selected=intersects[0].clickable;void 0!==selected.callback&&"function"==typeof selected.callback&&selected.callback(selected,_viewer,event,container)}}},setHover=function(selected,event){current_hover!=selected&&(current_hover&&current_hover.unhover_callback(current_hover,_viewer,event,container),current_hover=selected,selected&&void 0!==selected.hover_callback&&"function"==typeof selected.hover_callback&&selected.hover_callback(selected,_viewer,event,container))},handleHoverSelection=function(mouseX,mouseY,event){if(0!=hoverables.length){var mouse={x:mouseX,y:mouseY,z:-1};mouseVector.set(mouse.x,mouse.y,mouse.z),projector.unprojectVector(mouseVector,camera),mouseVector.sub(camera.position).normalize(),raycaster.set(camera.position,mouseVector);var intersects=[];if((intersects=raycaster.intersectObjects(modelGroup,hoverables)).length){var selected=intersects[0].clickable;setHover(selected),current_hover=selected}else setHover(null)}},handleHoverContinue=function(mouseX,mouseY,event){var mouse={x:mouseX,y:mouseY,z:-1};mouseVector.set(mouse.x,mouse.y,mouse.z),projector.unprojectVector(mouseVector,camera),mouseVector.sub(camera.position).normalize(),raycaster.set(camera.position,mouseVector);var intersects=[];0!=(intersects=raycaster.intersectObjects(modelGroup,hoverables)).length&&void 0!==intersects[0]||setHover(null),void 0!==intersects[0]&&intersects[0].clickable!==current_hover&&setHover(null)},calcTouchDistance=function(ev){var xdiff=ev.originalEvent.targetTouches[0].pageX-ev.originalEvent.targetTouches[1].pageX,ydiff=ev.originalEvent.targetTouches[0].pageY-ev.originalEvent.targetTouches[1].pageY;return Math.sqrt(xdiff*xdiff+ydiff*ydiff)},getXY=function(ev){var x=ev.pageX,y=ev.pageY;return void 0==x&&(x=ev.originalEvent.pageX),void 0==y&&(y=ev.originalEvent.pageY),ev.originalEvent.targetTouches&&ev.originalEvent.targetTouches[0]?(x=ev.originalEvent.targetTouches[0].pageX,y=ev.originalEvent.targetTouches[0].pageY):ev.originalEvent.changedTouches&&ev.originalEvent.changedTouches[0]&&(x=ev.originalEvent.changedTouches[0].pageX,y=ev.originalEvent.changedTouches[0].pageY),[x,y]},screenXY2model=function(x,y){var dx=x/WIDTH,dy=y/HEIGHT,zpos=rotationGroup.position.z,q=rotationGroup.quaternion,t=new $3Dmol.Vector3(0,0,zpos);return projector.projectVector(t,camera),t.x+=2*dx,t.y-=2*dy,projector.unprojectVector(t,camera),t.z=0,t.applyQuaternion(q),t},isInViewer=function(x,y){var WIDTH=container.width(),HEIGHT=container.height();if(void 0!=viewers&&!control_all){var width=WIDTH/cols,height=HEIGHT/rows,offset=$("canvas",container).offset(),relx=x-offset.left,rely=y-offset.top,r=rows-Math.floor(rely/height)-1,c=Math.floor(relx/width);if(r!=row||c!=col)return!1}return!0};$("body").bind("mouseup touchend",function(ev){if(isDragging&&scene){var xy=getXY(ev),x=xy[0],y=xy[1];if(x==mouseStartX&&y==mouseStartY){var offset=$("canvas",container).offset(),mouseX=(x-offset.left)/WIDTH*2-1,mouseY=-(y-offset.top)/HEIGHT*2+1;handleClickSelection(mouseX,mouseY,ev)}}isDragging=!1});var adjustZoomToLimits=function(z){if(config.lowerZoomLimit&&config.lowerZoomLimit>0){var lower=150-config.lowerZoomLimit;z>lower&&(z=lower)}if(config.upperZoomLimit&&config.upperZoomLimit>0){var upper=150-config.upperZoomLimit;z<upper&&(z=upper)}return z>150&&(z=149.85),z};this.setZoomLimits=function(lower,upper){void 0!==lower&&(config.lowerZoomLimit=lower),upper&&(config.upperZoomLimit=upper),rotationGroup.position.z=adjustZoomToLimits(rotationGroup.position.z),show()};var mouseButton,_handleMouseDown=this._handleMouseDown=function(ev){if(ev.preventDefault(),scene){var xy=getXY(ev),x=xy[0],y=xy[1];void 0!==x&&(isDragging=!0,clickedAtom=null,mouseButton=ev.which,mouseStartX=x,mouseStartY=y,touchDistanceStart=0,ev.originalEvent.targetTouches&&2==ev.originalEvent.targetTouches.length&&(touchDistanceStart=calcTouchDistance(ev)),cq=rotationGroup.quaternion,cz=rotationGroup.position.z,currentModelPos=modelGroup.position.clone(),cslabNear=slabNear,cslabFar=slabFar)}},_handleMouseScroll=this._handleMouseScroll=function(ev){if(ev.preventDefault(),scene){var xy=getXY(ev),x=xy[0],y=xy[1];if(void 0!==x&&isInViewer(x,y)){var scaleFactor=.85*(150-rotationGroup.position.z),mult=1;ev.originalEvent.ctrlKey&&(mult=-1),ev.originalEvent.detail?rotationGroup.position.z+=mult*scaleFactor*ev.originalEvent.detail/10:ev.originalEvent.wheelDelta&&(rotationGroup.position.z-=mult*scaleFactor*ev.originalEvent.wheelDelta/400),rotationGroup.position.z=adjustZoomToLimits(rotationGroup.position.z),show()}}};this.pngURI=function(){return $("canvas",container)[0].toDataURL("image/png")},this.setHoverDuration=function(duration){hoverDuration=duration};var hoverTimeout,_handleMouseMove=this._handleMouseMove=function(ev){WIDTH=container.width(),HEIGHT=container.height(),clearTimeout(hoverTimeout);var offset=$("canvas",container).offset(),mouseX=(getXY(ev)[0]-offset.left)/WIDTH*2-1,mouseY=-(getXY(ev)[1]-offset.top)/HEIGHT*2+1;if(null!==current_hover&&handleHoverContinue(mouseX,mouseY),hoverTimeout=setTimeout(function(){handleHoverSelection(mouseX,mouseY)},hoverDuration),ev.preventDefault(),scene&&isDragging){var mode=0,xy=getXY(ev),x=xy[0],y=xy[1];if(void 0!==x&&isInViewer(x,y)){var dx=(x-mouseStartX)/WIDTH,dy=(y-mouseStartY)/HEIGHT;0!=touchDistanceStart&&ev.originalEvent.targetTouches&&2==ev.originalEvent.targetTouches.length?(mode=2,dy=2*(calcTouchDistance(ev)-touchDistanceStart)/(WIDTH+HEIGHT),console.log("pinch "+touchDistanceStart+" dy "+dy)):ev.originalEvent.targetTouches&&3==ev.originalEvent.targetTouches.length&&(mode=1);var xyRatio=renderer.getXYRatio(),ratioX=xyRatio[0],ratioY=xyRatio[1];dx*=ratioX,dy*=ratioY;var scaleFactor,r=Math.sqrt(dx*dx+dy*dy);if(3==mode||3==mouseButton&&ev.ctrlKey)slabNear=cslabNear+100*dx,slabFar=cslabFar+100*dy;else if(2==mode||3==mouseButton||ev.shiftKey)(scaleFactor=.85*(150-rotationGroup.position.z))<80&&(scaleFactor=80),rotationGroup.position.z=cz+dy*scaleFactor,rotationGroup.position.z=adjustZoomToLimits(rotationGroup.position.z);else if(1==mode||2==mouseButton||ev.ctrlKey){var t=screenXY2model(ratioX*(x-mouseStartX),ratioY*(y-mouseStartY));modelGroup.position.addVectors(currentModelPos,t)}else if((0===mode||1==mouseButton)&&0!==r){var rs=Math.sin(r*Math.PI)/r;dq.x=Math.cos(r*Math.PI),dq.y=0,dq.z=rs*dx,dq.w=-rs*dy,rotationGroup.quaternion=new $3Dmol.Quaternion(1,0,0,0),rotationGroup.quaternion.multiply(dq),rotationGroup.quaternion.multiply(cq)}show()}}},initContainer=function(element){WIDTH=(container=element).width(),HEIGHT=container.height(),ASPECT=renderer.getAspect(WIDTH,HEIGHT),renderer.setSize(WIDTH,HEIGHT),container.append(renderer.domElement),glDOM=$(renderer.domElement),nomouse||(glDOM.bind("mousedown touchstart",_handleMouseDown),glDOM.bind("DOMMouseScroll mousewheel",_handleMouseScroll),glDOM.bind("mousemove touchmove",_handleMouseMove),glDOM.bind("contextmenu",function(ev){ev.preventDefault()}))};initContainer(container),this.setContainer=function(element){return"string"===$.type(element)&&(element=$("#"+element)),element||(element=container),initContainer(element),this},this.setBackgroundColor=function(hex,a){void 0===a?a=1:(a<0||a>1)&&(a=1);var c=$3Dmol.CC.color(hex);return scene.fog.color=c,bgColor=c.getHex(),renderer.setClearColorHex(c.getHex(),a),show(),this},this.setProjection=function(proj){camera.ortho="orthographic"===proj,setSlabAndFog()},this.setViewStyle=function(parameters){if("outline"===parameters.style){var params={};parameters.color&&(params.color=$3Dmol.CC.color(parameters.color)),parameters.width&&(params.width=parameters.width),renderer.enableOutline(params)}else renderer.disableOutline();return this},config.style&&this.setViewStyle(config),this.setWidth=function(w){return WIDTH=w||WIDTH,renderer.setSize(WIDTH,HEIGHT),this},this.setHeight=function(h){return HEIGHT=h||HEIGHT,renderer.setSize(WIDTH,HEIGHT),this},this.resize=function(){return WIDTH=container.width(),HEIGHT=container.height(),ASPECT=renderer.getAspect(WIDTH,HEIGHT),renderer.setSize(WIDTH,HEIGHT),camera.aspect=ASPECT,camera.updateProjectionMatrix(),show(),this},$(window).resize(this.resize),this.getModel=function(id){return id in models?models[id]:0==models.length?null:models[models.length-1]},this.rotate=function(angle,axis,animationDuration,fixedPath){animationDuration=void 0!==animationDuration?animationDuration:0,void 0===axis&&(axis="y"),"x"==axis&&(axis={x:1,y:0,z:0}),"y"==axis&&(axis={x:0,y:1,z:0}),"z"==axis&&(axis={x:0,y:0,z:1});var q=function(rangle){var s=Math.sin(rangle/2),c=Math.cos(rangle/2),i=0,j=0,k=0;return i=axis.x*s,j=axis.y*s,k=axis.z*s,new $3Dmol.Quaternion(i,j,k,c).normalize()}(Math.PI*angle/180);if(animationDuration){var final=(new $3Dmol.Quaternion).copy(rotationGroup.quaternion).multiply(q);animateMotion(animationDuration,fixedPath,modelGroup.position,rotationGroup.position.z,final,lookingAt)}else rotationGroup.quaternion.multiply(q),show();return this},this.surfacesFinished=function(){for(var key in surfaces)if(!surfaces[key][0].done)return!1;return!0},this.getView=function(){if(!modelGroup)return[0,0,0,0,0,0,0,1];var pos=modelGroup.position,q=rotationGroup.quaternion;return[pos.x,pos.y,pos.z,rotationGroup.position.z,q.x,q.y,q.z,q.w]},this.setView=function(arg,nolink){return void 0!==arg&&(arg instanceof Array||8!==arg.length)&&modelGroup&&rotationGroup?(modelGroup.position.x=arg[0],modelGroup.position.y=arg[1],modelGroup.position.z=arg[2],rotationGroup.position.z=arg[3],rotationGroup.quaternion.x=arg[4],rotationGroup.quaternion.y=arg[5],rotationGroup.quaternion.z=arg[6],rotationGroup.quaternion.w=arg[7],void 0!==arg[8]&&(rotationGroup.position.x=arg[8],rotationGroup.position.y=arg[9]),show(nolink),this):this},this.render=function(callback){renderer.setViewport(),new Date,updateClickables();var i,n,view=this.getView(),exts=renderer.supportedExtensions();for(i=0;i<models.length;i++)models[i]&&models[i].globj(modelGroup,exts);for(i=0;i<shapes.length;i++)shapes[i]&&shapes[i].globj(modelGroup,exts);for(i in surfaces)if(surfaces.hasOwnProperty(i)){var surfArr=surfaces[i];for(n=0;n<surfArr.length;n++)if(surfArr.hasOwnProperty(n)){var geo=surfArr[n].geo;if(!surfArr[n].finished){geo.verticesNeedUpdate=!0,geo.elementsNeedUpdate=!0,geo.normalsNeedUpdate=!0,geo.colorsNeedUpdate=!0,geo.buffersNeedUpdate=!0,geo.boundingSphere=null,surfArr[n].done&&(surfArr[n].finished=!0),surfArr[n].lastGL&&modelGroup.remove(surfArr[n].lastGL);var smesh=null;if(smesh=surfArr[n].mat instanceof $3Dmol.LineBasicMaterial?new $3Dmol.Line(geo,surfArr[n].mat):new $3Dmol.Mesh(geo,surfArr[n].mat),surfArr[n].mat.transparent&&0==surfArr[n].mat.opacity?smesh.visible=!1:smesh.visible=!0,surfArr[n].symmetries.length>1||1==surfArr[n].symmetries.length&&!surfArr[n].symmetries[n].isIdentity()){var j,tmeshes=new $3Dmol.Object3D;for(j=0;j<surfArr[n].symmetries.length;j++){var tmesh=smesh.clone();tmesh.matrix=surfArr[n].symmetries[j],tmesh.matrixAutoUpdate=!1,tmeshes.add(tmesh)}surfArr[n].lastGL=tmeshes,modelGroup.add(tmeshes)}else surfArr[n].lastGL=smesh,modelGroup.add(smesh)}}}return this.setView(view),new Date,"function"==typeof callback&&callback(),this},this.selectedAtoms=function(sel){return getAtomsFromSel(sel)},this.getUniqueValues=function(attribute,sel){void 0===sel&&(sel={});var atoms=getAtomsFromSel(sel),values={};for(var atom in atoms)atoms[atom].hasOwnProperty(attribute)&&(values[atoms[atom][attribute]]=!0);return Object.keys(values)},this.pdbData=function(sel){for(var atoms=getAtomsFromSel(sel),ret="",i=0,n=atoms.length;i<n;++i)ret+=atoms[i].pdbline+"\n";return ret};var spinInterval,slerp=function(v0,v1,t){if(1==t)return v1;if(0==t)return v0;var dot=v0.x*v1.x+v0.y*v1.y+v0.z*v1.z+v0.w*v1.w;if(dot>.9995){var result=new $3Dmol.Quaternion(v0.x+t*(v1.x-v0.x),v0.y+t*(v1.y-v0.y),v0.z+t*(v1.z-v0.z),v0.w+t*(v1.w-v0.w));return result.normalize(),result}dot<0&&(v1=v1.clone().multiplyScalar(-1),dot=-dot),dot>1?dot=1:dot<-1&&(dot=-1);var theta=Math.acos(dot)*t,v2=v1.clone();v2.sub(v0.clone().multiplyScalar(dot)),v2.normalize();var c=Math.cos(theta),s=Math.sin(theta),ret=new $3Dmol.Quaternion(v0.x*c+v2.x*s,v0.y*c+v2.y*s,v0.z*c+v2.z*s,v0.w*c+v2.w*s);return ret.normalize(),ret};this.spin=function(axis){if(clearInterval(spinInterval),void 0===axis&&(axis="y"),"boolean"==typeof axis){if(!axis)return;axis="y"}Array.isArray(axis)&&(axis={x:axis[0],y:axis[1],z:axis[2]});var viewer=this;spinInterval=setInterval(function(){viewer.rotate(1,axis)},25)};var animateMotion=function(duration,fixed,mpos,rz,rot,cam){var steps=Math.ceil(duration/20);steps<1&&(steps=1),incAnim();var curr={mpos:modelGroup.position.clone(),rz:rotationGroup.position.z,rot:rotationGroup.quaternion.clone(),cam:lookingAt.clone()};if(fixed){for(var n=(steps=new Array(steps)).length,i=0;i<n;i++){var frac=(i+1)/n,next={mpos:curr.mpos,rz:curr.rz,rot:curr.rot};mpos&&(next.mpos=mpos.clone().sub(curr.mpos).multiplyScalar(frac).add(curr.mpos)),void 0!==rz&&null!=rz&&(next.rz=curr.rz+frac*(rz-curr.rz)),rot&&(next.rot=slerp(curr.rot,rot,frac)),cam&&(next.cam=cam.clone().sub(curr.cam).multiplyScalar(frac).add(curr.cam)),steps[i]=next}var step=0,callback=function(){var p=steps[step];step+=1,p.mpos&&(modelGroup.position=p.mpos),p.rz&&(rotationGroup.position.z=p.rz),p.rot&&(rotationGroup.quaternion=p.rot),p.cam&&camera.lookAt(p.cam),step<steps.length?setTimeout(callback,20):decAnim(),show()};setTimeout(callback,20)}else{var delta={},frac=1/steps;mpos&&(delta.mpos=mpos.clone().sub(curr.mpos).multiplyScalar(frac)),void 0!==rz&&null!=rz&&(delta.rz=frac*(rz-curr.rz)),rot&&(next=slerp(curr.rot,rot,frac),delta.rot=curr.rot.clone().inverse().multiply(next)),cam&&(delta.cam=cam.clone().sub(curr.cam).multiplyScalar(frac));var step=0,callback=function(){step+=1,delta.mpos&&modelGroup.position.add(delta.mpos),delta.rz&&(rotationGroup.position.z+=delta.rz),delta.rot&&rotationGroup.quaternion.multiply(delta.rot),delta.cam&&(lookingAt.add(delta.cam),camera.lookAt(lookingAt)),step<steps?setTimeout(callback,20):decAnim(),show()};setTimeout(callback,20)}};this.zoom=function(factor,animationDuration,fixedPath){var factor=factor||2,animationDuration=void 0!==animationDuration?animationDuration:0,final_z=150-(150-rotationGroup.position.z)/factor;return animationDuration>0?animateMotion(animationDuration,fixedPath,modelGroup.position,adjustZoomToLimits(final_z),rotationGroup.quaternion,lookingAt):(rotationGroup.position.z=adjustZoomToLimits(final_z),show()),this},this.translate=function(x,y,animationDuration,fixedPath){var animationDuration=void 0!==animationDuration?animationDuration:0,dx=x/WIDTH,dy=y/HEIGHT,v=new $3Dmol.Vector3(0,0,-150);projector.projectVector(v,camera),v.x-=dx,v.y-=dy,projector.unprojectVector(v,camera),v.z=0;var final_position=lookingAt.clone().add(v);return animationDuration>0?animateMotion(animationDuration,fixedPath,modelGroup.position,rotationGroup.position.z,rotationGroup.quaternion,final_position):(lookingAt=final_position,camera.lookAt(lookingAt),show()),this},this.fitSlab=function(sel){var atoms=getAtomsFromSel(sel=sel||{}),tmp=$3Dmol.getExtent(atoms),x=tmp[1][0]-tmp[0][0],y=tmp[1][1]-tmp[0][1],z=tmp[1][2]-tmp[0][2],maxD=Math.sqrt(x*x+y*y+z*z);return maxD<5&&(maxD=5),slabNear=-maxD/1.9,slabFar=maxD/2,this},this.center=function(sel,animationDuration,fixedPath){animationDuration=void 0!==animationDuration?animationDuration:0;var allatoms,alltmp,atoms=getAtomsFromSel(sel=sel||{}),tmp=$3Dmol.getExtent(atoms);$.isEmptyObject(sel)?($.each(shapes,function(i,shape){if(shape&&shape.boundingSphere&&shape.boundingSphere.center){var c=shape.boundingSphere.center,r=shape.boundingSphere.radius;r>0?(atoms.push(new $3Dmol.Vector3(c.x+r,c.y,c.z)),atoms.push(new $3Dmol.Vector3(c.x-r,c.y,c.z)),atoms.push(new $3Dmol.Vector3(c.x,c.y+r,c.z)),atoms.push(new $3Dmol.Vector3(c.x,c.y-r,c.z)),atoms.push(new $3Dmol.Vector3(c.x,c.y,c.z+r)),atoms.push(new $3Dmol.Vector3(c.x,c.y,c.z-r))):atoms.push(c)}}),tmp=$3Dmol.getExtent(atoms),allatoms=atoms,alltmp=tmp):(allatoms=getAtomsFromSel({}),alltmp=$3Dmol.getExtent(allatoms));var center=new $3Dmol.Vector3(tmp[2][0],tmp[2][1],tmp[2][2]),x=alltmp[1][0]-alltmp[0][0],y=alltmp[1][1]-alltmp[0][1],z=alltmp[1][2]-alltmp[0][2];(maxD=Math.sqrt(x*x+y*y+z*z))<5&&(maxD=5),slabNear=-maxD/1.9,slabFar=maxD/2,x=tmp[1][0]-tmp[0][0],y=tmp[1][1]-tmp[0][1],z=tmp[1][2]-tmp[0][2],(maxD=Math.sqrt(x*x+y*y+z*z))<5&&(maxD=5);for(var maxDsq=25,i=0;i<atoms.length;i++)if(atoms[i]){var dsq=center.distanceToSquared(atoms[i]);dsq>maxDsq&&(maxDsq=dsq)}var maxD=2*Math.sqrt(maxDsq),finalpos=center.clone().multiplyScalar(-1);return animationDuration>0?animateMotion(animationDuration,fixedPath,finalpos,rotationGroup.position.z,rotationGroup.quaternion,lookingAt):(modelGroup.position=finalpos,show()),this},this.zoomTo=function(sel,animationDuration,fixedPath){animationDuration=void 0!==animationDuration?animationDuration:0;var allatoms,alltmp,atoms=getAtomsFromSel(sel=sel||{}),tmp=$3Dmol.getExtent(atoms);$.isEmptyObject(sel)?($.each(shapes,function(i,shape){if(shape&&shape.boundingSphere&&shape.boundingSphere.center){var c=shape.boundingSphere.center,r=shape.boundingSphere.radius;r>0?(atoms.push(new $3Dmol.Vector3(c.x+r,c.y,c.z)),atoms.push(new $3Dmol.Vector3(c.x-r,c.y,c.z)),atoms.push(new $3Dmol.Vector3(c.x,c.y+r,c.z)),atoms.push(new $3Dmol.Vector3(c.x,c.y-r,c.z)),atoms.push(new $3Dmol.Vector3(c.x,c.y,c.z+r)),atoms.push(new $3Dmol.Vector3(c.x,c.y,c.z-r))):atoms.push(c)}}),tmp=$3Dmol.getExtent(atoms),allatoms=atoms,alltmp=tmp):(allatoms=getAtomsFromSel({}),alltmp=$3Dmol.getExtent(allatoms));var center=new $3Dmol.Vector3(tmp[2][0],tmp[2][1],tmp[2][2]),x=alltmp[1][0]-alltmp[0][0],y=alltmp[1][1]-alltmp[0][1],z=alltmp[1][2]-alltmp[0][2];(maxD=Math.sqrt(x*x+y*y+z*z))<5&&(maxD=5),slabNear=-maxD/1.9,slabFar=maxD/2,x=tmp[1][0]-tmp[0][0],y=tmp[1][1]-tmp[0][1],z=tmp[1][2]-tmp[0][2],(maxD=Math.sqrt(x*x+y*y+z*z))<5&&(maxD=5);for(var maxDsq=25,i=0;i<atoms.length;i++)if(atoms[i]){var dsq=center.distanceToSquared(atoms[i]);dsq>maxDsq&&(maxDsq=dsq)}var maxD=2*Math.sqrt(maxDsq),finalpos=center.clone().multiplyScalar(-1),finalz=-(.5*maxD/Math.tan(Math.PI/180*camera.fov/2)-150);return finalz=adjustZoomToLimits(finalz),animationDuration>0?animateMotion(animationDuration,fixedPath,finalpos,finalz,rotationGroup.quaternion,lookingAt):(modelGroup.position=finalpos,rotationGroup.position.z=finalz,show()),camera.lookAt(new $3Dmol.Vector3(0,0,finalz)),this},this.setSlab=function(near,far){slabNear=near,slabFar=far},this.getSlab=function(sel){return{near:slabNear,far:slabFar}},this.addLabel=function(text,options,sel){if(options=options||{},sel){var extent=$3Dmol.getExtent(getAtomsFromSel(sel));options.position={x:extent[2][0],y:extent[2][1],z:extent[2][2]}}var label=new $3Dmol.Label(text,options);return label.setContext(),modelGroup.add(label.sprite),options.fixed&&fixed_labels.push(labels.length),labels.push(label),show(),label},this.addResLabels=function(sel,style){return applyToModels("addResLabels",sel,this,style),show(),this},this.removeLabel=function(label){for(var i=0;i<labels.length;i++)if(labels[i]==label){labels.splice(i,1),label.dispose(),modelGroup.remove(label.sprite);break}return show(),this},this.removeAllLabels=function(){for(var i=0;i<labels.length;i++)modelGroup.remove(labels[i].sprite);return labels.splice(0,labels.length),show(),this},this.setLabelStyle=function(label,stylespec){return modelGroup.remove(label.sprite),label.dispose(),label.stylespec=stylespec,label.setContext(),modelGroup.add(label.sprite),show(),label},this.setLabelText=function(label,text){return modelGroup.remove(label.sprite),label.dispose(),label.text=text,label.setContext(),modelGroup.add(label.sprite),show(),label},this.addShape=function(shapeSpec){shapeSpec=shapeSpec||{};var shape=new $3Dmol.GLShape(shapeSpec);return shape.shapePosition=shapes.length,shapes.push(shape),shape},this.removeShape=function(shape){if(!shape)return this;for(shape.removegl(modelGroup),delete shapes[shape.shapePosition];shapes.length>0&&void 0===shapes[shapes.length-1];)shapes.pop();return this},this.removeAllShapes=function(){for(var i=0;i<shapes.length;i++)shapes[i].removegl(modelGroup);return shapes.splice(0,shapes.length),this};var getSelectionCenter=function(spec){if(spec.hasOwnProperty("x")&&spec.hasOwnProperty("y")&&spec.hasOwnProperty("z"))return spec;var atoms=getAtomsFromSel(spec);if(0==atoms.length)return{x:0,y:0,z:0};var extent=$3Dmol.getExtent(atoms);return{x:extent[0][0]+(extent[1][0]-extent[0][0])/2,y:extent[0][1]+(extent[1][1]-extent[0][1])/2,z:extent[0][2]+(extent[1][2]-extent[0][2])/2}};this.addSphere=function(spec){(spec=spec||{}).center=getSelectionCenter(spec.center);var s=new $3Dmol.GLShape(spec);return s.shapePosition=shapes.length,s.addSphere(spec),shapes.push(s),s},this.addArrow=function(spec){(spec=spec||{}).start=getSelectionCenter(spec.start),spec.end=getSelectionCenter(spec.end);var s=new $3Dmol.GLShape(spec);return s.shapePosition=shapes.length,s.addArrow(spec),shapes.push(s),s},this.addCylinder=function(spec){(spec=spec||{}).start=getSelectionCenter(spec.start),spec.end=getSelectionCenter(spec.end);var s=new $3Dmol.GLShape(spec);return s.shapePosition=shapes.length,spec.dashed?s.addDashedCylinder(spec):s.addCylinder(spec),shapes.push(s),s},this.addLine=function(spec){(spec=spec||{}).start=getSelectionCenter(spec.start),spec.end=getSelectionCenter(spec.end),spec.wireframe=!0;var s=new $3Dmol.GLShape(spec);return s.shapePosition=shapes.length,spec.dashed?s=addLineDashed(spec,s):s.addLine(spec),shapes.push(s),s},this.addUnitCell=function(model){var s=new $3Dmol.GLShape({wireframe:!0});s.shapePosition=shapes.length;var data=model.getCrystData();if(data){if(data.matrix)matrix=data.matrix;else{var a=data.a,b=data.b,c=data.c,alpha=data.alpha,beta=data.beta,gamma=data.gamma;alpha=alpha*Math.PI/180,beta=beta*Math.PI/180,gamma=gamma*Math.PI/180;var u,v,w;u=Math.cos(beta),v=(Math.cos(alpha)-Math.cos(beta)*Math.cos(gamma))/Math.sin(gamma),w=Math.sqrt(Math.max(0,1-u*u-v*v));var matrix=new $3Dmol.Matrix4(a,b*Math.cos(gamma),c*u,0,0,b*Math.sin(gamma),c*v,0,0,0,c*w,0,0,0,0,1)}for(var points=[new $3Dmol.Vector3(0,0,0),new $3Dmol.Vector3(1,0,0),new $3Dmol.Vector3(0,1,0),new $3Dmol.Vector3(0,0,1),new $3Dmol.Vector3(1,1,0),new $3Dmol.Vector3(0,1,1),new $3Dmol.Vector3(1,0,1),new $3Dmol.Vector3(1,1,1)],i=0;i<points.length;i++)points[i]=points[i].applyMatrix4(matrix);s.addLine({start:points[0],end:points[1]}),s.addLine({start:points[0],end:points[2]}),s.addLine({start:points[1],end:points[4]}),s.addLine({start:points[2],end:points[4]}),s.addLine({start:points[0],end:points[3]}),s.addLine({start:points[3],end:points[5]}),s.addLine({start:points[2],end:points[5]}),s.addLine({start:points[1],end:points[6]}),s.addLine({start:points[4],end:points[7]}),s.addLine({start:points[6],end:points[7]}),s.addLine({start:points[3],end:points[6]}),s.addLine({start:points[5],end:points[7]})}return shapes.push(s),s},this.addCustom=function(spec){spec=spec||{};var s=new $3Dmol.GLShape(spec);return s.shapePosition=shapes.length,s.addCustom(spec),shapes.push(s),s},this.addVolumetricData=function(data,format,spec){spec=spec||{};var s=new $3Dmol.GLShape(spec);return s.shapePosition=shapes.length,s.addVolumetricData(data,format,spec),shapes.push(s),s},this.addIsosurface=function(data,spec,callback){spec=spec||{};var s=new $3Dmol.GLShape(spec);return s.shapePosition=shapes.length,s.addIsosurface(data,spec,callback),shapes.push(s),s},this.enableFog=function(fog){fog?scene.fog=new $3Dmol.Fog(bgColor,100,200):(config.disableFog=!0,show())},this.setFrame=function(framenum){return new Promise(function(resolve,reject){var modelMap=models.map(function(model){return model.setFrame(framenum)});Promise.all(modelMap).then(function(){resolve()})})},this.getNumFrames=function(){for(var mostFrames=0,i=0;i<models.length;i++)models[i].getNumFrames()>mostFrames&&(mostFrames=models[i].getNumFrames());return mostFrames},this.animate=function(options){incAnim();var interval=100,loop="forward",reps=0;(options=options||{}).interval&&(interval=options.interval),options.loop&&(loop=options.loop),options.reps&&(reps=options.reps);var mostFrames=this.getNumFrames(),that=this,currFrame=0,inc=1;options.step&&(reps/=inc=options.step);var displayCount=0,displayMax=mostFrames*reps,time=new Date,resolve=function(){if(that.render(),++displayCount!=displayMax&&that.isAnimated()){var newInterval=interval-(new Date-time);newInterval=newInterval>0?newInterval:0,setTimeout(display,newInterval,loop)}else clearTimeout(intervalID),decAnim()},display=function(direction){time=new Date,"forward"==direction?that.setFrame(currFrame).then(function(){currFrame=(currFrame+inc)%mostFrames,resolve()}):"backward"==direction?that.setFrame(mostFrames-1-currFrame).then(function(){currFrame=(currFrame+inc)%mostFrames,resolve()}):that.setFrame(currFrame).then(function(){inc*=(currFrame+=inc)%(mostFrames-1)==0?-1:1,resolve()})},intervalID=setTimeout(display,0,loop);return this},this.stopAnimate=function(){return animated=0,this},this.isAnimated=function(){return animated>0},this.addModel=function(data,format,options){options&&!options.defaultcolors&&(options.defaultcolors=defaultcolors);var m=new $3Dmol.GLModel(models.length,options);return m.addMolData(data,format,options),models.push(m),m},this.addModels=function(data,format,options){(options=options||{}).multimodel=!0,options.frames=!0;for(var modelatoms=$3Dmol.GLModel.parseMolData(data,format,options),i=0;i<modelatoms.length;i++){var newModel=new $3Dmol.GLModel(models.length,defaultcolors);newModel.setAtomDefaults(modelatoms[i]),newModel.addFrame(modelatoms[i]),newModel.setFrame(0),modelatoms.modelData&&newModel.setModelData(modelatoms.modelData[i]),newModel.setDontDuplicateAtoms(!options.duplicateAssemblyAtoms),models.push(newModel)}return models},this.addModelsAsFrames=function(data,format,options){(options=options||{}).multimodel=!0,options.frames=!0;var m=new $3Dmol.GLModel(models.length,defaultcolors);return m.addMolData(data,format,options),models.push(m),m},this.addAsOneMolecule=function(data,format,options){(options=options||{}).multimodel=!0,options.onemol=!0;var m=new $3Dmol.GLModel(models.length,defaultcolors);return m.addMolData(data,format,options),models.push(m),m},this.removeModel=function(model){if(model){for(model.removegl(modelGroup),delete models[model.getID()];models.length>0&&void 0===models[models.length-1];)models.pop();return this}},this.removeAllModels=function(){for(var i=0;i<models.length;i++)models[i].removegl(modelGroup);return models.splice(0,models.length),this},this.exportJSON=function(includeStyles,modelID){var object={};return object.m=void 0===modelID?models.map(function(model){return model.toCDObject(includeStyles)}):[model[modelID].toCDObject()],JSON.stringify(object)},this.createModelFrom=function(sel,extract){for(var m=new $3Dmol.GLModel(models.length,defaultcolors),i=0;i<models.length;i++)if(models[i]){var atoms=models[i].selectedAtoms(sel);m.addAtoms(atoms),extract&&models[i].removeAtoms(atoms)}return models.push(m),m},this.setStyle=function(sel,style){return void 0===style&&(style=sel,sel={}),applyToModels("setStyle",sel,style,!1),this},this.addStyle=function(sel,style){return void 0===style&&(style=sel,sel={}),applyToModels("setStyle",sel,style,!0),this},this.setClickable=function(sel,clickable,callback){return applyToModels("setClickable",sel,clickable,callback),this},this.setHoverable=function(sel,hoverable,hover_callback,unhover_callback){return applyToModels("setHoverable",sel,hoverable,hover_callback,unhover_callback),this},this.vibrate=function(numFrames,amplitude){return applyToModels("vibrate",numFrames,amplitude),this},this.setColorByProperty=function(sel,prop,scheme,range){return applyToModels("setColorByProperty",sel,prop,scheme,range),this},this.setColorByElement=function(sel,colors){return applyToModels("setColorByElement",sel,colors),this};var getAtomsWithin=function(atomlist,extent){for(var ret=[],i=0;i<atomlist.length;i++){var atom=atomlist[i];void 0!==atom&&(atom.x<extent[0][0]||atom.x>extent[1][0]||atom.y<extent[0][1]||atom.y>extent[1][1]||atom.z<extent[0][2]||atom.z>extent[1][2]||ret.push(atom))}return ret},volume=function(extent){return(extent[1][0]-extent[0][0])*(extent[1][1]-extent[0][1])*(extent[1][2]-extent[0][2])},carveUpExtent=function(extent,atomlist,atomstoshow){for(var ret=[],index2atomlist={},i=0,n=atomlist.length;i<n;i++)index2atomlist[atomlist[i].index]=i;for(var atomsToListIndex=function(atoms){for(var ret=[],i=0,n=atoms.length;i<n;i++)atoms[i].index in index2atomlist&&ret.push(index2atomlist[atoms[i].index]);return ret},copyExtent=function(extent){var ret=[];return ret[0]=[extent[0][0],extent[0][1],extent[0][2]],ret[1]=[extent[1][0],extent[1][1],extent[1][2]],ret},splitExtentR=function(extent){if(volume(extent)<maxVolume)return[extent];var index,w=extent[1][0]-extent[0][0],h=extent[1][1]-extent[0][1],d=extent[1][2]-extent[0][2];index=w>h&&w>d?0:h>w&&h>d?1:2;var a=copyExtent(extent),b=copyExtent(extent),mid=(extent[1][index]-extent[0][index])/2+extent[0][index];a[1][index]=mid,b[0][index]=mid;var alist=splitExtentR(a),blist=splitExtentR(b);return alist.concat(blist)},splits=splitExtentR(extent),i=0,n=splits.length;i<n;i++){var e=copyExtent(splits[i]);e[0][0]-=6,e[0][1]-=6,e[0][2]-=6,e[1][0]+=6,e[1][1]+=6,e[1][2]+=6;var atoms=getAtomsWithin(atomlist,e),toshow=getAtomsWithin(atomstoshow,splits[i]);ret.push({extent:splits[i],atoms:atomsToListIndex(atoms),toshow:atomsToListIndex(toshow)})}return ret},generateSurfaceMesh=function(atoms,VandF,mat){var geo=new $3Dmol.Geometry(!0),geoGroup=geo.updateGeoGroup(0),colors=[];for(i=0,il=atoms.length;i<il;i++){var atom=atoms[i];atom&&(void 0!==atom.surfaceColor?colors[i]=atom.surfaceColor:atom.color&&(colors[i]=$3Dmol.CC.color(atom.color)))}var offset,i,il,vertexArray=geoGroup.vertexArray,v=VandF.vertices;for(i=0,il=v.length;i<il;i++)vertexArray[offset=3*geoGroup.vertices]=v[i].x,vertexArray[offset+1]=v[i].y,vertexArray[offset+2]=v[i].z,geoGroup.vertices++;var colorArray=geoGroup.colorArray;if(mat.voldata&&mat.volscheme){var scheme=mat.volscheme,voldata=mat.voldata,range=scheme.range()||[-1,1];for(i=0,il=v.length;i<il;i++){var val=voldata.getVal(v[i].x,v[i].y,v[i].z),col=$3Dmol.CC.color(scheme.valueToHex(val,range));colorArray[offset=3*i]=col.r,colorArray[offset+1]=col.g,colorArray[offset+2]=col.b}}else if(colors.length>0)for(i=0,il=v.length;i<il;i++)A=v[i].atomid,colorArray[offsetA=3*i]=colors[A].r,colorArray[offsetA+1]=colors[A].g,colorArray[offsetA+2]=colors[A].b;var faces=VandF.faces;geoGroup.faceidx=faces.length,geo.initTypedArrays();var vA,vB,vC,norm,verts=geoGroup.vertexArray,normalArray=geoGroup.normalArray;for(i=0,il=faces.length;i<il;i+=3){var a=faces[i],b=faces[i+1],c=faces[i+2],A=v[a].atomid,offsetA=(v[b].atomid,v[c].atomid,3*a),offsetB=3*b,offsetC=3*c;vA=new $3Dmol.Vector3(verts[offsetA],verts[offsetA+1],verts[offsetA+2]),vB=new $3Dmol.Vector3(verts[offsetB],verts[offsetB+1],verts[offsetB+2]),(vC=new $3Dmol.Vector3(verts[offsetC],verts[offsetC+1],verts[offsetC+2])).subVectors(vC,vB),vA.subVectors(vA,vB),vC.cross(vA),(norm=vC).normalize(),normalArray[offsetA]+=norm.x,normalArray[offsetB]+=norm.x,normalArray[offsetC]+=norm.x,normalArray[offsetA+1]+=norm.y,normalArray[offsetB+1]+=norm.y,normalArray[offsetC+1]+=norm.y,normalArray[offsetA+2]+=norm.z,normalArray[offsetB+2]+=norm.z,normalArray[offsetC+2]+=norm.z}geoGroup.faceArray=new Uint16Array(faces);var mesh=new $3Dmol.Mesh(geo,mat);return mesh.doubleSided=!0,mesh},generateMeshSyncHelper=function(type,expandedExtent,extendedAtoms,atomsToShow,atoms,vol){new Date;var ps=new $3Dmol.ProteinSurface;return ps.initparm(expandedExtent,1!==type,vol),new Date,ps.fillvoxels(atoms,extendedAtoms),new Date,ps.buildboundary(),type!=$3Dmol.SurfaceType.SES&&type!=$3Dmol.SurfaceType.MS||(ps.fastdistancemap(),ps.boundingatom(!1),ps.fillvoxelswaals(atoms,extendedAtoms)),new Date,ps.marchingcube(type),new Date,ps.getFacesAndVertices(atomsToShow)};this.addMesh=function(mesh){var surfobj={geo:mesh.geometry,mat:mesh.material,done:!0,finished:!1},surfid=nextSurfID();return surfaces[surfid]=surfobj,surfid};var shallowCopy=function(l){var ret=[];return $.each(l,function(k,v){ret[k]=$.extend({},v)}),ret},surfaceTypeMap={VDW:$3Dmol.SurfaceType.VDW,MS:$3Dmol.SurfaceType.MS,SAS:$3Dmol.SurfaceType.SAS,SES:$3Dmol.SurfaceType.SES};this.addSurface=function(type,style,atomsel,allsel,focus,surfacecallback){var surfid=nextSurfID();"string"==typeof type?void 0!==surfaceTypeMap[type]?type=surfaceTypeMap[type]:console.log("Surface type : "+type+" is not recognized"):void 0===type&&console.log("Surface type : "+type+" is not recognized");var atomlist=null,focusSele=null,atomsToShow=shallowCopy(getAtomsFromSel(atomsel));atomlist=allsel?shallowCopy(getAtomsFromSel(allsel)):atomsToShow;var n,symmetries=!1;for(n=0;n<models.length;n++)if(models[n]){var symMatrices=models[n].getSymmetries();if(symMatrices.length>1||1==symMatrices.length&&!symMatrices[0].isIdentity()){symmetries=!0;break}}var addSurfaceHelper=function(surfobj,atomlist,atomsToShow){focusSele=focus?shallowCopy(getAtomsFromSel(focus)):atomsToShow,new Date;var atom,extent=$3Dmol.getExtent(atomsToShow,!0);if(style.map&&style.map.prop){var prop=style.map.prop,scheme=style.map.scheme||style.map.gradient||new $3Dmol.Gradient.RWB,range=scheme.range();range||(range=$3Dmol.getPropertyRange(atomsToShow,prop)),style.colorscheme={prop:prop,gradient:scheme}}for(i=0,il=atomlist.length;i<il;i++)(atom=atomlist[i]).surfaceColor=$3Dmol.getColorFromStyle(atom,style);var totalVol=volume(extent),extents=carveUpExtent(extent,atomlist,atomsToShow);if(focusSele&&focusSele.length&&focusSele.length>0){var seleExtent=$3Dmol.getExtent(focusSele,!0),sortFunc=function(a,b){var distSq=function(ex,sele){var e=ex.extent,x=e[1][0]-e[0][0],y=e[1][1]-e[0][1],z=e[1][2]-e[0][2],dx=x-sele[2][0];dx*=dx;var dy=y-sele[2][1];dy*=dy;var dz=z-sele[2][2];return dz*=dz,dx+dy+dz};return distSq(a,seleExtent)-distSq(b,seleExtent)};extents.sort(sortFunc)}var reducedAtoms=[];for(i=0,il=atomlist.length;i<il;i++)atom=atomlist[i],reducedAtoms[i]={x:atom.x,y:atom.y,z:atom.z,serial:i,elem:atom.elem};if($3Dmol.syncSurface){for(var callSyncHelper=function(i){return new Promise(function(resolve,reject){for(var VandF=generateMeshSyncHelper(type,extents[i].extent,extents[i].atoms,extents[i].toshow,reducedAtoms,totalVol),VandFs=$3Dmol.splitMesh({vertexArr:VandF.vertices,faceArr:VandF.faces}),vi=0,vl=VandFs.length;vi<vl;vi++){var VandF={vertices:VandFs[vi].vertexArr,faces:VandFs[vi].faceArr},mesh=generateSurfaceMesh(atomlist,VandF,mat);$3Dmol.mergeGeos(surfobj.geo,mesh)}_viewer.render(),resolve()})},promises=[],i=0;i<extents.length;i++)promises.push(callSyncHelper(i));return Promise.all(promises).then(function(){return surfobj.done=!0,Promise.resolve(surfid)})}var workers=[];type<0&&(type=0);for(var i=0,il=numWorkers;i<il;i++){var w=new Worker($3Dmol.SurfaceWorker);workers.push(w),w.postMessage({type:-1,atoms:reducedAtoms,volume:totalVol})}return new Promise(function(resolve,reject){var cnt=0;for(i=0;i<extents.length;i++){var worker=workers[i%workers.length];worker.onmessage=function(event){for(var VandFs=$3Dmol.splitMesh({vertexArr:event.data.vertices,faceArr:event.data.faces}),i=0,vl=VandFs.length;i<vl;i++){var VandF={vertices:VandFs[i].vertexArr,faces:VandFs[i].faceArr},mesh=generateSurfaceMesh(atomlist,VandF,mat);$3Dmol.mergeGeos(surfobj.geo,mesh)}_viewer.render(),++cnt==extents.length&&(surfobj.done=!0,resolve(surfid))},worker.onerror=function(event){console.log(event.message+" ("+event.filename+":"+event.lineno+")"),reject(event)},worker.postMessage({type:type,expandedExtent:extents[i].extent,extendedAtoms:extents[i].atoms,atomsToShow:extents[i].toshow})}})},mat=getMatWithStyle(style=style||{}),surfobj=[],promise=null;if(symmetries){var modelsAtomList={},modelsAtomsToShow={};for(n=0;n<models.length;n++)modelsAtomList[n]=[],modelsAtomsToShow[n]=[];for(n=0;n<atomlist.length;n++)modelsAtomList[atomlist[n].model].push(atomlist[n]);for(n=0;n<atomsToShow.length;n++)modelsAtomsToShow[atomsToShow[n].model].push(atomsToShow[n]);var promises=[];for(n=0;n<models.length;n++)modelsAtomsToShow[n].length>0&&(surfobj.push({geo:new $3Dmol.Geometry(!0),mat:mat,done:!1,finished:!1,symmetries:models[n].getSymmetries()}),promises.append(addSurfaceHelper(surfobj[n],modelsAtomList[n],modelsAtomsToShow[n])));promise=Promise.all(promises)}else surfobj.push({geo:new $3Dmol.Geometry(!0),mat:mat,done:!1,finished:!1,symmetries:[new $3Dmol.Matrix4]}),promise=addSurfaceHelper(surfobj[surfobj.length-1],atomlist,atomsToShow);return surfaces[surfid]=surfobj,promise.surfid=surfid,surfacecallback&&"function"==typeof surfacecallback?(promise.then(function(surfid){surfacecallback(surfid)}),surfid):promise},this.setSurfaceMaterialStyle=function(surf,style){if(surfaces[surf])for(var surfArr=surfaces[surf],i=0;i<surfArr.length;i++){var mat=surfArr[i].mat=getMatWithStyle(style);if(surfArr[i].mat.side=$3Dmol.FrontSide,style.color){surfArr[i].mat.color=style.color,surfArr[i].geo.colorsNeedUpdate=!0;var c=$3Dmol.CC.color(style.color);surfArr[i].geo.setColors(function(){return c})}else if(mat.voldata&&mat.volscheme){var scheme=mat.volscheme,voldata=mat.voldata,range=scheme.range()||[-1,1];surfArr[i].geo.setColors(function(x,y,z){var val=voldata.getVal(x,y,z);return $3Dmol.CC.color(scheme.valueToHex(val,range))})}surfArr[i].finished=!1}return this},this.removeSurface=function(surf){for(var surfArr=surfaces[surf],i=0;i<surfArr.length;i++)surfArr[i]&&surfArr[i].lastGL&&(void 0!==surfArr[i].geo&&surfArr[i].geo.dispose(),void 0!==surfArr[i].mat&&surfArr[i].mat.dispose(),modelGroup.remove(surfArr[i].lastGL));return delete surfaces[surf],show(),this},this.removeAllSurfaces=function(){for(var n in surfaces)if(surfaces.hasOwnProperty(n)){for(var surfArr=surfaces[n],i=0;i<surfArr.length;i++)surfArr[i]&&surfArr[i].lastGL&&(void 0!==surfArr[i].geo&&surfArr[i].geo.dispose(),void 0!==surfArr[i].mat&&surfArr[i].mat.dispose(),modelGroup.remove(surfArr[i].lastGL));delete surfaces[n]}return show(),this},this.jmolMoveTo=function(){var pos=modelGroup.position,ret="center { "+-pos.x+" "+-pos.y+" "+-pos.z+" }; ",q=rotationGroup.quaternion;return ret+="moveto .5 quaternion { "+q.x+" "+q.y+" "+q.z+" "+q.w+" };"},this.clear=function(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),show(),this},this.mapAtomProperties=function(props,sel){var atoms=getAtomsFromSel(sel=sel||{});if("function"==typeof props)for(var a=0,numa=atoms.length;a<numa;a++)props(atom=atoms[a]);else for(var a=0,numa=atoms.length;a<numa;a++)for(var atom=atoms[a],i=0,n=props.length;i<n;i++){var prop=props[i];if(prop.props)for(var p in prop.props)prop.props.hasOwnProperty(p)&&atomIsSelected(atom,prop)&&(atom.properties||(atom.properties={}),atom.properties[p]=prop.props[p])}return this},this.linkViewer=function(otherviewer){return linkedViewers.push(otherviewer),this};try{"function"==typeof callback&&callback(this)}catch(e){console.log("error with glviewer callback: "+e)}this.getPerceivedDistance=function(){return 150-rotationGroup.position.z},this.setPerceivedDistance=function(dist){rotationGroup.position.z=150-dist},this.setAutoEyeSeparation=function(){var dist=this.getPerceivedDistance();return camera.position.x>0?camera.position.x=dist*Math.tan(Math.PI/180*5):camera.position.x=-dist*Math.tan(Math.PI/180*5),camera.lookAt(new $3Dmol.Vector3(0,0,rotationGroup.position.z)),camera.position.x}}}(),$3Dmol.glmolViewer=$3Dmol.GLViewer;var $3Dmol=$3Dmol||{};$3Dmol.Gradient=function(min,max){},$3Dmol.Gradient.valueToHex=function(val,range){},$3Dmol.Gradient.range=function(){},$3Dmol.Gradient.normalizeValue=function(lo,hi,val){return hi>=lo?(val<lo&&(val=lo),val>hi&&(val=hi),{lo:lo,hi:hi,val:val}):(val>lo&&(val=lo),val<hi&&(val=hi),val=lo-val+hi,{lo:hi,hi:lo,val:val})},$3Dmol.Gradient.RWB=function(min,max,mid){void 0===max&&$.isArray(min)&&min.length>=2&&(max=min[1],min=min[0]),this.valueToHex=function(val,range){var lo,hi;if(val*=1,range?(lo=range[0],hi=range[1]):(lo=min,hi=max),void 0===val)return 16777215;var norm=$3Dmol.Gradient.normalizeValue(lo,hi,val);lo=norm.lo;var scale,middle=((hi=norm.hi)+lo)/2;return(val=norm.val)<=(middle=range&&void 0!==range[2]?range[2]:void 0!==mid?mid:(lo+hi)/2)?(scale=Math.floor(255*Math.sqrt((val-lo)/(middle-lo))),16711680+256*scale+scale):(scale=Math.floor(255*Math.sqrt(1-(val-middle)/(hi-middle))),65536*scale+256*scale+255)},this.range=function(){return void 0!==min&&void 0!==max?[min,max]:null}},$3Dmol.Gradient.ROYGB=function(min,max){void 0===max&&$.isArray(min)&&min.length>=2&&(max=min[1],min=min[0]),this.valueToHex=function(val,range){var lo,hi;if(val*=1,range?(lo=range[0],hi=range[1]):(lo=min,hi=max),void 0===val)return 16777215;var scale,norm=$3Dmol.Gradient.normalizeValue(lo,hi,val),mid=((lo=norm.lo)+(hi=norm.hi))/2,q1=(lo+mid)/2,q3=(mid+hi)/2;return(val=norm.val)<q1?(scale=Math.floor(255*Math.sqrt((val-lo)/(q1-lo))),16711680+256*scale+0):val<mid?(scale=Math.floor(255*Math.sqrt(1-(val-q1)/(mid-q1))),65536*scale+65280+0):val<q3?(scale=Math.floor(255*Math.sqrt((val-mid)/(q3-mid))),65280+1*scale):(scale=Math.floor(255*Math.sqrt(1-(val-q3)/(hi-q3))),0+256*scale+255)},this.range=function(){return void 0!==min&&void 0!==max?[min,max]:null}},$3Dmol.Gradient.Sinebow=function(min,max){var mult=1;void 0===max&&$.isArray(min)&&min.length>=2&&(max=min[1],min=min[0]),max<min&&(mult=-1,min*=-1,max*=-1),this.valueToHex=function(val,range){var lo,hi;if(val*=mult,range?(lo=range[0],hi=range[1]):(lo=min,hi=max),void 0===val)return 16777215;var norm=$3Dmol.Gradient.normalizeValue(lo,hi,val);lo=norm.lo,hi=norm.hi;var h=5*(((val=norm.val)-lo)/(hi-lo))/6+.5,r=Math.sin(Math.PI*h);r*=255*r;var g=Math.sin(Math.PI*(h+1/3));g*=255*g;var b=Math.sin(Math.PI*(h+2/3));return b*=255*b,65536*Math.floor(r)+256*Math.floor(b)+1*Math.floor(g)},this.range=function(){return void 0!==min&&void 0!==max?[min,max]:null}},$3Dmol.Gradient.builtinGradients={rwb:$3Dmol.Gradient.RWB,roygb:$3Dmol.Gradient.ROYGB,sinebow:$3Dmol.Gradient.Sinebow},$3Dmol.LabelCount=0,$3Dmol.Label=function(text,parameters){this.id=$3Dmol.LabelCount++,this.stylespec=parameters||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new $3Dmol.Sprite,this.text=text},$3Dmol.Label.prototype={constructor:$3Dmol.Label,getStyle:function(){return this.stylespec},setContext:function(){var roundRect=function(ctx,x,y,w,h,r,drawBorder){ctx.beginPath(),ctx.moveTo(x+r,y),ctx.lineTo(x+w-r,y),ctx.quadraticCurveTo(x+w,y,x+w,y+r),ctx.lineTo(x+w,y+h-r),ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h),ctx.lineTo(x+r,y+h),ctx.quadraticCurveTo(x,y+h,x,y+h-r),ctx.lineTo(x,y+r),ctx.quadraticCurveTo(x,y,x+r,y),ctx.closePath(),ctx.fill(),drawBorder&&ctx.stroke()},getColor=function(style,stylealpha,init){var ret=init;return void 0!==style&&(ret=style instanceof $3Dmol.Color?style.scaled():$3Dmol.CC.color(style).scaled()),void 0!==stylealpha&&(ret.a=parseFloat(stylealpha)),ret};return function(){var style=this.stylespec,useScreen=void 0!==style.useScreen&&style.useScreen,showBackground=style.showBackground;"0"!==showBackground&&"false"!==showBackground||(showBackground=!1),void 0===showBackground&&(showBackground=!0);var font=style.font?style.font:"sans-serif",fontSize=parseInt(style.fontSize)?parseInt(style.fontSize):18,fontColor=getColor(style.fontColor,style.fontOpacity,{r:255,g:255,b:255,a:1}),padding=style.padding?style.padding:4,borderThickness=style.borderThickness?style.borderThickness:0,backgroundColor=getColor(style.backgroundColor,style.backgroundOpacity,{r:0,g:0,b:0,a:1}),borderColor=getColor(style.borderColor,style.borderOpacity,backgroundColor),position=style.position?style.position:{x:-10,y:1,z:1},inFront=void 0===style.inFront||style.inFront;"false"!==inFront&&"0"!==inFront||(inFront=!1);var spriteAlignment=style.alignment||$3Dmol.SpriteAlignment.topLeft;"string"==typeof spriteAlignment&&spriteAlignment in $3Dmol.SpriteAlignment&&(spriteAlignment=$3Dmol.SpriteAlignment[spriteAlignment]);bold="";style.bold&&(bold="bold "),this.context.font=bold+fontSize+"px  "+font;var textWidth=this.context.measureText(this.text).width;showBackground||(borderThickness=0);var width=textWidth+2.5*borderThickness+2*padding,height=1.25*fontSize+2*borderThickness+2*padding;if(style.backgroundImage){var img=style.backgroundImage,w=style.backgroundWidth?style.backgroundWidth:img.width,h=style.backgroundHeight?style.backgroundHeight:img.height;w>width&&(width=w),h>height&&(height=h)}this.canvas.width=width,this.canvas.height=height,this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var bold="";if(style.bold&&(bold="bold "),this.context.font=bold+fontSize+"px  "+font,this.context.fillStyle="rgba("+backgroundColor.r+","+backgroundColor.g+","+backgroundColor.b+","+backgroundColor.a+")",this.context.strokeStyle="rgba("+borderColor.r+","+borderColor.g+","+borderColor.b+","+borderColor.a+")",this.context.lineWidth=borderThickness,showBackground&&roundRect(this.context,borderThickness,borderThickness,width-2*borderThickness,height-2*borderThickness,6,borderThickness>0),style.backgroundImage){var img=style.backgroundImage,w=style.backgroundWidth?style.backgroundWidth:img.width,h=style.backgroundHeight?style.backgroundHeight:img.height;this.context.drawImage(img,0,0,w,h)}this.context.fillStyle="rgba("+fontColor.r+","+fontColor.g+","+fontColor.b+","+fontColor.a+")",this.context.fillText(this.text,borderThickness+padding,fontSize+borderThickness+padding,textWidth);var texture=new $3Dmol.Texture(this.canvas);texture.needsUpdate=!0,this.sprite.material=new $3Dmol.SpriteMaterial({map:texture,useScreenCoordinates:useScreen,alignment:spriteAlignment,depthTest:!inFront}),this.sprite.scale.set(1,1,1),this.sprite.position.set(position.x,position.y,position.z)}}(),dispose:function(){void 0!==this.sprite.material.map&&this.sprite.material.map.dispose(),void 0!==this.sprite.material&&this.sprite.material.dispose()}},$3Dmol=$3Dmol||{},$3Dmol.MarchingCubeInitializer=function(){var my={};my.march=function(data,verts,faces,spec){var fulltable=!!spec.fulltable,origin=spec.hasOwnProperty("origin")&&spec.origin.hasOwnProperty("x")?spec.origin:{x:0,y:0,z:0},voxel=!!spec.voxel,transform=spec.matrix,nX=spec.nX||0,nY=spec.nY||0,nZ=spec.nZ||0,scale=spec.scale||1,unitCube=null;unitCube=spec.unitCube?spec.unitCube:{x:scale,y:scale,z:scale};var i,il,vertnums=new Int32Array(nX*nY*nZ);for(i=0,il=vertnums.length;i<il;++i)vertnums[i]=-1;var getVertex=function(i,j,k,code,p1,p2){var pt={x:0,y:0,z:0},val2=!!(code&1<<p2),p=p1;!!!(code&1<<p1)&&val2&&(p=p2),1&p&&k++,2&p&&j++,4&p&&i++,transform?pt={x:(pt=(pt=new $3Dmol.Vector3(i,j,k)).applyMatrix4(transform)).x,y:pt.y,z:pt.z}:(pt.x=origin.x+unitCube.x*i,pt.y=origin.y+unitCube.y*j,pt.z=origin.z+unitCube.z*k);var index=(nY*i+j)*nZ+k;return voxel?(verts.push(pt),verts.length-1):(vertnums[index]<0&&(vertnums[index]=verts.length,verts.push(pt)),vertnums[index])},intersects=new Int32Array(12),etable=fulltable?edgeTable2:edgeTable,tritable=fulltable?triTable2:triTable;for(i=0;i<nX-1;++i)for(var j=0;j<nY-1;++j)for(var k=0;k<nZ-1;++k){for(var code=0,p=0;p<8;++p)code|=!!(2&data[(nY*(i+((4&p)>>2))+j+((2&p)>>1))*nZ+k+(1&p)])<<p;if(0!==code&&255!==code){var ecode=etable[code];if(0!==ecode){var ttable=tritable[code];1&ecode&&(intersects[0]=getVertex(i,j,k,code,0,1)),2&ecode&&(intersects[1]=getVertex(i,j,k,code,1,3)),4&ecode&&(intersects[2]=getVertex(i,j,k,code,3,2)),8&ecode&&(intersects[3]=getVertex(i,j,k,code,2,0)),16&ecode&&(intersects[4]=getVertex(i,j,k,code,4,5)),32&ecode&&(intersects[5]=getVertex(i,j,k,code,5,7)),64&ecode&&(intersects[6]=getVertex(i,j,k,code,7,6)),128&ecode&&(intersects[7]=getVertex(i,j,k,code,6,4)),256&ecode&&(intersects[8]=getVertex(i,j,k,code,0,4)),512&ecode&&(intersects[9]=getVertex(i,j,k,code,1,5)),1024&ecode&&(intersects[10]=getVertex(i,j,k,code,3,7)),2048&ecode&&(intersects[11]=getVertex(i,j,k,code,2,6));for(var t=0;t<ttable.length;t+=3){var a=intersects[ttable[t]],b=intersects[ttable[t+1]],c=intersects[ttable[t+2]];voxel&&t>=3&&(verts.push(verts[a]),a=verts.length-1,verts.push(verts[b]),b=verts.length-1,verts.push(verts[c]),c=verts.length-1),faces.push(a),faces.push(b),faces.push(c)}}}}},my.laplacianSmooth=function(numiter,verts,faces){var i,il,j,jl,k,tps=new Array(verts.length);for(i=0,il=verts.length;i<il;i++)tps[i]={x:0,y:0,z:0};var flagvert,vertdeg=new Array(20);for(i=0;i<20;i++)vertdeg[i]=new Array(verts.length);for(i=0,il=verts.length;i<il;i++)vertdeg[0][i]=0;for(i=0,il=faces.length/3;i<il;i++){var aoffset=3*i,boffset=3*i+1,coffset=3*i+2;for(flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];j<jl;j++)if(faces[boffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[boffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];j<jl;j++)if(faces[coffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[coffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];j<jl;j++)if(faces[aoffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];j<jl;j++)if(faces[coffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[coffset]),flagvert=!0,j=0;j<vertdeg[0][faces[coffset]];j++)if(faces[aoffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[coffset]];j<jl;j++)if(faces[boffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[boffset])}for(k=0;k<numiter;k++){for(i=0,il=verts.length;i<il;i++)if(vertdeg[0][i]<3)tps[i].x=verts[i].x,tps[i].y=verts[i].y,tps[i].z=verts[i].z;else if(3==vertdeg[0][i]||4==vertdeg[0][i]){for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];j<jl;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=.5*verts[i].x,tps[i].y+=.5*verts[i].y,tps[i].z+=.5*verts[i].z,tps[i].x/=.5+vertdeg[0][i],tps[i].y/=.5+vertdeg[0][i],tps[i].z/=.5+vertdeg[0][i]}else{for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];j<jl;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=1*verts[i].x,tps[i].y+=1*verts[i].y,tps[i].z+=1*verts[i].z,tps[i].x/=1+vertdeg[0][i],tps[i].y/=1+vertdeg[0][i],tps[i].z/=1+vertdeg[0][i]}for(i=0,il=verts.length;i<il;i++)verts[i].x=tps[i].x,verts[i].y=tps[i].y,verts[i].z=tps[i].z}},my.edgeTable=[0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0];var edgeTable=new Uint32Array(my.edgeTable),triTable=my.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]];return my},$3Dmol.MarchingCube=$3Dmol.MarchingCubeInitializer(),$3Dmol.Parsers=function(){var parsers={},assignBonds=function(atoms){for(var i=0,n=atoms.length;i<n;i++)atoms[i].index||(atoms[i].index=i);for(var grid={},index=0;index<atoms.length;index++){var atom=atoms[index],x=Math.floor(atom.x/4.95),y=Math.floor(atom.y/4.95),z=Math.floor(atom.z/4.95);grid[x]||(grid[x]={}),grid[x][y]||(grid[x][y]={}),grid[x][y][z]||(grid[x][y][z]=[]),grid[x][y][z].push(atom)}var OFFSETS=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}];for(var x in grid){x=parseInt(x);for(var y in grid[x]){y=parseInt(y);for(var z in grid[x][y]){z=parseInt(z);for(var points=grid[x][y][z],i=0;i<points.length;i++)for(var atom1=points[i],j=i+1;j<points.length;j++){var atom2=points[j];areConnected(atom1,atom2)&&-1==atom1.bonds.indexOf(atom2.index)&&(atom1.bonds.push(atom2.index),atom1.bondOrder.push(1),atom2.bonds.push(atom1.index),atom2.bondOrder.push(1))}for(var o=0;o<OFFSETS.length;o++){var offset=OFFSETS[o];grid[x+offset.x]&&grid[x+offset.x][y+offset.y]&&grid[x+offset.x][y+offset.y][z+offset.z]&&function(points,otherPoints){for(var i=0;i<points.length;i++)for(var atom1=points[i],j=0;j<otherPoints.length;j++){var atom2=otherPoints[j];if(areConnected(atom1,atom2)){var a2i=atom1.bonds.indexOf(atom2.index),a1i=atom2.bonds.indexOf(atom1.index);-1==a2i&&-1==a1i?(atom1.bonds.push(atom2.index),atom1.bondOrder.push(1),atom2.bonds.push(atom1.index),atom2.bondOrder.push(1)):-1==a2i?(atom1.bonds.push(atom2.index),atom1.bondOrder.push(atom2.bondOrder[a1i])):-1==a1i&&(atom2.bonds.push(atom1.index),atom2.bondOrder.push(atom1.bondOrder[a2i]))}}}(points,grid[x+offset.x][y+offset.y][z+offset.z])}}}}},assignPDBBonds=function(atomsarray){var i,n,protatoms=[],hetatoms=[];for(i=0,n=atomsarray.length;i<n;i++){var atom=atomsarray[i];atom.index=i,atom.hetflag?hetatoms.push(atom):protatoms.push(atom)}assignBonds(hetatoms),protatoms.sort(function(a,b){return a.chain!=b.chain?a.chain<b.chain?-1:1:a.resi-b.resi});var lastResConnected,currentResi=-1,reschain=-1;for(i=0,n=protatoms.length;i<n;i++){var ai=protatoms[i];ai.resi!==currentResi&&(currentResi=ai.resi,lastResConnected||reschain++,lastResConnected=!1),ai.reschain=reschain;for(var j=i+1;j<protatoms.length;j++){var aj=protatoms[j];if(aj.chain!=ai.chain)break;if(aj.resi-ai.resi>1)break;areConnected(ai,aj)&&(-1===ai.bonds.indexOf(aj.index)&&(ai.bonds.push(aj.index),ai.bondOrder.push(1),aj.bonds.push(ai.index),aj.bondOrder.push(1)),ai.resi!==aj.resi&&(lastResConnected=!0))}}},assignBackboneHBonds=function(atomsarray){var i,j,n,atoms=[];for(i=0,n=atomsarray.length;i<n;i++){atomsarray[i].index=i;var atom=atomsarray[i];atom.hetflag||"N"!==atom.atom&&"O"!==atom.atom||(atoms.push(atom),atom.hbondOther=null,atom.hbondDistanceSq=Number.POSITIVE_INFINITY)}for(atoms.sort(function(a,b){return a.z-b.z}),i=0,n=atoms.length;i<n;i++){var ai=atoms[i];for(j=i+1;j<n;j++){var aj=atoms[j],zdiff=aj.z-ai.z;if(zdiff>3.2)break;if(aj.atom!=ai.atom){var ydiff=Math.abs(aj.y-ai.y);if(!(ydiff>3.2)){var xdiff=Math.abs(aj.x-ai.x);if(!(xdiff>3.2)){var dist=xdiff*xdiff+ydiff*ydiff+zdiff*zdiff;dist>10.24||aj.chain==ai.chain&&Math.abs(aj.resi-ai.resi)<4||(dist<ai.hbondDistanceSq&&(ai.hbondOther=aj,ai.hbondDistanceSq=dist),dist<aj.hbondDistanceSq&&(aj.hbondOther=ai,aj.hbondDistanceSq=dist))}}}}}},computeSecondaryStructure=function(atomsarray){assignBackboneHBonds(atomsarray);var i,il,c,r,atom,val,chres={};for(i=0,il=atomsarray.length;i<il;i++)void 0===chres[(atom=atomsarray[i]).chain]&&(chres[atom.chain]=[]),isFinite(atom.hbondDistanceSq)&&(void 0===chres[(other=atom.hbondOther).chain]&&(chres[other.chain]=[]),4===Math.abs(other.resi-atom.resi)&&(chres[atom.chain][atom.resi]="h"));for(c in chres)for(r=1;r<chres[c].length-1;r++){var valbefore=chres[c][r-1],valafter=chres[c][r+1];val=chres[c][r],"h"==valbefore&&valbefore==valafter&&val!=valbefore&&(chres[c][r]=valbefore)}for(i=0,il=atomsarray.length;i<il;i++)atom=atomsarray[i],isFinite(atom.hbondDistanceSq)&&"h"!=chres[atom.chain][atom.resi]&&"h"!=atom.ss&&(chres[atom.chain][atom.resi]="maybesheet");for(i=0,il=atomsarray.length;i<il;i++)if(atom=atomsarray[i],isFinite(atom.hbondDistanceSq)&&"maybesheet"==chres[atom.chain][atom.resi]){var other=atom.hbondOther,otherval=chres[other.chain][other.resi];"maybesheet"!=otherval&&"s"!=otherval||(chres[atom.chain][atom.resi]="s",chres[other.chain][other.resi]="s")}for(c in chres){for(r=1;r<chres[c].length-1;r++){var valbefore=chres[c][r-1],valafter=chres[c][r+1];val=chres[c][r],"s"==valbefore&&valbefore==valafter&&val!=valbefore&&(chres[c][r]=valbefore)}for(r=0;r<chres[c].length;r++)"h"!=(val=chres[c][r])&&"s"!=val||chres[c][r-1]!=val&&chres[c][r+1]!=val&&delete chres[c][r]}for(i=0,il=atomsarray.length;i<il;i++)void 0!==(val=chres[(atom=atomsarray[i]).chain][atom.resi])&&"maybesheet"!=val&&(atom.ss=val,chres[atom.chain][atom.resi-1]!=val&&(atom.ssbegin=!0),chres[atom.chain][atom.resi+1]!=val&&(atom.ssend=!0))},validateBonds=function(atomsarray,serialToIndex){for(var i=0,n=atomsarray.length;i<n;i++)for(var atom=atomsarray[i],b=0;b<atom.bonds.length;b++){var atom2=atomsarray[atom.bonds[b]],atomi=serialToIndex[atom.serial];atom2&&atomi&&atom2.bonds.indexOf(atomi)<0&&(atom2.bonds.push(atomi),atom2.bondOrder.push(atom.bondOrder[b]))}};parsers.vasp=parsers.VASP=function(str,options){var atoms=[[]],lattice={},lines=str.replace(/^\s+/,"").split(/[\n\r]/);if(lines.length<3)return atoms;if(!lines[1].match(/\d+/))return console.log("Warning: second line of the vasp structure file must be a number"),atoms;if(lattice.length=parseFloat(lines[1]),lattice.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),atoms;lattice.xVec=new Float32Array(lines[2].replace(/^\s+/,"").split(/\s+/)),lattice.yVec=new Float32Array(lines[3].replace(/^\s+/,"").split(/\s+/)),lattice.zVec=new Float32Array(lines[4].replace(/^\s+/,"").split(/\s+/));var matrix=new $3Dmol.Matrix4(lattice.xVec[0],lattice.xVec[1],lattice.xVec[2],0,lattice.yVec[0],lattice.yVec[1],lattice.yVec[2],0,lattice.zVec[0],lattice.zVec[1],lattice.zVec[2],0,0,0,0,1);matrix.multiplyScalar(lattice.length);atoms.modelData=[{symmetries:[],cryst:{matrix:matrix}}];var atomSymbols=lines[5].replace(/\s+/,"").replace(/\s+$/,"").split(/\s+/),atomSpeciesNumber=new Int16Array(lines[6].replace(/^\s+/,"").split(/\s+/)),vaspMode=lines[7].replace(/\s+/,"");if(vaspMode.match(/C/))vaspMode="cartesian";else{if(!vaspMode.match(/D/))return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),atoms;vaspMode="direct"}if(atomSymbols.length!=atomSpeciesNumber.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(atomSymbols),console.log(atomSpeciesNumber),atoms;lines.splice(0,8);for(var atomCounter=0,i=0,len=atomSymbols.length;i<len;i++){for(var atomSymbol=atomSymbols[i],j=0,atomLen=atomSpeciesNumber[i];j<atomLen;j++){var coords=new Float32Array(lines[atomCounter+j].replace(/^\s+/,"").split(/\s+/)),atom={};atom.elem=atomSymbol,"cartesian"==vaspMode?(atom.x=lattice.length*coords[0],atom.y=lattice.length*coords[1],atom.z=lattice.length*coords[2]):(atom.x=lattice.length*(coords[0]*lattice.xVec[0]+coords[1]*lattice.yVec[0]+coords[2]*lattice.zVec[0]),atom.y=lattice.length*(coords[0]*lattice.xVec[1]+coords[1]*lattice.yVec[1]+coords[2]*lattice.zVec[1]),atom.z=lattice.length*(coords[0]*lattice.xVec[2]+coords[1]*lattice.yVec[2]+coords[2]*lattice.zVec[2])),atom.bonds=[],atoms[0].push(atom)}atomCounter+=atomSpeciesNumber[i]}return atoms},parsers.cube=parsers.CUBE=function(str,options){var atoms=[[]],lines=str.replace(/^\s+/,"").split(/\n\r|\r+/);if(lines.length<6)return atoms;var lineArr=lines[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),natoms=Math.abs(parseFloat(lineArr[0]));lineArr=lines[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var convFactor=parseFloat(lineArr[0])>0?.529177:1;lines=lines.splice(6,natoms);for(var start=atoms[atoms.length-1].length,end=start+lines.length,i=start;i<end;++i){var atom={};atom.serial=i;var tokens=lines[i-start].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");6==tokens[0]?atom.elem="C":1==tokens[0]?atom.elem="H":8==tokens[0]?atom.elem="O":17==tokens[0]&&(atom.elem="Cl"),atom.x=parseFloat(tokens[2])*convFactor,atom.y=parseFloat(tokens[3])*convFactor,atom.z=parseFloat(tokens[4])*convFactor,atom.hetflag=!0,atom.bonds=[],atom.bondOrder=[],atom.properties={},atoms[atoms.length-1].push(atom)}for(i=0;i<atoms.length;i++)assignBonds(atoms[i]);return atoms},parsers.xyz=parsers.XYZ=function(str,options){for(var atoms=[[]],lines=str.split(/\r?\n|\r/);lines.length>0&&!(lines.length<3);){var atomCount=parseInt(lines[0]);if(isNaN(atomCount)||atomCount<=0)break;if(lines.length<atomCount+2)break;for(var offset=2,start=atoms[atoms.length-1].length,end=start+atomCount,i=start;i<end;i++){var tokens=lines[offset++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),atom={};atom.serial=i;var elem=tokens[0];atom.atom=atom.elem=elem[0].toUpperCase()+elem.substr(1).toLowerCase(),atom.x=parseFloat(tokens[1]),atom.y=parseFloat(tokens[2]),atom.z=parseFloat(tokens[3]),atom.hetflag=!0,atom.bonds=[],atom.bondOrder=[],atom.properties={},atoms[atoms.length-1][i]=atom,tokens.length>=7&&(atom.dx=parseFloat(tokens[4]),atom.dy=parseFloat(tokens[5]),atom.dz=parseFloat(tokens[6]))}if(!options.multimodel)break;atoms.push([]),lines.splice(0,offset)}for(i=0;i<atoms.length;i++)assignBonds(atoms[i]);if(options.onemol){var temp=atoms;(atoms=[]).push(temp[0]);for(i=1;i<temp.length;i++)for(var offset=atoms[0].length,j=0;j<temp[i].length;j++){for(var a=temp[i][j],k=0;k<a.bonds.length;k++)a.bonds[k]=a.bonds[k]+offset;a.index=atoms[0].length,a.serial=atoms[0].length,atoms[0].push(a)}}return atoms},parsers.sdf=parsers.SDF=function(str,options){var atoms=[[]],noH=!1;void 0!==options.keepH&&(noH=!options.keepH);for(var lines=str.split(/\r?\n|\r/);lines.length>0&&!(lines.length<4);){var atomCount=parseInt(lines[3].substr(0,3));if(isNaN(atomCount)||atomCount<=0)break;var bondCount=parseInt(lines[3].substr(3,3)),offset=4;if(lines.length<4+atomCount+bondCount)break;var i,line,serialToIndex=[],start=atoms[atoms.length-1].length,end=start+atomCount;for(i=start;i<end;i++,offset++){var atom={},elem=(line=lines[offset]).substr(31,3).replace(/ /g,"");atom.atom=atom.elem=elem[0].toUpperCase()+elem.substr(1).toLowerCase(),"H"==atom.elem&&noH||(atom.serial=i,serialToIndex[i]=atoms[atoms.length-1].length,atom.x=parseFloat(line.substr(0,10)),atom.y=parseFloat(line.substr(10,10)),atom.z=parseFloat(line.substr(20,10)),atom.hetflag=!0,atom.bonds=[],atom.bondOrder=[],atom.properties={},atom.index=atoms[atoms.length-1].length,atoms[atoms.length-1].push(atom))}for(i=0;i<bondCount;i++,offset++){line=lines[offset];var from=serialToIndex[parseInt(line.substr(0,3))-1+start],to=serialToIndex[parseInt(line.substr(3,3))-1+start],order=parseInt(line.substr(6,3));void 0!==from&&void 0!==to&&(atoms[atoms.length-1][from].bonds.push(to),atoms[atoms.length-1][from].bondOrder.push(order),atoms[atoms.length-1][to].bonds.push(from),atoms[atoms.length-1][to].bondOrder.push(order))}if(!options.multimodel)break;for(options.onemol||atoms.push([]);"$$$$"!=lines[offset];)offset++;lines.splice(0,++offset)}return atoms},parsers.cdjson=parsers.json=function(str,options){var atoms=[[]];"string"==typeof str&&(str=JSON.parse(str));for(var molecules=str.m,atomsInFile=molecules[0].a,bondsInFile=molecules[0].b,styles=molecules[0].s,parseStyle=void 0!==options&&void 0!==options.parseStyle?options.parseStyle:void 0!==styles,offset=atoms[atoms.length-1].length,i=0;i<atomsInFile.length;i++){var currentAtom=atomsInFile[i],atom={};atom.id=currentAtom.i,atom.x=currentAtom.x,atom.y=currentAtom.y,atom.z=currentAtom.z||0,atom.bonds=[],atom.bondOrder=[];var elem=currentAtom.l||"C";atom.elem=elem[0].toUpperCase()+elem.substr(1).toLowerCase(),atom.serial=atoms[atoms.length-1].length,parseStyle&&(atom.style=styles[currentAtom.s||0]),atoms[atoms.length-1].push(atom)}for(i=0;i<bondsInFile.length;i++){var currentBond=bondsInFile[i],beginIndex=currentBond.b+offset,endIndex=currentBond.e+offset,bondOrder=currentBond.o||1,firstAtom=atoms[atoms.length-1][beginIndex],secondAtom=atoms[atoms.length-1][endIndex];firstAtom.bonds.push(endIndex),firstAtom.bondOrder.push(bondOrder),secondAtom.bonds.push(beginIndex),secondAtom.bondOrder.push(bondOrder)}return atoms},parsers.mcif=parsers.cif=function(str,options){for(var atoms=[],noAssembly=!options.doAssembly,copyMatrix=!options.duplicateAssemblyAtoms,modelData=atoms.modelData=[],lines=str.split(/\r?\n|\r/),linesFiltered=[],trimDisabled=!1,lineNum=0;lineNum<lines.length;lineNum++){line=lines[lineNum].split("#")[0];if(trimDisabled?";"===line[0]&&(trimDisabled=!1):";"===line[0]&&(trimDisabled=!0),trimDisabled||""!==line){if(!trimDisabled&&"_"===(line=line.trim())[0]){var dot=line.split(/\s/)[0].indexOf(".");dot>-1&&(line[dot]="_",line=line.substr(0,dot)+"_"+line.substr(dot+1))}linesFiltered.push(line)}}for(lineNum=0;lineNum<linesFiltered.length;){for(;!linesFiltered[lineNum].startsWith("data_")||"data_global"===linesFiltered[lineNum];)lineNum++;lineNum++;for(var mmCIF={};lineNum<linesFiltered.length&&!linesFiltered[lineNum].startsWith("data_");)if(void 0===linesFiltered[lineNum][0])lineNum++;else if("_"===linesFiltered[lineNum][0]){var dataItem=mmCIF[dataItemName=linesFiltered[lineNum].split(/\s/)[0].toLowerCase()]=mmCIF[dataItemName]||[],restOfLine=linesFiltered[lineNum].substr(linesFiltered[lineNum].indexOf(dataItemName)+dataItemName.length);if(""===restOfLine)if(lineNum++,";"===linesFiltered[lineNum][0]){var dataBlock=linesFiltered[lineNum].substr(1);for(lineNum++;";"!==linesFiltered[lineNum];)dataBlock=dataBlock+"\n"+linesFiltered[lineNum],lineNum++;dataItem.push(dataBlock)}else dataItem.push(linesFiltered[lineNum]);else dataItem.push(restOfLine.trim());lineNum++}else if("loop_"===linesFiltered[lineNum].substr(0,5)){lineNum++;for(var dataItems=[];""===linesFiltered[lineNum]||"_"===linesFiltered[lineNum][0];){if(""!==linesFiltered[lineNum]){var dataItemName=linesFiltered[lineNum].split(/\s/)[0].toLowerCase(),dataItem=mmCIF[dataItemName]=mmCIF[dataItemName]||[];dataItems.push(dataItem)}lineNum++}for(var currentDataItem=0;lineNum<linesFiltered.length&&"_"!==linesFiltered[lineNum][0]&&!linesFiltered[lineNum].startsWith("loop_")&&!linesFiltered[lineNum].startsWith("data_");){for(var line=function(string,separator){for(var sections=[],sectionStart=0,sectionEnd=0;sectionEnd<string.length;){for(;string.substr(sectionEnd,separator.length)!==separator&&sectionEnd<string.length;){if("'"===string[sectionEnd])for(sectionEnd++;sectionEnd<string.length&&"'"!==string[sectionEnd];)sectionEnd++;else if('"'===string[sectionEnd])for(sectionEnd++;sectionEnd<string.length&&'"'!==string[sectionEnd];)sectionEnd++;sectionEnd++}sections.push(string.substr(sectionStart,sectionEnd-sectionStart)),sectionStart=sectionEnd+=separator.length}return sections}(linesFiltered[lineNum]," "),field=0;field<line.length;field++)""!==line[field]&&(dataItems[currentDataItem].push(line[field]),currentDataItem=(currentDataItem+1)%dataItems.length);lineNum++}}else lineNum++;modelData.push({symmetries:[]}),atoms.push([]);var atomCount=void 0!==mmCIF._atom_site_id?mmCIF._atom_site_id.length:mmCIF._atom_site_label.length;function sqr(n){return n*n}var conversionMatrix;if(void 0!==mmCIF._cell_length_a){var a=parseFloat(mmCIF._cell_length_a),b=parseFloat(mmCIF._cell_length_b),c=parseFloat(mmCIF._cell_length_c),alpha_deg=parseFloat(mmCIF._cell_angle_alpha)||90,beta_deg=parseFloat(mmCIF._cell_angle_beta)||90,gamma_deg=parseFloat(mmCIF._cell_angle_gamma)||90,alpha=alpha_deg*Math.PI/180,beta=beta_deg*Math.PI/180,gamma=gamma_deg*Math.PI/180,cos_alpha=Math.cos(alpha),cos_beta=Math.cos(beta),cos_gamma=Math.cos(gamma),sin_gamma=Math.sin(gamma);conversionMatrix=[[a,b*cos_gamma,c*cos_beta],[0,b*sin_gamma,c*(cos_alpha-cos_beta*cos_gamma)/sin_gamma],[0,0,c*Math.sqrt(1-sqr(cos_alpha)-sqr(cos_beta)-sqr(cos_gamma)+2*cos_alpha*cos_beta*cos_gamma)/sin_gamma]],modelData[modelData.length-1].cryst={a:a,b:b,c:c,alpha:alpha_deg,beta:beta_deg,gamma:gamma_deg}}function fractionalToCartesian(a,b,c){return{x:conversionMatrix[0][0]*a+conversionMatrix[0][1]*b+conversionMatrix[0][2]*c,y:conversionMatrix[1][0]*a+conversionMatrix[1][1]*b+conversionMatrix[1][2]*c,z:conversionMatrix[2][0]*a+conversionMatrix[2][1]*b+conversionMatrix[2][2]*c}}for(i=0;i<atomCount;i++)if(void 0===mmCIF._atom_site_group_pdb||"TER"!==mmCIF._atom_site_group_pdb[i]){var atom={};if(void 0!==mmCIF._atom_site_cartn_x)atom.x=parseFloat(mmCIF._atom_site_cartn_x[i]),atom.y=parseFloat(mmCIF._atom_site_cartn_y[i]),atom.z=parseFloat(mmCIF._atom_site_cartn_z[i]);else{var coords=fractionalToCartesian(parseFloat(mmCIF._atom_site_fract_x[i]),parseFloat(mmCIF._atom_site_fract_y[i]),parseFloat(mmCIF._atom_site_fract_z[i]));atom.x=coords.x,atom.y=coords.y,atom.z=coords.z}atom.chain=mmCIF._atom_site_auth_asym_id?mmCIF._atom_site_auth_asym_id[i]:void 0,atom.resi=mmCIF._atom_site_auth_seq_id?parseInt(mmCIF._atom_site_auth_seq_id[i]):void 0,atom.resn=mmCIF._atom_site_auth_comp_id?mmCIF._atom_site_auth_comp_id[i].trim():void 0,atom.atom=mmCIF._atom_site_auth_atom_id?mmCIF._atom_site_auth_atom_id[i].replace(/"/gm,""):void 0,atom.hetflag=!mmCIF._atom_site_group_pdb||"HETA"===mmCIF._atom_site_group_pdb[i]||"HETATM"===mmCIF._atom_site_group_pdb[i];var elem=mmCIF._atom_site_type_symbol[i];atom.elem=elem[0].toUpperCase()+elem.substr(1).toLowerCase(),atom.bonds=[],atom.ss="c",atom.serial=i,atom.bondOrder=[],atom.properties={},atoms[atoms.length-1].push(atom)}if(void 0!==mmCIF._pdbx_struct_oper_list_id&&!noAssembly){for(i=0;i<mmCIF._pdbx_struct_oper_list_id.length;i++){var matrix11=parseFloat(mmCIF["_pdbx_struct_oper_list_matrix[1][1]"][i]),matrix12=parseFloat(mmCIF["_pdbx_struct_oper_list_matrix[1][2]"][i]),matrix13=parseFloat(mmCIF["_pdbx_struct_oper_list_matrix[1][3]"][i]),vector1=parseFloat(mmCIF["_pdbx_struct_oper_list_vector[1]"][i]),matrix21=parseFloat(mmCIF["_pdbx_struct_oper_list_matrix[2][1]"][i]),matrix22=parseFloat(mmCIF["_pdbx_struct_oper_list_matrix[2][2]"][i]),matrix23=parseFloat(mmCIF["_pdbx_struct_oper_list_matrix[2][3]"][i]),vector2=parseFloat(mmCIF["_pdbx_struct_oper_list_vector[2]"][i]),matrix31=parseFloat(mmCIF["_pdbx_struct_oper_list_matrix[3][1]"][i]),matrix32=parseFloat(mmCIF["_pdbx_struct_oper_list_matrix[3][2]"][i]),matrix33=parseFloat(mmCIF["_pdbx_struct_oper_list_matrix[3][3]"][i]),vector3=parseFloat(mmCIF["_pdbx_struct_oper_list_vector[3]"][i]),matrix=new $3Dmol.Matrix4(matrix11,matrix12,matrix13,vector1,matrix21,matrix22,matrix23,vector2,matrix31,matrix32,matrix33,vector3);modelData[modelData.length-1].symmetries.push(matrix)}for(i=0;i<atoms.length;i++)processSymmetries(modelData[modelData.length-1].symmetries,copyMatrix,atoms[i])}function parseTerm(term){var denominator,negative=term.match("-"),fractionParts=(term=term.replace(/[-xyz]/g,"")).split("/");return denominator=void 0===fractionParts[1]?1:parseInt(fractionParts[1]),(""===fractionParts[0]?1:parseInt(fractionParts[0]))/denominator*(negative?-1:1)}if(void 0!==mmCIF._symmetry_equiv_pos_as_xyz)for(var sym=0;sym<mmCIF._symmetry_equiv_pos_as_xyz.length;sym++){for(var componentStrings=mmCIF._symmetry_equiv_pos_as_xyz[sym].replace(/["' ]/g,"").split(",").map(function(val){return val.replace(/-/g,"+-")}),matrix=new $3Dmol.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1),coord=0;coord<3;coord++)for(var terms=componentStrings[coord].split("+"),t=0;t<terms.length;t++){var term=terms[t];if(""!==term){var coefficient=parseTerm(term);term.match("x")?matrix.elements[coord+0]=coefficient:term.match("y")?matrix.elements[coord+4]=coefficient:term.match("z")?matrix.elements[coord+8]=coefficient:matrix.elements[coord+12]=coefficient}}var conversionMatrix4=new $3Dmol.Matrix4(conversionMatrix[0][0],conversionMatrix[0][1],conversionMatrix[0][2],0,conversionMatrix[1][0],conversionMatrix[1][1],conversionMatrix[1][2],0,conversionMatrix[2][0],conversionMatrix[2][1],conversionMatrix[2][2],0),conversionInverse=(new $3Dmol.Matrix4).getInverse(conversionMatrix4,!0);matrix=(new $3Dmol.Matrix4).multiplyMatrices(matrix,conversionInverse),matrix=(new $3Dmol.Matrix4).multiplyMatrices(conversionMatrix4,matrix),modelData[modelData.length-1].symmetries.push(matrix)}}for(var i=0;i<atoms.length;i++)assignBonds(atoms[i]),computeSecondaryStructure(atoms[i]),processSymmetries(modelData[i].symmetries,copyMatrix,atoms[i]);return atoms},parsers.mol2=parsers.MOL2=function(str,options){var atoms=[[]],noH=!1;void 0!==options.keepH&&(noH=!options.keepH);var mol_pos=str.search(/@<TRIPOS>MOLECULE/),atom_pos=str.search(/@<TRIPOS>ATOM/);if(-1==mol_pos||-1==atom_pos)return atoms;for(var lines=str.substr(mol_pos,str.length).split(/\r?\n|\r/);lines.length>0;){var serialToIndex=[],tokens=lines[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),natoms=parseInt(tokens[0]),nbonds=0;tokens.length>1&&(nbonds=parseInt(tokens[1]));var i,offset=4;for(i=3;i<lines.length;i++)if("@<TRIPOS>ATOM"==lines[i]){offset=i+1;break}var line,start=atoms[atoms.length-1].length,end=start+natoms;for(i=start;i<end;i++){var atom={},elem=(tokens=(line=lines[offset++]).replace(/^\s+/,"").replace(/\s+/g," ").split(" "))[5].split(".")[0];if(atom.atom=atom.elem=elem[0].toUpperCase()+elem.substr(1).toLowerCase(),"H"==atom.elem&&noH);else{var index=atoms[atoms.length-1].length,serial=parseInt(tokens[0]);atom.serial=serial,atom.x=parseFloat(tokens[2]),atom.y=parseFloat(tokens[3]),atom.z=parseFloat(tokens[4]),atom.atom=tokens[5];var charge=parseFloat(tokens[8]);atom.index=index,atom.bonds=[],atom.bondOrder=[],atom.properties={charge:charge,partialCharge:charge},serialToIndex[serial]=index,atoms[atoms.length-1].push(atom)}}for(var bonds_found=!1;offset<lines.length;)if("@<TRIPOS>BOND"==lines[offset++]){bonds_found=!0;break}if(bonds_found&&nbonds)for(i=0;i<nbonds;i++){tokens=(line=lines[offset++]).replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var from=parseInt(tokens[1]),fromAtom=atoms[atoms.length-1][serialToIndex[from]],to=parseInt(tokens[2]),toAtom=atoms[atoms.length-1][serialToIndex[to]],order=parseInt(tokens[3]);isNaN(order)&&(order=1),void 0!==fromAtom&&void 0!==toAtom&&(fromAtom.bonds.push(serialToIndex[to]),fromAtom.bondOrder.push(order),toAtom.bonds.push(serialToIndex[from]),toAtom.bondOrder.push(order))}if(!options.multimodel)break;options.onemol||atoms.push([]),lines.splice(0,offset),str=lines.join("\n")}return atoms};var bondTable={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45},bondLength=function(elem){return bondTable[elem]||1.6},areConnected=function(atom1,atom2){var maxsq=bondLength(atom1.elem)+bondLength(atom2.elem);maxsq+=.25,maxsq*=maxsq;var xdiff=atom1.x-atom2.x;if((xdiff*=xdiff)>maxsq)return!1;var ydiff=atom1.y-atom2.y;if((ydiff*=ydiff)>maxsq)return!1;var zdiff=atom1.z-atom2.z;if((zdiff*=zdiff)>maxsq)return!1;var distSquared=xdiff+ydiff+zdiff;return!isNaN(distSquared)&&(!(distSquared<.5)&&(!(distSquared>maxsq)&&(atom1.altLoc==atom2.altLoc||" "==atom1.altLoc||" "==atom2.altLoc)))},processSymmetries=function(copyMatrices,copyMatrix,atoms){var t,l,n,end=atoms.length,offset=end;if(copyMatrix){if(copyMatrices.length>1)for(t=0;t<atoms.length;t++){var symmetries=[];for(l=0;l<copyMatrices.length;l++)if(!copyMatrices[l].isIdentity()){var newXYZ=new $3Dmol.Vector3;newXYZ.set(atoms[t].x,atoms[t].y,atoms[t].z),newXYZ.applyMatrix4(copyMatrices[l]),symmetries.push(newXYZ)}atoms[t].symmetries=symmetries}}else for(t=0;t<copyMatrices.length;t++)if(!copyMatrices[t].isIdentity()){var xyz=new $3Dmol.Vector3;for(n=0;n<end;n++){var bondsArr=[];for(l=0;l<atoms[n].bonds.length;l++)bondsArr.push(atoms[n].bonds[l]+offset);xyz.set(atoms[n].x,atoms[n].y,atoms[n].z),xyz.applyMatrix4(copyMatrices[t]);var newAtom={};for(var i in atoms[n])newAtom[i]=atoms[n][i];newAtom.x=xyz.x,newAtom.y=xyz.y,newAtom.z=xyz.z,newAtom.bonds=bondsArr,atoms.push(newAtom)}offset=atoms.length}},isEmpty=function(obj){var name;for(name in obj)return!1;return!0},atomNameToElem=function(name,nothetero){var elem=name.replace(/ /g,"");return elem.length>0&&"H"==elem[0]&&"Hg"!=elem&&(elem="H"),elem.length>1&&(elem=elem[0].toUpperCase()+elem.substr(1).toLowerCase(),void 0===bondTable[elem]?elem=elem[0]:nothetero&&("Ca"==elem?elem="C":"Cd"==elem&&(elem="C"))),elem},getSinglePDB=function(lines,options,sslookup){var atom,i,j,line,atoms=[],noH=!options.keepH,ignoreStruct=!!options.noSecondaryStructure,computeStruct=!options.noComputeSecondaryStructure,noAssembly=!options.doAssembly,copyMatrix=!options.duplicateAssemblyAtoms,selAltLoc=options.altLoc?options.altLoc:"A",modelData={symmetries:[]},remainingLines=[],serialToIndex=[],seenbonds={};for(i=0;i<lines.length;i++){var startChain,startResi,endResi,recordName=(line=lines[i].replace(/^\s*/,"")).substr(0,6);if(0==recordName.indexOf("END")){if(remainingLines=lines.slice(i+1),"END"==recordName)for(var prop in sslookup)sslookup.hasOwnProperty(prop)&&delete sslookup[prop];break}if("ATOM  "==recordName||"HETATM"==recordName){var resn,chain,resi,icode,x,y,z,hetflag,elem,serial,altLoc;if(" "!=(altLoc=line.substr(16,1))&&altLoc!=selAltLoc&&"*"!=selAltLoc)continue;if(serial=parseInt(line.substr(6,5)),atom=line.substr(12,4).replace(/ /g,""),resn=line.substr(17,3).replace(/ /g,""),chain=line.substr(21,1),resi=parseInt(line.substr(22,4)),icode=line.substr(26,1),x=parseFloat(line.substr(30,8)),y=parseFloat(line.substr(38,8)),z=parseFloat(line.substr(46,8)),b=parseFloat(line.substr(60,8)),elem=line.substr(76,2).replace(/ /g,""),"H"==(elem=""===elem||void 0===bondTable[elem]?atomNameToElem(line.substr(12,2),"A"==line[0]):elem[0].toUpperCase()+elem.substr(1).toLowerCase())&&noH)continue;hetflag="H"==recordName[0],serialToIndex[serial]=atoms.length,atoms.push({resn:resn,x:x,y:y,z:z,elem:elem,hetflag:hetflag,altLoc:altLoc,chain:chain,resi:resi,icode:icode,rescode:resi+(" "!=icode?"^"+icode:""),serial:serial,atom:atom,bonds:[],ss:"c",bondOrder:[],properties:{},b:b,pdbline:line})}else if("SHEET "==recordName){!0,startChain=line.substr(21,1),startResi=parseInt(line.substr(22,4)),line.substr(32,1),endResi=parseInt(line.substr(33,4)),startChain in sslookup||(sslookup[startChain]={}),sslookup[startChain][startResi]="s1";for(res=startResi+1;res<endResi;res++)sslookup[startChain][res]="s";sslookup[startChain][endResi]="s2"}else if("CONECT"==recordName){var fromindex=serialToIndex[parseInt(line.substr(6,5))],fromAtom=atoms[fromindex],coffsets=[11,16,21,26];for(j=0;j<4;j++){var toindex=serialToIndex[parseInt(line.substr(coffsets[j],5))],toAtom=atoms[toindex];if(void 0!==fromAtom&&void 0!==toAtom)if(seenbonds[[fromindex,toindex]]){seenbonds[[fromindex,toindex]]+=1;for(var bi=0;bi<fromAtom.bonds.length;bi++)if(fromAtom.bonds[bi]==toindex){var newbo=seenbonds[[fromindex,toindex]];fromAtom.bondOrder[bi]=newbo>=4?1:newbo}}else seenbonds[[fromindex,toindex]]=1,0!=fromAtom.bonds.length&&fromAtom.bonds[fromAtom.bonds.length-1]==toindex||(fromAtom.bonds.push(toindex),fromAtom.bondOrder.push(1))}}else if("HELIX "==recordName){!0,startChain=line.substr(19,1),startResi=parseInt(line.substr(21,4)),line.substr(31,1),endResi=parseInt(line.substr(33,4)),startChain in sslookup||(sslookup[startChain]={}),sslookup[startChain][startResi]="h1";for(var res=startResi+1;res<endResi;res++)sslookup[startChain][res]="h";sslookup[startChain][endResi]="h2"}else if(noAssembly||"REMARK"!=recordName||"BIOMT"!=line.substr(13,5)){if("CRYST1"==recordName){var a,b,c,alpha,beta,gamma;a=parseFloat(line.substr(7,8)),b=parseFloat(line.substr(16,8)),c=parseFloat(line.substr(25,8)),alpha=parseFloat(line.substr(34,6)),beta=parseFloat(line.substr(41,6)),gamma=parseFloat(line.substr(48,6)),modelData.cryst={a:a,b:b,c:c,alpha:alpha,beta:beta,gamma:gamma}}else if("ANISOU"==recordName){var anisouAtom=atoms[serialToIndex[serial=parseInt(line.substr(6,5))]];if(anisouAtom){var vals=line.substr(30).trim().split(/\s+/),uMat={u11:parseInt(vals[0]),u22:parseInt(vals[1]),u33:parseInt(vals[2]),u12:parseInt(vals[3]),u13:parseInt(vals[4]),u23:parseInt(vals[5])};anisouAtom.uMat=uMat}}}else{var n,matrix=new $3Dmol.Matrix4;for(n=1;n<=3;n++)if(line=lines[i].replace(/^\s*/,""),parseInt(line.substr(18,1))==n)matrix.elements[n-1]=parseFloat(line.substr(23,10)),matrix.elements[n-1+4]=parseFloat(line.substr(33,10)),matrix.elements[n-1+8]=parseFloat(line.substr(43,10)),matrix.elements[n-1+12]=parseFloat(line.substr(53)),i++;else for(;"BIOMT"==line.substr(13,5);)line=lines[++i].replace(/^\s*/,"");matrix.elements[3]=0,matrix.elements[7]=0,matrix.elements[11]=0,matrix.elements[15]=1,modelData.symmetries.push(matrix),i--}}(new Date).getTime();if(validateBonds(atoms,serialToIndex),assignPDBBonds(atoms),noAssembly||processSymmetries(modelData.symmetries,copyMatrix,atoms),computeStruct&&!ignoreStruct&&((new Date).getTime(),computeSecondaryStructure(atoms)),(new Date).getTime(),!isEmpty(sslookup))for(i=0;i<atoms.length;i++)if(void 0!==(atom=atoms[i])&&atom.chain in sslookup&&atom.resi in sslookup[atom.chain]){var code=sslookup[atom.chain][atom.resi];atom.ss=code[0],code.length>1&&("1"==code[1]?atom.ssbegin=!0:"2"==code[1]&&(atom.ssend=!0))}return[atoms,modelData,remainingLines]};parsers.pdb=parsers.PDB=parsers.pdbqt=parsers.PDBQT=function(str,options){var atoms=[],sslookup={};atoms.modelData=[];for(var lines=str.split(/\r?\n|\r/);lines.length>0;){var pdbinfo=getSinglePDB(lines,options,sslookup),modelatoms=pdbinfo[0],modelData=pdbinfo[1];if(lines=pdbinfo[2],0!=modelatoms.length){if(options.multimodel&&options.onemol&&atoms.length>0)for(var inc=atoms[0].length,i=0;i<modelatoms.length;i++){var atom=modelatoms[i];atom.index=i;for(var b=0;b<atom.bonds.length;b++)atom.bonds[b]+=inc;atoms[0].push(atom)}else atoms.modelData.push(modelData),atoms.push(modelatoms);if(!options.multimodel)break}}return atoms},parsers.pqr=parsers.PQR=function(str,options){var j,line,atoms=[[]],computeStruct=(atoms[atoms.length-1].length,!options.noSecondaryStructure),serialToIndex=(options.doAssembly,options.duplicateAssemblyAtoms,atoms.modelData=[{symmetries:[]}],[]),lines=str.split(/\r?\n|\r/);for(i=0;i<lines.length;i++){var recordName=(line=lines[i].replace(/^\s*/,"")).substr(0,6);if(0==recordName.indexOf("END")){if(options.multimodel){options.onemol||atoms.push([]);continue}break}if("ATOM  "==recordName||"HETATM"==recordName){var hetflag,serial=parseInt(line.substr(6,5)),atom=line.substr(12,4).replace(/ /g,""),resn=line.substr(17,3),chain=line.substr(21,1),resi=parseInt(line.substr(22,4)),vals=line.substr(30).trim().split(/\s+/),x=parseFloat(vals[0]),y=parseFloat(vals[1]),z=parseFloat(vals[2]),charge=parseFloat(vals[3]),radius=parseFloat(vals[4]),elem=atom[0];atom.length>1&&atom[1].toUpperCase()!=atom[1]&&(elem=atom.substr(0,2)),hetflag="H"==line[0],serialToIndex[serial]=atoms[atoms.length-1].length,atoms[atoms.length-1].push({resn:resn,x:x,y:y,z:z,elem:elem,hetflag:hetflag,chain:chain,resi:resi,serial:serial,atom:atom,bonds:[],ss:"c",bondOrder:[],properties:{charge:charge,partialCharge:charge,radius:radius},pdbline:line})}else if("CONECT"==recordName){var from=parseInt(line.substr(6,5)),fromAtom=atoms[atoms.length-1][serialToIndex[from]];for(j=0;j<4;j++){var to=parseInt(line.substr([11,16,21,26][j],5)),toAtom=atoms[atoms.length-1][serialToIndex[to]];void 0!==fromAtom&&void 0!==toAtom&&(fromAtom.bonds.push(serialToIndex[to]),fromAtom.bondOrder.push(1))}}}for(var i=0;i<atoms.length;i++)assignPDBBonds(atoms[i]),computeStruct&&computeSecondaryStructure(atoms[i]);return atoms};var fromCharCode=function(charCodeArray){return String.fromCharCode.apply(null,charCodeArray).replace(/\0/g,"")},convertSS=function(val){return 2==val?"h":3==val?"s":"c"};return parsers.mmtf=parsers.MMTF=function(bindata,options){var noH=!options.keepH,selAltLoc=options.altLoc?options.altLoc:"A",ignoreStruct=!!options.noSecondaryStructure,computeStruct=!options.noComputeSecondaryStructure,noAssembly=!options.doAssembly,copyMatrix=!options.duplicateAssemblyAtoms,assemblyIndex=options.assemblyIndex?options.assemblyIndex:0,mmtfData=MMTF.decode(bindata),atoms=[[]],modelData=atoms.modelData=[],modelIndex=0,chainIndex=0,groupIndex=0,atomIndex=0,secStructList=(mmtfData.chainNameList,mmtfData.secStructList),insCodeList=mmtfData.insCodeList,sequenceIndexList=mmtfData.sequenceIndexList,bFactorList=mmtfData.bFactorList,altLocList=mmtfData.altLocList,occupancyList=mmtfData.occupancyList,bondAtomList=mmtfData.bondAtomList,bondOrderList=mmtfData.bondOrderList,numModels=mmtfData.numModels;if(0==numModels)return atoms;options.multimodel||(numModels=1);var i,j,k,kl,m,symmetries=[];if(!noAssembly&&mmtfData.bioAssemblyList&&mmtfData.bioAssemblyList.length>0){var transforms=mmtfData.bioAssemblyList[assemblyIndex].transformList;for(i=0,n=transforms.length;i<n;i++){var matrix=new $3Dmol.Matrix4(transforms[i].matrix);matrix.transpose(),symmetries.push(matrix)}}var bondAtomListStart=0;for(m=0;m<numModels;m++){var modelChainCount=mmtfData.chainsPerModel[m],matoms=atoms[atoms.length-1],serialToIndex=[];for(modelData.push({symmetries:symmetries}),i=0;i<modelChainCount;++i){var chainGroupCount=mmtfData.groupsPerChain[chainIndex],chainId=fromCharCode(mmtfData.chainIdList.subarray(4*chainIndex,4*chainIndex+4));mmtfData.chainNameList&&(chainId=fromCharCode(mmtfData.chainNameList.subarray(4*chainIndex,4*chainIndex+4)));var startGroup=groupIndex,prevSS="";for(j=0;j<chainGroupCount;++j){var groupData=mmtfData.groupList[mmtfData.groupTypeList[groupIndex]],groupAtomCount=groupData.atomNameList.length,secStruct=0,secStructBegin=!1,secStructEnd=!1;if(secStructList){secStruct=secStructList[groupIndex];var sscode=convertSS(secStruct);0!=groupIndex&&sscode==prevSS||(secStructBegin=!0),prevSS=sscode;var nextgroup=groupIndex+1;(nextgroup>=secStructList.length||convertSS(secStructList[nextgroup]!=sscode))&&(secStructEnd=!0)}mmtfData.insCodeList&&String.fromCharCode(insCodeList[groupIndex]);sequenceIndexList&&sequenceIndexList[groupIndex];var groupId=mmtfData.groupIdList[groupIndex],groupName=groupData.groupName,startAtom=atomIndex;for(k=0;k<groupAtomCount;++k){var element=groupData.elementList[k];if(noH&&"H"==element)atomIndex+=1;else{var bFactor="";bFactorList&&(bFactor=bFactorList[atomIndex]);var altLoc="";altLocList&&altLocList[atomIndex]&&(altLoc=String.fromCharCode(altLocList[atomIndex]));var occupancy="";if(occupancyList&&(occupancy=occupancyList[atomIndex]),""==altLoc||altLoc==selAltLoc||"*"==selAltLoc){var atomId=mmtfData.atomIdList[atomIndex],atomName=groupData.atomNameList[k],atomCharge=0;groupData.atomChargeList&&(atomCharge=groupData.atomChargeList[k]);var xCoord=mmtfData.xCoordList[atomIndex],yCoord=mmtfData.yCoordList[atomIndex],zCoord=mmtfData.zCoordList[atomIndex];serialToIndex[atomIndex]=matoms.length,matoms.push({resn:groupName,x:xCoord,y:yCoord,z:zCoord,elem:element,hetflag:secStruct<0,chain:chainId,resi:groupId,icode:altLoc,rescode:groupId+(" "!=altLoc?"^"+altLoc:""),serial:atomId,altLoc:altLoc,index:atomIndex,atom:atomName,bonds:[],ss:convertSS(secStruct),ssbegin:secStructBegin,ssend:secStructEnd,bondOrder:[],properties:{charge:atomCharge,occupancy:occupancy},b:bFactor}),atomIndex+=1}else atomIndex+=1}}var groupBondAtomList=groupData.bondAtomList;for(k=0,kl=groupData.bondOrderList.length;k<kl;++k){var atomIndex1=startAtom+groupBondAtomList[2*k],atomIndex2=startAtom+groupBondAtomList[2*k+1],bondOrder=groupData.bondOrderList[k],i1=serialToIndex[atomIndex1],i2=serialToIndex[atomIndex2],a1=matoms[i1],a2=matoms[i2];a1&&a2&&(a1.bonds.push(i2),a1.bondOrder.push(bondOrder),a2.bonds.push(i1),a2.bondOrder.push(bondOrder))}groupIndex+=1}for(groupIndex=startGroup,j=0;j<chainGroupCount;++j)groupIndex+=1;chainIndex+=1}if(bondAtomList)for(k=bondAtomListStart,kl=bondAtomList.length;k<kl;k+=2){var atomIndex1=bondAtomList[k],atomIndex2=bondAtomList[k+1],bondOrder=bondOrderList?bondOrderList[k/2]:1;if(atomIndex1>=atomIndex){bondAtomListStart=k;break}var i1=serialToIndex[atomIndex1],i2=serialToIndex[atomIndex2],a1=matoms[i1],a2=matoms[i2];a1&&a2&&(a1.bonds.push(i2),a1.bondOrder.push(bondOrder),a2.bonds.push(i1),a2.bondOrder.push(bondOrder))}if(options.multimodel&&(options.onemol||atoms.push([])),!noAssembly)for(var n=0;n<atoms.length;n++)processSymmetries(modelData[modelIndex].symmetries,copyMatrix,atoms[n]);modelIndex+=1}return computeStruct&&!ignoreStruct&&computeSecondaryStructure(atoms),atoms},parsers.prmtop=parsers.PRMTOP=function(str,options){function getIndex(section){var index=lines.indexOf(sectionList.filter(function(line){return line.includes(section)})[0]);if(Number.isInteger(index)&&index>0){for(;!lines[index].includes("FORMAT");)index++;return index}return-1}function getColEleSize(i){var numberOfCol=lines[i].match(/\((\d*)\S*/),elementSize=lines[i].match(/[a-zA-Z](\d*)\)\s*/);return null==elementSize&&(elementSize=lines[i].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[numberOfCol[1],elementSize[1]]}var atoms=[],count=0,lines=str.split(/\r?\n|\r/);if(!(lines.length>0&&lines[0].includes("VERSION")))return[];var sectionList=lines.filter(function(line){return line.includes("POINTERS")||line.includes("ATOM_NAME")||line.includes("CHARGE")||line.includes("RADII")||line.includes("BONDS_INC_HYDROGEN")||line.includes("BONDS_WITHOUT_HYDROGEN")}),index=getIndex("POINTERS");if(-1==index)return[];var col=getColEleSize(index),atomCount=parseInt(lines[index+1].slice(0,col[1]));if(isNaN(atomCount)||atomCount<=0)return[];if(-1==(index=getIndex("ATOM_NAME")))return[];for(var noOfCol=(col=getColEleSize(index))[0],i=0;i<atomCount/col[0];i++){i==parseInt(atomCount/col[0])&&(noOfCol=atomCount%col[0]);for(var j=0;j<noOfCol;j++){var atom={},properties={charge:"",radii:""};atom.serial=count,atom.x=0,atom.y=0,atom.z=0,atom.atom=lines[index+1].slice(col[1]*j,col[1]*(j+1)),atom.elem=lines[index+1].slice(col[1]*j,col[1]*j+1),atom.properties=properties,atom.bonds=[],atom.bondOrder=[],atoms.push(atom),count++}index++}if(-1!=(index=getIndex("CHARGE")))for(count=0,noOfCol=(col=getColEleSize(index))[0],i=0;i<atomCount/col[0];i++){for(i==parseInt(atomCount/col[0])&&(noOfCol=atomCount%col[0]),j=0;j<noOfCol;j++)atoms[count].properties.charge=parseFloat(lines[index+1].slice(col[1]*j,col[1]*(j+1))),count++;index++}if(-1!=(index=getIndex("RADII")))for(count=0,noOfCol=(col=getColEleSize(index))[0],i=0;i<atomCount/col[0];i++){for(i==parseInt(atomCount/col[0])&&(noOfCol=atomCount%col[0]),j=0;j<noOfCol;j++)atoms[count].properties.radii=parseFloat(lines[index+1].slice(col[1]*j,col[1]*(j+1))),count++;index++}if(-1!=(index=getIndex("BONDS_WITHOUT_HYDROGEN"))){count=0,noOfCol=(col=getColEleSize(index))[0];for(index+=1;!lines[index].match(/^%FLAG/);){for(lines[index+1].match(/^%FLAG/)&&(noOfCol=atomCount%col[0]),j=0;j<noOfCol;j++)count%3==0&&(atomIndex=parseInt(lines[index].slice(col[1]*j,col[1]*(j+1))/3)),count%3==1&&atoms[atomIndex].bonds.push(parseInt(lines[index].slice(col[1]*j,col[1]*(j+1))/3)),count++;index++}}if(-1!=(index=getIndex("BONDS_INC_HYDROGEN"))){count=0,noOfCol=(col=getColEleSize(index))[0];var atomIndex;for(index+=1;!lines[index].match(/^%FLAG/);){for(lines[index+1].match(/^%FLAG/)&&(noOfCol=atomCount%col[0]),j=0;j<noOfCol;j++)count%3==0&&(atomIndex=parseInt(lines[index].slice(col[1]*j,col[1]*(j+1))/3)),count%3==1&&atoms[atomIndex].bonds.push(parseInt(lines[index].slice(col[1]*j,col[1]*(j+1))/3)),count++;index++}}return[atoms]},parsers.gro=parsers.GRO=function(str,options){for(var allatoms=[],lines=str.split(/\r?\n|\r/);lines.length>0&&!(lines.length<3);){var atomCount=parseInt(lines[1]);if(isNaN(atomCount)||atomCount<=0)break;if(lines.length<atomCount+3)break;var atoms=[];allatoms.push(atoms);for(var offset=2,start=atoms.length,end=start+atomCount,i=start;i<end;i++){var line=lines[offset++],atom={};atom.serial=i,atom.atom=line.slice(10,15).trim(),atom.elem=atomNameToElem(atom.atom,!0),atom.x=10*parseFloat(line.slice(20,28)),atom.y=10*parseFloat(line.slice(28,36)),atom.z=10*parseFloat(line.slice(36,44)),atom.resi=parseInt(line.slice(0,5)),atom.resn=line.slice(5,10).trim(),atom.bonds=[],atom.bondOrder=[],atom.properties={},line.length>44&&(atom.dx=10*parseFloat(line.slice(44,52)),atom.dy=10*parseFloat(line.slice(52,60)),atom.dz=10*parseFloat(line.slice(60,68))),atoms[i]=atom}if(lines.length<=offset+3){var box=lines[offset++].trim().split(/\s+/);if(3==box.length){for(var b=0;b<3;b++)box[b]=10*parseFloat(box[b]);allatoms.box=box}}lines.splice(0,++offset)}for(i=0;i<allatoms.length;i++)assignPDBBonds(allatoms[i]);return allatoms},parsers.lammpstrj=parsers.LAMMPSTRJ=function(str,options){for(var atoms=[],dic={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"},lines=str.split(/\r?\n|\r/),offset=0,atomCount=0,start=0;start<lines.length-9;){for(j=start;j<lines.length;j++)if(lines[j].match(/ITEM: NUMBER OF ATOMS/)&&(atomCount=parseInt(lines[j+1])),lines[j].match(/ITEM: ATOMS/)){offset=j+1;break}var types=lines[offset-1].replace("ITEM: ATOMS ","").split(" ");atoms.push([]);for(var j=offset;j<offset+atomCount;j++){for(var atom={},properties={},tokens=lines[j].split(" "),k=0;k<tokens.length;k++){var prop=dic[types[k]];void 0!=prop&&("serial"==prop?atom[prop]=parseInt(tokens[k]):"x"==prop||"y"==prop||"z"===prop?atom[prop]=parseFloat(tokens[k]):"charge"==prop||"radius"==prop?properties[prop]=parseFloat(tokens[k]):atom[prop]=tokens[k]),atom.properties=properties,atom.bonds=[],atom.bondOrder=[]}atoms[atoms.length-1][j-offset]=atom}start=offset+atomCount-1}if(options.assignbonds)for(var i=0;i<atoms.length;i++)assignBonds(atoms[i]);return atoms},parsers}();var $3Dmol=$3Dmol||{};$3Dmol.partialCharges={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55},$3Dmol.applyPartialCharges=function(atom,keepexisting){if((!keepexisting||void 0===atom.partialCharge)&&atom.resn&&atom.atom){var key=atom.resn+":"+atom.atom;atom.properties.partialCharge=$3Dmol.partialCharges[key]}},$3Dmol.VolumeData=function(str,format,options){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,format=format.toLowerCase(),/\.gz$/.test(format)){format=format.replace(/\.gz$/,"");try{str=this[format]&&this[format].isbinary?pako.inflate(str):new TextDecoder("utf-8").decode(pako.inflate(str))}catch(err){console.log(err)}}if(this[format]&&this[format](str),options){if(options.negate)for(var i=0,n=this.data.length;i<n;i++)this.data[i]=-this.data[i];if(options.normalize){for(var total=0,i=0,n=this.data.length;i<n;i++)total+=this.data[i];var mean=total/this.data.length;console.log("computed mean: "+mean),total=0;for(var i=0,n=this.data.length;i<n;i++){var diff=this.data[i]-mean;total+=diff*diff}for(var variance=total/this.data.length,i=0,n=this.data.length;i<n;i++)this.data[i]=(this.data[i]-mean)/variance}}},$3Dmol.VolumeData.prototype.getVal=function(x,y,z){if(this.matrix){this.inversematrix||(this.inversematrix=(new $3Dmol.Matrix4).getInverse(this.matrix));var pt=new $3Dmol.Vector3(x,y,z);x=(pt=pt.applyMatrix4(this.inversematrix)).x,y=pt.y,z=pt.z}else x-=this.origin.x,y-=this.origin.y,z-=this.origin.z,x/=this.unit.x,y/=this.unit.y,z/=this.unit.z;return x=Math.round(x),y=Math.round(y),z=Math.round(z),x<0||x>=this.size.x?0:y<0||y>=this.size.y?0:z<0||z>=this.size.z?0:this.data[x*this.size.y*this.size.z+y*this.size.z+z]},$3Dmol.VolumeData.prototype.getCoordinates=function(index){var x=index/(this.size.y*this.size.z),y=index%(this.size.y*this.size.z),z=index%this.size.z;return x*=this.unit.x,y*=this.unit.y,z*=this.unit.z,x+=this.origin.x,y+=this.origin.y,z+=this.origin.z,{x:x,y:y,z:z}},$3Dmol.VolumeData.prototype.vasp=function(str){var lines=str.replace(/^\s+/,"").split(/[\n\r]/),natoms=$3Dmol.Parsers.vasp(str)[0].length;if(0==natoms)return console.log("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),void(this.data=[]);var v,l_units=1.889725992,convFactor=parseFloat(lines[1]);v=lines[2].replace(/^\s+/,"").split(/\s+/);var xVec=new $3Dmol.Vector3(parseFloat(v[0]),parseFloat(v[1]),parseFloat(v[2])).multiplyScalar(convFactor*l_units);v=lines[3].replace(/^\s+/,"").split(/\s+/);var yVec=new $3Dmol.Vector3(parseFloat(v[0]),parseFloat(v[1]),parseFloat(v[2])).multiplyScalar(convFactor*l_units);v=lines[4].replace(/^\s+/,"").split(/\s+/);var zVec=new $3Dmol.Vector3(parseFloat(v[0]),parseFloat(v[1]),parseFloat(v[2])).multiplyScalar(convFactor*l_units),vol=xVec.x*(yVec.y*zVec.z-zVec.y*yVec.z)-yVec.x*(xVec.y*zVec.z-zVec.y*xVec.z)+zVec.x*(xVec.y*yVec.z-yVec.y*xVec.z),vol_scale=1/(vol=Math.abs(vol)/Math.pow(l_units,3));lines.splice(0,8+natoms+1);var lineArr=lines[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),nX=Math.abs(lineArr[0]),nY=Math.abs(lineArr[1]),nZ=Math.abs(lineArr[2]),origin=this.origin=new $3Dmol.Vector3(0,0,0);this.size={x:nX,y:nY,z:nZ},this.unit=new $3Dmol.Vector3(xVec.x,yVec.y,zVec.z),xVec=xVec.multiplyScalar(1/(l_units*nX)),yVec=yVec.multiplyScalar(1/(l_units*nY)),zVec=zVec.multiplyScalar(1/(l_units*nZ)),0==xVec.y&&0==xVec.z&&0==yVec.x&&0==yVec.z&&0==zVec.x&&0==zVec.y||(this.matrix=new $3Dmol.Matrix4(xVec.x,yVec.x,zVec.x,0,xVec.y,yVec.y,zVec.y,0,xVec.z,yVec.z,zVec.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,(new $3Dmol.Matrix4).makeTranslation(origin.x,origin.y,origin.z)),this.origin=new $3Dmol.Vector3(0,0,0),this.unit=new $3Dmol.Vector3(1,1,1)),lines.splice(0,1);var raw=lines.join(" ");(raw=(raw=raw.replace(/^\s+/,"")).split(/[\s\r]+/)).splice(nX*nY*nZ+1);for(var preConvertedData=new Float32Array(raw),i=0;i<preConvertedData.length;i++)preConvertedData[i]=preConvertedData[i]*vol_scale*.036749309;this.data=preConvertedData},$3Dmol.VolumeData.prototype.dx=function(str){var i,m,lines=str.split(/[\n\r]+/),recounts=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,reorig=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,redelta=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,follows=/data follows/;for(i=0;i<lines.length;i++){var line=lines[i];if(m=recounts.exec(line)){var nX=parseInt(m[1]),nY=parseInt(m[2]),nZ=parseInt(m[3]);this.size={x:nX,y:nY,z:nZ}}else if(m=redelta.exec(line)){var xunit=parseFloat(m[1]);if(0==parseFloat(m[2])&&0==parseFloat(m[3])||console.log("Non-orthogonal delta matrix not currently supported in dx format"),i+=1,line=lines[i],null==(m=redelta.exec(line)))return void console.log("Parse error in dx delta matrix");var yunit=parseFloat(m[2]);if(0==parseFloat(m[1])&&0==parseFloat(m[3])||console.log("Non-orthogonal delta matrix not currently supported in dx format"),i+=1,line=lines[i],null==(m=redelta.exec(line)))return void console.log("Parse error in dx delta matrix");var zunit=parseFloat(m[3]);0==parseFloat(m[1])&&0==parseFloat(m[2])||console.log("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new $3Dmol.Vector3(xunit,yunit,zunit)}else if(m=reorig.exec(line)){var xorig=parseFloat(m[1]),yorig=parseFloat(m[2]),zorig=parseFloat(m[3]);this.origin=new $3Dmol.Vector3(xorig,yorig,zorig)}else if(m=follows.exec(line))break}if(i+=1,this.size&&this.origin&&this.unit&&this.size){var raw=lines.splice(i).join(" ");raw=raw.split(/[\s\r]+/),this.data=new Float32Array(raw)}else console.log("Error parsing dx format")},$3Dmol.VolumeData.prototype.cube=function(str){var lines=str.replace(/^\s+/,"").split(/[\n\r]+/);if(!(lines.length<6)){var lineArr=lines[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),atomsnum=parseFloat(lineArr[0]),natoms=Math.abs(atomsnum),origin=this.origin=new $3Dmol.Vector3(parseFloat(lineArr[1]),parseFloat(lineArr[2]),parseFloat(lineArr[3])),convFactor=(lineArr=lines[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "))[0]>0?.529177:1;origin.multiplyScalar(convFactor);var nX=Math.abs(lineArr[0]),xVec=new $3Dmol.Vector3(parseFloat(lineArr[1]),parseFloat(lineArr[2]),parseFloat(lineArr[3])).multiplyScalar(convFactor);lineArr=lines[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var nY=Math.abs(lineArr[0]),yVec=new $3Dmol.Vector3(parseFloat(lineArr[1]),parseFloat(lineArr[2]),parseFloat(lineArr[3])).multiplyScalar(convFactor);lineArr=lines[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var nZ=Math.abs(lineArr[0]),zVec=new $3Dmol.Vector3(parseFloat(lineArr[1]),parseFloat(lineArr[2]),parseFloat(lineArr[3])).multiplyScalar(convFactor);this.size={x:nX,y:nY,z:nZ},this.unit=new $3Dmol.Vector3(xVec.x,yVec.y,zVec.z),0==xVec.y&&0==xVec.z&&0==yVec.x&&0==yVec.z&&0==zVec.x&&0==zVec.y||(this.matrix=new $3Dmol.Matrix4(xVec.x,yVec.x,zVec.x,0,xVec.y,yVec.y,zVec.y,0,xVec.z,yVec.z,zVec.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,(new $3Dmol.Matrix4).makeTranslation(origin.x,origin.y,origin.z)),this.origin=new $3Dmol.Vector3(0,0,0),this.unit=new $3Dmol.Vector3(1,1,1));var headerlines=6;atomsnum<0&&headerlines++;var raw=lines.splice(natoms+headerlines).join(" ");raw=(raw=raw.replace(/^\s+/,"")).split(/[\s\r]+/),this.data=new Float32Array(raw)}},$3Dmol.VolumeData.prototype.ccp4=function(bin){var header={};bin=new Int8Array(bin);var intView=new Int32Array(bin.buffer,0,56),floatView=new Float32Array(bin.buffer,0,56),dv=new DataView(bin.buffer);if(header.MAP=String.fromCharCode(dv.getUint8(208),dv.getUint8(209),dv.getUint8(210),dv.getUint8(211)),header.MACHST=[dv.getUint8(212),dv.getUint8(213)],17===header.MACHST[0]&&17===header.MACHST[1])for(var n=bin.byteLength,i=0;i<n;i+=4)dv.setFloat32(i,dv.getFloat32(i),!0);header.NX=intView[0],header.NY=intView[1],header.NZ=intView[2],header.MODE=intView[3],header.NXSTART=intView[4],header.NYSTART=intView[5],header.NZSTART=intView[6],header.MX=intView[7],header.MY=intView[8],header.MZ=intView[9],header.xlen=floatView[10],header.ylen=floatView[11],header.zlen=floatView[12],header.alpha=floatView[13],header.beta=floatView[14],header.gamma=floatView[15],header.MAPC=intView[16],header.MAPR=intView[17],header.MAPS=intView[18],header.DMIN=floatView[19],header.DMAX=floatView[20],header.DMEAN=floatView[21],header.ISPG=intView[22],header.NSYMBT=intView[23],header.LSKFLG=intView[24],header.originX=floatView[49],header.originY=floatView[50],header.originZ=floatView[51],header.ARMS=floatView[54];var h=header,basisX=[h.xlen,0,0],basisY=[h.ylen*Math.cos(Math.PI/180*h.gamma),h.ylen*Math.sin(Math.PI/180*h.gamma),0],basisZ=[h.zlen*Math.cos(Math.PI/180*h.beta),h.zlen*(Math.cos(Math.PI/180*h.alpha)-Math.cos(Math.PI/180*h.gamma)*Math.cos(Math.PI/180*h.beta))/Math.sin(Math.PI/180*h.gamma),0];basisZ[2]=Math.sqrt(h.zlen*h.zlen*Math.sin(Math.PI/180*h.beta)*Math.sin(Math.PI/180*h.beta)-basisZ[1]*basisZ[1]);var basis=[0,basisX,basisY,basisZ],nxyz=[0,h.MX,h.MY,h.MZ],mapcrs=[0,h.MAPC,h.MAPR,h.MAPS];this.matrix=new $3Dmol.Matrix4,this.matrix.set(basis[mapcrs[1]][0]/nxyz[mapcrs[1]],basis[mapcrs[2]][0]/nxyz[mapcrs[2]],basis[mapcrs[3]][0]/nxyz[mapcrs[3]],0,basis[mapcrs[1]][1]/nxyz[mapcrs[1]],basis[mapcrs[2]][1]/nxyz[mapcrs[2]],basis[mapcrs[3]][1]/nxyz[mapcrs[3]],0,basis[mapcrs[1]][2]/nxyz[mapcrs[1]],basis[mapcrs[2]][2]/nxyz[mapcrs[2]],basis[mapcrs[3]][2]/nxyz[mapcrs[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,(new $3Dmol.Matrix4).makeTranslation(h.NXSTART+h.originX,h.NYSTART+h.originY,h.NZSTART+h.originZ)),this.origin=new $3Dmol.Vector3(0,0,0),this.unit=new $3Dmol.Vector3(1,1,1),this.size={x:header.NX,y:header.NY,z:header.NZ};var data=new Float32Array(bin.buffer,1024+header.NSYMBT),NX=header.NX,NY=header.NY,NZ=header.NZ;this.data=new Float32Array(NX*NY*NZ);for(i=0;i<NX;i++)for(var j=0;j<NY;j++)for(var k=0;k<NZ;k++)this.data[(i*NY+j)*NZ+k]=data[(k*NY+j)*NX+i]},$3Dmol.VolumeData.prototype.ccp4.isbinary=!0,$3Dmol.workerString=function(){self.onmessage=function(oEvent){var obj=oEvent.data,type=obj.type;if(type<0)self.atomData=obj.atoms,self.volume=obj.volume,self.ps=new ProteinSurface;else{var ps=self.ps;ps.initparm(obj.expandedExtent,1!=type,self.volume),ps.fillvoxels(self.atomData,obj.extendedAtoms),ps.buildboundary(),4!==type&&2!==type||(ps.fastdistancemap(),ps.boundingatom(!1),ps.fillvoxelswaals(self.atomData,obj.extendedAtoms)),ps.marchingcube(type);var VandF=ps.getFacesAndVertices(obj.atomsToShow);self.postMessage(VandF)}}}.toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+="; var ProteinSurface="+$3Dmol.ProteinSurface.toString().replace(/[a-zA-Z_$]{1}[0-9a-zA-Z_$]*.MarchingCube./g,"MarchingCube."),$3Dmol.workerString+=",MarchingCube=("+$3Dmol.MarchingCubeInitializer.toString()+")();",$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):{postMessage:function(){}},$3Dmol.workerString=$3Dmol.workerString,$3Dmol.SurfaceWorker=$3Dmol.SurfaceWorker,function(){"use strict";$(document).on("click",".3dmol-cartoon",function(){$3Dmol.viewers[$(this).data("divid")].setStyle({cartoon:{color:"spectrum"}}).render()}),$(document).on("click",".3dmol-cross",function(){$3Dmol.viewers[$(this).data("divid")].setStyle({},{cross:{}}).render()}),$(document).on("click",".3dmol-line",function(){$3Dmol.viewers[$(this).data("divid")].setStyle({},{line:{}}).render()}),$(document).on("click",".3dmol-sphere",function(){$3Dmol.viewers[$(this).data("divid")].setStyle({},{sphere:{}}).render()}),$(document).on("click",".3dmol-stick",function(){$3Dmol.viewers[$(this).data("divid")].setStyle({},{stick:{}}).render()})}();var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={manual:_self.Prism&&_self.Prism.manual,util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){switch(n.util.type(e)){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){var i=(r=r||n.languages)[e];if(2==arguments.length){a=arguments[1];for(var l in a)a.hasOwnProperty(l)&&(i[l]=a[l]);return i}var o={};for(var s in i)if(i.hasOwnProperty(s)){if(s==t)for(var l in a)a.hasOwnProperty(l)&&(o[l]=a[l]);o[s]=i[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var i in e)e.hasOwnProperty(i)&&(t.call(e,i,e[i],a||i),"Object"!==n.util.type(e[i])||r[n.util.objId(e[i])]?"Array"!==n.util.type(e[i])||r[n.util.objId(e[i])]||(r[n.util.objId(e[i])]=!0,n.languages.DFS(e[i],t,i,r)):(r[n.util.objId(e[i])]=!0,n.languages.DFS(e[i],t,null,r)))}},plugins:{},highlightAll:function(e,t){var a={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var r,i=a.elements||document.querySelectorAll(a.selector),l=0;r=i[l++];)n.highlightElement(r,!0===e,a.callback)},highlightElement:function(t,a,r){for(var i,l,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(i=(o.className.match(e)||[,""])[1].toLowerCase(),l=n.languages[i]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+i,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+i);var u={element:t,language:i,grammar:l,code:t.textContent};if(n.hooks.run("before-sanity-check",u),!u.code||!u.grammar)return u.code&&(n.hooks.run("before-highlight",u),u.element.textContent=u.code,n.hooks.run("after-highlight",u)),void n.hooks.run("complete",u);if(n.hooks.run("before-highlight",u),a&&_self.Worker){var g=new Worker(n.filename);g.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},g.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var i=n.tokenize(e,t);return a.stringify(n.util.encode(i),r)},matchGrammar:function(e,t,a,r,i,l,o){var s=n.Token;for(var u in a)if(a.hasOwnProperty(u)&&a[u]){if(u==o)return;var g=a[u];g="Array"===n.util.type(g)?g:[g];for(var c=0;c<g.length;++c){var h=g[c],f=h.inside,d=!!h.lookbehind,m=!!h.greedy,p=0,y=h.alias;if(m&&!h.pattern.global){var v=h.pattern.toString().match(/[imuy]*$/)[0];h.pattern=RegExp(h.pattern.source,v+"g")}h=h.pattern||h;for(var b=r,k=i;b<t.length;k+=t[b].length,++b){var w=t[b];if(t.length>e.length)return;if(!(w instanceof s)){h.lastIndex=0;var _=h.exec(w),P=1;if(!_&&m&&b!=t.length-1){if(h.lastIndex=k,!(_=h.exec(e)))break;for(var A=_.index+(d?_[1].length:0),j=_.index+_[0].length,x=b,O=k,S=t.length;S>x&&(j>O||!t[x].type&&!t[x-1].greedy);++x)O+=t[x].length,A>=O&&(++b,k=O);if(t[b]instanceof s||t[x-1].greedy)continue;P=x-b,w=e.slice(k,O),_.index-=k}if(_){d&&(p=_[1].length);var j=(A=_.index+p)+(_=_[0].slice(p)).length,N=w.slice(0,A),C=w.slice(j),E=[b,P];N&&(++b,k+=N.length,E.push(N));var L=new s(u,f?n.tokenize(_,f):_,y,_,m);if(E.push(L),C&&E.push(C),Array.prototype.splice.apply(t,E),1!=P&&n.matchGrammar(e,t,a,b,k,!0,u),l)break}else if(l)break}}}}},tokenize:function(e,t){var a=[e],r=t.rest;if(r){for(var i in r)t[i]=r[i];delete t.rest}return n.matchGrammar(e,a,t,0,0,!1),a},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,i=0;r=a[i++];)r(t)}}},a=n.Token=function(e,t,n,a,r){this.type=e,this.content=t,this.alias=n,this.length=0|(a||"").length,this.greedy=!!r};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var i={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==i.type&&(i.attributes.spellcheck="true"),e.alias){var l="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(i.classes,l)}n.hooks.run("wrap",i);var o=Object.keys(i.attributes).map(function(e){return e+'="'+(i.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+i.tag+' class="'+i.classes.join(" ")+'"'+(o?" "+o:"")+">"+i.content+"</"+i.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,i=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),i&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,!document.addEventListener||n.manual||r.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(n.highlightAll):window.setTimeout(n.highlightAll,16):document.addEventListener("DOMContentLoaded",n.highlightAll))),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism),Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(true|false)\b/,function:/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,function:/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i,operator:/-[-=]?|\+[+=]?|!=?=?|<<?=?|>>?>?=?|=(?:==?|>)?|&[&=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),Prism.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\s\S]*?>)[\s\S]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript"}}),Prism.languages.js=Prism.languages.javascript,function(e){var t={variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b-?(?:0x[\dA-Fa-f]+|\d*\.?\d+(?:[Ee]-?\d+)?)\b/,operator:/--?|-=|\+\+?|\+=|!=?|~|\*\*?|\*=|\/=?|%=?|<<=?|>>=?|<=?|>=?|==?|&&?|&=|\^=?|\|\|?|\|=|\?|:/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\([^)]+\)|`[^`]+`/,inside:{variable:/^\$\(|^`|\)$|`$/}},/\$(?:[a-z0-9_#\?\*!@]+|\{[^}]+\})/i]};e.languages.bash={shebang:{pattern:/^#!\s*\/bin\/bash|^#!\s*\/bin\/sh/,alias:"important"},comment:{pattern:/(^|[^"{\\])#.*/,lookbehind:!0},string:[{pattern:/((?:^|[^<])<<\s*)(?:"|')?(\w+?)(?:"|')?\s*\r?\n(?:[\s\S])*?\r?\n\2/g,lookbehind:!0,greedy:!0,inside:t},{pattern:/(["'])(?:\\\\|\\?[^\\])*?\1/g,greedy:!0,inside:t}],variable:t.variable,function:{pattern:/(^|\s|;|\||&)(?:alias|apropos|apt-get|aptitude|aspell|awk|basename|bash|bc|bg|builtin|bzip2|cal|cat|cd|cfdisk|chgrp|chmod|chown|chroot|chkconfig|cksum|clear|cmp|comm|command|cp|cron|crontab|csplit|cut|date|dc|dd|ddrescue|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|du|egrep|eject|enable|env|ethtool|eval|exec|expand|expect|export|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|getopts|git|grep|groupadd|groupdel|groupmod|groups|gzip|hash|head|help|hg|history|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|jobs|join|kill|killall|less|link|ln|locate|logname|logout|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|make|man|mkdir|mkfifo|mkisofs|mknod|more|most|mount|mtools|mtr|mv|mmv|nano|netstat|nice|nl|nohup|notify-send|npm|nslookup|open|op|passwd|paste|pathchk|ping|pkill|popd|pr|printcap|printenv|printf|ps|pushd|pv|pwd|quota|quotacheck|quotactl|ram|rar|rcp|read|readarray|readonly|reboot|rename|renice|remsync|rev|rm|rmdir|rsync|screen|scp|sdiff|sed|seq|service|sftp|shift|shopt|shutdown|sleep|slocate|sort|source|split|ssh|stat|strace|su|sudo|sum|suspend|sync|tail|tar|tee|test|time|timeout|times|touch|top|traceroute|trap|tr|tsort|tty|type|ulimit|umask|umount|unalias|uname|unexpand|uniq|units|unrar|unshar|uptime|useradd|userdel|usermod|users|uuencode|uudecode|v|vdir|vi|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yes|zip)(?=$|\s|;|\||&)/,lookbehind:!0},keyword:{pattern:/(^|\s|;|\||&)(?:let|:|\.|if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)(?=$|\s|;|\||&)/,lookbehind:!0},boolean:{pattern:/(^|\s|;|\||&)(?:true|false)(?=$|\s|;|\||&)/,lookbehind:!0},operator:/&&?|\|\|?|==?|!=?|<<<?|>>|<=?|>=?|=~/,punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];]/};var a=t.variable[1].inside;a.function=e.languages.bash.function,a.keyword=e.languages.bash.keyword,a.boolean=e.languages.bash.boolean,a.operator=e.languages.bash.operator,a.punctuation=e.languages.bash.punctuation}(Prism),Prism.languages.c=Prism.languages.extend("clike",{keyword:/\b(asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while)\b/,operator:/\-[>-]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|?\||[~^%?*\/]/,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)[ful]*\b/i}),Prism.languages.insertBefore("c","string",{macro:{pattern:/(^\s*)#\s*[a-z]+([^\r\n\\]|\\.|\\(?:\r\n?|\n))*/im,lookbehind:!0,alias:"property",inside:{string:{pattern:/(#\s*include\s*)(<.+?>|("|')(\\?.)+?\3)/,lookbehind:!0},directive:{pattern:/(#\s*)\b(define|elif|else|endif|error|ifdef|ifndef|if|import|include|line|pragma|undef|using)\b/,lookbehind:!0,alias:"keyword"}}},constant:/\b(__FILE__|__LINE__|__DATE__|__TIME__|__TIMESTAMP__|__func__|EOF|NULL|stdin|stdout|stderr)\b/}),delete Prism.languages.c["class-name"],delete Prism.languages.c.boolean,Prism.languages.cpp=Prism.languages.extend("c",{keyword:/\b(alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|float|for|friend|goto|if|inline|int|long|mutable|namespace|new|noexcept|nullptr|operator|private|protected|public|register|reinterpret_cast|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,boolean:/\b(true|false)\b/,operator:/[-+]{1,2}|!=?|<{1,2}=?|>{1,2}=?|\->|:{1,2}|={1,2}|\^|~|%|&{1,2}|\|?\||\?|\*|\/|\b(and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/}),Prism.languages.insertBefore("cpp","keyword",{"class-name":{pattern:/(class\s+)[a-z0-9_]+/i,lookbehind:!0}}),function(e){e.languages.ruby=e.languages.extend("clike",{comment:[/#(?!\{[^\r\n]*?\}).*/,/^=begin(?:\r?\n|\r)(?:.*(?:\r?\n|\r))*?=end/m],keyword:/\b(alias|and|BEGIN|begin|break|case|class|def|define_method|defined|do|each|else|elsif|END|end|ensure|false|for|if|in|module|new|next|nil|not|or|raise|redo|require|rescue|retry|return|self|super|then|throw|true|undef|unless|until|when|while|yield)\b/});var n={pattern:/#\{[^}]+\}/,inside:{delimiter:{pattern:/^#\{|\}$/,alias:"tag"},rest:e.util.clone(e.languages.ruby)}};e.languages.insertBefore("ruby","keyword",{regex:[{pattern:/%r([^a-zA-Z0-9\s\{\(\[<])(?:[^\\]|\\[\s\S])*?\1[gim]{0,3}/,greedy:!0,inside:{interpolation:n}},{pattern:/%r\((?:[^()\\]|\\[\s\S])*\)[gim]{0,3}/,greedy:!0,inside:{interpolation:n}},{pattern:/%r\{(?:[^#{}\\]|#(?:\{[^}]+\})?|\\[\s\S])*\}[gim]{0,3}/,greedy:!0,inside:{interpolation:n}},{pattern:/%r\[(?:[^\[\]\\]|\\[\s\S])*\][gim]{0,3}/,greedy:!0,inside:{interpolation:n}},{pattern:/%r<(?:[^<>\\]|\\[\s\S])*>[gim]{0,3}/,greedy:!0,inside:{interpolation:n}},{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}],variable:/[@$]+[a-zA-Z_][a-zA-Z_0-9]*(?:[?!]|\b)/,symbol:/:[a-zA-Z_][a-zA-Z_0-9]*(?:[?!]|\b)/}),e.languages.insertBefore("ruby","number",{builtin:/\b(Array|Bignum|Binding|Class|Continuation|Dir|Exception|FalseClass|File|Stat|File|Fixnum|Float|Hash|Integer|IO|MatchData|Method|Module|NilClass|Numeric|Object|Proc|Range|Regexp|String|Struct|TMS|Symbol|ThreadGroup|Thread|Time|TrueClass)\b/,constant:/\b[A-Z][a-zA-Z_0-9]*(?:[?!]|\b)/}),e.languages.ruby.string=[{pattern:/%[qQiIwWxs]?([^a-zA-Z0-9\s\{\(\[<])(?:[^\\]|\\[\s\S])*?\1/,greedy:!0,inside:{interpolation:n}},{pattern:/%[qQiIwWxs]?\((?:[^()\\]|\\[\s\S])*\)/,greedy:!0,inside:{interpolation:n}},{pattern:/%[qQiIwWxs]?\{(?:[^#{}\\]|#(?:\{[^}]+\})?|\\[\s\S])*\}/,greedy:!0,inside:{interpolation:n}},{pattern:/%[qQiIwWxs]?\[(?:[^\[\]\\]|\\[\s\S])*\]/,greedy:!0,inside:{interpolation:n}},{pattern:/%[qQiIwWxs]?<(?:[^<>\\]|\\[\s\S])*>/,greedy:!0,inside:{interpolation:n}},{pattern:/("|')(#\{[^}]+\}|\\(?:\r?\n|\r)|\\?.)*?\1/,greedy:!0,inside:{interpolation:n}}]}(Prism),Prism.languages.fortran={"quoted-number":{pattern:/[BOZ](['"])[A-F0-9]+\1/i,alias:"number"},string:{pattern:/(?:\w+_)?(['"])(?:\1\1|&(?:\r\n?|\n)(?:\s*!.+(?:\r\n?|\n))?|(?!\1).)*(?:\1|&)/,inside:{comment:{pattern:/(&(?:\r\n?|\n)\s*)!.*/,lookbehind:!0}}},comment:/!.*/,boolean:/\.(?:TRUE|FALSE)\.(?:_\w+)?/i,number:/(?:\b|[+-])(?:\d+(?:\.\d*)?|\.\d+)(?:[ED][+-]?\d+)?(?:_\w+)?/i,keyword:[/\b(?:INTEGER|REAL|DOUBLE ?PRECISION|COMPLEX|CHARACTER|LOGICAL)\b/i,/\b(?:END ?)?(?:BLOCK ?DATA|DO|FILE|FORALL|FUNCTION|IF|INTERFACE|MODULE(?! PROCEDURE)|PROGRAM|SELECT|SUBROUTINE|TYPE|WHERE)\b/i,/\b(?:ALLOCATABLE|ALLOCATE|BACKSPACE|CALL|CASE|CLOSE|COMMON|CONTAINS|CONTINUE|CYCLE|DATA|DEALLOCATE|DIMENSION|DO|END|EQUIVALENCE|EXIT|EXTERNAL|FORMAT|GO ?TO|IMPLICIT(?: NONE)?|INQUIRE|INTENT|INTRINSIC|MODULE PROCEDURE|NAMELIST|NULLIFY|OPEN|OPTIONAL|PARAMETER|POINTER|PRINT|PRIVATE|PUBLIC|READ|RETURN|REWIND|SAVE|SELECT|STOP|TARGET|WHILE|WRITE)\b/i,/\b(?:ASSIGNMENT|DEFAULT|ELEMENTAL|ELSE|ELSEWHERE|ELSEIF|ENTRY|IN|INCLUDE|INOUT|KIND|NULL|ONLY|OPERATOR|OUT|PURE|RECURSIVE|RESULT|SEQUENCE|STAT|THEN|USE)\b/i],operator:[/\*\*|\/\/|=>|[=\/]=|[<>]=?|::|[+\-*=%]|\.(?:EQ|NE|LT|LE|GT|GE|NOT|AND|OR|EQV|NEQV)\.|\.[A-Z]+\./i,{pattern:/(^|(?!\().)\/(?!\))/,lookbehind:!0}],punctuation:/\(\/|\/\)|[(),;:&]/},Prism.languages.go=Prism.languages.extend("clike",{keyword:/\b(break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,builtin:/\b(bool|byte|complex(64|128)|error|float(32|64)|rune|string|u?int(8|16|32|64|)|uintptr|append|cap|close|complex|copy|delete|imag|len|make|new|panic|print(ln)?|real|recover)\b/,boolean:/\b(_|iota|nil|true|false)\b/,operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,number:/\b(-?(0x[a-f\d]+|(\d+\.?\d*|\.\d+)(e[-+]?\d+)?)i?)\b/i,string:{pattern:/("|'|`)(\\?.|\r|\n)*?\1/,greedy:!0}}),delete Prism.languages.go["class-name"],Prism.languages.java=Prism.languages.extend("clike",{keyword:/\b(abstract|continue|for|new|switch|assert|default|goto|package|synchronized|boolean|do|if|private|this|break|double|implements|protected|throw|byte|else|import|public|throws|case|enum|instanceof|return|transient|catch|extends|int|short|try|char|final|interface|static|void|class|finally|long|strictfp|volatile|const|float|native|super|while)\b/,number:/\b0b[01]+\b|\b0x[\da-f]*\.?[\da-fp\-]+\b|\b\d*\.?\d+(?:e[+-]?\d+)?[df]?\b/i,operator:{pattern:/(^|[^.])(?:\+[+=]?|-[-=]?|!=?|<<?=?|>>?>?=?|==?|&[&=]?|\|[|=]?|\*=?|\/=?|%=?|\^=?|[?:~])/m,lookbehind:!0}}),Prism.languages.insertBefore("java","function",{annotation:{alias:"punctuation",pattern:/(^|[^.])@\w+/,lookbehind:!0}}),Prism.languages.julia={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},string:/"""[\s\S]+?"""|'''[\s\S]+?'''|("|')(\\?.)*?\1/,keyword:/\b(abstract|baremodule|begin|bitstype|break|catch|ccall|const|continue|do|else|elseif|end|export|finally|for|function|global|if|immutable|import|importall|let|local|macro|module|print|println|quote|return|try|type|typealias|using|while)\b/,boolean:/\b(true|false)\b/,number:/\b-?(0[box])?(?:[\da-f]+\.?\d*|\.\d+)(?:[efp][+-]?\d+)?j?\b/i,operator:/\+=?|-=?|\*=?|\/[\/=]?|\\=?|\^=?|%=?|÷=?|!=?=?|&=?|\|[=>]?|\$=?|<(?:<=?|[=:])?|>(?:=|>>?=?)?|==?=?|[~≠≤≥]/,punctuation:/[{}[\];(),.:]/},function(a){var e=/\\([^a-z()[\]]|[a-z\*]+)/i,n={"equation-command":{pattern:e,alias:"regex"}};Prism.languages.latex={comment:/%.*/m,cdata:{pattern:/(\\begin\{((?:verbatim|lstlisting)\*?)\})([\s\S]*?)(?=\\end\{\2\})/,lookbehind:!0},equation:[{pattern:/\$(?:\\?[\s\S])*?\$|\\\((?:\\?[\s\S])*?\\\)|\\\[(?:\\?[\s\S])*?\\\]/,inside:n,alias:"string"},{pattern:/(\\begin\{((?:equation|math|eqnarray|align|multline|gather)\*?)\})([\s\S]*?)(?=\\end\{\2\})/,lookbehind:!0,inside:n,alias:"string"}],keyword:{pattern:/(\\(?:begin|end|ref|cite|label|usepackage|documentclass)(?:\[[^\]]+\])?\{)[^}]+(?=\})/,lookbehind:!0},url:{pattern:/(\\url\{)[^}]+(?=\})/,lookbehind:!0},headline:{pattern:/(\\(?:part|chapter|section|subsection|frametitle|subsubsection|paragraph|subparagraph|subsubparagraph|subsubsubparagraph)\*?(?:\[[^\]]+\])?\{)[^}]+(?=\}(?:\[[^\]]+\])?)/,lookbehind:!0,alias:"class-name"},function:{pattern:e,alias:"selector"},punctuation:/[[\]{}&]/}}(),Prism.languages.makefile={comment:{pattern:/(^|[^\\])#(?:\\(?:\r\n|[\s\S])|.)*/,lookbehind:!0},string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},builtin:/\.[A-Z][^:#=\s]+(?=\s*:(?!=))/,symbol:{pattern:/^[^:=\r\n]+(?=\s*:(?!=))/m,inside:{variable:/\$+(?:[^(){}:#=\s]+|(?=[({]))/}},variable:/\$+(?:[^(){}:#=\s]+|\([@*%<^+?][DF]\)|(?=[({]))/,keyword:[/-include\b|\b(?:define|else|endef|endif|export|ifn?def|ifn?eq|include|override|private|sinclude|undefine|unexport|vpath)\b/,{pattern:/(\()(?:addsuffix|abspath|and|basename|call|dir|error|eval|file|filter(?:-out)?|findstring|firstword|flavor|foreach|guile|if|info|join|lastword|load|notdir|or|origin|patsubst|realpath|shell|sort|strip|subst|suffix|value|warning|wildcard|word(?:s|list)?)(?=[ \t])/,lookbehind:!0}],operator:/(?:::|[?:+!])?=|[|@]/,punctuation:/[:;(){}]/},Prism.languages.matlab={string:/\B'(?:''|[^'\n])*'/,comment:[/%\{[\s\S]*?\}%/,/%.+/],number:/\b-?(?:\d*\.?\d+(?:[eE][+-]?\d+)?(?:[ij])?|[ij])\b/,keyword:/\b(?:break|case|catch|continue|else|elseif|end|for|function|if|inf|NaN|otherwise|parfor|pause|pi|return|switch|try|while)\b/,function:/(?!\d)\w+(?=\s*\()/,operator:/\.?[*^\/\\']|[+\-:@]|[<>=~]=?|&&?|\|\|?/,punctuation:/\.{3}|[.,;\[\](){}!]/},Prism.languages.perl={comment:[{pattern:/(^\s*)=\w+[\s\S]*?=cut.*/m,lookbehind:!0},{pattern:/(^|[^\\$])#.*/,lookbehind:!0}],string:[{pattern:/\b(?:q|qq|qx|qw)\s*([^a-zA-Z0-9\s\{\(\[<])(?:[^\\]|\\[\s\S])*?\1/,greedy:!0},{pattern:/\b(?:q|qq|qx|qw)\s+([a-zA-Z0-9])(?:[^\\]|\\[\s\S])*?\1/,greedy:!0},{pattern:/\b(?:q|qq|qx|qw)\s*\((?:[^()\\]|\\[\s\S])*\)/,greedy:!0},{pattern:/\b(?:q|qq|qx|qw)\s*\{(?:[^{}\\]|\\[\s\S])*\}/,greedy:!0},{pattern:/\b(?:q|qq|qx|qw)\s*\[(?:[^[\]\\]|\\[\s\S])*\]/,greedy:!0},{pattern:/\b(?:q|qq|qx|qw)\s*<(?:[^<>\\]|\\[\s\S])*>/,greedy:!0},{pattern:/("|`)(?:[^\\]|\\[\s\S])*?\1/,greedy:!0},{pattern:/'(?:[^'\\\r\n]|\\.)*'/,greedy:!0}],regex:[{pattern:/\b(?:m|qr)\s*([^a-zA-Z0-9\s\{\(\[<])(?:[^\\]|\\[\s\S])*?\1[msixpodualngc]*/,greedy:!0},{pattern:/\b(?:m|qr)\s+([a-zA-Z0-9])(?:[^\\]|\\.)*?\1[msixpodualngc]*/,greedy:!0},{pattern:/\b(?:m|qr)\s*\((?:[^()\\]|\\[\s\S])*\)[msixpodualngc]*/,greedy:!0},{pattern:/\b(?:m|qr)\s*\{(?:[^{}\\]|\\[\s\S])*\}[msixpodualngc]*/,greedy:!0},{pattern:/\b(?:m|qr)\s*\[(?:[^[\]\\]|\\[\s\S])*\][msixpodualngc]*/,greedy:!0},{pattern:/\b(?:m|qr)\s*<(?:[^<>\\]|\\[\s\S])*>[msixpodualngc]*/,greedy:!0},{pattern:/(^|[^-]\b)(?:s|tr|y)\s*([^a-zA-Z0-9\s\{\(\[<])(?:[^\\]|\\[\s\S])*?\2(?:[^\\]|\\[\s\S])*?\2[msixpodualngcer]*/,lookbehind:!0,greedy:!0},{pattern:/(^|[^-]\b)(?:s|tr|y)\s+([a-zA-Z0-9])(?:[^\\]|\\[\s\S])*?\2(?:[^\\]|\\[\s\S])*?\2[msixpodualngcer]*/,lookbehind:!0,greedy:!0},{pattern:/(^|[^-]\b)(?:s|tr|y)\s*\((?:[^()\\]|\\[\s\S])*\)\s*\((?:[^()\\]|\\[\s\S])*\)[msixpodualngcer]*/,lookbehind:!0,greedy:!0},{pattern:/(^|[^-]\b)(?:s|tr|y)\s*\{(?:[^{}\\]|\\[\s\S])*\}\s*\{(?:[^{}\\]|\\[\s\S])*\}[msixpodualngcer]*/,lookbehind:!0,greedy:!0},{pattern:/(^|[^-]\b)(?:s|tr|y)\s*\[(?:[^[\]\\]|\\[\s\S])*\]\s*\[(?:[^[\]\\]|\\[\s\S])*\][msixpodualngcer]*/,lookbehind:!0,greedy:!0},{pattern:/(^|[^-]\b)(?:s|tr|y)\s*<(?:[^<>\\]|\\[\s\S])*>\s*<(?:[^<>\\]|\\[\s\S])*>[msixpodualngcer]*/,lookbehind:!0,greedy:!0},{pattern:/\/(?:[^\/\\\r\n]|\\.)*\/[msixpodualngc]*(?=\s*(?:$|[\r\n,.;})&|\-+*~<>!?^]|(lt|gt|le|ge|eq|ne|cmp|not|and|or|xor|x)\b))/,greedy:!0}],variable:[/[&*$@%]\{\^[A-Z]+\}/,/[&*$@%]\^[A-Z_]/,/[&*$@%]#?(?=\{)/,/[&*$@%]#?((::)*'?(?!\d)[\w$]+)+(::)*/i,/[&*$@%]\d+/,/(?!%=)[$@%][!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~]/],filehandle:{pattern:/<(?![<=])\S*>|\b_\b/,alias:"symbol"},vstring:{pattern:/v\d+(\.\d+)*|\d+(\.\d+){2,}/,alias:"string"},function:{pattern:/sub [a-z0-9_]+/i,inside:{keyword:/sub/}},keyword:/\b(any|break|continue|default|delete|die|do|else|elsif|eval|for|foreach|given|goto|if|last|local|my|next|our|package|print|redo|require|say|state|sub|switch|undef|unless|until|use|when|while)\b/,number:/\b-?(0x[\dA-Fa-f](_?[\dA-Fa-f])*|0b[01](_?[01])*|(\d(_?\d)*)?\.?\d(_?\d)*([Ee][+-]?\d+)?)\b/,operator:/-[rwxoRWXOezsfdlpSbctugkTBMAC]\b|\+[+=]?|-[-=>]?|\*\*?=?|\/\/?=?|=[=~>]?|~[~=]?|\|\|?=?|&&?=?|<(?:=>?|<=?)?|>>?=?|![~=]?|[%^]=?|\.(?:=|\.\.?)?|[\\?]|\bx(?:=|\b)|\b(lt|gt|le|ge|eq|ne|cmp|not|and|or|xor)\b/,punctuation:/[{}[\];(),:]/},Prism.languages.python={"triple-quoted-string":{pattern:/"""[\s\S]+?"""|'''[\s\S]+?'''/,alias:"string"},comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},string:{pattern:/("|')(?:\\\\|\\?[^\\\r\n])*?\1/,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_][a-zA-Z0-9_]*(?=\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)[a-z0-9_]+/i,lookbehind:!0},keyword:/\b(?:as|assert|async|await|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|pass|print|raise|return|try|while|with|yield)\b/,boolean:/\b(?:True|False)\b/,number:/\b-?(?:0[bo])?(?:(?:\d|0x[\da-f])[\da-f]*\.?\d*|\.\d+)(?:e[+-]?\d+)?j?\b/i,operator:/[-+%=]=?|!=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]|\b(?:or|and|not)\b/,punctuation:/[{}[\];(),.:]/},Prism.languages.r={comment:/#.*/,string:{pattern:/(['"])(?:\\?.)*?\1/,greedy:!0},"percent-operator":{pattern:/%[^%\s]*%/,alias:"operator"},boolean:/\b(?:TRUE|FALSE)\b/,ellipsis:/\.\.(?:\.|\d+)/,number:[/\b(?:NaN|Inf)\b/,/\b(?:0x[\dA-Fa-f]+(?:\.\d*)?|\d*\.?\d+)(?:[EePp][+-]?\d+)?[iL]?\b/],keyword:/\b(?:if|else|repeat|while|function|for|in|next|break|NULL|NA|NA_integer_|NA_real_|NA_complex_|NA_character_)\b/,operator:/->?>?|<(?:=|<?-)?|[>=!]=?|::?|&&?|\|\|?|[+*\/^$@~]/,punctuation:/[(){}\[\],;]/};