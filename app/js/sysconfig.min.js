/*! elabftw https://www.elabftw.net */

!function(){"use strict";$(document).ready(function(){function toggleMailMethod(method){switch(method){case"sendmail":$("#smtp_config").hide(),$("#sendmail_config").show();break;case"smtp":$("#smtp_config").show(),$("#sendmail_config").hide();break;case"php":$("#smtp_config").hide(),$("#sendmail_config").hide(),$("#general_mail_config").show();break;default:$("#smtp_config").hide(),$("#sendmail_config").hide(),$("#general_mail_config").hide()}}var Teams={controller:"app/controllers/SysconfigController.php",create:function(){document.getElementById("teamsCreateButton").disabled=!0;var name=$("#teamsName").val();$.post(this.controller,{teamsCreate:!0,teamsName:name}).done(function(data){Teams.destructor(data)})},update:function(id){document.getElementById("teamsUpdateButton_"+id).disabled=!0;var name=$("#teamName_"+id).val(),orgid=$("#teamOrgid_"+id).val();$.post(this.controller,{teamsUpdate:!0,teamsUpdateId:id,teamsUpdateName:name,teamsUpdateOrgid:orgid}).done(function(data){Teams.destructor(data)})},destroy:function(id){document.getElementById("teamsDestroyButton_"+id).disabled=!0,$.post(this.controller,{teamsDestroy:!0,teamsDestroyId:id}).done(function(data){Teams.destructor(data)})},destructor:function(data){data.res?(notif(data.msg,"ok"),$("#teamsDiv").load("sysconfig.php #teamsDiv")):notif(data.msg,"ko")}};$(document).on("keyup",".teamNameInput",function(){document.getElementById("teamsUpdateButton_"+$(this).data("id")).disabled=!1}),$(document).on("click","#teamsCreateButton",function(){Teams.create()}),$(document).on("click",".teamsUpdateButton",function(){Teams.update($(this).data("id"))}),$(document).on("click",".teamsDestroyButton",function(){Teams.destroy($(this).data("id"))}),$(document).on("click",".teamsArchiveButton",function(){notif("Feature not yet implemented :)","ok")}),$(document).on("click","#promoteSysadminButton",function(){document.getElementById("promoteSysadminButton").disabled=!0;var email=$("#promoteSysadmin").val();$.post("app/controllers/SysconfigController.php",{promoteSysadmin:!0,email:email}).done(function(data){data.res?(notif(data.msg,"ok"),$("#teamsDiv").load("sysconfig.php #teamsDiv")):notif(data.msg,"ko")})}),$(document).on("change","#selectMailMethod",function(){toggleMailMethod($(this).val())}),$(document).on("click","#massSend",function(){$("#massSend").prop("disabled",!0),$("#massSend").text("Sending…"),$.post("app/controllers/SysconfigController.php",{massEmail:!0,subject:$("#massSubject").val(),body:$("#massBody").val()}).done(function(data){data.res?(notif(data.msg,"ok"),$("#massSend").text("Sent!")):(notif(data.msg,"ko"),$("#massSend").prop("disabled",!1),$("#massSend").css("background-color","#e6614c"),$("#massSend").text("Error"))})}),$(document).on("click","#testemailButton",function(){var email=$("#testemailEmail").val();document.getElementById("testemailButton").disabled=!0,$("#testemailButton").text("Sending…"),$.post("app/controllers/SysconfigController.php",{testemailSend:!0,testemailEmail:email}).done(function(data){data.res?(notif(data.msg,"ok"),$("#massSend").text("Sent!"),document.getElementById("testemailButton").disabled=!1):(notif(data.msg,"ko"),$("#testemailButton").text("Error"),$("#testemailButton").css("background-color","#e6614c"))})}),$(document).on("click","#logsDestroyButton",function(){document.getElementById("logsDestroyButton").disabled=!0,$.post("app/controllers/SysconfigController.php",{logsDestroy:!0}).done(function(data){data.res?(notif(data.msg,"ok"),$("#logsDiv").load("sysconfig.php #logsDiv")):notif(data.msg,"ko")})}),$(document).on("click","#editSmtpPassword",function(){$("#hidden_smtp_password").toggle()});for(var input_list=document.getElementsByTagName("input"),i=0;i<input_list.length;i++)input_list[i].disabled=!1;toggleMailMethod($("#selectMailMethod").val())})}();